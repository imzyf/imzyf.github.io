<!DOCTYPE html>
<html lang="zh-cn">
  <head><meta name="generator" content="Hexo 3.8.0">
    
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">


<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">

<meta name="theme-color" content="#f8f5ec">
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">



  <meta name="description" content="【Modern PHP】读书笔记">




  <meta name="keywords" content="php, Yifans_Z Blog">










  <link rel="alternate" href="/atom.xml" title="Yifans_Z Blog">




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=2.10.3">



<link rel="canonical" href="https://zyf.im/2018/05/08/modern-php-reading-notes/">



  <link rel="stylesheet" type="text/css" href="/lib/fancybox/jquery.fancybox.css">






<link rel="stylesheet" type="text/css" href="/css/style.css?v=2.10.3">



  


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-84666938-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-84666938-1');
</script>


  <script id="baidu_push">
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>





  <script src="//cdn1.lncld.net/static/js/3.1.1/av-min.js"></script>
  <script id="leancloud">
    AV.init({
      appId: "er5hlK0M8mWKUTrVtqnHl97N-gzGzoHsz",
      appKey: "a6lIOEoJs3ijGvj3eP2rkFGG"
    });
  </script>





<script>
  window.config = {"leancloud":{"app_id":"er5hlK0M8mWKUTrVtqnHl97N-gzGzoHsz","app_key":"a6lIOEoJs3ijGvj3eP2rkFGG"},"toc":true,"fancybox":true,"pjax":false};
</script>

<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
  (adsbygoogle = window.adsbygoogle || []).push({
    google_ad_client: "ca-pub-2330747317815601",
    enable_page_level_ads: true
  });
</script>

    <title> 【Modern PHP】读书笔记 - Yifans_Z Blog </title>
  </head>

  <body><div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/." class="logo">Yifans_Z Blog</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>

<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    
      <a href="/">
        <li class="mobile-menu-item">
          
          
            首页
          
        </li>
      </a>
    
      <a href="/archives/">
        <li class="mobile-menu-item">
          
          
            归档
          
        </li>
      </a>
    
      <a href="/tags">
        <li class="mobile-menu-item">
          
          
            标签
          
        </li>
      </a>
    
      <a href="/about">
        <li class="mobile-menu-item">
          
          
            关于
          
        </li>
      </a>
    
  </ul>
</nav>

    <div class="container" id="mobile-panel">
      <header id="header" class="header"><div class="logo-wrapper">
  <a href="/." class="logo">Yifans_Z Blog</a>
</div>

<nav class="site-navbar">
  
    <ul id="menu" class="menu">
      
        <li class="menu-item">
          <a class="menu-item-link" href="/">
            
            
              首页
            
          </a>
        </li>
      
        <li class="menu-item">
          <a class="menu-item-link" href="/archives/">
            
            
              归档
            
          </a>
        </li>
      
        <li class="menu-item">
          <a class="menu-item-link" href="/tags">
            
            
              标签
            
          </a>
        </li>
      
        <li class="menu-item">
          <a class="menu-item-link" href="/about">
            
            
              关于
            
          </a>
        </li>
      
    </ul>
  
</nav>

      </header>

      <main id="main" class="main">
        <div class="content-wrapper">
          <div id="content" class="content">
            
  
  <article class="post">
    <header class="post-header">
      <h1 class="post-title">
        
          【Modern PHP】读书笔记
        
      </h1>

      <div class="post-meta">
        <span class="post-time">
          2018-05-08
        </span>
        
        
        <span class="post-visits" data-url="/2018/05/08/modern-php-reading-notes/" data-title="【Modern PHP】读书笔记">
          阅读次数 0
        </span>
        
      </div>
    </header>

    
    
  <div class="post-toc" id="post-toc">
    <h2 class="post-toc-title">文章目录</h2>
    <div class="post-toc-content">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#特性"><span class="toc-text">特性</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#命名空间"><span class="toc-text">命名空间</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#使用接口"><span class="toc-text">使用接口</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#性状-trait"><span class="toc-text">性状 trait</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#生成器"><span class="toc-text">生成器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#闭包"><span class="toc-text">闭包</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Zend-OPcache"><span class="toc-text">Zend OPcache</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#内置的-HTTP-服务器"><span class="toc-text">内置的 HTTP 服务器</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#标准"><span class="toc-text">标准</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#PSR-是什么"><span class="toc-text">PSR 是什么</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#组件"><span class="toc-text">组件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#查找组件"><span class="toc-text">查找组件</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#良好实践"><span class="toc-text">良好实践</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#流"><span class="toc-text">流</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#错误和异常"><span class="toc-text">错误和异常</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#调优"><span class="toc-text">调优</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#内存"><span class="toc-text">内存</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Zend-OPcache-1"><span class="toc-text">Zend OPcache</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#文件上传"><span class="toc-text">文件上传</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#会话处理"><span class="toc-text">会话处理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#缓冲输出"><span class="toc-text">缓冲输出</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#真实路径缓存"><span class="toc-text">真实路径缓存</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#部署"><span class="toc-text">部署</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#测试"><span class="toc-text">测试</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#分析"><span class="toc-text">分析</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#HHVM-和-Hack"><span class="toc-text">HHVM 和 Hack</span></a></li></ol>
    </div>
  </div>



    <div class="post-content">
      
        <p>又回到 PHP Web 开发，使用 Laravel 框架，重读《Modern PHP》。</p>
<blockquote>
<p>PHP 正在重生。</p>
</blockquote>
<h2 id="特性"><a href="#特性" class="headerlink" title="特性"></a>特性</h2><h3 id="命名空间"><a href="#命名空间" class="headerlink" title="命名空间"></a>命名空间</h3><p>声明命名空间：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">namespace Oreilly\ModernPHP;</span><br></pre></td></tr></table></figure>
<p>导入和别名：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">use Symfony\Component\HttpFoundation\Response as Res;</span><br><span class="line"></span><br><span class="line">$r = new Res(&apos;Oops&apos;, 400);</span><br><span class="line">$r-&gt;send();</span><br></pre></td></tr></table></figure>
<a id="more"></a>
<p>PHP 5.6 开始可以导入函数和常量：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">use func Namespace\functionName;</span><br><span class="line">use constant Namespace\CONST_NAME;</span><br><span class="line"></span><br><span class="line">functionName();</span><br><span class="line">echo CONST_NAME;</span><br></pre></td></tr></table></figure>
<h3 id="使用接口"><a href="#使用接口" class="headerlink" title="使用接口"></a>使用接口</h3><p>接口是两个 PHP 对象之间的契约，其目的不是让一个对象依赖另一个对象的身份，而是依赖另一个对象的能力。</p>
<p>使用接口编写更加灵活，能委托别人实现细节。</p>
<h3 id="性状-trait"><a href="#性状-trait" class="headerlink" title="性状 trait"></a>性状 trait</h3><p>性状是类的部分实现，可以混入一个或者多个现有的 PHP 类中。性状有两个作用：表明类可以做什么（像是接口）；提供模块化实现（像是类）。</p>
<p>如果想让两个无关的 PHP 类具有类似的行为，应该怎么呢？性状就是为了解决这种问题而诞生的。性状能把模块化的实现方式注入多个无关的类中。而且性状还能促进代码的重用。</p>
<p>这与创建一个接口，两个无关的类实现这个接口的优势在于：不用写相同的实现代码，符合 DRY 原则。</p>
<p>PHP 解释器在编译时会把性状复制粘贴到类的定义体中，但是不会处理这个操作引入的不兼容问题。如果性状假定类中有特定的属性和方法（在性状中没有定义），要确保相应的类中有对应的属性和方法。</p>
<h3 id="生成器"><a href="#生成器" class="headerlink" title="生成器"></a>生成器</h3><p>Generator 是 PHP 5.5.0 引入的功能。生成器是简单的迭代器，仅此而已。</p>
<p>PHP 生成器不要求类实现 Iterator 接口，从而减轻了类的负担。生成器会根据需求计算并产生要迭代的值。这对应该的性能有重大影响。假如标准的 PHP 迭代器经常在内存中执行迭代操作，这要预先计算出数据集，性能低；此时我们可以使用生成器，即时计算并产出后续值，不占用宝贵的内存资源。</p>
<p>PHP 生成器不能满足所有迭代操作的需求，因为如果不查询，生成器永远不知道下一个要迭代的值是什么，在生成器中无法后退和快进。生成器还是一次性，无法多次迭代同一个生成器。不过，如果需要，可以重建或克隆生成器。</p>
<p>PHP 生成器是 PHP 函数，只不过要在函数中一次或者多次使用 yield 关键字。生成器从不返回值，值产出值。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">function myGenerator() &#123;</span><br><span class="line">    yield &apos;value1&apos;;</span><br><span class="line">    yield &apos;value2&apos;;</span><br><span class="line">    yield &apos;value3&apos;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">foreach (myGenerator()  as $yieldedValue) &#123;</span><br><span class="line">   echo $yieldedValue, PHP_EOL;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">value1</span><br><span class="line">value2</span><br><span class="line">value3</span><br></pre></td></tr></table></figure>
<p>使用生成器处理 CSV：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">function getRows($file) &#123;</span><br><span class="line">    $handle = fopen($file, &apos;rb&apos;);</span><br><span class="line">    if ($handle === false) &#123;</span><br><span class="line">        throw new Exception();</span><br><span class="line">    &#125;</span><br><span class="line">    while (feof($handle) === false) &#123;</span><br><span class="line">        yield fgetcsv($handle);</span><br><span class="line">    &#125;</span><br><span class="line">    fclose($handle);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">foreach (getRows(&apos;data.csv&apos;) as $row) &#123;</span><br><span class="line">   print_r($row);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="闭包"><a href="#闭包" class="headerlink" title="闭包"></a>闭包</h3><p>理论上讲，闭包和匿名函数是不同的概念。不过，PHP  将其视作相同的概念。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$closure = function ($name) &#123;</span><br><span class="line">    return sprintf(&apos;Hello %s&apos;, $name);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">echo $closure(&quot;Josh&quot;);</span><br></pre></td></tr></table></figure>
<p>我们之所以能调用 \$closure 变量，是因为这个变量的值是一个闭包，而且闭包对象实现了 <code>__invoke()</code> 魔术方法。只要变量名后有()，PHP 就会查找并调用 <code>__invoke()</code> 方法。</p>
<p>PHP 闭包常被当做函数和方法的回调使用。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$numbersPlusOne = array_map(function ($number) &#123;</span><br><span class="line">    return $number + 1;</span><br><span class="line">&#125;, [1,2,3]);</span><br><span class="line"></span><br><span class="line">print_r($numbersPlusOne);</span><br><span class="line"></span><br><span class="line">// [2,3,4]</span><br></pre></td></tr></table></figure>
<p>在有闭包之前，只能单独创建具名函数，然后使用名称引用那个函数：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$numbersPlusOne = array_map(&apos;incrementNumber&apos;, [1,2,3]);</span><br><span class="line">// 如果只需要使用一次回调，没必要单独定义。把闭包当成回调使用，写出的代码更整洁、更清晰。</span><br></pre></td></tr></table></figure>
<p>使用 use 关键字附加闭包状态：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">function enclosePerson($name) &#123;</span><br><span class="line">    return function ($doCommand) use ($name) &#123;</span><br><span class="line">        return sprintf(&apos;%s, %s&apos;, $name, $doCommand);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 把字符串 Clay 封装到闭包里</span><br><span class="line">$clay = enclosePerson(&apos;Clay&apos;);</span><br><span class="line"></span><br><span class="line">// 传入参数，调用闭包</span><br><span class="line">echo $clay(&apos;get me sweet tea!&apos;);</span><br><span class="line"></span><br><span class="line">// &quot;Clay, get me sweet tea!&quot;</span><br></pre></td></tr></table></figure>
<p>具名函数 enclosePerson() 有个名为 $name 的参数，这个函数返回一个闭包对象，而且这个闭包封装了 $name 参数。即便返回的闭包对象跳出了 enclosePerson() 函数的作用域，它也会记住 $name 参数的值，因为 $name 变量仍在闭包中。</p>
<p>PHP 闭包是对象。闭包对象的默认状态没什么用，不过有一个 <code>__invoke()</code> 魔术方法和 <code>bindTo()</code> 方法。</p>
<h3 id="Zend-OPcache"><a href="#Zend-OPcache" class="headerlink" title="Zend OPcache"></a>Zend OPcache</h3><p>字节码缓存能存储预先编译好的 PHP 字节码。这意味着，请求 PHP 脚本时，PHP 解释器不用每次都读取、解析和编译 PHP 代码。</p>
<h3 id="内置的-HTTP-服务器"><a href="#内置的-HTTP-服务器" class="headerlink" title="内置的 HTTP 服务器"></a>内置的 HTTP 服务器</h3><p>启动这个服务器：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">php -S localhost:4000</span><br><span class="line"></span><br><span class="line">// 让 PHP Web 服务器监听所有接口</span><br><span class="line">php -S 0.0.0.0:4000</span><br></pre></td></tr></table></figure>
<h2 id="标准"><a href="#标准" class="headerlink" title="标准"></a>标准</h2><h3 id="PSR-是什么"><a href="#PSR-是什么" class="headerlink" title="PSR 是什么"></a>PSR 是什么</h3><p>PHP Standards Recommendation.</p>
<ul>
<li>PSR-1 基本的代码风格</li>
<li>PSR-2 严格的代码风格</li>
<li>PSR-3 日志记录器接口</li>
<li>PSR-4 自动加载</li>
</ul>
<h2 id="组件"><a href="#组件" class="headerlink" title="组件"></a>组件</h2><h3 id="查找组件"><a href="#查找组件" class="headerlink" title="查找组件"></a>查找组件</h3><ul>
<li><a href="https://github.com/ziadoz/awesome-php#text-editors-and-ides" target="_blank" rel="noopener">Awesome PHP</a></li>
<li><a href="https://packagist.org" target="_blank" rel="noopener">Packagist</a></li>
</ul>
<h2 id="良好实践"><a href="#良好实践" class="headerlink" title="良好实践"></a>良好实践</h2><h3 id="流"><a href="#流" class="headerlink" title="流"></a>流</h3><p>流式数据的种类各异，每种类型需要独特的协议，以便读写数据。称这些协议为流封装协议。</p>
<ol>
<li>开始通信</li>
<li>读取数据</li>
<li>写入数据</li>
<li>结束通信</li>
</ol>
<p>指定协议和目标的方法是使用流标识符：</p>
<p><code>&lt;scheme&gt;://&lt;target&gt;</code></p>
<p>使用 HTTP 流封装协议创建了一个与 Flickr API 通信的 PHP 流：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$json = file_get_contents(</span><br><span class="line">    &apos;http://api.flickr.com/services/feeds/photos_public.gne?format=json&apos;</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<p>不要误以为这是普通的网页 URL，file_get_contents() 函数的字符串参数其实是一个流标识符。http 协议会让 PHP 使用 HTTP 流封装协议。在这个参数中，http 之后是流的目标。很多 PHP 开发者不知道普通的 URL 其实是 PHP 流封装协议标识的伪装。</p>
<p>我们使用 file_get_contents() fopen() fwrite() 和 fclose() 函数读写文件系统。因为 PHP 默认使用的流封装协议是 file://，使用我们很少认为这些函数使用的是 PHP 流。</p>
<p>隐式使用 file:// 流封装协议：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$handle = fopen(&apos;/etc/hosts&apos;, &apos;rb&apos;);</span><br><span class="line">while (feof($handle) !== ture) &#123;</span><br><span class="line">    echo fgets($handle);</span><br><span class="line">&#125;</span><br><span class="line">fclose($handle);</span><br></pre></td></tr></table></figure>
<p>显示使用 file:// 流封装协议：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">...</span><br><span class="line">$handle = fopen(&apos;file://etc/hosts&apos;, &apos;rb&apos;);</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>我们通常会省略 file:// 封装协议，这是 PHP 使用的默认值。</p>
<p>编写命令行脚本的 PHP 开发者会感激 php:// 流封装协议。这个流封装协议的作用是与 PHP 脚本的标准输入、标准输出和标准错误文件描描述符通信。</p>
<p>php://stdin 只读 PHP 流，其中的数据来自标准输入。例如，接收命令行传入脚本的信息。</p>
<p>php://stdout 把数据写入当前的缓冲区。这个流只能写，无法读或寻址。</p>
<p>php://memory 从系统内存中读取数据，或者把数据写入系统内存。缺点是，可用内存是有限的。使用 php://temp 流更安全。</p>
<p>php://temp 和 php://memory 类似，不过没有可以内存时，PHP 会把数据写入临时文件。</p>
<h3 id="错误和异常"><a href="#错误和异常" class="headerlink" title="错误和异常"></a>错误和异常</h3><p>提到了 <a href="https://github.com/Seldaek/monolog" target="_blank" rel="noopener">Monolog</a> 记录日志。</p>
<h2 id="调优"><a href="#调优" class="headerlink" title="调优"></a>调优</h2><h3 id="内存"><a href="#内存" class="headerlink" title="内存"></a>内存</h3><p><em>一共能分配给 PHP 多少内存？</em></p>
<p>Linode 2GB 的 sever 留 512MB 给 PHP。</p>
<p><em>单个 PHP 进程平均消耗多少内存？</em></p>
<p>使用 top 命令查看。一般 PHP 进程消耗 5 ~ 20MB 内存。</p>
<p><em>能负担的起多少个 PHP-FPM 进程？</em></p>
<p>假设 PHP 分配了 512MB 内存，每个 PHP 平均消耗 15MB 内存，从而确定能负担的起 34 个进程。</p>
<p>压力测试工具：</p>
<ul>
<li><a href="https://httpd.apache.org/docs/2.4/programs/ab.html" target="_blank" rel="noopener">ab - Apache HTTP server benchmarking tool</a></li>
<li><a href="https://www.joedog.org/siege-home/" target="_blank" rel="noopener">Siege</a></li>
</ul>
<h3 id="Zend-OPcache-1"><a href="#Zend-OPcache-1" class="headerlink" title="Zend OPcache"></a>Zend OPcache</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">opcache.memory_consumption = 64</span><br><span class="line"># 为操作码缓存分配的内存量（单位 MB）。</span><br><span class="line"></span><br><span class="line">opcache.interned_strings_buffer = 16</span><br><span class="line"># 用来存储驻留字符串的内存量（单位 MB，默认 4MB）。</span><br><span class="line"></span><br><span class="line">opcache.max_accelerated_file = 4000</span><br><span class="line"># 操作码缓存中最多能存储多少个 PHP 脚本。这个值一定比 PHP 应用中的文件数量大。</span><br><span class="line"></span><br><span class="line">opcache.validate_timestamps = 1</span><br><span class="line"># 为 1 时，一段时间后 PHP 会检查 PHP 脚本的内容是否变化。检查的时间间隔由 revalidate_freq 指定。</span><br><span class="line"># 开发环境设为 1，在生成环境中为 0。</span><br><span class="line"></span><br><span class="line">opcache.revalidate_freq = 0</span><br><span class="line"># 设置多久检查一次 PHP 脚本的内容是否有变化。</span><br><span class="line"></span><br><span class="line">opcache.fast_shutdown = 1</span><br><span class="line"># 这么设置能让操作码使用更快的停机步骤，把对象析构和内存释放交给 Zend Engine 的内存管理器完成。</span><br></pre></td></tr></table></figure>
<h3 id="文件上传"><a href="#文件上传" class="headerlink" title="文件上传"></a>文件上传</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">file_uploads = 1</span><br><span class="line">upload_max_filesize = 10M</span><br><span class="line">max_file_uploads = 3</span><br></pre></td></tr></table></figure>
<p>如果需要上传非常大的文件，还要调整 nginx 虚拟主机配置中的 client_max_body_size 设置。</p>
<h3 id="会话处理"><a href="#会话处理" class="headerlink" title="会话处理"></a>会话处理</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">session.save_handler = &apos;memcached&apos;</span><br><span class="line">session.save_path = &apos;127.0.0.2:11211&apos;</span><br></pre></td></tr></table></figure>
<h3 id="缓冲输出"><a href="#缓冲输出" class="headerlink" title="缓冲输出"></a>缓冲输出</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">output_buffering = 4096</span><br><span class="line">implicit_flush = false</span><br></pre></td></tr></table></figure>
<p>确保使用的值是 4（32 位系统）或者 8（64 位系统）的倍数。</p>
<h3 id="真实路径缓存"><a href="#真实路径缓存" class="headerlink" title="真实路径缓存"></a>真实路径缓存</h3><p>realpath cache，PHP 会缓存应用使用的文件路径，这样每次包含或者导入文件时就无需不断搜索包含路径了。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">realpath_cache_size = 64k</span><br></pre></td></tr></table></figure>
<h2 id="部署"><a href="#部署" class="headerlink" title="部署"></a>部署</h2><p>提到了 <a href="http://capistranorb.com/" target="_blank" rel="noopener">Capistrano</a> 待研究。</p>
<h2 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h2><ul>
<li>PHPUnit</li>
<li>Xdebug</li>
<li>使用 Travis CI 持续测试</li>
</ul>
<h2 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h2><ul>
<li>XHProf 较新的 PHP 应用分析器</li>
<li>XHGUI</li>
<li>New Relic</li>
<li>Blackfire</li>
</ul>
<h2 id="HHVM-和-Hack"><a href="#HHVM-和-Hack" class="headerlink" title="HHVM 和 Hack"></a>HHVM 和 Hack</h2><p>Hip-Hop Virtual Machine.</p>
<p>Hack 是一门建立在 PHP 之上的编程语音，引入了静态类型，新的数据结构和额外的接口，同时还能向后兼容现有的动态类型 PHP 代码。</p>
<p>动态类型和静态类型，二者之间的区别在于何时检查 PHP 类型。动态类型在运行时检查类型，而静态类型在编译时检查类型。</p>
<p>– EOF –</p>

      
    </div>

    
      
      

  <div class="post-copyright">
    <p class="copyright-item">
      <span>原文作者: </span>
      <a href="https://zyf.im">Yifans_Z</a>
    </p>
    <p class="copyright-item">
      <span>原文链接: </span>
      <a href="https://zyf.im/2018/05/08/modern-php-reading-notes/">https://zyf.im/2018/05/08/modern-php-reading-notes/</a>
    </p>
    <p class="copyright-item">
      <span>许可协议: </span>
      
      <a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/" target="_blank">知识共享署名-非商业性使用 4.0 国际许可协议</a>
    </p>
  </div>



      
      
  <div class="post-reward">
    <input type="checkbox" name="reward" id="reward" hidden>
    <label class="reward-button" for="reward">赞赏支持</label>
    <div class="qr-code">
      
      
        <label class="qr-code-image" for="reward">
          <img class="image" src="https://cdn-qn.yifans.com/imzyf/reward_wechat.jpg" title="wechat">
        </label>
      
      
    </div>
  </div>


    

    
      <footer class="post-footer">
        
          <div class="post-tags">
            
              <a href="/tags/php/">php</a>
            
          </div>
        
        
        
  <nav class="post-nav">
    
      <a class="prev" href="/2018/05/09/laravel-essential-training-reading-notes/">
        <i class="iconfont icon-left"></i>
        <span class="prev-text nav-default">【Laravel 教程 - Web 开发实战入门】读书笔记</span>
        <span class="prev-text nav-mobile">上一篇</span>
      </a>
    
    
      <a class="next" href="/2018/05/05/phpstorm-using-experience/">
        <span class="next-text nav-default">PhpStorm 使用经验</span>
        <span class="prev-text nav-mobile">下一篇</span>
        <i class="iconfont icon-right"></i>
      </a>
    
  </nav>


      </footer>
    

  </article>


          </div>
          
  <div class="comments" id="comments">
    
      <div id="disqus_thread">
        <noscript>
          Please enable JavaScript to view the
          <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a>
        </noscript>
      </div>
    
  </div>


        </div>
      </main>

      <footer id="footer" class="footer">

  <div class="social-links">
    
      
        
          <a href="mailto:168@yifans.com" class="iconfont icon-email" title="email"></a>
        
      
    
      
        
          <a href="https://github.com/imzyf" class="iconfont icon-github" title="github"></a>
        
      
    
      
        
          <a href="https://stackoverflow.com/users/5958443/yifan" class="iconfont icon-stack-overflow" title="stack-overflow"></a>
        
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    

    
      <a href="/atom.xml" class="iconfont icon-rss" title="rss"></a>
    
  </div>



<div class="copyright">
  <span class="power-by">
    由 <a class="hexo-link" rel="nofollow" href="https://hexo.io/">Hexo</a> 强力驱动
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    主题 -
    <a class="theme-link" rel="nofollow" href="https://github.com/ahonn/hexo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    
    &copy;
    
      2016 -
    
    2019

    <span class="heart">
      <i class="iconfont icon-heart"></i>
    </span>
    <span class="author">Yifans_Z</span>
  </span>
</div>

<!-- Start of StatCounter Code for Default Guide -->
<script type="text/javascript">
var sc_project=11262529;
var sc_invisible=1;
var sc_security="476b93ef";
var scJsHost = (("https:" == document.location.protocol) ?
"https://secure." : "http://www.");
document.write("<sc"+"ript type='text/javascript' src='" +
scJsHost+
"statcounter.com/counter/counter.js'></"+"script>");
</script>
<noscript><div class="statcounter"><a title="web analytics" href="http://statcounter.com/" target="_blank"><img class="statcounter" src="//c.statcounter.com/11262529/0/476b93ef/1/" alt="web
analytics"></a></div></noscript>
<!-- End of StatCounter Code for Default Guide -->

      </footer>

      <div class="back-to-top" id="back-to-top">
        <i class="iconfont icon-up"></i>
      </div>
    </div>

    
  
  <script type="text/javascript">
    var disqus_config = function () {
        this.page.url = 'https://zyf.im/2018/05/08/modern-php-reading-notes/';
        this.page.identifier = '2018/05/08/modern-php-reading-notes/';
        this.page.title = '【Modern PHP】读书笔记';
    };
    (function() {
    var d = document, s = d.createElement('script');

    s.src = '//yifans.disqus.com/embed.js';

    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
    })();  
  </script>

  

  



    
  







  
    <script type="text/javascript" src="/lib/jquery/jquery.min.js"></script>
  

  
    <script type="text/javascript" src="/lib/slideout/slideout.js"></script>
  

  
    <script type="text/javascript" src="/lib/fancybox/jquery.fancybox.pack.js"></script>
  

  

  


    <script type="text/javascript" src="/js/src/even.js?v=2.10.3"></script>

  </body>
</html>
