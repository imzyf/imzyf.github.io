<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>LeetCode Database Second Highest Salary 176 | ZYF.IM BLOG</title>
<meta name=keywords content="leetcode"><meta name=description content="176. Second Highest Salary
  Write a SQL query to get the second highest salary from the Employee table.
+----+--------+
| Id | Salary |
+----+--------+
| 1  | 100    |
| 2  | 200    |
| 3  | 300    |
+----+--------+
For example, given the above Employee table, the second highest salary is 200. If there is no second highest salary, then the query should return null.

大体意思
写 SQL 查询出第二高薪水的 Id。如何没有第二高，则返回 null"><meta name=author content="Me"><link rel=canonical href=https://zyf.im/2016/09/11/leetcode-database-second-highest-salary-176/><link crossorigin=anonymous href=/assets/css/stylesheet.4997c86cdc3165a43745858554a5b14aaf4d3769db9f06a36b0c69ef98eb2927.css integrity="sha256-SZfIbNwxZaQ3RYWFVKWxSq9NN2nbnwajawxp75jrKSc=" rel="preload stylesheet" as=style><link rel=icon href=https://zyf.im/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://zyf.im/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://zyf.im/favicon-32x32.png><link rel=apple-touch-icon href=https://zyf.im/apple-touch-icon.png><link rel=mask-icon href=https://zyf.im/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://zyf.im/2016/09/11/leetcode-database-second-highest-salary-176/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-6DVZ6E58DG"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-6DVZ6E58DG")}</script><meta property="og:url" content="https://zyf.im/2016/09/11/leetcode-database-second-highest-salary-176/"><meta property="og:site_name" content="ZYF.IM BLOG"><meta property="og:title" content="LeetCode Database Second Highest Salary 176"><meta property="og:description" content="176. Second Highest Salary Write a SQL query to get the second highest salary from the Employee table.
+----+--------+ | Id | Salary | +----+--------+ | 1 | 100 | | 2 | 200 | | 3 | 300 | +----+--------+ For example, given the above Employee table, the second highest salary is 200. If there is no second highest salary, then the query should return null.
大体意思 写 SQL 查询出第二高薪水的 Id。如何没有第二高，则返回 null"><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2016-09-11T19:45:00+00:00"><meta property="article:modified_time" content="2016-09-11T19:45:00+00:00"><meta property="article:tag" content="Leetcode"><meta name=twitter:card content="summary"><meta name=twitter:title content="LeetCode Database Second Highest Salary 176"><meta name=twitter:description content="176. Second Highest Salary
  Write a SQL query to get the second highest salary from the Employee table.
+----+--------+
| Id | Salary |
+----+--------+
| 1  | 100    |
| 2  | 200    |
| 3  | 300    |
+----+--------+
For example, given the above Employee table, the second highest salary is 200. If there is no second highest salary, then the query should return null.

大体意思
写 SQL 查询出第二高薪水的 Id。如何没有第二高，则返回 null"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://zyf.im/posts/"},{"@type":"ListItem","position":2,"name":"LeetCode Database Second Highest Salary 176","item":"https://zyf.im/2016/09/11/leetcode-database-second-highest-salary-176/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"LeetCode Database Second Highest Salary 176","name":"LeetCode Database Second Highest Salary 176","description":"176. Second Highest Salary Write a SQL query to get the second highest salary from the Employee table.\n+----+--------+ | Id | Salary | +----+--------+ | 1 | 100 | | 2 | 200 | | 3 | 300 | +----+--------+ For example, given the above Employee table, the second highest salary is 200. If there is no second highest salary, then the query should return null.\n大体意思 写 SQL 查询出第二高薪水的 Id。如何没有第二高，则返回 null\n","keywords":["leetcode"],"articleBody":"176. Second Highest Salary Write a SQL query to get the second highest salary from the Employee table.\n+----+--------+ | Id | Salary | +----+--------+ | 1 | 100 | | 2 | 200 | | 3 | 300 | +----+--------+ For example, given the above Employee table, the second highest salary is 200. If there is no second highest salary, then the query should return null.\n大体意思 写 SQL 查询出第二高薪水的 Id。如何没有第二高，则返回 null\n自己的解法 SELECT Salary FROM Employee ORDER BY Salary DESC LIMIT 1,1 但是在没有第二高的时候将没有返回值，不符合题意；看了别人的，发现自己也少考虑 DISTINCT\n别人的解法 多加一层 SELECT 并添加一个 IF 条件判断。如果结果有 0 行则返回 NULL，有 1 行返回正常结果。由于可以预期上一步结果只有一个，所以这里可以用 COUNT 而不用 GROUP BY。\n构造测试数据：\nCREATE TABLE IF NOT EXISTS Employee ( Id INT, Salary INT ); DELETE FROM Employee; INSERT INTO Employee VALUES (1, 100), (2, 200), (3, 100), (4, 300); 预期结果：\n+---------------------+ | SecondHighestSalary | +---------------------+ | 200 | +---------------------+ 解法一：\nSELECT IF(COUNT(Salary) \u003e= 1, Salary, NULL) AS SecondHighestSalary FROM (SELECT DISTINCT Salary FROM Employee ORDER BY Salary DESC LIMIT 1 , 1) tmp 解法二： 正常 Ranking 类问题解法，使用自定义变量计算排名。接着和上面一种解法类似需要对结果进行处理，没有第 2 名的返回 NULL：\nSELECT IF(COUNT(Salary) \u003e= 1, Salary, NULL) AS SecondHighestSalary FROM (SELECT DISTINCT Salary FROM (SELECT Id, Salary, @rank:=IF(@prevVal \u003e Salary, @rank:=@rank + 1, @rank) AS Rank, @prevVal:=Salary FROM Employee, (SELECT @prevVal:=NULL) x, (SELECT @rank:=1) y ORDER BY Salary DESC) tmp WHERE tmp.Rank = 2) tmp2 解法三： 上面两种解法都是可以扩展到任意排名的，如果想偏一点可以得到其他解法。排名第 2 可以看做是除了 MAX 之外的 MAX，可以得到这两种类似的解法。由于 MAX 函数可以返回 NULL 结果，就不用在进一步加工结果。\nSELECT MAX(Salary) FROM Employee WHERE Salary \u003c (SELECT MAX(Salary) FROM Employee) SELECT MAX(Salary) FROM Employee WHERE Salary NOT IN (SELECT MAX(Salary) FROM Employee) Reference: Leetcode Database: #176 Second Highest Salary | tsuinteru\n","wordCount":"257","inLanguage":"en","datePublished":"2016-09-11T19:45:00Z","dateModified":"2016-09-11T19:45:00Z","author":{"@type":"Person","name":"Me"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://zyf.im/2016/09/11/leetcode-database-second-highest-salary-176/"},"publisher":{"@type":"Organization","name":"ZYF.IM BLOG","logo":{"@type":"ImageObject","url":"https://zyf.im/favicon.ico"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://zyf.im/ accesskey=h title="ZYF.IM (Alt + H)"><img src=https://zyf.im/apple-touch-icon.png alt aria-label=logo height=35>ZYF.IM</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://zyf.im/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://zyf.im/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://zyf.im/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://zyf.im/about/ title=About><span>About</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://zyf.im/>Home</a>&nbsp;»&nbsp;<a href=https://zyf.im/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">LeetCode Database Second Highest Salary 176</h1><div class=post-meta><span title='2016-09-11 19:45:00 +0000 UTC'>September 11, 2016</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;257 words&nbsp;·&nbsp;Me</div></header><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><ul><li><a href=#大体意思>大体意思</a></li><li><a href=#自己的解法>自己的解法</a></li><li><a href=#别人的解法>别人的解法</a></li></ul></li></ul></nav></div></details></div><div class=post-content><p><a href=https://leetcode.com/problems/second-highest-salary/>176. Second Highest Salary</a>
  Write a SQL query to get the second highest salary from the <code>Employee</code> table.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=o>+</span><span class=c1>----+--------+
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>|</span><span class=w> </span><span class=n>Id</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>Salary</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+</span><span class=c1>----+--------+
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>|</span><span class=w> </span><span class=mi>1</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>100</span><span class=w>    </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>2</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>200</span><span class=w>    </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>3</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>300</span><span class=w>    </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+</span><span class=c1>----+--------+
</span></span></span></code></pre></div><p>For example, given the above Employee table, the second highest salary is <code>200</code>. If there is no second highest salary, then the query should return <code>null</code>.</p><h3 id=大体意思>大体意思<a hidden class=anchor aria-hidden=true href=#大体意思>#</a></h3><p>写 SQL 查询出第二高薪水的 Id。如何没有第二高，则返回 <code>null</code></p><h3 id=自己的解法>自己的解法<a hidden class=anchor aria-hidden=true href=#自己的解法>#</a></h3><pre tabindex=0><code>SELECT
    Salary
FROM
    Employee
ORDER BY Salary DESC
LIMIT 1,1
</code></pre><p>但是在没有第二高的时候将没有返回值，不符合题意；看了别人的，发现自己也少考虑 <code>DISTINCT</code></p><h3 id=别人的解法>别人的解法<a hidden class=anchor aria-hidden=true href=#别人的解法>#</a></h3><p>多加一层 SELECT 并添加一个 IF 条件判断。如果结果有 0 行则返回 NULL，有 1 行返回正常结果。由于可以预期上一步结果只有一个，所以这里可以用 COUNT 而不用 GROUP BY。</p><p>构造测试数据：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=k>IF</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>EXISTS</span><span class=w> </span><span class=n>Employee</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>Id</span><span class=w> </span><span class=nb>INT</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>Salary</span><span class=w> </span><span class=nb>INT</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>DELETE</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>Employee</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>Employee</span><span class=w> </span><span class=k>VALUES</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>(</span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=mi>100</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>(</span><span class=mi>2</span><span class=p>,</span><span class=w> </span><span class=mi>200</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>(</span><span class=mi>3</span><span class=p>,</span><span class=w> </span><span class=mi>100</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>(</span><span class=mi>4</span><span class=p>,</span><span class=w> </span><span class=mi>300</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></div><p>预期结果：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=o>+</span><span class=c1>---------------------+
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>|</span><span class=w> </span><span class=n>SecondHighestSalary</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+</span><span class=c1>---------------------+
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>|</span><span class=w> </span><span class=mi>200</span><span class=w>                 </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+</span><span class=c1>---------------------+
</span></span></span></code></pre></div><p>解法一：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>IF</span><span class=p>(</span><span class=k>COUNT</span><span class=p>(</span><span class=n>Salary</span><span class=p>)</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=n>Salary</span><span class=p>,</span><span class=w> </span><span class=k>NULL</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>SecondHighestSalary</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>FROM</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>(</span><span class=k>SELECT</span><span class=w> </span><span class=k>DISTINCT</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Salary</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>FROM</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Employee</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>Salary</span><span class=w> </span><span class=k>DESC</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>LIMIT</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=n>tmp</span><span class=w>
</span></span></span></code></pre></div><p>解法二：
正常 Ranking 类问题解法，使用自定义变量计算排名。接着和上面一种解法类似需要对结果进行处理，没有第 2 名的返回 NULL：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>IF</span><span class=p>(</span><span class=k>COUNT</span><span class=p>(</span><span class=n>Salary</span><span class=p>)</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=n>Salary</span><span class=p>,</span><span class=w> </span><span class=k>NULL</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>SecondHighestSalary</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>FROM</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>(</span><span class=k>SELECT</span><span class=w> </span><span class=k>DISTINCT</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Salary</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>FROM</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>(</span><span class=k>SELECT</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>         </span><span class=n>Id</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>Salary</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=o>@</span><span class=n>rank</span><span class=p>:</span><span class=o>=</span><span class=k>IF</span><span class=p>(</span><span class=o>@</span><span class=n>prevVal</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=n>Salary</span><span class=p>,</span><span class=w> </span><span class=o>@</span><span class=n>rank</span><span class=p>:</span><span class=o>=@</span><span class=n>rank</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=o>@</span><span class=n>rank</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>Rank</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=o>@</span><span class=n>prevVal</span><span class=p>:</span><span class=o>=</span><span class=n>Salary</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>     </span><span class=k>FROM</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>         </span><span class=n>Employee</span><span class=p>,</span><span class=w> </span><span class=p>(</span><span class=k>SELECT</span><span class=w> </span><span class=o>@</span><span class=n>prevVal</span><span class=p>:</span><span class=o>=</span><span class=k>NULL</span><span class=p>)</span><span class=w> </span><span class=n>x</span><span class=p>,</span><span class=w> </span><span class=p>(</span><span class=k>SELECT</span><span class=w> </span><span class=o>@</span><span class=n>rank</span><span class=p>:</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=n>y</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>     </span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>Salary</span><span class=w> </span><span class=k>DESC</span><span class=p>)</span><span class=w> </span><span class=n>tmp</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>WHERE</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>tmp</span><span class=p>.</span><span class=n>Rank</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>2</span><span class=p>)</span><span class=w> </span><span class=n>tmp2</span><span class=w>
</span></span></span></code></pre></div><p>解法三：
上面两种解法都是可以扩展到任意排名的，如果想偏一点可以得到其他解法。排名第 2 可以看做是除了 MAX 之外的 MAX，可以得到这两种类似的解法。由于 MAX 函数可以返回 NULL 结果，就不用在进一步加工结果。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>MAX</span><span class=p>(</span><span class=n>Salary</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>FROM</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>Employee</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>WHERE</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>Salary</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=p>(</span><span class=k>SELECT</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>MAX</span><span class=p>(</span><span class=n>Salary</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>FROM</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>Employee</span><span class=p>)</span><span class=w>
</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>MAX</span><span class=p>(</span><span class=n>Salary</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>FROM</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>Employee</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>WHERE</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>Salary</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=p>(</span><span class=k>SELECT</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>MAX</span><span class=p>(</span><span class=n>Salary</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>FROM</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>Employee</span><span class=p>)</span><span class=w>
</span></span></span></code></pre></div><blockquote><p>Reference:
<a href=http://tsuinte.ru/2015/04/05/leetcode-database-176-second-highest-salary/>Leetcode Database: #176 Second Highest Salary | tsuinteru</a></p></blockquote></div><footer class=post-footer><ul class=post-tags><li><a href=https://zyf.im/tags/leetcode/>Leetcode</a></li></ul><nav class=paginav><a class=prev href=https://zyf.im/2016/09/11/leetcode-database-consecutive-numbers-180/><span class=title>« Prev</span><br><span>LeetCode Database Consecutive Numbers 180</span>
</a><a class=next href=https://zyf.im/2016/09/11/leetcode-database-rising-temperature-197/><span class=title>Next »</span><br><span>LeetCode Database Rising Temperature 197</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://zyf.im/>ZYF.IM BLOG</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>