[{"content":"配置 mkcert 会在本地生成一套根 CA（包含根证书和私钥），并把根证书导入系统/浏览器的信任列表。随后，它用这套 CA 的私钥为 localhost 等域名签发服务器证书；因为根证书已被信任，浏览器访问时就会把服务器证书视为可信。\nbrew install mkcert mkcert -install mkcert localhost # The certificate is at \u0026#34;./localhost.pem\u0026#34; and the key at \u0026#34;./localhost-key.pem\u0026#34; ✅ # vi default.conf server { listen 443 ssl; server_name localhost; ssl_certificate /etc/ssl/certs/localhost.pem; ssl_certificate_key /etc/ssl/certs/localhost-key.pem; # 只允许 TLSv1.2 和 TLSv1.3 协议，显示禁止 TLSv1.0 和 TLSv1.1 协议 ssl_protocols TLSv1.2 TLSv1.3; # 只保留高强度、带身份验证、且不使用 MD5 的 TLS 1.2（及以下）套件 ssl_ciphers HIGH:!aNULL:!MD5; # 优先使用服务器端加密套件 ssl_prefer_server_ciphers on; location / { root /usr/share/nginx/html; index index.html index.htm; } } docker run -d --name nginx-ssl \\ -p 8443:443 \\ -v ./default.conf:/etc/nginx/conf.d/default.conf:ro \\ -v ./localhost.pem:/etc/ssl/certs/localhost.pem:ro \\ -v ./localhost-key.pem:/etc/ssl/certs/localhost-key.pem:ro \\ nginx:alpine # docker rm -f nginx-ssl # docker container restart nginx-ssl 测试 游览器 游览器访问 https://localhost:8443/，如果证书是绿色的，说明成功了。\ncurl curl -I https://localhost:8443/ HTTP/1.1 200 OK Server: nginx/1.29.0 Date: Fri, 27 Jun 2025 01:54:36 GMT Content-Type: text/html Content-Length: 615 Last-Modified: Tue, 24 Jun 2025 17:57:38 GMT Connection: keep-alive ETag: \u0026#34;685ae712-267\u0026#34; Accept-Ranges: bytes HTTP/2 当前使用的是 HTTP/1.1，如何启用 HTTP/2，请移步 NGINX 启用 HTTP/2 ｜ ZYF.IM。\n\u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2025/06/26/use-https-in-local-environment/","summary":"\u003ch2 id=\"配置\"\u003e配置\u003c/h2\u003e\n\u003cp\u003e\u003ca href=\"https://github.com/FiloSottile/mkcert\"\u003emkcert\u003c/a\u003e 会在本地生成一套根 CA（包含根证书和私钥），并把根证书导入系统/浏览器的信任列表。随后，它用这套 CA 的私钥为 localhost 等域名签发服务器证书；因为根证书已被信任，浏览器访问时就会把服务器证书视为可信。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ebrew install mkcert\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003emkcert -install\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003emkcert localhost\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# The certificate is at \u0026#34;./localhost.pem\u0026#34; and the key at \u0026#34;./localhost-key.pem\u0026#34; ✅\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# vi default.conf\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eserver \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    listen \u003cspan class=\"m\"\u003e443\u003c/span\u003e ssl\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    server_name localhost\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    ssl_certificate /etc/ssl/certs/localhost.pem\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    ssl_certificate_key /etc/ssl/certs/localhost-key.pem\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e# 只允许 TLSv1.2 和 TLSv1.3 协议，显示禁止 TLSv1.0 和 TLSv1.1 协议\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    ssl_protocols TLSv1.2 TLSv1.3\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e# 只保留高强度、带身份验证、且不使用 MD5 的 TLS 1.2（及以下）套件\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    ssl_ciphers HIGH:!aNULL:!MD5\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e# 优先使用服务器端加密套件\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    ssl_prefer_server_ciphers on\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    location / \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        root /usr/share/nginx/html\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        index  index.html index.htm\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"o\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edocker run -d --name nginx-ssl \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e  -p 8443:443 \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e  -v ./default.conf:/etc/nginx/conf.d/default.conf:ro \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e  -v ./localhost.pem:/etc/ssl/certs/localhost.pem:ro \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e  -v ./localhost-key.pem:/etc/ssl/certs/localhost-key.pem:ro \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e  nginx:alpine\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# docker rm -f nginx-ssl\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# docker container restart nginx-ssl\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"测试\"\u003e测试\u003c/h2\u003e\n\u003ch3 id=\"游览器\"\u003e游览器\u003c/h3\u003e\n\u003cp\u003e游览器访问 \u003ccode\u003ehttps://localhost:8443/\u003c/code\u003e，如果证书是绿色的，说明成功了。\u003c/p\u003e","title":"在本地环境使用 HTTPS"},{"content":"简介 PHP 8.4 引入了许多新特性，如属性钩子（Property Hooks）、非对称可见性（Asymmetric Visibility）以及更新的 DOM API 等。本文将介绍主要变化和如何进行迁移。\n参考资源 在线测试环境：https://onlinephp.io/ 官方发布说明：https://www.php.net/releases/8.4/en.php 迁移指南：https://www.php.net/manual/en/migration84.php 更新详情：https://php.watch/versions/8.4 PHP 8.4 新特性 属性钩子与非对称可见性 // 属性钩子（Property Hooks）与非对称可见性（Asymmetric Visibility） class User { private bool $isModified = false; public function __construct(public private(set) string $first, private string $last) { } public string $fullName { get =\u0026gt; $this-\u0026gt;first . \u0026#34; \u0026#34; . $this-\u0026gt;last; set { [$this-\u0026gt;first, $this-\u0026gt;last] = explode(\u0026#39; \u0026#39;, $value, 2); $this-\u0026gt;isModified = true; } } } $user = new User(\u0026#34;Ming\u0026#34;, \u0026#34;Li\u0026#34;); echo $user-\u0026gt;fullName; // 输出: Ming Li $user-\u0026gt;fullName = \u0026#34;Hong Xiao\u0026#34;; echo $user-\u0026gt;fullName; // 输出: Hong Xiao // 非对称可见性示例 echo $user-\u0026gt;first; // 输出: Hong $user-\u0026gt;first = \u0026#34;Hua\u0026#34;; // 错误: Fatal error: Uncaught Error: Cannot modify private(set) property User::$first 属性钩子允许我们定义属性的获取和设置行为，而非对称可见性允许我们为属性设置不同的读写权限。在上例中，$first 属性可以公开读取但只能私有写入。\n可空类型解包 PHP 8.4 引入了可空类型解包操作符 ??=，可以在一行代码中解包可空值：\n// 旧方式 function getUsername(?User $user): string { if ($user === null) { return \u0026#39;Guest\u0026#39;; } return $user-\u0026gt;username; } // PHP 8.4 新方式 function getUsername(?User $user): string { return $user??-\u0026gt;username ?? \u0026#39;Guest\u0026#39;; } 增强的 DOM API PHP 8.4 更新了 DOM API，提供了更现代、更易用的接口：\n// 新的 DOM API 示例 $doc = new DOM\\Document(); $doc-\u0026gt;loadHTML(\u0026#39;\u0026lt;div\u0026gt;\u0026lt;span\u0026gt;Hello\u0026lt;/span\u0026gt;\u0026lt;/div\u0026gt;\u0026#39;); // 使用 querySelector 和 querySelectorAll $span = $doc-\u0026gt;querySelector(\u0026#39;span\u0026#39;); echo $span-\u0026gt;textContent; // 输出: Hello // 使用 innerHTML/outerHTML $div = $doc-\u0026gt;querySelector(\u0026#39;div\u0026#39;); echo $div-\u0026gt;innerHTML; // 输出: \u0026lt;span\u0026gt;Hello\u0026lt;/span\u0026gt; $div-\u0026gt;innerHTML = \u0026#39;\u0026lt;p\u0026gt;World\u0026lt;/p\u0026gt;\u0026#39;; echo $div-\u0026gt;outerHTML; // 输出: \u0026lt;div\u0026gt;\u0026lt;p\u0026gt;World\u0026lt;/p\u0026gt;\u0026lt;/div\u0026gt; BCMath 的对象 API // BCMath 的对象 API use BcMath\\Number; $num1 = new Number(\u0026#39;0.12345\u0026#39;); $num2 = new Number(\u0026#39;2\u0026#39;); $result = $num1 + $num2; echo $result; // 输出: \u0026#39;2.12345\u0026#39; var_dump($num1 \u0026gt; $num2); // 输出: false // PHP 8.4 之前的写法 $num1 = \u0026#39;0.12345\u0026#39;; $num2 = 2; $result = bcadd($num1, $num2, 5); echo $result; // 输出: \u0026#39;2.12345\u0026#39; var_dump(bccomp($num1, $num2) \u0026gt; 0); // 输出: false PHP 8.4 为 BCMath 引入了对象 API，使用起来更加直观和面向对象。\nPHP 8.4 新增函数 新的数组操作函数 // array_find(array $array, callable $callback): mixed - 查找第一个满足条件的元素 $animal = array_find( [\u0026#39;dog\u0026#39;, \u0026#39;cat\u0026#39;, \u0026#39;cow\u0026#39;, \u0026#39;duck\u0026#39;, \u0026#39;goose\u0026#39;], static fn (string $value): bool =\u0026gt; str_starts_with($value, \u0026#39;c\u0026#39;), ); var_dump($animal); // 输出: string(3) \u0026#34;cat\u0026#34; // array_find_key(array $array, callable $callback): mixed - 查找第一个满足条件的元素的键 // array_any(array $array, callable $callback): bool - 检查是否至少有一个元素满足回调函数条件 $result = array_any([1, 2, 3, 4], fn($n) =\u0026gt; $n \u0026gt; 3); // 结果: true // array_all(array $array, callable $callback): bool - 检查是否所有元素都满足回调函数条件 $result = array_all([1, 2, 3, 4], fn($n) =\u0026gt; $n \u0026gt; 0); // 结果: true 这些新函数简化了常见的数组操作，提高了代码的可读性和简洁性。\n性能优化 PHP 8.4 包含多项性能优化：\n改进的 JIT 编译器：进一步优化了 Just-In-Time 编译性能 更高效的内存管理：减少了内存使用和垃圾收集开销 优化的字符串处理：提升了字符串操作的性能 在基准测试中，PHP 8.4 比 PHP 8.3 平均快 5-10%，特别是在处理复杂计算和大型数组时。\n兼容性与迁移 弃用特性 隐式可空类型 // ❌ PHP 8.4 已弃用 function save(Book $book = null) {} // ✅ 修复方法：显式声明可空类型 function save(?Book $book = null) {} 在 PHP 8.4 中，隐式可空类型已被弃用，需要使用问号（?）显式声明可空类型。\n不安全的哈希函数 // ❌ PHP 8.4 中 md5() 和 sha1() 被标记为不安全 // ✅ 推荐使用更安全的哈希算法 echo hash(\u0026#39;xxh128\u0026#39;, \u0026#39;ABC123\u0026#39;); 在 PHP 8.4 中，md5() 和 sha1() 函数被标记为不安全，推荐使用更安全的哈希算法。\n已移除的功能 以下功能在 PHP 8.4 中被完全移除：\n// ❌ 在 PHP 8.4 中不再可用 $str = create_function(\u0026#39;$a\u0026#39;, \u0026#39;return $a + 1;\u0026#39;); // 已在 PHP 7.2 弃用并在 PHP 8.4 移除 $size = each($array); // 已在 PHP 7.2 弃用并在 PHP 8.4 移除 行为变化 一些函数和特性的行为发生了变化：\n// PHP 8.3 及以前版本 - 隐式将数组转换为对象 $array = [\u0026#39;a\u0026#39; =\u0026gt; 1, \u0026#39;b\u0026#39; =\u0026gt; 2]; $obj = (object) $array; echo $obj-\u0026gt;a; // 输出: 1 // PHP 8.4 - 更严格的类型检查，某些隐式转换可能失败 总结 PHP 8.4 带来了许多实用的新特性和改进，包括属性钩子、非对称可见性、BCMath 对象 API 和新的数组函数等。同时，一些旧特性也被弃用或移除，如隐式可空类型和不安全的哈希函数。通过了解这些变化和遵循迁移建议，我们可以顺利地从 PHP 8.3 迁移到 PHP 8.4，并充分利用新版本带来的性能提升和功能改进。\n","permalink":"https://zyf.im/2025/02/01/php-migrating-83-to-84/","summary":"\u003ch2 id=\"简介\"\u003e简介\u003c/h2\u003e\n\u003cp\u003ePHP 8.4 引入了许多新特性，如属性钩子（Property Hooks）、非对称可见性（Asymmetric Visibility）以及更新的 DOM API 等。本文将介绍主要变化和如何进行迁移。\u003c/p\u003e\n\u003ch3 id=\"参考资源\"\u003e参考资源\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e在线测试环境：\u003ca href=\"https://onlinephp.io/\"\u003ehttps://onlinephp.io/\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e官方发布说明：\u003ca href=\"https://www.php.net/releases/8.4/en.php\"\u003ehttps://www.php.net/releases/8.4/en.php\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e迁移指南：\u003ca href=\"https://www.php.net/manual/en/migration84.php\"\u003ehttps://www.php.net/manual/en/migration84.php\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e更新详情：\u003ca href=\"https://php.watch/versions/8.4\"\u003ehttps://php.watch/versions/8.4\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"php-84-新特性\"\u003ePHP 8.4 新特性\u003c/h2\u003e\n\u003ch3 id=\"属性钩子与非对称可见性\"\u003e属性钩子与非对称可见性\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 属性钩子（Property Hooks）与非对称可见性（Asymmetric Visibility）\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eUser\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"nx\"\u003ebool\u003c/span\u003e \u003cspan class=\"nv\"\u003e$isModified\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003efalse\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003efunction\u003c/span\u003e \u003cspan class=\"fm\"\u003e__construct\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eset\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"nx\"\u003estring\u003c/span\u003e \u003cspan class=\"nv\"\u003e$first\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"nx\"\u003estring\u003c/span\u003e \u003cspan class=\"nv\"\u003e$last\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"nx\"\u003estring\u003c/span\u003e \u003cspan class=\"nv\"\u003e$fullName\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nx\"\u003eget\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"nv\"\u003e$this\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"na\"\u003efirst\u003c/span\u003e \u003cspan class=\"o\"\u003e.\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34; \u0026#34;\u003c/span\u003e \u003cspan class=\"o\"\u003e.\u003c/span\u003e \u003cspan class=\"nv\"\u003e$this\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"na\"\u003elast\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nx\"\u003eset\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"nv\"\u003e$this\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"na\"\u003efirst\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$this\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"na\"\u003elast\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003eexplode\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; \u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$value\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"nv\"\u003e$this\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"na\"\u003eisModified\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$user\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003eUser\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;Ming\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Li\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eecho\u003c/span\u003e \u003cspan class=\"nv\"\u003e$user\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"na\"\u003efullName\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"c1\"\u003e// 输出: Ming Li\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nv\"\u003e$user\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"na\"\u003efullName\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Hong Xiao\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eecho\u003c/span\u003e \u003cspan class=\"nv\"\u003e$user\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"na\"\u003efullName\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"c1\"\u003e// 输出: Hong Xiao\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 非对称可见性示例\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003eecho\u003c/span\u003e \u003cspan class=\"nv\"\u003e$user\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"na\"\u003efirst\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"c1\"\u003e// 输出: Hong\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nv\"\u003e$user\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"na\"\u003efirst\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Hua\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 错误: Fatal error: Uncaught Error: Cannot modify private(set) property User::$first\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e属性钩子允许我们定义属性的获取和设置行为，而非对称可见性允许我们为属性设置不同的读写权限。在上例中，\u003ccode\u003e$first\u003c/code\u003e 属性可以公开读取但只能私有写入。\u003c/p\u003e\n\u003ch3 id=\"可空类型解包\"\u003e可空类型解包\u003c/h3\u003e\n\u003cp\u003ePHP 8.4 引入了可空类型解包操作符 \u003ccode\u003e??=\u003c/code\u003e，可以在一行代码中解包可空值：\u003c/p\u003e","title":"PHP Migrating 8.3 to 8.4"},{"content":" 实验环境：https://onlinephp.io/ https://www.php.net/releases/8.3/en.php https://www.php.net/manual/en/migration83.php https://php.watch/versions/8.3 PHP 8.3 contains many new features, such as explicit typing of class constants, deep-cloning of readonly properties and additions to the randomness functionality.\nNew Features 8.3 // Typed class constants // Include class, trait, interface, enum trait TestTrait { final protected const string TEST = \u0026#39;test\u0026#39;; } interface TestInterface { public const string TEST = \u0026#39;test\u0026#39;; } enum TestEnum: string { public const string TEST = \u0026#39;test\u0026#39;; } // Similar to return types, class constant types can also be \u0026#34;narrowed\u0026#34;, or kept the same in a sub-class or an implementation. This follows LSP. class ParentClass { public const string|int VALUE = \u0026#39;MyValue\u0026#39;; } class ChildClass extends ParentClass { public const string VALUE = \u0026#39;MyValue\u0026#39;; } json_validate(\u0026#39;[1, 2, 3]\u0026#39;); // true json_validate(\u0026#39;{1, 2, 3]\u0026#39;); // false // Dynamic class constant and Enum member fetch support class Foo { const PHP = \u0026#39;PHP 8.3\u0026#39;; } $searchableConstant = \u0026#39;PHP\u0026#39;; echo constant(Foo::class . \u0026#34;::{$searchableConstant}\u0026#34;); echo Foo::{$searchableConstant}; // instead of `constant()` // Random extension // public function getFloat( // float $min, float $max, // \\Random\\IntervalBoundary $boundary = \\Random\\IntervalBoundary::ClosedOpen // ): float // // enum IntervalBoundary { // case ClosedOpen; // case ClosedClosed; // case OpenClosed; // case OpenOpen; // } $rng = new Random\\Randomizer(); echo $rng-\u0026gt;getFloat(0, 10, \\Random\\IntervalBoundary::OpenOpen); // 6.7810757668383 // Generate a random number in the range 0 \u0026lt;= and \u0026lt; 1: $rng = new Random\\Randomizer(); echo $rng-\u0026gt;nextFloat(); // 0.21185336351144 // Returns a random number sequence of a requested length ($length parameter), only containing a bytes from the requested series of bytes ($string parameter). $rng = new Random\\Randomizer(); $chars = \u0026#39;AEIOU\u0026#39;; echo $rng-\u0026gt;getBytesFromString($chars, 1); // \u0026#34;E\u0026#34; echo $rng-\u0026gt;getBytesFromString($chars, 5); // \u0026#34;AIIEO\u0026#34; // #[\\Override] attribute // PHP enforces that the targeted class method must be overriding or implementing a parent/interface method. class ParentClass { protected function demo() {} } class ChildClass extends ParentClass { #[\\Override] protected function demo() {} // ✅ 明确覆盖 #[\\Override] protected function demmo() {} // ❌ Fatal error (拼写错误) } New Functions 8.3 // Pad a multibyte string to a certain length with another multibyte string echo mb_str_pad(\u0026#39;中国\u0026#39;, 6, \u0026#39;爱\u0026#39;, STR_PAD_RIGHT) . \u0026#34;\\n\u0026#34;; echo mb_str_pad(\u0026#39;中国\u0026#39;, 6, \u0026#39;爱\u0026#39;, STR_PAD_LEFT) . \u0026#34;\\n\u0026#34;; echo mb_str_pad(\u0026#39;中国人\u0026#39;, 6, \u0026#39;爱\u0026#39;, STR_PAD_BOTH) . \u0026#34;\\n\u0026#34;; // 中国爱爱爱爱 // 爱爱爱爱中国 // 爱中国人爱爱 Backward Incompatible Changes 8.3 // Assigning a negative index n to an empty array will now make sure that the next index is n + 1 instead of 0. $arr = []; $arr[-5] = \u0026#39;a\u0026#39;; $arr[] = \u0026#39;b\u0026#39;; var_dump($arr); // PHP8.3 → [-5 =\u0026gt; \u0026#39;a\u0026#39;, -4 =\u0026gt; \u0026#39;b\u0026#39;] // PHP \u0026lt;8.3 → [-5 =\u0026gt; \u0026#39;a\u0026#39;, 0 =\u0026gt; \u0026#39;b\u0026#39;] \u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2024/08/01/php-migrating-82-to-83/","summary":"\u003cul\u003e\n\u003cli\u003e实验环境：\u003ca href=\"https://onlinephp.io/\"\u003ehttps://onlinephp.io/\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.php.net/releases/8.3/en.php\"\u003ehttps://www.php.net/releases/8.3/en.php\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.php.net/manual/en/migration83.php\"\u003ehttps://www.php.net/manual/en/migration83.php\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://php.watch/versions/8.3\"\u003ehttps://php.watch/versions/8.3\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cblockquote\u003e\n\u003cp\u003ePHP 8.3 contains many new features, such as explicit typing of class constants, deep-cloning of readonly properties and additions to the randomness functionality.\u003c/p\u003e\u003c/blockquote\u003e\n\u003ch2 id=\"new-features-83\"\u003eNew Features 8.3\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Typed class constants\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Include class, trait, interface, enum\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003etrait\u003c/span\u003e \u003cspan class=\"nx\"\u003eTestTrait\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003efinal\u003c/span\u003e \u003cspan class=\"k\"\u003eprotected\u003c/span\u003e \u003cspan class=\"k\"\u003econst\u003c/span\u003e \u003cspan class=\"no\"\u003estring\u003c/span\u003e \u003cspan class=\"nx\"\u003eTEST\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;test\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003einterface\u003c/span\u003e \u003cspan class=\"nx\"\u003eTestInterface\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003econst\u003c/span\u003e \u003cspan class=\"no\"\u003estring\u003c/span\u003e \u003cspan class=\"nx\"\u003eTEST\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;test\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003eenum\u003c/span\u003e \u003cspan class=\"nx\"\u003eTestEnum\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"nx\"\u003estring\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003econst\u003c/span\u003e \u003cspan class=\"no\"\u003estring\u003c/span\u003e \u003cspan class=\"nx\"\u003eTEST\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;test\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Similar to return types, class constant types can also be \u0026#34;narrowed\u0026#34;, or kept the same in a sub-class or an implementation. This follows LSP.\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eParentClass\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003econst\u003c/span\u003e \u003cspan class=\"no\"\u003estring\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"nx\"\u003eint\u003c/span\u003e \u003cspan class=\"nx\"\u003eVALUE\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;MyValue\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eChildClass\u003c/span\u003e \u003cspan class=\"k\"\u003eextends\u003c/span\u003e \u003cspan class=\"nx\"\u003eParentClass\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003econst\u003c/span\u003e \u003cspan class=\"no\"\u003estring\u003c/span\u003e \u003cspan class=\"nx\"\u003eVALUE\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;MyValue\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003ejson_validate\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;[1, 2, 3]\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"c1\"\u003e// true\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nx\"\u003ejson_validate\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;{1, 2, 3]\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"c1\"\u003e// false\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Dynamic class constant and Enum member fetch support\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eFoo\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003econst\u003c/span\u003e \u003cspan class=\"no\"\u003ePHP\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;PHP 8.3\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$searchableConstant\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;PHP\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eecho\u003c/span\u003e \u003cspan class=\"nx\"\u003econstant\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eFoo\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"na\"\u003eclass\u003c/span\u003e \u003cspan class=\"o\"\u003e.\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;::\u003c/span\u003e\u003cspan class=\"si\"\u003e{\u003c/span\u003e\u003cspan class=\"nv\"\u003e$searchableConstant\u003c/span\u003e\u003cspan class=\"si\"\u003e}\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eecho\u003c/span\u003e \u003cspan class=\"nx\"\u003eFoo\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nv\"\u003e$searchableConstant\u003c/span\u003e\u003cspan class=\"p\"\u003e};\u003c/span\u003e \u003cspan class=\"c1\"\u003e// instead of `constant()`\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Random extension\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// public function getFloat(\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e//         float $min, float $max,\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e//         \\Random\\IntervalBoundary $boundary = \\Random\\IntervalBoundary::ClosedOpen\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e//     ): float\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e//\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// enum IntervalBoundary {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e//     case ClosedOpen;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e//     case ClosedClosed;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e//     case OpenClosed;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e//     case OpenOpen;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// }\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nv\"\u003e$rng\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003eRandom\\Randomizer\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eecho\u003c/span\u003e \u003cspan class=\"nv\"\u003e$rng\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"na\"\u003egetFloat\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e10\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003e\\Random\\IntervalBoundary\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"na\"\u003eOpenOpen\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"c1\"\u003e// 6.7810757668383\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Generate a random number in the range 0 \u0026lt;= and \u0026lt; 1:\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nv\"\u003e$rng\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003eRandom\\Randomizer\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eecho\u003c/span\u003e \u003cspan class=\"nv\"\u003e$rng\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"na\"\u003enextFloat\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e \u003cspan class=\"c1\"\u003e// 0.21185336351144\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Returns a random number sequence of a requested length ($length parameter), only containing a bytes from the requested series of bytes ($string parameter).\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nv\"\u003e$rng\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003eRandom\\Randomizer\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$chars\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;AEIOU\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eecho\u003c/span\u003e \u003cspan class=\"nv\"\u003e$rng\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"na\"\u003egetBytesFromString\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$chars\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"c1\"\u003e// \u0026#34;E\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003eecho\u003c/span\u003e \u003cspan class=\"nv\"\u003e$rng\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"na\"\u003egetBytesFromString\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$chars\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e5\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"c1\"\u003e// \u0026#34;AIIEO\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// #[\\Override] attribute\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// PHP enforces that the targeted class method must be overriding or implementing a parent/interface method.\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eParentClass\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eprotected\u003c/span\u003e \u003cspan class=\"k\"\u003efunction\u003c/span\u003e \u003cspan class=\"nf\"\u003edemo\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eChildClass\u003c/span\u003e \u003cspan class=\"k\"\u003eextends\u003c/span\u003e \u003cspan class=\"nx\"\u003eParentClass\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e#[\\Override]\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e    \u003cspan class=\"k\"\u003eprotected\u003c/span\u003e \u003cspan class=\"k\"\u003efunction\u003c/span\u003e \u003cspan class=\"nf\"\u003edemo\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{}\u003c/span\u003e \u003cspan class=\"c1\"\u003e// ✅ 明确覆盖\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e#[\\Override]\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e    \u003cspan class=\"k\"\u003eprotected\u003c/span\u003e \u003cspan class=\"k\"\u003efunction\u003c/span\u003e \u003cspan class=\"nf\"\u003edemmo\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{}\u003c/span\u003e \u003cspan class=\"c1\"\u003e// ❌ Fatal error (拼写错误)\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"new-functions-83\"\u003eNew Functions 8.3\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Pad a multibyte string to a certain length with another multibyte string\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003eecho\u003c/span\u003e \u003cspan class=\"nx\"\u003emb_str_pad\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;中国\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e6\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;爱\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eSTR_PAD_RIGHT\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e.\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"se\"\u003e\\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eecho\u003c/span\u003e \u003cspan class=\"nx\"\u003emb_str_pad\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;中国\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e6\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;爱\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eSTR_PAD_LEFT\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e.\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"se\"\u003e\\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eecho\u003c/span\u003e \u003cspan class=\"nx\"\u003emb_str_pad\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;中国人\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e6\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;爱\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eSTR_PAD_BOTH\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e.\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"se\"\u003e\\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 中国爱爱爱爱\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 爱爱爱爱中国\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 爱中国人爱爱\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"backward-incompatible-changes-83\"\u003eBackward Incompatible Changes 8.3\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Assigning a negative index n to an empty array will now make sure that the next index is n + 1 instead of 0.\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nv\"\u003e$arr\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e[];\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$arr\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e5\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;a\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$arr\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;b\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$arr\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// PHP8.3    →  [-5 =\u0026gt; \u0026#39;a\u0026#39;, -4 =\u0026gt; \u0026#39;b\u0026#39;]\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// PHP \u0026lt;8.3  →  [-5 =\u0026gt; \u0026#39;a\u0026#39;, 0 =\u0026gt; \u0026#39;b\u0026#39;]\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u0026ndash; EOF \u0026ndash;\u003c/p\u003e","title":"PHP Migrating 8.2 to 8.3"},{"content":" 实验环境：https://onlinephp.io/ https://www.php.net/releases/8.2/en.php https://www.php.net/manual/en/migration82.php https://php.watch/versions/8.2 https://github.com/symfony/polyfill/tree/1.x/src/Php82 PHP 8.2 brings type-system improvements for expressive and fine-grained type-safety, readonly classes, sensitive parameter redaction support, new random extension, and many new features along with several changes to streamline and modernize PHP language.\nNew Features 8.2 // Readonly Classes // Complete class properties become immutable when declared readonly readonly class User { public function __construct(public string $username, public string $email) { } } // All properties automatically become readonly $user = new User(\u0026#39;john_doe\u0026#39;, \u0026#39;john@example.com\u0026#39;); $user-\u0026gt;email = \u0026#39;new@example.com\u0026#39;; // Fatal error: Uncaught Error: Cannot modify readonly property User::$email // Combine union and intersection types using Disjunctive Normal Form // 析取范式，允许通过 |（联合）和 \u0026amp;（交叉）运算符组合类型 function process((Countable\u0026amp;Iterator)|null $item) { return $item; } // Use null, true, false as independent types function alwaysFalse(): false {} function alwaysNull(): null {} function alwaysTrue(): true {} // Define constants directly in traits trait NetworkTrait { public const TIMEOUT = 60; } // Hide sensitive data in stack traces function hashPassword(#[\\SensitiveParameter] string $password) { debug_print_backtrace(); } hashPassword(\u0026#39;secret123\u0026#39;); // Before #0 /home/user/scripts/code.php(7): hashPassword(\u0026#39;secret123\u0026#39;) // PHP8.2 #0 /home/user/scripts/code.php(7): hashPassword(Object(SensitiveParameterValue)) // Consolidated RNG functions with OOP interface $randomizer = new \\Random\\Randomizer(); echo $randomizer-\u0026gt;getInt(1, 100); // Random integer New Functions 8.2 // Parses any data size recognized by PHP INI values ini_parse_quantity(\u0026#39;256M\u0026#39;); // 268435456 Deprecated Features 8.2 // ${var} String Interpolation Deprecated $name = \u0026#39;Li\u0026#39;; echo \u0026#34;Hello ${name}\u0026#34;; // should be `{$name}` // Deprecated: Using ${var} in strings is deprecated, use {$var} instead $var = \u0026#39;name\u0026#39;; echo \u0026#34;Hello ${$var}\u0026#34;; // should be `{$$var}` // Deprecated: Using ${expr} (variable variables) in strings is deprecated, use {${expr}} \u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2024/07/01/php-migrating-81-to-82/","summary":"\u003cul\u003e\n\u003cli\u003e实验环境：\u003ca href=\"https://onlinephp.io/\"\u003ehttps://onlinephp.io/\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.php.net/releases/8.2/en.php\"\u003ehttps://www.php.net/releases/8.2/en.php\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.php.net/manual/en/migration82.php\"\u003ehttps://www.php.net/manual/en/migration82.php\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://php.watch/versions/8.2\"\u003ehttps://php.watch/versions/8.2\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/symfony/polyfill/tree/1.x/src/Php82\"\u003ehttps://github.com/symfony/polyfill/tree/1.x/src/Php82\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cblockquote\u003e\n\u003cp\u003ePHP 8.2 brings type-system improvements for expressive and fine-grained type-safety, readonly classes, sensitive parameter redaction support, new random extension, and many new features along with several changes to streamline and modernize PHP language.\u003c/p\u003e\u003c/blockquote\u003e\n\u003ch2 id=\"new-features-82\"\u003eNew Features 8.2\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Readonly Classes\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Complete class properties become immutable when declared readonly\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nx\"\u003ereadonly\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eUser\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003efunction\u003c/span\u003e \u003cspan class=\"fm\"\u003e__construct\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"nx\"\u003estring\u003c/span\u003e \u003cspan class=\"nv\"\u003e$username\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"nx\"\u003estring\u003c/span\u003e \u003cspan class=\"nv\"\u003e$email\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// All properties automatically become readonly\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nv\"\u003e$user\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003eUser\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;john_doe\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;john@example.com\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$user\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"na\"\u003eemail\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;new@example.com\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Fatal error: Uncaught Error: Cannot modify readonly property User::$email\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Combine union and intersection types using Disjunctive Normal Form\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 析取范式，允许通过 |（联合）和 \u0026amp;（交叉）运算符组合类型\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003efunction\u003c/span\u003e \u003cspan class=\"nf\"\u003eprocess\u003c/span\u003e\u003cspan class=\"p\"\u003e((\u003c/span\u003e\u003cspan class=\"nx\"\u003eCountable\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"nx\"\u003eIterator\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"k\"\u003enull\u003c/span\u003e \u003cspan class=\"nv\"\u003e$item\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nv\"\u003e$item\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Use null, true, false as independent types\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003efunction\u003c/span\u003e \u003cspan class=\"nf\"\u003ealwaysFalse\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"k\"\u003efalse\u003c/span\u003e \u003cspan class=\"p\"\u003e{}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003efunction\u003c/span\u003e \u003cspan class=\"nf\"\u003ealwaysNull\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e \u003cspan class=\"p\"\u003e{}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003efunction\u003c/span\u003e \u003cspan class=\"nf\"\u003ealwaysTrue\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"k\"\u003etrue\u003c/span\u003e \u003cspan class=\"p\"\u003e{}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Define constants directly in traits\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003etrait\u003c/span\u003e \u003cspan class=\"nx\"\u003eNetworkTrait\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003econst\u003c/span\u003e \u003cspan class=\"no\"\u003eTIMEOUT\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e60\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Hide sensitive data in stack traces\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003efunction\u003c/span\u003e \u003cspan class=\"nf\"\u003ehashPassword\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"c1\"\u003e#[\\SensitiveParameter] string $password) {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e    \u003cspan class=\"nx\"\u003edebug_print_backtrace\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003ehashPassword\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;secret123\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Before #0 /home/user/scripts/code.php(7): hashPassword(\u0026#39;secret123\u0026#39;)\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// PHP8.2 #0 /home/user/scripts/code.php(7): hashPassword(Object(SensitiveParameterValue))\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Consolidated RNG functions with OOP interface\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nv\"\u003e$randomizer\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003e\\Random\\Randomizer\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eecho\u003c/span\u003e \u003cspan class=\"nv\"\u003e$randomizer\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"na\"\u003egetInt\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e100\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"c1\"\u003e// Random integer\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"new-functions-82\"\u003eNew Functions 8.2\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Parses any data size recognized by PHP INI values\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nx\"\u003eini_parse_quantity\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;256M\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"c1\"\u003e// 268435456\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"deprecated-features-82\"\u003eDeprecated Features 8.2\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// ${var} String Interpolation Deprecated\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nv\"\u003e$name\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;Li\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eecho\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Hello \u003c/span\u003e\u003cspan class=\"si\"\u003e${\u003c/span\u003e\u003cspan class=\"nv\"\u003ename\u003c/span\u003e\u003cspan class=\"si\"\u003e}\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"c1\"\u003e// should be `{$name}`\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Deprecated: Using ${var} in strings is deprecated, use {$var} instead\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nv\"\u003e$var\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;name\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eecho\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Hello \u003c/span\u003e\u003cspan class=\"si\"\u003e${\u003c/span\u003e\u003cspan class=\"nv\"\u003e$var\u003c/span\u003e\u003cspan class=\"si\"\u003e}\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"c1\"\u003e// should be `{$$var}`\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Deprecated: Using ${expr} (variable variables) in strings is deprecated, use {${expr}}\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u0026ndash; EOF \u0026ndash;\u003c/p\u003e","title":"PHP Migrating 8.1 to 8.2"},{"content":"04 特色及优势 对象模型，快速响应业务变化：\n多形性：同一个集合中可以包含不同字段（类型）的文档对象。 动态性：线上修改数据模式，修改是应用与数据库均无须下线。 数据治理：支持使用JSONSchema 来规范数据模式。在保证模式灵活动态的前提下，提供数据治理能力。 快速的开发：\n只存储在一个存储区读写。 反范式、无关联的组织极大优化查询速度。 程序 API 自然，开发速度快。 原生的高可用：\nReplica Set - 2 to 50 个成员，建议单数。 自恢复。 多中心容灾能力。 滚动服务，最小化服务终端。 横向扩展能力：\n需要的时候无缝扩展。 应用全透明。 多种数据分布策略。 轻松支持 TB-PB 数量级。 06 基本操作 cloud.mongodb.com 云服务 样本数据 | geektime-mongodb-course tar -xvf dump.tar.gz mongorestore --uri=\u0026#34;mongodb://root:root@10.130.0.12/?\u0026amp;authMechanism=SCRAM-SHA-1\u0026#34; // 插入 db.fruit.insertOne({name: \u0026#34;apple\u0026#34;}) db.fruit.insertMany([ {name: \u0026#34;apple\u0026#34;}, {name: \u0026#34;pear\u0026#34;}, {name: \u0026#34;orange\u0026#34;}, ]) // 查询 db.customers.find({username: \u0026#34;fmiller\u0026#34;, name: \u0026#34;Elizabeth Ray\u0026#34;}) db.customers.find({username: /^f/}) db.customers.find({$or: [{username: /^f/}, {name: /^E/}]}) a \u0026lt;\u0026gt; 1 {a: {$ne: 1}} a \u0026gt; 1 {a: {$gt: 1}} a \u0026gt;= 1 {a: {$gte: 1}} a \u0026lt; 1 {a: {$lt: 1}} a \u0026lt;= 1 {a: {$lte: 1}} a=1 OR b=1 {$or: [{a: 1}, {b: 1}]} a IS NULL {a: {$exists: false}} a IS (1,2,3) {a: {$in: [1, 2, 3]}} // 同时满足 {$eleMatch: {\u0026#34;city\u0026#34;: \u0026#34;Rome\u0026#34;, \u0026#34;country\u0026#34;: \u0026#34;USA\u0026#34;}} // 投影 projection // like select db.customers.find({username: /^f/}, {name: 0, email: 0}) db.customers.find({username: /^f/}, {_id: 1, name: 1}) // remove db.customers.remove({username: \u0026#34;abrown\u0026#34;}) // update db.customers.updateOne({username: \u0026#34;fmiller\u0026#34;}, {$set: {from: \u0026#34;China\u0026#34;}}) db.customers.updateMany({username: \u0026#34;fmiller\u0026#34;}, {$set: {from: \u0026#34;China\u0026#34;}}) // $set $unset // $push $pushAll $pop 数组操作 // $pull $pullAll 如果匹配，从数组中删除相应的对象 // $addToSet 如果不存在则增加一个值到数组 // drop db.fruit.drop() show collections db db.dropDatabase() show dbs 08 聚合查询 Aggregation Framework\nPipeline Stage pipeline = [stage1, stage2, ...] db.\u0026lt;collection\u0026gt;.aggregate( pipeline, { option } ) $match 过滤 $project 投影 $sort 排序 $group 分组 $skip $limit 结果限制 $lookup 左外连接 09 聚合查询实验 // 计算总合计 db.orders.aggregate([ { $group: { _id: null, total: {$sum: \u0026#34;$total\u0026#34;} } } ]) // { // \u0026#34;_id\u0026#34;: null, // \u0026#34;total\u0026#34;: NumberDecimal(\u0026#34;44019609\u0026#34;) // } // 查询 2019 第一季度，已完成订单（completed）总金额（金额+运费）和订单总数 db.orders.aggregate([ { $match: { status: \u0026#34;completed\u0026#34;, orderDate: { $gte: ISODate(\u0026#34;2019-01-01\u0026#34;), $lt: ISODate(\u0026#34;2019-04-01\u0026#34;) } } }, { $group: { _id: null, total: { $sum: \u0026#34;$total\u0026#34; }, shippingFee: { $sum: \u0026#34;$shippingFee\u0026#34; }, count: { $sum: 1 } } }, { $project: { grandTotal: { $add: [\u0026#34;$total\u0026#34;, \u0026#34;$shippingFee\u0026#34;] }, count: 1, _id: 0 } } ]) // { // \u0026#34;count\u0026#34;: 5875, // \u0026#34;grandTotal\u0026#34;: NumberDecimal(\u0026#34;2636376\u0026#34;) // } 10 复制集机制及原理 由3个以上具有投票权的节点组成：\n1个主节点 PRIMARY：接收写入操作和选举时投票。 两个或多个从节点 SECONDARY：复制主节点上的新数据和选举时投票。 数据是如何复制的：\n当一个修改操作，无论是插入、更新或删除，到达主节点时它对数据的操作将被记录下来(经过些必要的转换)，这些记录称为 oplog。 从节点通过在主节点上打开一个 tailable 游标不断获取新进入主节点的 oplog，并在自己的数据上回放，以此保持跟主节点的数据一致。 通过选举完成故障恢复：\n具有投票权的节点之间两两互相发送心跳。 当5次心跳未收到时判断为节点失联。 如果失联的是主节点，从节点会发起选举，选出新的主节点。 如果失联的是从节点则不会产生新的选举。 选举基于RAFT一致性算法实现，选举成功的必要条件是大多数投票节点存活。 复制集中最多可以有50个节点，但具有投票权的节点最多7个。 影响选举的因素：\n整个集群必须有大多数节点存活。 被选举为主节点的节点必须： 能够与多数节点建立连接 具有较新的 oplog 具有较高的优先级(如果有配置) 复制集节点有以下常见的选配项：\n是否具有投票权（v 参数）：有则参与投票。 优先级（priority 参数）：优先级越高的节点越优先成为主节点。优先级为0的节点无法成为主节点。 隐藏（hidden 参数）：复制数据，但对应用不可见。隐藏节点可以具有投票仅，但优先级必须为0。 延迟（slaveDelay 参数）：复制 n 秒之前的数据，保持与主节点的时间差。 复制集注意事项：\n关于硬件： 因为正常的复制集节点都有可能成为主节点，它们的地位是一样的，因此硬件配置上必须致； 为了保证节点不会同时岩机，各节点使用的硬件必须具有独立性。 关于软件： 复制集各节点软件版本必须一致，以避免出现不可预知的问题。 增加节点不会增加系统写性能！ 11 搭建 MongoDB 复制集 mkdir -p runtime/data_db{1,2,3} \u0026amp;\u0026amp; \\ mkdir -p runtime/data_configdb{1,2,3} hostname -f rs.status() 12 全家桶 launch-manage | mongodb database-tools | mongodb 13 模型设计基础 Entity Attribute Relationship 概念模型 CDM -\u0026gt; 逻辑模型 LDM -\u0026gt; 物理模型 PDM 对象 -\u0026gt; 实体、属性、关系 -\u0026gt; 表结构、字段列表、主外建\n14 JSON 文档模型设计 无模式的由来：可以省略无论建模的具体过程，物理模型可省。\n设计原则：\n性能 Performance 开发易用 Ease of Development 15 基础设计 集合、字段、基础形状 -\u0026gt; 引用及关联 -\u0026gt; 最终模式\n业务需求及逻辑模型 \u0026ndash;逻辑导向-\u0026gt; 基础建模 \u0026mdash;\u0026gt; 集合、字段、基础形状\n一个文档 16MB max.\n内嵌为主。\n16 工况细化 技术需求、读写比例、方式及数据 \u0026ndash;技术导向-\u0026gt; 工况细化 \u0026mdash;\u0026gt; 引用及关联\n引用模式 $lookup：\ndb.contacts.aggregate([ $lookup: { form: \u0026#34;groups\u0026#34;, localField: \u0026#34;groups_ids\u0026#34;, foreignField: \u0026#34;groups_id\u0026#34;, as: \u0026#34;groups\u0026#34;, } ]) 使用引用方式：\n内嵌文档太大 内嵌文档或数组元素频繁修改 内嵌文档数组元素持续增长且没有封顶 使用引用的设计：\n没有主外键的检查 $lookup 只支持 left outer join $lookup 的关系目标（from）不能是分片表 17 模式套用 经验和学习 \u0026ndash;模式导向-\u0026gt; 套用设计模式 -\u0026gt; 优化的模型\n时序数据，分桶设计：利用文档内嵌组，将一个时间段的数据聚合到一个文档里。大量减少文档数据量，大量减少索引占用空间。\n18 设计模式集锦 大文档，很多字段，很多索引。列转行。列数据变化为数组。多语言多国家属性，类似字段需要建立很多索引。转化为数组，一个索引解决所有查询问题。\n模型灵活了，如何管理文档不同版本？增加一个版本字段。schema_version。\n统计网页点击流量。近似计算。if random(0,9)==0 increment by 10。\n业绩排名、游戏排名等精确统计。消耗资源多，聚合计算时间长。用预聚合字段。模型中直接增加统计字段，每次更新数据时同时更新统计值。\n19 写操作事务 writeConcern write-concern | mongodb\n{ w: \u0026lt;value\u0026gt;, j: \u0026lt;boolean\u0026gt;, wtimeout: \u0026lt;number\u0026gt; } rs.status(); db.test.drop() db.test.insert({count:2}, {writeConcern: {w: \u0026#34;majority\u0026#34;}}) db.test.insert({count:2}, {writeConcern: {w: 3}}) db.test.insert({count:2}, {writeConcern: {w: 1}}) // WriteResult({ \u0026#34;nInserted\u0026#34; : 1, \u0026#34;writeConcernError\u0026#34; : [ ] }) db.test.insert({count:2}, {writeConcern: {w: 4}}) // [Error] 100 - Not enough data-bearing nodes db.test.find() // 配置延迟节点，模拟网络延迟 conf=rs.conf() // { // \u0026#34;_id\u0026#34;: 3, // \u0026#34;host\u0026#34;: \u0026#34;mongo3:27017\u0026#34;, // \u0026#34;arbiterOnly\u0026#34;: false, // \u0026#34;buildIndexes\u0026#34;: true, // \u0026#34;hidden\u0026#34;: false, // \u0026#34;priority\u0026#34;: 1, // \u0026#34;tags\u0026#34;: { }, // \u0026#34;slaveDelay\u0026#34;: NumberLong(\u0026#34;0\u0026#34;), // \u0026#34;votes\u0026#34;: 1 // } conf.members[2].slaveDelay=5 // 没有选举权 conf.members[2].priority=0 rs.reconfig(conf) // { // \u0026#34;_id\u0026#34;: 3, // \u0026#34;host\u0026#34;: \u0026#34;mongo3:27017\u0026#34;, // \u0026#34;arbiterOnly\u0026#34;: false, // \u0026#34;buildIndexes\u0026#34;: true, // \u0026#34;hidden\u0026#34;: false, // \u0026#34;priority\u0026#34;: 0, // \u0026#34;tags\u0026#34;: { }, // \u0026#34;slaveDelay\u0026#34;: NumberLong(\u0026#34;5\u0026#34;), // \u0026#34;votes\u0026#34;: 1 // } db.test.insert({count:2}, {writeConcern: {w: 3}}) // Result Time 5s // 3s 超时 db.test.insert({count:5}, {writeConcern: {w: 3, wtimeout:3000}}) // writeResult({ // \u0026#34;nInserted\u0026#34; : 1, // \u0026#34;writeConcernError\u0026#34; : { // \u0026#34;code\u0026#34; : 64, // \u0026#34;codeName\u0026#34; : \u0026#34;WriteConcernFailed\u0026#34;, // \u0026#34;errmsg\u0026#34; : \u0026#34;waiting for replication timed out\u0026#34;, // \u0026#34;errInfo\u0026#34; : { // \u0026#34;wtimeout\u0026#34; : true, // \u0026#34;writeConcern\u0026#34; : { // \u0026#34;w\u0026#34; : 3, // \u0026#34;wtimeout\u0026#34; : 3000, // \u0026#34;provenance\u0026#34; : \u0026#34;clientSupplied\u0026#34; // } // } // } // }) 20 读操作事务 readPreference Read Preference | mongodb Read Preference Tags | mongodb 配置：\nmongodb://\u0026hellip;/?replicaSet=rs\u0026amp;readPrefence=secondary 通过驱动API，MongoCollection.withReadPrefence(ReadPrefence readPref) Mongo Shell: db.collection.find({}).readPref(\u0026ldquo;secondary\u0026rdquo;) 实验：\n// 主节点 db.test.drop() db.test.insert({count:2}, {writeConcern: {w: 3}}) db.test.find({}) // 1 line db.test.find({}).readPref(\u0026#34;secondary\u0026#34;) // 1 line // 从节点 1、2 db.test.find({}) // 1 line db.fsyncLock() // now locked against writes, use db.fsyncUnlock() to unlock 锁住写入 // 主节点 db.test.insert({count:3}) db.test.find({}) // 2 line db.test.find().readPref(\u0026#34;secondary\u0026#34;) // 1 line // 从节点 1、2 db.fsyncUnlock() // 主节点 db.test.find().readPref(\u0026#34;secondary\u0026#34;) 21 读操作事务 readConcern read-concern | mongodb enableMajorityReadConcern: true\n// 从节点 1、2 db.fsyncLock() // 主节点 db.test.insert({count:3}) db.test.find().readConcern(\u0026#34;local\u0026#34;) // 如果在一个写操作到达大多数节点前读取了这个写操作，然后因为系统故障该操作回滚了，则发生了脏读 // {readConcern: \u0026#34;majority\u0026#34;} 可以避免脏读 db.test.find().readConcern(\u0026#34;majority\u0026#34;) majority 约为：Read Committed。\n22 多文档事务 Atomocity 原子性 Consistency 一致性 writeConcern,readConcern Isolation 隔离性 readConcern Durability 持久性 Journal and Replication 实验启用事务后的隔离性：\ndb.tx.drop(); db.tx.insertMany([{x:1},{x:2}]); var session = db.getMongo().startSession(); session.startTransaction(); var coll = session.getDatabase(\u0026#39;test\u0026#39;).getCollection(\u0026#39;tx\u0026#39;); coll.updateOne({x:2}, {$set: {y:1}}); // { // acknowledged: true, // insertedId: null, // matchedCount: 1, // modifiedCount: 1, // upsertedCount: 0 // } coll.find(); // [ // { _id: ObjectId(\u0026#34;64478074fcfac90fb90f1a65\u0026#34;), x: 1 }, // { _id: ObjectId(\u0026#34;64478074fcfac90fb90f1a66\u0026#34;), x: 2, y: 1 } // ] db.tx.find(); // [ // { _id: ObjectId(\u0026#34;64478074fcfac90fb90f1a65\u0026#34;), x: 1 }, // { _id: ObjectId(\u0026#34;64478074fcfac90fb90f1a66\u0026#34;), x: 2 } // ] session.commitTransaction(); db.tx.find(); 实验可重复读 Repeatable Read：\ndb.tx.drop(); db.tx.insertMany([{x:1},{x:2}]); var session = db.getMongo().startSession(); session.startTransaction({ readConcern: {\u0026#34;level\u0026#34;: \u0026#34;snapshot\u0026#34;}, writeConcern: {\u0026#34;w\u0026#34;: \u0026#34;majority\u0026#34;} }); var coll = session.getDatabase(\u0026#39;test\u0026#39;).getCollection(\u0026#39;tx\u0026#39;); coll.findOne({x: 1}); // 模拟事务之外的操作 db.tx.updateOne({x:1}, {$set: {y:1}}); db.tx.find(); // [ // { _id: ObjectId(\u0026#34;644782c3fcfac90fb90f1a69\u0026#34;), x: 1, y: 1 }, // { _id: ObjectId(\u0026#34;644782c3fcfac90fb90f1a6a\u0026#34;), x: 2 } // ] coll.findOne({x: 1}); // { _id: ObjectId(\u0026#34;644782c3fcfac90fb90f1a69\u0026#34;), x: 1 } session.abortTransaction(); 实验写冲突：\ndb.tx.drop(); db.tx.insertMany([{x:1},{x:2}]); // shell 1、2 var session = db.getMongo().startSession(); session.startTransaction({ readConcern: {\u0026#34;level\u0026#34;: \u0026#34;snapshot\u0026#34;}, writeConcern: {\u0026#34;w\u0026#34;: \u0026#34;majority\u0026#34;} }); var coll = session.getDatabase(\u0026#39;test\u0026#39;).getCollection(\u0026#39;tx\u0026#39;); // shell 1 coll.updateOne({x:1}, {$set: {y:1}}); // ok // shell 2 coll.updateOne({x:1}, {$set: {y:1}}); // MongoServerError: WriteConflict error: this operation conflicted with another operation. Please retry your operation or multi-document transaction. // session.abortTransaction(); 事务默认 60s 内完成。 多文档事务中的读操作必须使用主节点读。 23 Change Stream 类似触发器。\n触发方式：异步 | 同步（事务保证） 触发位置：回调事件 | 数据库触发器 触发次数：每个订阅事件的客户端 | 1次 故障恢复：从上此断点重新触发 | 事务回滚 基于 oplog 实现。被追踪的变更事件主要包括：\ninsert/update/delete drop rename dropDatabase invalidate：drop/rename/dropDatabase 将导致 invalidate 被触发，并关闭 chage stream 可重复读。未开启 majority readConcern 的集群无法使用 Change Stream。当集群无法满足 {w: \u0026ldquo;majority\u0026rdquo;} 时，不会触发 Change Stream。\n可以使用集合管道的过滤步骤过滤事件。\n25 分片集群机制及原理 路由节点 mongos 配置节点 mongod 数据节点 mongod 分片集群数据发布方式\n基于范围 查询性能好，数据分布可能不均匀 基于哈希 发布均匀，范围查询效率低；日志、物联网 Zone 数据天然分区 25 分片集群设计 片键 shard key 文档中的一个字段 文档 doc 块 chunk 分片 shard 集群 cluster 片键：\n取值基数范围要大 取值范围应尽可能均匀 对主要查询要具有定向能力 组合片键。{user_id:1, time:1}\n27 分片集群搭建及扩容 # 1 配置域名解析 # 2 准备分片目录 # 3 创建第1个分片复制集 member1:27010 member3:27010 member5:27010 mongod --bind_ip_all --replSet shard1 --shardsvr --wiredTigerCacheSizeGB 1 # --shardsvr 标注为分片节点 # --wiredTigerCacheSizeGB 1 缓存大小 # 4 初始化分片复制集 # 5 创建 config server 复制集 member1:27019 member3:27019 member5:27019 mongod --bind_ip_all --replSet config --configsvr --wiredTigerCacheSizeGB 1 # --configsvr 标注为配置节点 # 6 创建 config server 复制集 # 7 搭建 mongos member1:27017 mongos --bind_ip_all --configdb config/member1:27019,member3:27019,member5:27019, # 连接到 mongos 添加分片 sh.addShard(\u0026#34;shard1/member1:27010,member3:27010,member5:27010\u0026#34;) # 8 创建分片表 # 连接到 mongos member1:27017 sh.enableSharding(\u0026#34;foo\u0026#34;); sh.shardCollection(\u0026#34;foo.bar\u0026#34;, {_id: \u0026#34;hashed\u0026#34;}); sh.status(); # 插入测试数据 use foo for(var i=0;1\u0026lt;10000;i++) { db.bar.insert({i:i)) } # 9 创建第2个分片复制集 member2:27011 member4:27011 member6:27011 # 10 初始化第2个分片复制集 # 11 加入第2个分片 # 连接到 mongos 添加分片 sh.addShard(\u0026#34;shard2/member2:27011,member4:27011,member6:27011\u0026#34;) 28 监控最佳实践 MongoDB Ops Manager Percona 程序脚本 如何获取监控数据：\ndb.serverStatus() 从上次开机到现在为止 db.isMaster() monogostats db.serverStatus().opcounters 29 备份与恢复 延迟节点备份 全量备份+Oplog增量，Oplog 幂等性 支持重放 mongodump \u0026ndash;oplog；不遗漏 dump 时的数据 mongorestore \u0026ndash;oplogReplay 31 安全架构 db.createRole({ role: \u0026#34;readWriteRole\u0026#34;, privileges: [ { resource: { db: \u0026#34;myDatabase\u0026#34;, collection: \u0026#34;sample\u0026#34; }, actions: [ \u0026#34;find\u0026#34;, \u0026#34;insert\u0026#34;, \u0026#34;update\u0026#34;, \u0026#34;remove\u0026#34; ] } ], roles: [{ role: \u0026#39;read\u0026#39;, db: \u0026#39;sampledb\u0026#39;, }] }) db.createUser({ user: \u0026#39;sampleUser\u0026#39;, pwd: \u0026#39;pwd\u0026#39;, roles: [{ role: \u0026#39;readWriteRole\u0026#39;, db: \u0026#39;admin\u0026#39;, }] }) 32 安全加固实践 # 禁止脚本执行 --noscripting # 必须鉴权 --auth 33 索引机制（一） Index、Key、DataPage Covered Query/FETCH IXSCAN/COLLSCAN 索引扫描/集合扫描 Big O Notation 时间复杂度 Query Shape 查询的形状 Index Prefix 索引前缀 Selectivity 过滤器 选择区别度大的 B-数结构 B-树和B+树都是常见的多路搜索树结构，常用于数据库索引和文件系统中。它们的主要区别在于如何存储和检索数据。\nB-树是一种自平衡的搜索树，其中每个节点可以存储多个键和对应的值，并支持在O(log n)时间内进行搜索、插入和删除操作。B-树的每个节点都包含了一个子节点数组，可以用来搜索和遍历树。在B-树中，所有节点都可以存储键和值，而非仅仅是叶子节点。\nB+树与B-树非常相似，但是只有叶节点包含了所有的键和值，而且所有叶节点都通过指针链接在一起。这意味着在B+树上进行查找只需要搜索一条从根节点到叶节点的路径，而在B-树中可能需要搜索多个节点。B+树的非叶子节点只包含键，而不包含值，这使得B+树在维护索引时更加高效。\n因此，B+树比B-树更适用于存储和检索大量数据，尤其是数据库和文件系统中的索引。B+树的叶子节点形成了一个有序链表，可以方便地进行区间查找和遍历。而B-树则更适合内存较小的情况下，例如缓存。\n34 索引机制（二） .explain(true) 查看：\nexecutionTimeMillis totalDocsExamined executionStages.docsExamined executionStages.inputStage.stage 组合索引 ESR 原则，Equal(最前) Sort(中间) Range(最后)\ndb.member.createIndex({city:1}, {background: true})\n36 性能诊断工具 mongostat 了解 MongoDB 运行状态的工具。\ndirty 没有刷盘的比例 \u0026lt;5% used qrw 排队的请求 con 连接数量 mongotop 了解集合压力状态\nmtools\n41 应用场景及选型 优点：\n横向扩展能力，数据量或并发量增加时候架构可以自动扩容 灵活模型，适合迭代开发，数据模型多变场景 JSON 数据结构，适合微服务/REST API 44 关系型数据库迁移 从基于关系型数据库应用迁移到 MongoDB 的理由：\n高并发需求（数千 - 数十万 ops），关系型数据库不容易扩展 快速迭代 - 关系型模式太严谨 灵活的 JSON 模式 大数据量需求 地理位置查询 多数据中心跨地域部署 References MongoDB 高手课 mongodb-cluster-docker-compose \u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2023/04/19/mongodb-course/","summary":"\u003ch2 id=\"04-特色及优势\"\u003e04 特色及优势\u003c/h2\u003e\n\u003cp\u003e对象模型，快速响应业务变化：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e多形性：同一个集合中可以包含不同字段（类型）的文档对象。\u003c/li\u003e\n\u003cli\u003e动态性：线上修改数据模式，修改是应用与数据库均无须下线。\u003c/li\u003e\n\u003cli\u003e数据治理：支持使用JSONSchema 来规范数据模式。在保证模式灵活动态的前提下，提供数据治理能力。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e快速的开发：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e只存储在一个存储区读写。\u003c/li\u003e\n\u003cli\u003e反范式、无关联的组织极大优化查询速度。\u003c/li\u003e\n\u003cli\u003e程序 API 自然，开发速度快。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e原生的高可用：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eReplica Set - 2 to 50 个成员，建议单数。\u003c/li\u003e\n\u003cli\u003e自恢复。\u003c/li\u003e\n\u003cli\u003e多中心容灾能力。\u003c/li\u003e\n\u003cli\u003e滚动服务，最小化服务终端。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e横向扩展能力：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e需要的时候无缝扩展。\u003c/li\u003e\n\u003cli\u003e应用全透明。\u003c/li\u003e\n\u003cli\u003e多种数据分布策略。\u003c/li\u003e\n\u003cli\u003e轻松支持 TB-PB 数量级。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"06-基本操作\"\u003e06 基本操作\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://cloud.mongodb.com/v2/\"\u003ecloud.mongodb.com 云服务\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/tapdata/geektime-mongodb-course/blob/master/aggregation/dump.tar.gz\"\u003e样本数据 | geektime-mongodb-course\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003etar -xvf dump.tar.gz\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003emongorestore --uri\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;mongodb://root:root@10.130.0.12/?\u0026amp;authMechanism=SCRAM-SHA-1\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-javascript\" data-lang=\"javascript\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 插入\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nx\"\u003edb\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003efruit\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003einsertOne\u003c/span\u003e\u003cspan class=\"p\"\u003e({\u003c/span\u003e\u003cspan class=\"nx\"\u003ename\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;apple\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e})\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003edb\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003efruit\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003einsertMany\u003c/span\u003e\u003cspan class=\"p\"\u003e([\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nx\"\u003ename\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;apple\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e},\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nx\"\u003ename\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;pear\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e},\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nx\"\u003ename\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;orange\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e},\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 查询\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nx\"\u003edb\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ecustomers\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003efind\u003c/span\u003e\u003cspan class=\"p\"\u003e({\u003c/span\u003e\u003cspan class=\"nx\"\u003eusername\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;fmiller\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003ename\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Elizabeth Ray\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e})\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003edb\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ecustomers\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003efind\u003c/span\u003e\u003cspan class=\"p\"\u003e({\u003c/span\u003e\u003cspan class=\"nx\"\u003eusername\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"sr\"\u003e/^f/\u003c/span\u003e\u003cspan class=\"p\"\u003e})\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003edb\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ecustomers\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003efind\u003c/span\u003e\u003cspan class=\"p\"\u003e({\u003c/span\u003e\u003cspan class=\"nx\"\u003e$or\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e[{\u003c/span\u003e\u003cspan class=\"nx\"\u003eusername\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"sr\"\u003e/^f/\u003c/span\u003e\u003cspan class=\"p\"\u003e},\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nx\"\u003ename\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"sr\"\u003e/^E/\u003c/span\u003e\u003cspan class=\"p\"\u003e}]})\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cul\u003e\n\u003cli\u003e\u003ccode\u003ea \u0026lt;\u0026gt; 1\u003c/code\u003e \u003ccode\u003e{a: {$ne: 1}}\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003ea \u0026gt; 1\u003c/code\u003e \u003ccode\u003e{a: {$gt: 1}}\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003ea \u0026gt;= 1\u003c/code\u003e \u003ccode\u003e{a: {$gte: 1}}\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003ea \u0026lt; 1\u003c/code\u003e \u003ccode\u003e{a: {$lt: 1}}\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003ea \u0026lt;= 1\u003c/code\u003e \u003ccode\u003e{a: {$lte: 1}}\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003ea=1 OR b=1\u003c/code\u003e \u003ccode\u003e{$or: [{a: 1}, {b: 1}]}\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003ea IS NULL\u003c/code\u003e \u003ccode\u003e{a: {$exists: false}}\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003ea IS (1,2,3)\u003c/code\u003e \u003ccode\u003e{a: {$in: [1, 2, 3]}}\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-javascript\" data-lang=\"javascript\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 同时满足\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nx\"\u003e$eleMatch\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;city\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Rome\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;country\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;USA\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e}}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-javascript\" data-lang=\"javascript\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 投影 projection\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// like select\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nx\"\u003edb\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ecustomers\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003efind\u003c/span\u003e\u003cspan class=\"p\"\u003e({\u003c/span\u003e\u003cspan class=\"nx\"\u003eusername\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"sr\"\u003e/^f/\u003c/span\u003e\u003cspan class=\"p\"\u003e},\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nx\"\u003ename\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eemail\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e})\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003edb\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ecustomers\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003efind\u003c/span\u003e\u003cspan class=\"p\"\u003e({\u003c/span\u003e\u003cspan class=\"nx\"\u003eusername\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"sr\"\u003e/^f/\u003c/span\u003e\u003cspan class=\"p\"\u003e},\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nx\"\u003e_id\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003ename\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e})\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-javascript\" data-lang=\"javascript\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// remove\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nx\"\u003edb\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ecustomers\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eremove\u003c/span\u003e\u003cspan class=\"p\"\u003e({\u003c/span\u003e\u003cspan class=\"nx\"\u003eusername\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;abrown\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e})\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// update\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nx\"\u003edb\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ecustomers\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eupdateOne\u003c/span\u003e\u003cspan class=\"p\"\u003e({\u003c/span\u003e\u003cspan class=\"nx\"\u003eusername\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;fmiller\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e},\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nx\"\u003e$set\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nx\"\u003efrom\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;China\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e}})\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003edb\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ecustomers\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eupdateMany\u003c/span\u003e\u003cspan class=\"p\"\u003e({\u003c/span\u003e\u003cspan class=\"nx\"\u003eusername\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;fmiller\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e},\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nx\"\u003e$set\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nx\"\u003efrom\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;China\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e}})\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// $set $unset\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// $push $pushAll $pop 数组操作\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// $pull $pullAll 如果匹配，从数组中删除相应的对象\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// $addToSet 如果不存在则增加一个值到数组\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// drop\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nx\"\u003edb\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003efruit\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003edrop\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003eshow\u003c/span\u003e \u003cspan class=\"nx\"\u003ecollections\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003edb\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003edb\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003edropDatabase\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003eshow\u003c/span\u003e \u003cspan class=\"nx\"\u003edbs\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"08-聚合查询\"\u003e08 聚合查询\u003c/h2\u003e\n\u003cp\u003eAggregation Framework\u003c/p\u003e","title":"MongoDB 高手课"},{"content":"01 小传 Domain-Driven Design 是一种开发复杂软件的系统化的 方法学和思想。\n面向对象方法学还不能很好地应用于企业应用原因：\n很多开发人员走了一条只重技术不重业务的弯路。 围绕业务进行开发的方法本身就不好学。 早期面向对象方法学主要考虑的是建模技术，很少考虑协作问题。 难以适应变化。 从业务出发进行系统的设计。\nDDD 从面向对象和敏捷中提炼出了一套原则、模式和实践，使面向对象方法学在企业应用中更加容易学习和掌握。\n如果没有迭代开发、持续重构、测试驱动、持续集成等敏捷实践的支持，构建良好的领域模型并在代码上落地是很困难的。\n微服务是一种架构风格（或者说架构模式）。\n02 迭代一 领域专家需要对业务有总体性和本质性的把握，同时对业务发展也要有一定前瞻性，心里要有一盘棋。\n捕获行为需求（事件风暴）-\u0026gt; 领域建模 -\u0026gt; 结构设计 -\u0026gt; 数据库设计 -\u0026gt; 代码实现 |------- 模型的建立 --------| |--------- 模型的实现 ------| 03 事件风暴 上 识别领域事件；在业务流程中发生了什么？ 识别命令；谁，做了什么事，导致领域事件的发生？ 识别领域名词；命令、事件和那些名词性概念有关？ 领域事件表示的是，业务流程中每个步骤引发的结果。一般是完成时 + 被动语态。例：订单已被提交。\n在 DDD 中的各种命名，一般都优先使用约定俗成的 业务术语。\n不要把技术事件当成领域事件。 查询功能不算领域事件。领域事件应该是对某样事物产生了影响，并被记录的事情。 参加的人，各自写出领域事件 -\u0026gt; 一起讨论，统一理解。这种先发散，后收敛，反复迭代的过程实际上就是一种头脑风暴。“协作”才是事件风暴的精髓。\n04 事件风暴 下 首先我们看看领域事件的作用。从代码实现的角度来看，领域事件一般会对应一段代码逻辑，这段逻辑可能会最终改变数据库中的数据。另外，在事件驱动的架构中，一个领域事件可能会表现为一个向外部发送的异步消息。 那命令的作用体现在哪儿呢？领域建模时，我们可以通过对命令的走查（walkthrough），细化和验证领域模型。在实现层面，一个命令可能对应前端的一个操作，例如按下按钮；对于后端而言，一个命令可能对应一个 API。 再来说命令的执行者。在领域建模时，执行者可能本身就是一个领域对象，也可能是领域对象充当的角色，或者是权限管理中的一个角色。 如果要体现严格的时间顺序，我们可以用流程图、用顺序图等方法，但事件风暴不必关注这一点。\n我们是把每个小步骤都当作独立的一个事务来看待，还是把它们合起来作为同一个事务。另外，可以设想，如果每个小步骤都向外界发出一个领域事件，对系统后续的功能是不是有意义。原则上宜粗不宜细。\n抓住协作、统一语言、识别领域名词等要点。\n事件风暴是一种通过协作的方式捕获行为需求的方法，在这个过程里，业务人员和技术人员一起消化领域知识、形成统一语言、并为领域建模奠定基础。\nReferences \u0026ndash;\n","permalink":"https://zyf.im/2023/03/09/hands-on-ddd-part1/","summary":"\u003ch2 id=\"01-小传\"\u003e01 小传\u003c/h2\u003e\n\u003cp\u003eDomain-Driven Design 是一种开发复杂软件的系统化的 \u003cstrong\u003e方法学和思想\u003c/strong\u003e。\u003c/p\u003e\n\u003cp\u003e面向对象方法学还不能很好地应用于企业应用原因：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e很多开发人员走了一条只重技术不重业务的弯路。\u003c/li\u003e\n\u003cli\u003e围绕业务进行开发的方法本身就不好学。\u003c/li\u003e\n\u003cli\u003e早期面向对象方法学主要考虑的是建模技术，很少考虑协作问题。\u003c/li\u003e\n\u003cli\u003e难以适应变化。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e从业务出发进行系统的设计。\u003c/p\u003e\n\u003cp\u003eDDD 从面向对象和敏捷中提炼出了一套原则、模式和实践，使面向对象方法学在企业应用中更加容易学习和掌握。\u003c/p\u003e\n\u003cp\u003e如果没有迭代开发、持续重构、测试驱动、持续集成等敏捷实践的支持，构建良好的领域模型并在代码上落地是很困难的。\u003c/p\u003e\n\u003cp\u003e微服务是一种架构风格（或者说架构模式）。\u003c/p\u003e\n\u003ch2 id=\"02-迭代一\"\u003e02 迭代一\u003c/h2\u003e\n\u003cp\u003e领域专家需要对业务有总体性和本质性的把握，同时对业务发展也要有一定前瞻性，心里要有一盘棋。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e捕获行为需求（事件风暴）-\u0026gt; 领域建模 -\u0026gt; 结构设计 -\u0026gt; 数据库设计 -\u0026gt; 代码实现\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e-------   模型的建立   --------\u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e---------   模型的实现   ------\u003cspan class=\"p\"\u003e|\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"03-事件风暴-上\"\u003e03 事件风暴 上\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003e识别领域事件；在业务流程中发生了什么？\u003c/li\u003e\n\u003cli\u003e识别命令；谁，做了什么事，导致领域事件的发生？\u003c/li\u003e\n\u003cli\u003e识别领域名词；命令、事件和那些名词性概念有关？\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e领域事件表示的是，业务流程中每个步骤引发的结果。一般是完成时 + 被动语态。例：订单已被提交。\u003c/p\u003e\n\u003cp\u003e在 DDD 中的各种命名，一般都优先使用约定俗成的 \u003cstrong\u003e业务术语\u003c/strong\u003e。\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e不要把技术事件当成领域事件。\u003c/li\u003e\n\u003cli\u003e查询功能不算领域事件。领域事件应该是对某样事物产生了影响，并被记录的事情。\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e参加的人，各自写出领域事件 -\u0026gt; 一起讨论，统一理解。这种先发散，后收敛，反复迭代的过程实际上就是一种头脑风暴。“协作”才是事件风暴的精髓。\u003c/p\u003e\n\u003ch2 id=\"04-事件风暴-下\"\u003e04 事件风暴 下\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e首先我们看看领域事件的作用。从代码实现的角度来看，领域事件一般会对应一段代码逻辑，这段逻辑可能会最终改变数据库中的数据。另外，在事件驱动的架构中，一个领域事件可能会表现为一个向外部发送的异步消息。\u003c/li\u003e\n\u003cli\u003e那命令的作用体现在哪儿呢？领域建模时，我们可以通过对命令的走查（walkthrough），细化和验证领域模型。在实现层面，一个命令可能对应前端的一个操作，例如按下按钮；对于后端而言，一个命令可能对应一个 API。\u003c/li\u003e\n\u003cli\u003e再来说命令的执行者。在领域建模时，执行者可能本身就是一个领域对象，也可能是领域对象充当的角色，或者是权限管理中的一个角色。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e如果要体现严格的时间顺序，我们可以用流程图、用顺序图等方法，但事件风暴不必关注这一点。\u003c/p\u003e\n\u003cp\u003e我们是把每个小步骤都当作独立的一个事务来看待，还是把它们合起来作为同一个事务。另外，可以设想，如果每个小步骤都向外界发出一个领域事件，对系统后续的功能是不是有意义。原则上宜粗不宜细。\u003c/p\u003e\n\u003cp\u003e抓住协作、统一语言、识别领域名词等要点。\u003c/p\u003e\n\u003cp\u003e事件风暴是一种通过协作的方式捕获行为需求的方法，在这个过程里，业务人员和技术人员一起消化领域知识、形成统一语言、并为领域建模奠定基础。\u003c/p\u003e\n\u003ch2 id=\"references\"\u003eReferences\u003c/h2\u003e\n\u003cp\u003e\u0026ndash;\u003c/p\u003e","title":"手把手教你落地 DDD Part1"},{"content":"00 regex101 regulex ihateregex 01 元字符 正则表达式 —— 字符串的规则。\n元字符就是指那些在正则表达式中具有特殊意义的专用字符。\n特殊单字符 . 任意字符（换行除外） \\d 任意数字 \\D 任意非数字 \\w A-Za-z0-9_ \\W \\s 空白符 \\S 空白符 \\r 回车符 \\n 换行符 \\f 换页符 \\t 制表符 \\v 垂直制表符 范围 | 或 [abc] 多选一 [a-z] 之间 [^abc] 取反，不能是括号中的任意单个元素 量词 * 0\u0026lt;= + 1\u0026lt;= ? 0或1 {m} m {m,} m\u0026lt;= {m,n} m-n 02 量词与贪婪 贪婪(Greedy) *：匹配最长。在贪婪量词模式下，正则表达式会尽可能长地去匹配符合规则的字符串，且会回溯。\npreg_match_all(\u0026#34;/a*/i\u0026#34;, \u0026#34;aaabb\u0026#34;, $matches); var_dump($matches); 非贪婪(Reluctant) +?：匹配最短。在非贪婪量词模式下，正则表达式会匹配尽可能短的字符串。\nENV：Python3\nimport re re.findall(r\u0026#39;a*\u0026#39;, \u0026#39;aaabb\u0026#39;) # 贪婪模式 # [\u0026#39;aaa\u0026#39;, \u0026#39;\u0026#39;, \u0026#39;\u0026#39;, \u0026#39;\u0026#39;] re.findall(r\u0026#39;a*?\u0026#39;, \u0026#39;aaabb\u0026#39;) # 非贪婪模式 # [\u0026#39;\u0026#39;, \u0026#39;a\u0026#39;, \u0026#39;\u0026#39;, \u0026#39;a\u0026#39;, \u0026#39;\u0026#39;, \u0026#39;a\u0026#39;, \u0026#39;\u0026#39;, \u0026#39;\u0026#39;, \u0026#39;\u0026#39;] re.findall(r\u0026#39;\u0026#34;.+\u0026#34;\u0026#39;, \u0026#39;\u0026#34;the little cat\u0026#34; is a toy, it lokks \u0026#34;a little bad\u0026#34;\u0026#39;) # 贪婪模式 # [\u0026#39;\u0026#34;the little cat\u0026#34; is a toy, it lokks \u0026#34;a little bad\u0026#34;\u0026#39;] re.findall(r\u0026#39;\u0026#34;.+?\u0026#34;\u0026#39;, \u0026#39;\u0026#34;the little cat\u0026#34; is a toy, it lokks \u0026#34;a little bad\u0026#34;\u0026#39;) # 非贪婪模式 # [\u0026#39;\u0026#34;the little cat\u0026#34;\u0026#39;, \u0026#39;\u0026#34;a little bad\u0026#34;\u0026#39;] 独占模式(Possessive) ++：同贪婪一样匹配最长。不过在独占量词模式下，正则表达式尽可能长地去匹配字符串，一旦匹配不成功就会结束匹配而 不会回溯。\n# 回溯示例： import re re.findall(r\u0026#39;xy{1,3}z\u0026#39;, \u0026#39;xyyz\u0026#39;) # 回溯 # [\u0026#39;xyyz\u0026#39;] # 正则 xy{1,3} 会尽可能长地去匹配到 xyyz，无法匹配 z，向前回溯 xyy # 正则 z 匹配到剩下字符串 z re.findall(r\u0026#39;xy{1,3}?z\u0026#39;, \u0026#39;xyyz\u0026#39;) # 非贪婪 # [\u0026#39;xyyz\u0026#39;] # 正则 xy{1,3} 会尽可能短地去匹配到 xy # 正则 z 匹配到字符串 y，无法匹配，向前回溯 # 正则 xy{1,3} 会尽可能短地去匹配 xyy # 正则 z 匹配到剩下字符串 z # 独占模式示例： # pip install regex -i https://mirrors.aliyun.com/pypi/simple/ import regex regex.findall(r\u0026#39;xy{1,3}+z\u0026#39;, \u0026#39;xyyz\u0026#39;) # 独占 # [\u0026#39;xyyz\u0026#39;] # 正则 xy{1,3}+ 会尽可能长地去匹配到 xyy 并占用 # 正则 z 匹配到字符串 z regex.findall(r\u0026#39;xy{1,3}+yz\u0026#39;, \u0026#39;xyyz\u0026#39;) # 独占 # [] # 正则 xy{1,3}+ 会尽可能长地去匹配到 xyy 并占用 # 正则 yz 无法匹配到剩下字符串 z 03 分组与引用 import regex # 不保存分组 (?:正则) regex.sub(r\u0026#39;(\\d{4})-(?:\\d{2})-(\\d{2})\u0026#39;, r\u0026#34;年：\\1 日：\\2\u0026#34;, \u0026#39;2023-03-01\u0026#39;) # \u0026#39;年：2023 日：01\u0026#39; # 去除重复连续单词 regex.sub(r\u0026#39;(\\w+)(\\s\\1)+\u0026#39;, r\u0026#34;\\1\u0026#34;, \u0026#39;the little cat cat is in the hat hat hat, we like it.\u0026#39;) # \u0026#39;the little cat is in the hat, we like it.\u0026#39; 04 匹配模式 指改变元字符匹配行为。\n不区分大小写模式（Case-Insensitive）(?模式标识) (?i)。\nimport regex regex.findall(r\u0026#34;(?i)cat\u0026#34;, \u0026#34;cat Cat CAt\u0026#34;) # [\u0026#39;cat\u0026#39;, \u0026#39;Cat\u0026#39;, \u0026#39;CAt\u0026#39;] # https://regex101.com/r/3OUJda/1 # 二次重复时的大小写一致 ((?i)cat) \\1 点号通配模式（Dot All）(?s) 让英文的点 . 可以匹配上包括换行的任何字符。等价 [\\s\\S] [\\d\\D] [\\w\\W]。\n# https://regex101.com/r/zXtwLv/1 # 匹配包括换行符 (?s).+ 多行匹配模式（Multiline）(?m) 使 ^ 和 $ 能匹配上每行的开头或结尾。\n# 分行匹配 (?m)^cat|dog$ 注释模式（Comment）(?#)\n(\\w+)(?#word) \\1(?#word repeat again) 05 断言 Assertion 对要匹配的文本的位置也有一定的要求。只用于匹配位置，而不是文本内容本身，这种结构就是断言。\n边界（Boundary）\nimport re # 单词边界 \\b # tom -\u0026gt; jerry, tomorrow 不受影响 re.sub(r\u0026#39;\\btom\\b\u0026#39;, \u0026#39;jerry\u0026#39;, \u0026#34;tom asked me if I would go fishing with him tomorrow.\u0026#34;) # \u0026#39;jerry asked me if I would go fishing with him tomorrow.\u0026#39; # 行的开始结束 # \\A \\z 不受模式影响 # \\A -\u0026gt; ^, \\z -\u0026gt; $ re.sub(r\u0026#39;\\Atom\u0026#39;, \u0026#39;jerry\u0026#39;, \u0026#34;tom asked me if I would go fishing with him tomorrow.\u0026#34;) # 环视 左尖括号代表看左边，没有尖括号是看右边，感叹号是非的意思 # (?\u0026lt;=Y) 左边是Y # (?\u0026lt;!Y) 左边不是Y # (?=Y) 右边是Y # (?!Y) 右边不是Y re.findall(r\u0026#39;[1-9]\\d{5}\u0026#39;, \u0026#34;138001380002\u0026#34;) # [\u0026#39;138001\u0026#39;, \u0026#39;380002\u0026#39;] re.findall(r\u0026#39;(?\u0026lt;!\\d)[1-9]\\d{5}(?!\\d)\u0026#39;, \u0026#34;138001380002\u0026#34;) # 左边不是数字、右边不是数字 # [] re.findall(r\u0026#39;(?\u0026lt;!\\d)[1-9]\\d{5}(?!\\d)\u0026#39;, \u0026#34;code138001code\u0026#34;) # 左边不是数字、右边不是数字 # [\u0026#39;138001\u0026#39;] # \\b\\w+\\b -\u0026gt; (?\u0026lt;!\\w)\\w+(?!\\w) -\u0026gt; (?\u0026lt;=\\W)\\w+(?=\\W) # https://regex101.com/r/PBEKxY/1 # (\\w+)(\\s+\\b\\1\\b)+ # 单词，单词的左边是单词边界、可以有一个及以上空格，右边是单词边界 # 比 (\\w+)(\\s+\\1)+ 更严谨 eg: the little cat cat2 is in the hat hat2 06 转义 转义字符 Escape Character 后面的字符，不是原来的意思了。\nimport re re.findall(r\u0026#39;\\\\d\u0026#39;, \u0026#39;abc\\\\d123d\\\\\u0026#39;) # [\u0026#39;\\\\d\u0026#39;] re.findall(\u0026#39;\\\\\u0026#39;, \u0026#39;a*b+c?\\\\d123d\\\\\u0026#39;) # bad escape (end of pattern) at position 0 re.findall(\u0026#39;\\\\\\\\\u0026#39;, \u0026#39;a*b+c?\\\\d123d\\\\\u0026#39;) # [\u0026#39;\\\\\u0026#39;, \u0026#39;\\\\\u0026#39;] # 字符串-\u0026gt;正则表达式：字符串转义和正则转义 # \\\\\\\\ 字符串转义 \\\\ # \\\\ 正则转义 \\ re.findall(r\u0026#39;\\\\\u0026#39;, \u0026#39;a*b+c?\\\\d123d\\\\\u0026#39;) # [\u0026#39;\\\\\u0026#39;, \u0026#39;\\\\\u0026#39;] re.findall(\u0026#39;\\(\\)\\[]\\{}\u0026#39;, \u0026#39;()[]{}\u0026#39;) # [\u0026#39;()[]{}\u0026#39;] # 方括号和花括号的转义一般转义开括号就可以，但圆括号两个都需要转义 import re re.escape(\u0026#39;\\d\u0026#39;) # 反斜杠和字母d转义 # \u0026#39;\\\\\\\\d\u0026#39; re.findall(re.escape(\u0026#39;\\d\u0026#39;), \u0026#39;\\d\u0026#39;) # [\u0026#39;\\\\d\u0026#39;] re.escape(\u0026#39;[+]\u0026#39;) # \u0026#39;\\\\[\\\\+\\\\]\u0026#39; re.findall(re.escape(\u0026#39;[+]\u0026#39;), \u0026#39;[+]\u0026#39;) # [\u0026#39;[+]\u0026#39;] import re re.findall(r\u0026#39;[^ab]\u0026#39;, \u0026#39;^ab\u0026#39;) # 转义前代表\u0026#34;非\u0026#34; # [\u0026#39;^\u0026#39;] re.findall(r\u0026#39;[^cd]\u0026#39;, \u0026#39;^ab\u0026#39;) # [\u0026#39;^\u0026#39;, \u0026#39;a\u0026#39;, \u0026#39;b\u0026#39;] re.findall(r\u0026#39;[\\^ab]\u0026#39;, \u0026#39;^ab\u0026#39;) # 转义后代表普通字符 # [\u0026#39;^\u0026#39;, \u0026#39;a\u0026#39;, \u0026#39;b\u0026#39;] re.findall(r\u0026#39;[a-c]\u0026#39;, \u0026#39;abc-\u0026#39;) # 中划线在中间，代表\u0026#34;范围\u0026#34; # [\u0026#39;a\u0026#39;, \u0026#39;b\u0026#39;, \u0026#39;c\u0026#39;] re.findall(r\u0026#39;[a\\-c]\u0026#39;, \u0026#39;abc-\u0026#39;) # 中划线在中间，转义后的 re.findall(r\u0026#39;[-ac]\u0026#39;, \u0026#39;abc-\u0026#39;) # 在开头，不需要转义 re.findall(r\u0026#39;[ac-]\u0026#39;, \u0026#39;abc-\u0026#39;) # 在结尾，不需要转义 # [\u0026#39;a\u0026#39;, \u0026#39;c\u0026#39;, \u0026#39;-\u0026#39;] re.findall(r\u0026#39;[]ab]\u0026#39;, \u0026#39;]ab\u0026#39;) # 右括号不转义，在首位 # [\u0026#39;]\u0026#39;, \u0026#39;a\u0026#39;, \u0026#39;b\u0026#39;] re.findall(r\u0026#39;[a]b]\u0026#39;, \u0026#39;]ab\u0026#39;) # 右括号不转义，不在首位 # [] re.findall(r\u0026#39;[a\\]b]\u0026#39;, \u0026#39;]ab\u0026#39;) # 转义后代表普通字符 # [\u0026#39;]\u0026#39;, \u0026#39;a\u0026#39;, \u0026#39;b\u0026#39;] re.findall(r\u0026#39;[.*+?()]\u0026#39;, \u0026#39;[.*+?()]\u0026#39;) # 单个长度的元字符在中括号里，可以不转义 # [\u0026#39;.\u0026#39;, \u0026#39;*\u0026#39;, \u0026#39;+\u0026#39;, \u0026#39;?\u0026#39;, \u0026#39;(\u0026#39;, \u0026#39;)\u0026#39;] re.findall(r\u0026#39;[\\d]\u0026#39;, \u0026#39;d12\\\\\u0026#39;) # \\w，\\d等在中括号中还是元字符的功能 # [\u0026#39;1\u0026#39;, \u0026#39;2\u0026#39;] import re re.findall(\u0026#39;\\n\u0026#39;, \u0026#39;\\\\n\\n\\\\\u0026#39;) # [\u0026#39;\\n\u0026#39;] \\n -\u0026gt; (\\n) -\u0026gt; (\\n) re.findall(\u0026#39;\\\\n\u0026#39;, \u0026#39;\\\\n\\n\\\\\u0026#39;) # [\u0026#39;\\n\u0026#39;] \\\\n -\u0026gt; \\n -\u0026gt; (\\n) re.findall(\u0026#39;\\\\\\n\u0026#39;, \u0026#39;\\\\n\\n\\\\\u0026#39;) # [\u0026#39;\\n\u0026#39;] \\\\\\n -\u0026gt; \\n -\u0026gt; (\\n) re.escape(\u0026#39;\\n\u0026#39;) # \u0026#39;\\\\\\n\u0026#39; re.findall(\u0026#39;\\\\\\\\n\u0026#39;, \u0026#39;\\\\n\\n\\\\\u0026#39;) # [\u0026#39;\\\\n\u0026#39;] \\\\\\\\n -\u0026gt; \\\\\\n -\u0026gt; \\(\\n) re.escape(\u0026#39;\\\\n\u0026#39;) # \u0026#39;\\\\\\\\n\u0026#39; 07 流派及其特性 POSIX Portable Operating System Interface。不能使用 \\d。 BRE Basic Regular Expression 基本正则表达式。grep sed 花园问管家 {}()?|+ 要转义。 ERE Extended Regular Expression 扩展正则表达式。egrep grep -E sed -E。 PCRE Perl Compatible Regular Expressions。可以使用 \\d \\w \\s。grep -P sed -P。 grep --help | grep PATTERN # PATTERN is, by default, a basic regular expression (BRE). # -E, --extended-regexp PATTERN is an extended regular expression (ERE) # -F, --fixed-strings PATTERN is a set of newline-separated fixed strings # -G, --basic-regexp PATTERN is a basic regular expression (BRE) # -P, --perl-regexp PATTERN is a Perl regular expression Linux/Unix 工具与正则表达式的 POSIX 规范 | 余晟\n08 处理 Unicode 文本 Unicode 相当于规定了字符对应的码值，这个码值得编码成字节的形式去传输和存储。最常见的编码方式是 UTF-8，另外还有 UTF-16，UTF-32 等。UTF-8 之所以能够流行起来，是因为其编码比较巧妙，采用的是变长的方法。也就是一个 Unicode 字符，在使用 UTF-8 编码表示时占用 1 到 4 个字节不等。最重要的是 Unicode 兼容 ASCII 编码，在表示纯英文时，并不会占用更多存储空间。而汉字呢，在 UTF-8 中，通常是用三个字节来表示。\n# python2.7 import re u\u0026#39;极客\u0026#39;.encode(\u0026#39;utf-8\u0026#39;) # \u0026#39;\\xe6\\x9e\\x81\\xe5\\xae\\xa2\u0026#39; u\u0026#39;时间\u0026#39;.encode(\u0026#39;utf-8\u0026#39;) # \u0026#39;\\xe6\\x97\\xb6\\xe9\\x97\\xb4\u0026#39; # 都含有 e6 re.search(r\u0026#39;[时间]\u0026#39;, \u0026#39;极客\u0026#39;) is not None # True re.compile(r\u0026#39;[时间]\u0026#39;, re.DEBUG) # in # literal 230 # literal 151 # literal 182 # literal 233 # literal 151 # literal 180 # \u0026lt;_sre.SRE_Pattern object at 0x10ab44d78\u0026gt; re.compile(r\u0026#39;[极客]\u0026#39;, re.DEBUG) # in # literal 230 # literal 158 # literal 129 # literal 229 # literal 174 # literal 162 # \u0026lt;_sre.SRE_Pattern object at 0x10ab44e40\u0026gt; re.compile(ur\u0026#39;[时间]\u0026#39;, re.DEBUG) # in # literal 26102 # literal 38388 # \u0026lt;_sre.SRE_Pattern object at 0x10ac02710\u0026gt; re.search(ur\u0026#39;[时间]\u0026#39;, \u0026#39;时间\u0026#39;) is not None False re.search(ur\u0026#39;[时间]\u0026#39;, u\u0026#39;时间\u0026#39;) is not None True # python2.7 import re re.findall(r\u0026#39;^.$\u0026#39;, \u0026#39;学\u0026#39;) # [] re.findall(r\u0026#39;^.$\u0026#39;, u\u0026#39;学\u0026#39;) # [u\u0026#39;\\u5b66\u0026#39;] re.findall(ur\u0026#39;^.$\u0026#39;, u\u0026#39;学\u0026#39;) # [u\u0026#39;\\u5b66\u0026#39;] print(unichr(0x5B66)) # 学 # python3 import re re.findall(r\u0026#39;^.$\u0026#39;, \u0026#39;学\u0026#39;) # [\u0026#39;学\u0026#39;] re.findall(r\u0026#39;(?a)^.$\u0026#39;, \u0026#39;学\u0026#39;) # [\u0026#39;学\u0026#39;] # (?a) 表示启用 ASCII 模式 chr(0x5B66) # \u0026#39;学\u0026#39; // 可以匹配汉语 in PHP \\p{Han} # python2.7 import re re.findall(r\u0026#39;客{3}\u0026#39;, \u0026#39;极客客客客\u0026#39;) # [] re.findall(ur\u0026#39;客{3}\u0026#39;, \u0026#39;极客客客客\u0026#39;) # [] re.findall(r\u0026#39;客{3}\u0026#39;, u\u0026#39;极客客客客\u0026#39;) # [] re.findall(ur\u0026#39;客{3}\u0026#39;, u\u0026#39;极客客客客\u0026#39;) # [u\u0026#39;\\u5ba2\\u5ba2\\u5ba2\u0026#39;] re.findall(r\u0026#39;(客){3}\u0026#39;, \u0026#39;极客客客客\u0026#39;) # python3 re.findall(r\u0026#39;客{3}\u0026#39;, \u0026#39;极客客客客\u0026#39;) # [\u0026#39;客客客\u0026#39;] # 在 Python3 中，不需要在正则表达式字符串前面添加 u 前缀，因为所有字符串都默认为 Unicode 字符串。 Script (Unicode) | wikipedia 09 编辑器中使用正则 竖向编辑：MacOS alt + 鼠标纵向滑动。\n10 语言中用正则 校验文本内容：\nimport re reg = re.compile(r\u0026#39;\\A\\d{4}-\\d{2}-\\d{2}\\Z\u0026#39;) # 建议先编译，提高效率 reg.search(\u0026#39;2020-06-01\u0026#39;) is not None # True reg.match(\u0026#39;2020-06-01\u0026#39;) is not None # 使用 match 时 \\A 可省略，match 就是从头匹配 # True reg = re.compile(r\u0026#39;\\d{4}-\\d{2}\u0026#39;) reg.findall(\u0026#39;2020-05 2020-06\u0026#39;) # [\u0026#39;2020-05\u0026#39;, \u0026#39;2020-06\u0026#39;] /^\\d{4}-\\d{2}-\\d{2}$/.test(\u0026#34;2020-06-01\u0026#34;) // true var regex = new RegExp(/^\\d{4}-\\d{2}-\\d{2}$/) regex.test(\u0026#34;2020-01-01\u0026#34;) // true var regex = /^\\d{4}-\\d{2}-\\d{2}$/ \u0026#34;2020-06-01\u0026#34;.search(regex) // 0 $regex = \u0026#39;/^\\d{4}-\\d{2}-\\d{2}$/\u0026#39;; $ret = preg_match($regex, \u0026#34;2020-06-01\u0026#34;); var_dump($ret); // int(1) 提取文本内容：\nimport re # 没有子组时 reg = re.compile(r\u0026#39;\\d{4}-\\d{2}\u0026#39;) reg.findall(\u0026#39;2020-05 2020-06\u0026#39;) # [\u0026#39;2020-05\u0026#39;, \u0026#39;2020-06\u0026#39;] # 有子组时 reg = re.compile(r\u0026#39;(\\d{4})-(\\d{2})\u0026#39;) reg.findall(\u0026#39;2020-05 2020-06\u0026#39;) [(\u0026#39;2020\u0026#39;, \u0026#39;05\u0026#39;), (\u0026#39;2020\u0026#39;, \u0026#39;06\u0026#39;)] reg = re.compile(r\u0026#39;(\\d{4})-(\\d{2})\u0026#39;) for match in reg.finditer(\u0026#39;2020-05 2020-06\u0026#39;): print(\u0026#39;date: \u0026#39;, match[0]) # 整个正则匹配到的内容 print(\u0026#39;year: \u0026#39;, match[1]) # 第一个子组 print(\u0026#39;month:\u0026#39;, match[2]) # 第二个子组 # date: 2020-05 # year: 2020 # month: 05 # date: 2020-06 # year: 2020 # month: 06 // 使用g模式，查找所有符合要求的内容 \u0026#34;2020-06 2020-07\u0026#34;.match(/\\d{4}-\\d{2}/g) // [\u0026#39;2020-06\u0026#39;, \u0026#39;2020-07\u0026#39;] // 不使用g模式，找到第一个就会停下来 \u0026#34;2020-06 2020-07\u0026#34;.match(/\\d{4}-\\d{2}/) // [\u0026#39;2020-06\u0026#39;, index: 0, input: \u0026#39;2020-06 2020-07\u0026#39;, groups: undefined] $regex = \u0026#34;/\\d{4}-\\d{2}/\u0026#34;; $str = \u0026#34;2020-05 2020-04\u0026#34;; $matchs = []; preg_match_all($regex, $str, $matchs, PREG_SET_ORDER); var_dump($matchs); // array(2) { // [0] =\u0026gt; // array(1) { // [0] =\u0026gt; // string(7) \u0026#34;2020-05\u0026#34; // } // [1] =\u0026gt; // array(1) { // [0] =\u0026gt; // string(7) \u0026#34;2020-04\u0026#34; // } // } // PREG_PATTERN_ORDER: 结果排序为$matches[0]保存完整模式的所有匹配, $matches[1]保存第一个子组的所有匹配，以此类推。 // PREG_SET_ORDER: 结果排序为$matches[0]包含第一次匹配得到的所有匹配(包含子组)，$matches[1]是包含第二次匹配到的所有匹配(包含子组)的数组，以此类推。 替换文本内容：\nreg = re.compile(r\u0026#39;(\\d{2})-(\\d{2})-(\\d{4})\u0026#39;) reg.sub(r\u0026#39;\\3年\\1月\\2日\u0026#39;, \u0026#39;02-20-2020 05-21-2020\u0026#39;) # \u0026#39;2020年02月20日 2020年05月21日\u0026#39; # 可以在替换中使用 \\g\u0026lt;数字\u0026gt;，如果分组多于10个时避免歧义 reg.sub(r\u0026#39;\\g\u0026lt;3\u0026gt;年\\g\u0026lt;1\u0026gt;月\\g\u0026lt;2\u0026gt;日\u0026#39;, \u0026#39;02-20-2020 05-21-2020\u0026#39;) # \u0026#39;2020年02月20日 2020年05月21日\u0026#39; # 返回替换次数 reg.subn(r\u0026#39;\\3年\\1月\\2日\u0026#39;, \u0026#39;02-20-2020 05-21-2020\u0026#39;) # (\u0026#39;2020年02月20日 2020年05月21日\u0026#39;, 2) // 使用g模式，替换所有的 \u0026#34;02-20-2020 05-21-2020\u0026#34;.replace(/(\\d{2})-(\\d{2})-(\\d{4})/g, \u0026#34;$3年$1月$2日\u0026#34;) // \u0026#34;2020年02月20日 2020年05月21日\u0026#34; // 不使用 g 模式时，只替换一次 \u0026#34;02-20-2020 05-21-2020\u0026#34;.replace(/(\\d{2})-(\\d{2})-(\\d{4})/, \u0026#34;$3年$1月$2日\u0026#34;) // \u0026#34;2020年02月20日 05-21-2020\u0026#34; $ret = preg_replace(\u0026#39;/(\\d{2})-(\\d{2})-(\\d{4})/\u0026#39;, \u0026#39;\\3年\\1月\\2日\u0026#39;, \u0026#34;02-20-2020 05-21-2020\u0026#34;); var_dump($ret); // string(35) \u0026#34;2020年02月20日 2020年05月21日\u0026#34; 切割文本内容：\nreg = re.compile(r\u0026#39;\\W+\u0026#39;) reg.split(\u0026#34;apple, pear! orange; tea\u0026#34;) # [\u0026#39;apple\u0026#39;, \u0026#39;pear\u0026#39;, \u0026#39;orange\u0026#39;, \u0026#39;tea\u0026#39;] # 限制切割次数，比如切一刀，变成两部分 reg.split(\u0026#34;apple, pear! orange; tea\u0026#34;, 1) # [\u0026#39;apple\u0026#39;, \u0026#39;pear! orange; tea\u0026#39;] \u0026#34;apple, pear! orange; tea\u0026#34;.split(/\\W+/) // [\u0026#34;apple\u0026#34;, \u0026#34;pear\u0026#34;, \u0026#34;orange\u0026#34;, \u0026#34;tea\u0026#34;] // 传入第二个参数的情况 \u0026#34;apple, pear! orange; tea\u0026#34;.split(/\\W+/, 1) // [\u0026#34;apple\u0026#34;] \u0026#34;apple, pear! orange; tea\u0026#34;.split(/\\W+/, 2) // [\u0026#34;apple\u0026#34;, \u0026#34;pear\u0026#34;] \u0026#34;apple, pear! orange; tea\u0026#34;.split(/\\W+/, 10) // [\u0026#34;apple\u0026#34;, \u0026#34;pear\u0026#34;, \u0026#34;orange\u0026#34;, \u0026#34;tea\u0026#34;] $ret = preg_split(\u0026#39;/\\W+/\u0026#39;, \u0026#39;apple, pear! orange; tea\u0026#39;); var_dump($ret); // array(4) { // [0] =\u0026gt; // string(5) \u0026#34;apple\u0026#34; // [1] =\u0026gt; // string(4) \u0026#34;pear\u0026#34; // [2] =\u0026gt; // string(6) \u0026#34;orange\u0026#34; // [3] =\u0026gt; // string(3) \u0026#34;tea\u0026#34; // } $ret = preg_split(\u0026#39;/\\W+/\u0026#39;, \u0026#39;apple, pear! orange; tea\u0026#39;, 2); var_dump($ret); // array(2) { // [0] =\u0026gt; // string(5) \u0026#34;apple\u0026#34; // [1] =\u0026gt; // string(17) \u0026#34;pear! orange; tea\u0026#34; // } 11 匹配原理以及优化原则 回溯不可怕，我们要尽量减少回溯后的判断\nimport re x = \u0026#39;-\u0026#39; * 1000000 + \u0026#39;abc\u0026#39; timeit re.search(\u0026#39;abc\u0026#39;, x) 提前编译好正则。 尽量准确表示匹配范围：匹配引号里面的内容 .+? 改写为 [^\u0026quot;]+。 提取出公共部分：(abcd|abxy) =\u0026gt; ab(cd|xy)，(^this|^that) =\u0026gt; ^th(is|at)。 出现可能性大的放左边：\\.(?:com|net)\\b。 只在必要时才使用子组：把不需要保存子组的括号中加上 ?: 来表示只用于归组。 警惕嵌套的子组重复：(.*)* 匹配的次数会呈指数级增长，尽量不要写这样的正则。 避免不同分支重复匹配。 NFA 是以表达式为主导的，先看正则表达式，再看文本。而 DFA 则是以文本为主导的，先看文本，再看正则表达式。POSIX NFA 是指符合 POSIX 标准的 NFA 引擎，它会不断回溯，以确保找到最左侧最长匹配。\n12 常见问题 import re re.match(r\u0026#39;^(?:(?!\\d\\d)\\w){6}$\u0026#39;, \u0026#39;11abcd\u0026#39;) # 不能匹配上 # 否定预测先行断言的语法\u0026#34;(?!)\u0026#34;来排除两个数字字符结尾的情况 # (?!) 表示匹配不满足某个条件的位置 re.match(r\u0026#39;^(?:\\w(?!\\d\\d)){6}$\u0026#39;, \u0026#39;11abcd\u0026#39;) # 错误正则示范 # \u0026lt;re.Match object; span=(0, 6), match=\u0026#39;11abcd\u0026#39;\u0026gt; # (11) 回溯 # 1(1a) ok # 11ab... ok 正负号、可二位小数、小数位末尾 0 无影响 Regulex：^[-+]?\\d+(?:\\.(?:\\d){0,2}0*)?$ 手机号码：1(?:3\\d|4[5-9]|5[0-35-9]|6[2567]|7[0-8]|8\\d|9[1389])\\d{8} 身份证：[1-9]\\d{14}(\\d\\d[0-9Xx])? 邮政编码：(?\u0026lt;!\\d)\\d{6}(?!\\d) 中文字符：[\\u4E00-\\u9FFF] \\p{Han} 邮箱：a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+\\.[a-zA-Z0-9-.]+ 程语言的角度来理解正则 命令式编程的世界观是：程序是由若干行动指令组成的有序列表； 命令式编程的方法论是：用变量来存储数据，用语句来执行指令。 声明式编程的世界观是：程序是由若干目标任务组成的有序列表； 声明式编程的方法论是：用语法元素来描述任务，由解析引擎转化为指令并执行。 References 《精通正则表达式（第三版）》 《正则指引（第二版）》 \u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2023/03/01/regular-expression-getting-started/","summary":"\u003ch2 id=\"00\"\u003e00\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://regex101.com/\"\u003eregex101\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://jex.im/regulex/#!flags=\u0026amp;re=%5E(a%7Cb)*%3F%24\"\u003eregulex\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://ihateregex.io/expr/username/\"\u003eihateregex\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"01-元字符\"\u003e01 元字符\u003c/h2\u003e\n\u003cp\u003e正则表达式 —— 字符串的规则。\u003c/p\u003e\n\u003cp\u003e元字符就是指那些在正则表达式中具有特殊意义的专用字符。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e特殊单字符\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003e.\u003c/code\u003e 任意字符（换行除外）\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e\\d\u003c/code\u003e 任意数字 \u003ccode\u003e\\D\u003c/code\u003e 任意非数字\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e\\w\u003c/code\u003e A-Za-z0-9_ \u003ccode\u003e\\W\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e\\s\u003c/code\u003e 空白符 \u003ccode\u003e\\S\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e空白符\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003e\\r\u003c/code\u003e 回车符\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e\\n\u003c/code\u003e 换行符\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e\\f\u003c/code\u003e 换页符\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e\\t\u003c/code\u003e 制表符\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e\\v\u003c/code\u003e 垂直制表符\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e范围\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003e|\u003c/code\u003e 或\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e[abc]\u003c/code\u003e 多选一\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e[a-z]\u003c/code\u003e 之间\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e[^abc]\u003c/code\u003e 取反，不能是括号中的任意单个元素\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e量词\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003e*\u003c/code\u003e 0\u0026lt;=\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e+\u003c/code\u003e 1\u0026lt;=\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e?\u003c/code\u003e 0或1\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e{m}\u003c/code\u003e m\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e{m,}\u003c/code\u003e m\u0026lt;=\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e{m,n}\u003c/code\u003e m-n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"02-量词与贪婪\"\u003e02 量词与贪婪\u003c/h2\u003e\n\u003cp\u003e贪婪(Greedy) \u003ccode\u003e*\u003c/code\u003e：匹配最长。在贪婪量词模式下，正则表达式会尽可能长地去匹配符合规则的字符串，且会回溯。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003epreg_match_all\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;/a*/i\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;aaabb\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$matches\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$matches\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e非贪婪(Reluctant) \u003ccode\u003e+?\u003c/code\u003e：匹配最短。在非贪婪量词模式下，正则表达式会匹配尽可能短的字符串。\u003c/p\u003e\n\u003cp\u003eENV：Python3\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"nn\"\u003ere\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003ere\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003efindall\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"sa\"\u003er\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;a*\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;aaabb\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"c1\"\u003e# 贪婪模式\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# [\u0026#39;aaa\u0026#39;, \u0026#39;\u0026#39;, \u0026#39;\u0026#39;, \u0026#39;\u0026#39;]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003ere\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003efindall\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"sa\"\u003er\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;a*?\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;aaabb\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"c1\"\u003e# 非贪婪模式\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# [\u0026#39;\u0026#39;, \u0026#39;a\u0026#39;, \u0026#39;\u0026#39;, \u0026#39;a\u0026#39;, \u0026#39;\u0026#39;, \u0026#39;a\u0026#39;, \u0026#39;\u0026#39;, \u0026#39;\u0026#39;, \u0026#39;\u0026#39;]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003ere\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003efindall\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"sa\"\u003er\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;\u0026#34;.+\u0026#34;\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;\u0026#34;the little cat\u0026#34; is a toy, it lokks \u0026#34;a little bad\u0026#34;\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"c1\"\u003e# 贪婪模式\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# [\u0026#39;\u0026#34;the little cat\u0026#34; is a toy, it lokks \u0026#34;a little bad\u0026#34;\u0026#39;]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003ere\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003efindall\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"sa\"\u003er\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;\u0026#34;.+?\u0026#34;\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;\u0026#34;the little cat\u0026#34; is a toy, it lokks \u0026#34;a little bad\u0026#34;\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"c1\"\u003e# 非贪婪模式\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# [\u0026#39;\u0026#34;the little cat\u0026#34;\u0026#39;, \u0026#39;\u0026#34;a little bad\u0026#34;\u0026#39;]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e独占模式(Possessive) \u003ccode\u003e++\u003c/code\u003e：同贪婪一样匹配最长。不过在独占量词模式下，正则表达式尽可能长地去匹配字符串，一旦匹配不成功就会结束匹配而 \u003cstrong\u003e不会回溯\u003c/strong\u003e。\u003c/p\u003e","title":"正则表达式"},{"content":"安装 yum list installed | grep vim # vim-X11.x86_64 2:7.4.629-8.el7_9 @updates # vim-common.x86_64 2:7.4.629-8.el7_9 @updates # vim-enhanced.x86_64 2:7.4.629-8.el7_9 @updates # vim-filesystem.x86_64 2:7.4.629-8.el7_9 @updates # vim-minimal.x86_64 2:7.4.629-8.el7_9 @updates # https://gist.github.com/yevrah/21cdccc1dc65efd2a4712781815159fb # Update to Vim8 on CentOS 7 rpm -Uvh http://mirror.ghettoforge.org/distributions/gf/gf-release-latest.gf.el7.noarch.rpm rpm --import http://mirror.ghettoforge.org/distributions/gf/RPM-GPG-KEY-gf.el7 yum -y remove vim-minimal vim-common vim-enhanced yum -y --enablerepo=gf-plus install vim-enhanced vim-filesystem sudo vim --version # VIM - Vi IMproved 8.0 (2016 Sep 12, compiled Sep 18 2016 14:42:40) yum list installed | grep vim # vim-common.x86_64 2:8.0.003-1.gf.el7 @gf-plus # vim-enhanced.x86_64 2:8.0.003-1.gf.el7 @gf-plus # vim-filesystem.x86_64 2:8.0.003-1.gf.el7 @gf-plus # vim-minimal.x86_64 2:8.0.003-1.gf.el7 @gf-plus # 中文帮助 mkdir -p ~/.vim/pack/my/start cd ~/.vim/pack/my/start git clone git://github.com/yianwillis/vimcdoc.git # 自带教程 LANG=zh_CN.UTF-8 vimtutor ","permalink":"https://zyf.im/2023/02/28/vim-practical-tips/","summary":"\u003ch2 id=\"安装\"\u003e安装\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eyum list installed \u003cspan class=\"p\"\u003e|\u003c/span\u003e grep vim\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# vim-X11.x86_64                   2:7.4.629-8.el7_9             @updates\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# vim-common.x86_64                2:7.4.629-8.el7_9             @updates\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# vim-enhanced.x86_64              2:7.4.629-8.el7_9             @updates\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# vim-filesystem.x86_64            2:7.4.629-8.el7_9             @updates\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# vim-minimal.x86_64               2:7.4.629-8.el7_9             @updates\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# https://gist.github.com/yevrah/21cdccc1dc65efd2a4712781815159fb\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Update to Vim8 on CentOS 7\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003erpm -Uvh http://mirror.ghettoforge.org/distributions/gf/gf-release-latest.gf.el7.noarch.rpm\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003erpm --import http://mirror.ghettoforge.org/distributions/gf/RPM-GPG-KEY-gf.el7\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eyum -y remove vim-minimal vim-common vim-enhanced\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eyum -y --enablerepo\u003cspan class=\"o\"\u003e=\u003c/span\u003egf-plus install vim-enhanced vim-filesystem sudo\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003evim --version\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# VIM - Vi IMproved 8.0 (2016 Sep 12, compiled Sep 18 2016 14:42:40)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eyum list installed \u003cspan class=\"p\"\u003e|\u003c/span\u003e grep vim\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# vim-common.x86_64                2:8.0.003-1.gf.el7            @gf-plus\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# vim-enhanced.x86_64              2:8.0.003-1.gf.el7            @gf-plus\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# vim-filesystem.x86_64            2:8.0.003-1.gf.el7            @gf-plus\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# vim-minimal.x86_64               2:8.0.003-1.gf.el7            @gf-plus\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# 中文帮助\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003emkdir -p ~/.vim/pack/my/start\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003ecd\u003c/span\u003e ~/.vim/pack/my/start\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit clone git://github.com/yianwillis/vimcdoc.git\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# 自带教程\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003eLANG\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003ezh_CN.UTF-8 vimtutor\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2\u003e\u003c/h2\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e\u003c/code\u003e\u003c/pre\u003e","title":"Vim 实用技巧必知必会"},{"content":"24 PersistentVolume 数据持久化 PersistentVolume 属于集群的系统资源，是和 Node 平级的一种对象，Pod 对它没有管理权，只有使用权。\nStorageClass 它抽象了特定类型的存储系统（比如 Ceph、NFS），在 PVC 和 PV 之间充当“协调人”的角色，帮助 PVC 找到合适的 PV。\n# vim host-path-pv-pvc.yml apiVersion: v1 kind: PersistentVolume metadata: # 只有 10MB 容量的存储设备 name: host-10m-pv spec: # kubectl explain PersistentVolume.spec.storageClassName storageClassName: host-vol # kubectl explain PersistentVolume.spec.accessModes accessModes: # ReadWriteOnce：存储卷可读可写，但只能被一个节点上的 Pod 挂载。 # ReadOnlyMany：存储卷只读不可写，可以被任意节点上的 Pod 多次挂载。 # ReadWriteMany：存储卷可读可写，也可以被任意节点上的 Pod 多次挂载。 - ReadWriteOnce capacity: # Ki/Mi/Gi storage: 10Mi hostPath: path: /tmp/host-10m-pv/ --- # PVC 不表示实际的存储，而是一个“申请”或者“声明” apiVersion: v1 kind: PersistentVolumeClaim metadata: name: host-5m-pvc spec: storageClassName: host-vol accessModes: - ReadWriteOnce resources: requests: storage: 5Mi mkdir /tmp/host-10m-pv kubectl apply -f host-path-pv-pvc.yml kubectl get pv # NAME CAPACITY ACCESS MODES RECLAIM POLICY STATUS CLAIM STORAGECLASS REASON AGE # host-10m-pv 10Mi RWO Retain Bound default/host-5m-pvc host-vol 4s kubectl get pvc # NAME STATUS VOLUME CAPACITY ACCESS MODES STORAGECLASS AGE # host-5m-pvc Bound host-10m-pv 10Mi RWO host-vol 6s # vim host-pvc-pod.yml apiVersion: v1 kind: Pod metadata: name: host-pvc-pod spec: volumes: - name: host-pvc-vol persistentVolumeClaim: claimName: host-5m-pvc containers: - name: ngx-pvc-pod image: nginx:alpine ports: - containerPort: 80 volumeMounts: - name: host-pvc-vol mountPath: /tmp kubectl apply -f host-pvc-pod.yml kubectl get pod -o wide kubectl exec -it host-pvc-pod -- sh cd /tmp \u0026amp;\u0026amp; touch a.md # check in worker node /tmp/host-10m-pv/ 25 NFS 网络共享存储 \u0026hellip;\nReferences chronolaw/k8s_study | GitHub ","permalink":"https://zyf.im/2023/02/24/kubernetes-getting-started-part3/","summary":"\u003ch2 id=\"24-persistentvolume-数据持久化\"\u003e24 PersistentVolume 数据持久化\u003c/h2\u003e\n\u003cp\u003ePersistentVolume 属于集群的系统资源，是和 Node 平级的一种对象，Pod 对它没有管理权，只有使用权。\u003c/p\u003e\n\u003cp\u003eStorageClass 它抽象了特定类型的存储系统（比如 Ceph、NFS），在 PVC 和 PV 之间充当“协调人”的角色，帮助 PVC 找到合适的 PV。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-yaml\" data-lang=\"yaml\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c\"\u003e# vim host-path-pv-pvc.yml\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"nt\"\u003eapiVersion\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003ev1\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"nt\"\u003ekind\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003ePersistentVolume\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"nt\"\u003emetadata\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"c\"\u003e# 只有 10MB 容量的存储设备\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003ehost-10m-pv\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"nt\"\u003espec\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"c\"\u003e# kubectl explain PersistentVolume.spec.storageClassName\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003estorageClassName\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"l\"\u003ehost-vol\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"c\"\u003e# kubectl explain PersistentVolume.spec.accessModes\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003eaccessModes\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"c\"\u003e# ReadWriteOnce：存储卷可读可写，但只能被一个节点上的 Pod 挂载。\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"c\"\u003e# ReadOnlyMany：存储卷只读不可写，可以被任意节点上的 Pod 多次挂载。\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"c\"\u003e# ReadWriteMany：存储卷可读可写，也可以被任意节点上的 Pod 多次挂载。\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e- \u003cspan class=\"l\"\u003eReadWriteOnce\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003ecapacity\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"c\"\u003e#  Ki/Mi/Gi\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nt\"\u003estorage\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003e10Mi\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003ehostPath\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nt\"\u003epath\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003e/tmp/host-10m-pv/\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"nn\"\u003e---\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"c\"\u003e# PVC 不表示实际的存储，而是一个“申请”或者“声明”\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"nt\"\u003eapiVersion\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003ev1\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"nt\"\u003ekind\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003ePersistentVolumeClaim\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"nt\"\u003emetadata\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003ehost-5m-pvc\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"nt\"\u003espec\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003estorageClassName\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003ehost-vol\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003eaccessModes\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e- \u003cspan class=\"l\"\u003eReadWriteOnce\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003eresources\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nt\"\u003erequests\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"nt\"\u003estorage\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003e5Mi\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003emkdir /tmp/host-10m-pv\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ekubectl apply -f host-path-pv-pvc.yml\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ekubectl get pv\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# NAME          CAPACITY   ACCESS MODES   RECLAIM POLICY   STATUS   CLAIM                 STORAGECLASS   REASON   AGE\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# host-10m-pv   10Mi       RWO            Retain           Bound    default/host-5m-pvc   host-vol                4s\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ekubectl get pvc\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# NAME          STATUS   VOLUME        CAPACITY   ACCESS MODES   STORAGECLASS   AGE\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# host-5m-pvc   Bound    host-10m-pv   10Mi       RWO            host-vol       6s\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-yaml\" data-lang=\"yaml\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c\"\u003e# vim host-pvc-pod.yml\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"nt\"\u003eapiVersion\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003ev1\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"nt\"\u003ekind\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003ePod\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"nt\"\u003emetadata\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003ehost-pvc-pod\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"nt\"\u003espec\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003evolumes\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e- \u003cspan class=\"nt\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003ehost-pvc-vol\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"nt\"\u003epersistentVolumeClaim\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e        \u003c/span\u003e\u003cspan class=\"nt\"\u003eclaimName\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003ehost-5m-pvc\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003econtainers\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e- \u003cspan class=\"nt\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003engx-pvc-pod\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"nt\"\u003eimage\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003enginx:alpine\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"nt\"\u003eports\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e        \u003c/span\u003e- \u003cspan class=\"nt\"\u003econtainerPort\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"m\"\u003e80\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"nt\"\u003evolumeMounts\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e        \u003c/span\u003e- \u003cspan class=\"nt\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003ehost-pvc-vol\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e          \u003c/span\u003e\u003cspan class=\"nt\"\u003emountPath\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003e/tmp\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ekubectl apply -f host-pvc-pod.yml\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ekubectl get pod -o wide\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ekubectl \u003cspan class=\"nb\"\u003eexec\u003c/span\u003e -it host-pvc-pod -- sh\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003ecd\u003c/span\u003e /tmp \u003cspan class=\"o\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e touch a.md\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# check in worker node\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e/tmp/host-10m-pv/\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"25-nfs-网络共享存储\"\u003e25 NFS 网络共享存储\u003c/h2\u003e\n\u003cp\u003e\u0026hellip;\u003c/p\u003e","title":"Kubernetes 入门实战 Part3"},{"content":"17 多节点的 Kubernetes 集群 在腾讯云 TencentOS Server 3.1 (TK4) 下测试：\nmaster SA3.MEDIUM4 2 核 4GB 5Mbps worker S5.SMALL2 1 核 2GB 1Mbps worker S5.SMALL2 1 核 2GB 1Mbps # 修改源 https://mirrors.cloud.tencent.com/ mv /etc/yum.repos.d/CentOS-Base.repo /etc/yum.repos.d/CentOS-Base.repo.backup wget -O /etc/yum.repos.d/CentOS-Base.repo http://mirrors.cloud.tencent.com/repo/centos7_base.repo yum clean all yum makecache # install docker yum remove docker \\ docker-client \\ docker-client-latest \\ docker-common \\ docker-latest \\ docker-latest-logrotate \\ docker-logrotate \\ docker-engine yum install -y yum-utils yum-config-manager \\ --add-repo \\ https://download.docker.com/linux/centos/docker-ce.repo yum install -y docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin systemctl start docker docker -v docker run hello-world 一些准备工作：\n# 改主机名 vi /etc/hostname # reboot # 把 cgroup 的驱动程序改成 systemd # 使用 Docker 作为 Kubernetes 的底层支持 cat \u0026lt;\u0026lt;EOF | sudo tee /etc/docker/daemon.json { \u0026#34;exec-opts\u0026#34;: [\u0026#34;native.cgroupdriver=systemd\u0026#34;], \u0026#34;log-driver\u0026#34;: \u0026#34;json-file\u0026#34;, \u0026#34;log-opts\u0026#34;: { \u0026#34;max-size\u0026#34;: \u0026#34;100m\u0026#34; }, \u0026#34;storage-driver\u0026#34;: \u0026#34;overlay2\u0026#34; } EOF systemctl enable docker systemctl daemon-reload systemctl restart docker docker version # https://kubernetes.io/zh-cn/docs/setup/production-environment/container-runtimes/ # 转发 IPv4 并让 iptables 看到桥接流量 cat \u0026lt;\u0026lt;EOF | sudo tee /etc/modules-load.d/k8s.conf overlay br_netfilter EOF sudo modprobe overlay sudo modprobe br_netfilter # check lsmod | grep br_netfilter lsmod | grep overlay # 设置所需的 sysctl 参数，参数在重新启动后保持不变 cat \u0026lt;\u0026lt;EOF | sudo tee /etc/sysctl.d/k8s.conf net.bridge.bridge-nf-call-iptables = 1 net.bridge.bridge-nf-call-ip6tables = 1 net.ipv4.ip_forward = 1 EOF # 应用 sysctl 参数而不重新启动 sudo sysctl --system sysctl net.bridge.bridge-nf-call-iptables net.bridge.bridge-nf-call-ip6tables net.ipv4.ip_forward # net.bridge.bridge-nf-call-iptables = 1 # net.bridge.bridge-nf-call-ip6tables = 1 # net.ipv4.ip_forward = 1 # 关闭 Linux 的 swap 分区 swapoff -a sed -ri \u0026#39;/\\sswap\\s/s/^#?/#/\u0026#39; /etc/fstab # https://developer.aliyun.com/mirror/kubernetes cat \u0026lt;\u0026lt;EOF \u0026gt; /etc/yum.repos.d/kubernetes.repo [kubernetes] name=Kubernetes baseurl=https://mirrors.cloud.tencent.com/kubernetes/yum/repos/kubernetes-el7-x86_64/ EOF yum clean all yum makecache # 将 SELinux 设置为 permissive 模式（相当于将其禁用） setenforce 0 sed -i \u0026#39;s/^SELINUX=enforcing$/SELINUX=permissive/\u0026#39; /etc/selinux/config # 新版本搞不定 # yum install -y kubelet kubeadm kubectl --disableexcludes=kubernetes --nogpgcheck yum --showduplicate list kubelet yum install -y kubelet-1.23.16-0 kubeadm-1.23.16-0 kubectl-1.23.16-0 --disableexcludes=kubernetes --nogpgcheck systemctl enable --now kubelet kubeadm version kubectl version --output=yaml kubelet --version 下载 Kubernetes 组件镜像：\n# kubeadm config images list kubeadm config images list --kubernetes-version v1.23.16 安装 Master 节点：\nvim /etc/containerd/config.toml #disabled_plugins = [\u0026#34;cri\u0026#34;] systemctl enable containerd systemctl restart containerd systemctl status containerd systemctl enable kubelet.service systemctl restart kubelet systemctl status kubelet containerd config default \u0026gt; /etc/containerd/config.toml yum install -y nc nc 127.0.0.1 6443 kubeadm init -h kubeadm reset -f rm -rf ~/.kube/config kubeadm init \\ --image-repository=registry.aliyuncs.com/google_containers \\ --pod-network-cidr=10.10.0.0/16 \\ --kubernetes-version=v1.23.16 \\ --v=9 # Run \u0026#34;kubectl apply -f [podnetwork].yaml\u0026#34; with one of the options listed at: # https://kubernetes.io/docs/concepts/cluster-administration/addons/ # success mkdir -p $HOME/.kube sudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config sudo chown $(id -u):$(id -g) $HOME/.kube/config export KUBECONFIG=/etc/kubernetes/admin.conf kubectl get node # NAME STATUS ROLES AGE VERSION # master NotReady control-plane,master 2m4s v1.23.16 # dubug systemctl restart docker systemctl restart kubelet systemctl restart containerd journalctl -xeu kubelet crictr ps -a crictl --runtime-endpoint unix:///var/run/containerd/containerd.sock ps -a | grep kube | grep -v pause kubectl get pods -n kube-system kubectl describe pods -n kube-system # Flannel 网络插件 https://github.com/flannel-io/flannel/tree/master # curl https://github.com/flannel-io/flannel/releases/latest/download/kube-flannel.yml --output kube-flannel.yml # net-conf.json: | # { # \u0026#34;Network\u0026#34;: \u0026#34;10.10.0.0/16\u0026#34;, # \u0026#34;Backend\u0026#34;: { # \u0026#34;Type\u0026#34;: \u0026#34;vxlan\u0026#34; # } # } kubectl apply -f https://github.com/flannel-io/flannel/releases/latest/download/kube-flannel.yml kubectl get node # NAME STATUS ROLES AGE VERSION # master Ready control-plane,master 14h v1.23.16 # show join command in control-plane kubeadm token create --print-join-command # work join; 云服务记得开放入站端口 telnet 172.21.0.5 6443 systemctl enable kubelet.service kubeadm join 172.21.0.5:6443 --token xxx --discovery-token-ca-cert-hash sha256:xxx --v=9 # check in control-plane kubectl get nodes # NAME STATUS ROLES AGE VERSION # master Ready control-plane,master 14h v1.23.16 # vm-0-9-centos Ready \u0026lt;none\u0026gt; 3m27s v1.23.16 # run nginx kubectl run ngx --image=nginx:alpine kubectl get pod -o wide # NAME READY STATUS RESTARTS AGE IP NODE NOMINATED NODE READINESS GATES # ngx 1/1 Running 0 52m 10.10.1.2 woker01 \u0026lt;none\u0026gt; \u0026lt;none\u0026gt; 18 Deployment 部署应用 “单一职责”和“对象组合”。既然 Pod 管理不了自己，那么我们就再创建一个新的对象，由它来管理 Pod，采用和 Job/CronJob 一样的形式——“对象套对象”。\nkubectl api-resources export out=\u0026#34;--dry-run=client -o yaml\u0026#34; kubectl create deploy ngx-dep --image=nginx:alpine $out \u0026gt; ngx-dep.yml vim ngx-dep.yml apiVersion: apps/v1 kind: Deployment metadata: creationTimestamp: null labels: app: ngx-dep name: ngx-dep spec: # 定义了 Pod 的“期望数量”，Kubernetes 会自动维护 Pod 数量到正常水平 replicas: 2 # 定义了基于 labels 筛选 Pod 的规则，它必须与 template 里 Pod 的 labels 一致 selector: matchLabels: app: ngx-dep strategy: {} template: metadata: creationTimestamp: null # 贴标签 labels: app: ngx-dep spec: containers: - image: nginx:alpine name: nginx resources: {} status: {} Deployment 实际上并不“持有”Pod 对象，它只是帮助 Pod 对象能够有足够的副本数量运行。\n通过标签这种设计，Kubernetes 就解除了 Deployment 和模板里 Pod 的强绑定，把组合关系变成了“弱引用”。\n# replicas: 2 kubectl apply -f ngx-dep.yml kubectl get deploy # NAME READY UP-TO-DATE AVAILABLE AGE # ngx-dep 2/2 2 2 57s kubectl get pod # NAME READY STATUS RESTARTS AGE # ngx-dep-bfbb5f64b-96scb 1/1 Running 0 3m20s # ngx-dep-bfbb5f64b-qnzbh 1/1 Running 0 3m20s READY：运行的 Pod 数量，当前数量/期望数量。 UP-TO-DATE：当前已经更新到最新状态的 Pod 数量。 AVAILABLE：不仅要求已经运行，还必须是健康状态，能够正常对外提供服务，它才是我们最关心的 Deployment 指标。 AGE：从创建到现在所经过的时间。 # 测试自启恢复 kubectl delete pod ngx-dep-bfbb5f64b-qnzbh kubectl get pod # NAME READY STATUS RESTARTS AGE # ngx-dep-bfbb5f64b-7n724 1/1 Running 0 33s # ngx-dep-bfbb5f64b-96scb 1/1 Running 0 4m52s # 测试伸缩 kubectl scale --replicas=5 deploy ngx-dep kubectl get pod # NAME READY STATUS RESTARTS AGE # ngx-dep-bfbb5f64b-7n724 1/1 Running 0 77s # ngx-dep-bfbb5f64b-7xhbs 1/1 Running 0 7s # ngx-dep-bfbb5f64b-96scb 1/1 Running 0 5m36s # ngx-dep-bfbb5f64b-97qp5 1/1 Running 0 7s # ngx-dep-bfbb5f64b-vjn4q 1/1 Running 0 7s # 筛选标签 ==、!=、in、notin kubectl get pod -l app=nginx kubectl get pod -l \u0026#39;app in (ngx, nginx, ngx-dep)\u0026#39; 19 DaemonSet 看门狗 在 Deployment 看来，Pod 的运行环境与功能是无关的，只要 Pod 的数量足够，应用程序应该会正常工作。\n有些场景下，要在集群里的每个节点上都运行 Pod，也就是说 Pod 的数量与节点数量保持同步。防止在集群里漂移。\nDaemonSet 的目标是在集群的每个节点上运行且仅运行一个 Pod。\nkubectl api-resources # export out=\u0026#34;--dry-run=client -o yaml\u0026#34; # kubectl create deploy redis-ds --image=redis:5-alpine $out # kind modify DaemonSet, delete spec.replicas # https://kubernetes.io/zh-cn/docs/concepts/workloads/controllers/daemonset/ # vim redis-ds.yml apiVersion: apps/v1 kind: DaemonSet metadata: name: redis-ds labels: app: redis-ds spec: # 和 deplayment 比没有 replicas selector: matchLabels: name: redis-ds template: metadata: labels: name: redis-ds spec: containers: - image: redis:5-alpine name: redis ports: - containerPort: 6379 kubectl apply -f redis-ds.yml kubectl get ds # NAME DESIRED CURRENT READY UP-TO-DATE AVAILABLE NODE SELECTOR AGE # redis-ds 2 2 2 2 2 \u0026lt;none\u0026gt; 30m kubectl get pod -o wide # 两个 worker 的场景 # NAME READY STATUS RESTARTS AGE IP NODE NOMINATED NODE READINESS GATES # redis-ds-9r96k 1/1 Running 0 2m52s 10.10.3.2 woker02 \u0026lt;none\u0026gt; \u0026lt;none\u0026gt; # redis-ds-hdl28 1/1 Running 0 21m 10.10.1.11 woker01 \u0026lt;none\u0026gt; \u0026lt;none\u0026gt; # Master 节点却被排除在外了 污点（taint）作用也是给节点“贴标签”。容忍度（toleration）Pod 能否“容忍”污点。\nkubectl describe node master # Taints: node-role.kubernetes.io/master:NoSchedule # 污点会拒绝 Pod 调度到本节点上运行 kubectl describe node woker01 # Taints: \u0026lt;none\u0026gt; # - 出掉 master 污点 kubectl taint node master node-role.kubernetes.io/master:NoSchedule- # NAME DESIRED CURRENT READY UP-TO-DATE AVAILABLE NODE SELECTOR AGE # redis-ds 3 3 3 3 3 \u0026lt;none\u0026gt; 31m # Pod 添加 tolerations # kubectl explain ds.spec.template.spec.tolerations # vim redis-ds-t.yml apiVersion: apps/v1 kind: DaemonSet metadata: name: redis-ds-t labels: app: redis-ds-t spec: # 和 deplayment 比没有 replicas selector: matchLabels: name: redis-ds-t template: metadata: labels: name: redis-ds-t spec: containers: - image: redis:5-alpine name: redis ports: - containerPort: 6379 # 容忍 node-role.kubernetes.io/master tolerations: - key: node-role.kubernetes.io/master effect: NoSchedule operator: Exists kubectl apply -f redis-ds-t.yml kubectl get ds # NAME DESIRED CURRENT READY UP-TO-DATE AVAILABLE NODE SELECTOR AGE # redis-ds 2 2 2 2 2 \u0026lt;none\u0026gt; 41m # redis-ds-t 3 3 3 3 3 \u0026lt;none\u0026gt; 6s # 差别在 master kubectl get pod -o wide # NAME READY STATUS RESTARTS AGE IP NODE NOMINATED NODE READINESS GATES # redis-ds-9r96k 1/1 Running 0 23m 10.10.3.2 woker02 \u0026lt;none\u0026gt; \u0026lt;none\u0026gt; # redis-ds-hdl28 1/1 Running 0 42m 10.10.1.11 woker01 \u0026lt;none\u0026gt; \u0026lt;none\u0026gt; # redis-ds-t-4mptv 1/1 Running 0 80s 10.10.3.4 woker02 \u0026lt;none\u0026gt; \u0026lt;none\u0026gt; # redis-ds-t-dpcl8 1/1 Running 0 80s 10.10.1.12 woker01 \u0026lt;none\u0026gt; \u0026lt;none\u0026gt; # redis-ds-t-kdjmn 1/1 Running 0 80s 10.10.0.6 master \u0026lt;none\u0026gt; \u0026lt;none\u0026gt; https://kubernetes.io/zh-cn/docs/concepts/scheduling-eviction/taint-and-toleration/\n静态 Pod：\nll -a /etc/kubernetes/manifests # -rw------- 1 root root 2274 Feb 22 12:47 etcd.yaml # -rw------- 1 root root 3358 Feb 22 12:47 kube-apiserver.yaml # -rw------- 1 root root 2878 Feb 22 12:47 kube-controller-manager.yaml # -rw------- 1 root root 1465 Feb 22 12:47 kube-scheduler.yaml Kubernetes 的 4 个核心组件 apiserver、etcd、scheduler、controller-manager 原来都以静态 Pod 的形式存在的，这也是为什么它们能够先于 Kubernetes 集群启动的原因。\nkubelet 会定期检查目录里的文件。\n# flannel 就是一个 DaemonSet kubectl get ns kubectl get ds -n kube-flannel # NAME DESIRED CURRENT READY UP-TO-DATE AVAILABLE NODE SELECTOR AGE # kube-flannel-ds 3 3 3 3 3 \u0026lt;none\u0026gt; 3h54m 20 Service 服务发现 由 kube-proxy 控制的四层负载均衡，在 TCP/IP 协议栈上转发流量。\nPod 的生命周期很短暂，会不停地创建销毁，所以就需要用 Service 来实现负载均衡，它由 Kubernetes 分配固定的 IP 地址，能够屏蔽后端的 Pod 变化。\nexport out=\u0026#34;--dry-run=client -o yaml\u0026#34; kubectl expose deploy ngx-dep --port=80 --target-port=80 $ou # vim ngx-svc.yml apiVersion: v1 kind: Service metadata: name: ngx-svc spec: ports: - port: 80 protocol: TCP targetPort: 80 selector: app: ngx-dep status: loadBalancer: {} --- apiVersion: v1 kind: ConfigMap metadata: name: ngx-conf data: default.conf: | server { listen 80; location / { default_type text/plain; return 200 \u0026#39;srv : $server_addr:$server_port\\nhost: $hostname\\nuri : $request_method $host $request_uri\\ndate: $time_iso8601\\n\u0026#39;; } } --- apiVersion: apps/v1 kind: Deployment metadata: name: ngx-dep spec: replicas: 2 selector: matchLabels: app: ngx-dep template: metadata: labels: app: ngx-dep spec: volumes: - name: ngx-conf-vol configMap: name: ngx-conf containers: - image: nginx:alpine name: nginx ports: - containerPort: 80 volumeMounts: - mountPath: /etc/nginx/conf.d name: ngx-conf-vol kubectl apply -f ngx-svc.yml kubectl get svc # NAME TYPE CLUSTER-IP EXTERNAL-IP PORT(S) AGE # kubernetes ClusterIP 10.96.0.1 \u0026lt;none\u0026gt; 443/TCP 5h10m # ngx-svc ClusterIP 10.109.131.132 \u0026lt;none\u0026gt; 80/TCP 35s # 虚地址 10.109.131.132 kubectl describe svc ngx-svc # Name: ngx-svc # Namespace: default # Labels: \u0026lt;none\u0026gt; # Annotations: \u0026lt;none\u0026gt; # Selector: app=ngx-dep # Type: ClusterIP # IP Family Policy: SingleStack # IP Families: IPv4 # IP: 10.109.131.132 # IPs: 10.109.131.132 # Port: \u0026lt;unset\u0026gt; 80/TCP # TargetPort: 80/TCP # Endpoints: 10.10.1.13:80,10.10.3.5:80 # Session Affinity: None # Events: \u0026lt;none\u0026gt; kubectl get pod -o wide NAME READY STATUS RESTARTS AGE IP NODE ngx-dep-6796688696-cwm8f 1/1 Running 0 2m4s 10.10.3.5 woker02 ngx-dep-6796688696-khjnv 1/1 Running 0 2m2s 10.10.1.13 woker01 # same Endpoints # 因为 Service、 Pod 的 IP 地址都是 Kubernetes 集群的内部网段 # 所以我们需要用 kubectl exec 进入到 Pod 内部 kubectl exec -it ngx-dep-6796688696-cwm8f -- sh curl 10.109.131.132 # srv : 10.10.3.5:80 # host: ngx-dep-6796688696-cwm8f # uri : GET 10.109.131.132 / # date: 2023-02-22T10:09:49+00:00 curl 10.109.131.132 # srv : 10.10.1.13:80 # host: ngx-dep-6796688696-khjnv # uri : GET 10.109.131.132 / # date: 2023-02-22T10:09:50+00:00 # 测试恢复 kubectl delete pod ngx-dep-6796688696-khjnv kubectl describe svc ngx-svc # Endpoints: 10.10.1.14:80,10.10.3.5:80 # 之前是 10.10.1.13:80,10.10.3.5:80 # 测试扩容 kubectl scale --replicas=5 deploy ngx-dep kubectl describe svc ngx-svc # Endpoints: 10.10.1.14:80,10.10.1.15:80,10.10.3.5:80 + 2 more... Service 对象的域名完全形式是 对象.名字空间.svc.cluster.local，但很多时候也可以省略后面的部分，直接写 对象.名字空间 甚至 对象名 就足够了，默认会使用对象所在的名字空间（比如这里就是 default）。\n# Name: ngx-svc # Namespace: default kubectl exec -it ngx-dep-6796688696-cwm8f -- sh curl ngx-svc # srv : 10.10.3.5:80 # host: ngx-dep-6796688696-cwm8f # uri : GET ngx-svc / # date: 2023-02-22T10:19:25+00:00 curl ngx-svc.default # srv : 10.10.3.6:80 # host: ngx-dep-6796688696-lpcfs # uri : GET ngx-svc.default / # date: 2023-02-22T10:19:41+00:00 curl ngx-svc.default.svc.cluster.local # srv : 10.10.3.5:80 # host: ngx-dep-6796688696-cwm8f # uri : GET ngx-svc.default.svc.cluster.local / # date: 2023-02-22T10:20:04+00:00 Pod 分配了域名：IP 地址.名字空间.pod.cluster.local IP 地址 . 改成 -。\n# kubectl explain svc.spec.type # vim ngx-svc.yml ... type: NodePort kubectl apply -f ngx-svc.yml kubectl get svc # NAME TYPE CLUSTER-IP EXTERNAL-IP PORT(S) AGE # kubernetes ClusterIP 10.96.0.1 \u0026lt;none\u0026gt; 443/TCP 5h56m # ngx-svc NodePort 10.109.131.132 \u0026lt;none\u0026gt; 80:30916/TCP 46m # Service 的默认类型是“ClusterIP”，只能在集群内部访问， # 如果改成“NodePort”，就会在节点上开启一个随机端口号，让外界也能够访问内部的服务。 curl localhost:30916 # srv : 10.10.1.15:80 # host: ngx-dep-6796688696-l6skl # uri : GET localhost / # date: 2023-02-22T10:48:32+00:00 21 Ingress 流量总管 Service 本身是没有服务能力的，它只是一些 iptables 规则，真正配置、应用这些规则的实际上是节点里的 kube-proxy 组件。\nIngress 也只是一些 HTTP 路由规则的集合，相当于一份静态的描述文件，真正要把这些规则在集群里实施运行，还需要有另外一个东西，这就是 Ingress Controller，它的作用就相当于 Service 的 kube-proxy，能够读取、应用 Ingress 规则，处理、调度流量。\nIngress Class 是插在 Ingress 和 Ingress Controller 中间，作为流量规则和控制器的协调人，解除了 Ingress 和 Ingress Controller 的强绑定关系。\nKubernetes 用户可以转向管理 Ingress Class，用它来定义不同的业务逻辑分组，简化 Ingress 规则的复杂度。\nexport out=\u0026#34;--dry-run=client -o yaml\u0026#34; kubectl create ing ngx-ing --rule=\u0026#34;ngx.test/=ngx-svc:80\u0026#34; --class=ngx-ink $out # vim ingress.yml apiVersion: networking.k8s.io/v1 kind: Ingress metadata: creationTimestamp: null name: ngx-ing spec: ingressClassName: ngx-ink rules: - host: ngx.test http: # 路径的匹配方式 paths: - backend: service: name: ngx-svc port: number: 80 path: / # 精确匹配（Exact）或前缀匹配（Prefix） pathType: Exact status: loadBalancer: {} --- apiVersion: networking.k8s.io/v1 kind: IngressClass metadata: name: ngx-ink spec: controller: nginx.org/ingress-controller kubectl apply -f ingress.yml # NAME CONTROLLER PARAMETERS AGE # ngx-ink nginx.org/ingress-controller \u0026lt;none\u0026gt; 15s kubectl get ing # NAME CLASS HOSTS ADDRESS PORTS AGE # ngx-ing ngx-ink ngx.test 80 84s kubectl describe ing ngx-ing # Name: ngx-ing # Labels: \u0026lt;none\u0026gt; # Namespace: default # Address: # Default backend: default-http-backend:80 (\u0026lt;error: endpoints \u0026#34;default-http-backend\u0026#34; not found\u0026gt;) # Rules: # Host Path Backends # ---- ---- -------- # ngx.test # / ngx-svc:80 (10.10.1.14:80,10.10.1.15:80) # Annotations: \u0026lt;none\u0026gt; # Events: \u0026lt;none\u0026gt; 在 Kubernetes 里使用 Ingress Controller：\nhttps://docs.nginx.com/nginx-ingress-controller/installation/installation-with-manifests/\ngit clone https://github.com/nginxinc/kubernetes-ingress.git --branch v3.0.2 cd kubernetes-ingress/deployments # Configure RBAC # 为Ingress控制器创建一个命名空间和一个服务账户 kubectl apply -f common/ns-and-sa.yaml # 为服务账户创建一个集群角色和集群角色绑定 kubectl apply -f rbac/rbac.yaml # Create Common Resources # 为NGINX的默认服务器创建一个带有TLS证书和密钥的秘密 kubectl apply -f common/default-server-secret.yaml # 创建一个 config map，用于定制NGINX配置。 kubectl apply -f common/nginx-config.yaml # 创建一个IngressClass资源 kubectl apply -f common/ingress-class.yaml # Create Custom Resources # kubectl apply -f common/crds/ vim deployment/nginx-ingress.yaml # args add: # -enable-custom-resources=false # Run the Ingress Controller kubectl apply -f deployment/nginx-ingress.yaml # check kubectl get pods --namespace=nginx-ingress # NAME READY STATUS RESTARTS AGE # nginx-ingress-5f98f8f5f9-nnkv7 1/1 Running 0 3m14s # Get Access to the Ingress Controller kubectl create -f service/nodeport.yaml kubectl get service -n nginx-ingress # NAME TYPE CLUSTER-IP EXTERNAL-IP PORT(S) AGE # nginx-ingress NodePort 10.111.210.52 \u0026lt;none\u0026gt; 80:31754/TCP,443:30188/TCP 5s # debug kubectl get IngressClass kubectl get ing -n nginx-ingress kubectl get deploy -n nginx-ingress kubectl get pod -n nginx-ingress -o wide kubectl describe service -n nginx-ingress -o wide kubectl describe pod -n nginx-ingress # 命令kubectl port-forward，它可以直接把本地的端口映射到 Kubernetes 集群的某个 Pod 里 kubectl port-forward -n nginx-ingress nginx-ingress-5f98f8f5f9-nnkv7 8080:80 \u0026amp; 22 玩转 Kubernetes 2 Kubernetes 部署 WordPress：\n# vim wp-maria.yml apiVersion: v1 kind: ConfigMap metadata: name: maria-cm data: DATABASE: \u0026#34;db\u0026#34; USER: \u0026#34;wp\u0026#34; PASSWORD: \u0026#34;123\u0026#34; ROOT_PASSWORD: \u0026#34;123\u0026#34; --- apiVersion: apps/v1 kind: Deployment metadata: labels: app: maria-dep name: maria-dep spec: replicas: 1 selector: matchLabels: app: maria-dep template: metadata: labels: app: maria-dep spec: containers: - image: mariadb:10 name: mariadb ports: - containerPort: 3306 envFrom: - prefix: \u0026#34;MARIADB_\u0026#34; configMapRef: name: maria-cm --- apiVersion: v1 kind: Service metadata: labels: app: maria-dep name: maria-svc spec: ports: - port: 3306 protocol: TCP targetPort: 3306 selector: app: maria-dep kubectl apply -f wp-maria.yml kubectl get pod kubectl get deploy kubectl get svc # vim wp-app.yml apiVersion: v1 kind: ConfigMap metadata: name: wp-cm data: # DNS HOST HOST: \u0026#34;maria-svc\u0026#34; USER: \u0026#34;wp\u0026#34; PASSWORD: \u0026#34;123\u0026#34; NAME: \u0026#34;db\u0026#34; --- apiVersion: apps/v1 kind: Deployment metadata: labels: app: wp-dep name: wp-dep spec: replicas: 2 selector: matchLabels: app: wp-dep template: metadata: labels: app: wp-dep spec: containers: - image: wordpress:5 name: wordpress ports: - containerPort: 80 envFrom: - prefix: \u0026#34;WORDPRESS_DB_\u0026#34; configMapRef: name: wp-cm --- apiVersion: v1 kind: Service metadata: labels: app: wp-dep name: wp-svc spec: ports: - name: http80 port: 80 protocol: TCP targetPort: 80 # 指定端口 nodePort: 30088 selector: app: wp-dep # NodePort type: NodePort kubectl apply -f wp-app.yml kubectl get pod kubectl get deploy kubectl get svc kubectl port-forward service/wp-svc 80:80 --address 0.0.0.0 # vim wp-ing.yml apiVersion: networking.k8s.io/v1 kind: IngressClass metadata: name: wp-ink spec: controller: nginx.org/ingress-controller --- # kubectl create ing wp-ing --rule=\u0026#34;wp.test/=wp-svc:80\u0026#34; --class=wp-ink $out apiVersion: networking.k8s.io/v1 kind: Ingress metadata: name: wp-ing spec: ingressClassName: wp-ink rules: - host: wp.test http: paths: - path: / pathType: Prefix backend: service: name: wp-svc port: number: 80 # vim wp-kic-dep.yml apiVersion: apps/v1 kind: Deployment metadata: name: wp-kic-dep namespace: nginx-ingress spec: replicas: 1 selector: matchLabels: app: wp-kic-dep template: metadata: labels: app: wp-kic-dep spec: # kubectl explain Deployment.spec.template.spec.serviceAccountName serviceAccountName: nginx-ingress # kubectl explain Deployment.spec.template.spec.hostNetwork hostNetwork: true containers: - image: nginx/nginx-ingress:3.0.2 imagePullPolicy: IfNotPresent name: nginx-ingress ports: - name: http containerPort: 80 - name: https containerPort: 443 - name: readiness-port containerPort: 8081 - name: prometheus containerPort: 9113 readinessProbe: httpGet: path: /nginx-ready port: readiness-port periodSeconds: 1 securityContext: allowPrivilegeEscalation: true runAsUser: 101 #nginx runAsNonRoot: true capabilities: drop: - ALL add: - NET_BIND_SERVICE env: - name: POD_NAMESPACE valueFrom: fieldRef: fieldPath: metadata.namespace - name: POD_NAME valueFrom: fieldRef: fieldPath: metadata.name args: # 默认是 nginx - -ingress-class=wp-ink - -enable-custom-resources=false - -nginx-configmaps=$(POD_NAMESPACE)/nginx-config - -default-server-tls-secret=$(POD_NAMESPACE)/default-server-secret --- apiVersion: v1 kind: Service metadata: name: wp-kic-svc namespace: nginx-ingress spec: ports: - port: 80 protocol: TCP targetPort: 80 nodePort: 30080 selector: app: wp-kic-dep type: NodePort kubectl apply -f wp-ing.yml -f wp-kic-dep.yml kubectl get ing kubectl get ingressclass kubectl get pod -n=nginx-ingress kubectl describe pod -n=nginx-ingress kubectl get deploy -n=nginx-ingress kubectl get svc -n=nginx-ingress # 在服务器上 kubectl get pod -n=nginx-ingress -o=wide # NAME READY STATUS RESTARTS AGE IP NODE # wp-kic-dep-68579bc688-d64zs 1/1 Running 0 10m 172.21.0.9 woker01 curl 172.21.0.9 -H \u0026#34;HOST: wp.test\u0026#34; # 在服务器外 kubectl port-forward service/wp-kic-svc -n=nginx-ingress 80:80 --address 0.0.0.0 vim /etc/hosts [master ip] wp.test # 游览器访问 wp.test 23 中级篇实操总结 # DaemonSet 模板生成 kubectl create deploy redis-ds --image=redis:5-alpine $out \\ | sed \u0026#39;s/Deployment/DaemonSet/g\u0026#39; - \\ | sed -e \u0026#39;/replicas/d\u0026#39; - References chronolaw/k8s_study | GitHub nginx-ingress-controller Installation with Manifests | nginx.com \u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2023/02/22/kubernetes-getting-started-part2/","summary":"\u003ch2 id=\"17-多节点的-kubernetes-集群\"\u003e17 多节点的 Kubernetes 集群\u003c/h2\u003e\n\u003cp\u003e在腾讯云 TencentOS Server 3.1 (TK4) 下测试：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003emaster SA3.MEDIUM4 2 核 4GB 5Mbps\u003c/li\u003e\n\u003cli\u003eworker S5.SMALL2 1 核 2GB 1Mbps\u003c/li\u003e\n\u003cli\u003eworker S5.SMALL2 1 核 2GB 1Mbps\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# 修改源 https://mirrors.cloud.tencent.com/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003emv /etc/yum.repos.d/CentOS-Base.repo /etc/yum.repos.d/CentOS-Base.repo.backup\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ewget -O /etc/yum.repos.d/CentOS-Base.repo http://mirrors.cloud.tencent.com/repo/centos7_base.repo\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eyum clean all\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eyum makecache\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# install docker\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eyum remove docker \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e                  docker-client \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e                  docker-client-latest \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e                  docker-common \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e                  docker-latest \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e                  docker-latest-logrotate \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e                  docker-logrotate \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e                  docker-engine\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eyum install -y yum-utils\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eyum-config-manager \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e    --add-repo \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e    https://download.docker.com/linux/centos/docker-ce.repo\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eyum install -y docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esystemctl start docker\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edocker -v\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edocker run hello-world\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e一些准备工作：\u003c/p\u003e","title":"Kubernetes 入门实战 Part2"},{"content":"01 初识 Docker apt install -y docker.io service docker start usermod -aG docker ${USER} docker version docker info docker ps docker pull busybox # show all images docker images https://docs.docker.com/get-started/overview/\n02 被隔离的进程 docker pull alpine docker run -it alpine sh cat /etc/os-release 隔离资源，保证系统安全，提高资源的利用率。\n资源隔离提供了三种技术：namespace、 cgroup、chroot（pivot_rott）。\n03 容器化的应用 Build once, Run anywhere.\n应用程序不再直接和操作系统打交道，而是封装成镜像，再交给容器环境去运行。\n# remove image docker rmi busybox # 开启一个交互式操作的 Shell docker run -it busybox # 在后台运行 docker run -d busybox # 为容器起一个名字 docker run -d --name xxx busybox # 不保存容器，只要运行完毕就自动清除 docker run --rm busybox echo \u0026#34;hello docker\u0026#34; docker stop xxx # remove container docker rm xxx # show all container docker ps -a docker exec xxx echo \u0026#34;hello docker\u0026#34; 05 镜像仓库 https://github.com/docker-library/official-images https://hub.docker.com/u/library 用户名/应用名:标签 官方镜像用户名是 library。\nslim 经过精简的 fat 包含了较多的辅助工具 rc 候选版本，release candidate docker build -t docker tag ngx-app chronolaw/ngx-app:1.0 docker push chronolaw/ngx-app:1.0 save 和 load 这两个镜像归档命令：\ndocker save ngx-app:latest -o ngx.tar docker load -i ngx.tar 06 打破次元壁 docker run -d --rm --name ubu phusion/baseimage:jammy-1.0.1 echo \u0026#34;hello\u0026#34; \u0026gt; a.txt # a.txt 拷贝到容器 tmp docker cp a.txt ubu:/tmp docker exec -it ubu bash # 考出容器 docker cp ubu:/tmp/a.txt ./b.txt 容器和主机共享本地目录：\n# --mount # -v /tmp:/tmp:ro 只读 docker run -d --rm -v /tmp:/tmp --name ubu phusion/baseimage:jammy-1.0.1 docker exec -it ubu bash docker pull python:alpine docker run -it --rm -v `pwd`:/tmp python:alpine sh 网络模式：null host bridge\n# host docker run -d --rm --net=host --name=ng nginx:alpine docker exec ng ip addr docker inspect ng | grep IPAddress docker stop ng # bridge 默认模式 docker run -d --rm --name=ng nginx:alpine docker inspect ng | grep IPAddress # \u0026#34;IPAddress\u0026#34;: \u0026#34;172.17.0.3\u0026#34; docker run -d --rm --name=rd redis docker inspect rd | grep IPAddress # \u0026#34;IPAddress\u0026#34;: \u0026#34;172.17.0.4\u0026#34; 分配服务端口号\ndocker run -d -p 80:80 --rm nginx:alpine docker run -d -p 8080:80 --rm nginx:alpine # 分别“映射”到了两个容器里的 80 端口 07 玩转 Docker Container Image Registry\nhttps://registry.hub.docker.com/_/registry/\ndocker run -d -p 5000:5000 registry # 使用 docker tag 命令给镜像打标签再上传 docker tag nginx:alpine 127.0.0.1:5000/nginx:alpine docker push 127.0.0.1:5000/nginx:alpine # 本次重新拉取测试 docker rmi 127.0.0.1:5000/nginx:alpine docker pull 127.0.0.1:5000/nginx:alpine https://docs.docker.com/registry/spec/api/\n# Listing Repositories curl 127.1:5000/v2/_catalog # {\u0026#34;repositories\u0026#34;:[\u0026#34;nginx\u0026#34;]} curl 127.1:5000/v2/nginx/tags/list # {\u0026#34;name\u0026#34;:\u0026#34;nginx\u0026#34;,\u0026#34;tags\u0026#34;:[\u0026#34;alpine\u0026#34;]} registry 默认会把镜像存储在 Docker 内部目录 /var/lib/registry。\n搭建 WordPress：\ndocker run -d --rm \\ --env MARIADB_DATABASE=db \\ --env MARIADB_USER=wp \\ --env MARIADB_PASSWORD=123 \\ --env MARIADB_ROOT_PASSWORD=123 \\ --name mariadb \\ mariadb:10 # 进入 mariadb docker exec -it mariadb mysql -uwp -p123 # show mariadb ip docker inspect mariadb | grep IPAddress # \u0026#34;IPAddress\u0026#34;: \u0026#34;172.17.0.2\u0026#34; docker run -d --rm \\ --env WORDPRESS_DB_HOST=172.17.0.2 \\ --env WORDPRESS_DB_USER=wp \\ --env WORDPRESS_DB_PASSWORD=123 \\ --env WORDPRESS_DB_NAME=db \\ --name wp \\ wordpress:5 docker inspect wp | grep IPAddress # \u0026#34;IPAddress\u0026#34;: \u0026#34;172.17.0.4\u0026#34; vim wp.conf server { listen 80; default_type text/html; location / { proxy_http_version 1.1; proxy_set_header Host $host; # wordpress server proxy_pass http://172.17.0.4; } } # 感觉可以直接用 wordpress 的 80，无需再代理一次 docker run -d --rm \\ -p 80:80 \\ -v `pwd`/wp.conf:/etc/nginx/conf.d/default.conf \\ --name ng \\ nginx:alpine # show logs docker logs mariadb docker logs ng docker logs wp 08 入门篇总结 docker pull alpine docker run -it alpine sh uname -a # Linux de3852b4ec42 5.15.49-linuxkit #1 SMP Tue Sep 13 07:51:46 UTC 2022 x86_64 Linux # Darwin V_YFANZHAO-MB1 19.6.0 Darwin Kernel Version 19.6.0: Tue Jun 21 21:18:39 PDT 2022; root:xnu-6153.141.66~1/RELEASE_X86_64 x86_64 构建自己的镜像：\nhttps://github.com/chronolaw/k8s_study/blob/master/ch1/Dockerfile\nARG IMAGE_BASE=\u0026#34;nginx\u0026#34; ARG IMAGE_TAG=\u0026#34;1.21-alpine\u0026#34; FROM ${IMAGE_BASE}:${IMAGE_TAG} ENV PATH=$PATH:/tmp ENV DEBUG=OFF COPY ./default.conf /etc/nginx/conf.d/ RUN cd /usr/share/nginx/html \\ \u0026amp;\u0026amp; echo \u0026#34;hello nginx\u0026#34; \u0026gt; a.txt EXPOSE 8081 8082 8083 WORKDIR /etc/nginx docker build -t ngx-app:1.0 . docker run -it --rm ngx-app:1.0 sh docker save ngx-app:1.0 -o ngx.tar docker load -i ngx.tar 09 Kubernetes 环境 容器编排 Container Orchestration\nKubernetes 就是一个生产级别的容器编排平台和集群管理系统。\nhttps://minikube.sigs.k8s.io/docs/start/\nminikube version # minikube version: v1.29.0 # commit: ddac20b4b34a9c8c857fc602203b6ba2679794d3 # 统一实验环境 minikube start --kubernetes-version=v1.23.3 # 查看状态 minikube status minikube node list # minikube 192.168.49.2 # 登录到这个节点上 minikube ssh uname -a # Linux minikube 5.15.49-linuxkit #1 SMP Tue Sep 13 07:51:46 UTC 2022 x86_64 x86_64 x86_64 GNU/Linux ip add # minikube 管理 Kubernetes 集群环境 # kubectl 操作实际的 Kubernetes 功能 # install kubectl minikube kubectl minikube kubectl -- version alias kubectl=\u0026#34;minikube kubectl --\u0026#34; kubectl version # 启动一个镜像 kubectl run ngx --image=nginx:alpine # like docker ps kubectl get pod https://kubernetes.io/zh/\n10 Kubernetes 工作机制 Kubernetes 采用了现今流行的“控制面 / 数据面”（Control Plane / Data Plane）架构，集群里的计算机被称为“节点”（Node），可以是实机也可以是虚机，少量的节点用作控制面来执行集群的管理维护工作，其他的大部分节点都被划归数据面，用来跑业务应用。Master 节点实现管理控制功能，Worker 节点运行具体业务。\nkubectl get node # NAME STATUS ROLES AGE VERSION # minikube Ready control-plane,master 38m v1.23.3 # 查看 master Component pod kubectl get pod -n kube-system # NAME READY STATUS RESTARTS AGE # coredns-65c54cc984-4pckd 1/1 Running 0 40m # etcd-minikube 1/1 Running 0 40m # kube-apiserver-minikube 1/1 Running 0 40m # kube-controller-manager-minikube 1/1 Running 0 40m # kube-proxy-88wt2 1/1 Running 0 40m # kube-scheduler-minikube 1/1 Running 0 40m # storage-provisioner 1/1 Running 3 (6m39s ago) 40m # worker node minikube ssh # show kube-proxy docker ps |grep kube-proxy # show kubelet, not exist docker ps -ef|grep kubelet # show addons list minikube addons list minikube dashboard 11 YAML YAML 是 JSON 的超集。\nShell 脚本和 Dockerfile 可以很好地描述“命令式”（Imperative）。“声明式”（Declarative）注重结果。\napiserver 采用了 HTTP 协议的 URL 资源理念，API 风格也用 RESTful，被称为是“API 对象”了。\n# 查看 kubectl api-service 支持的所有对象 kubectl api-resources # 显示出详细的命令执行过程 kubectl get pod --v=9 # 自带的 API 文档 https://kubernetes.io/docs/reference/kubernetes-api/ kubectl explain pod kubectl explain pod.metadata # 命令式 kubectl run ngx --image=nginx:alpine # 转换为 YAML 声名式 kubectl run ngx --image=nginx:alpine --dry-run=client -o yaml \u0026gt; ngx-pod.yml kubectl apply -f ngx-pod.yml kubectl delete -f ngx-pod.yml 12 Pod 为了解决这样多应用联合运行的问题，同时还要不破坏容器的隔离，就需要在容器外面再建立一个“收纳舱”。\napiVersion: v1 kind: Pod metadata: creationTimestamp: null labels: run: ngx name: ngx spec: containers: - image: nginx:alpine name: ngx resources: {} dnsPolicy: ClusterFirst restartPolicy: Always status: {} vim ngx-pod.yml kubectl apply -f ngx-pod.yml kubectl logs ngx kubectl get pod kubectl describe pod ngx # cp file to pod echo \u0026#39;aaa\u0026#39; \u0026gt; a.txt kubectl cp a.txt ngx:/tmp # exec need -- kubectl exec -it ngx -- sh 13 Job CronJob 离线业务 “单一职责”的意思是对象应该只专注于做好一件事情，不要贪大求全，保持足够小的粒度才更方便复用和管理。\n“组合优于继承”的意思是应该尽量让对象在运行时产生联系，保持松耦合，而不要用硬编码的方式固定对象的关系。\nkubectl create job echo-job --image=busybox --dry-run=client -o yaml \u0026gt; job.yml apiVersion: batch/v1 kind: Job metadata: creationTimestamp: null name: echo-job spec: template: metadata: creationTimestamp: null spec: containers: - image: busybox name: echo-job resources: {} # 补充输出 command: [\u0026#34;/bin/echo\u0026#34;] args: [\u0026#34;hello\u0026#34;, \u0026#34;world\u0026#34;] restartPolicy: Never status: {} kubectl apply -f job.yml kubectl get job # NAME COMPLETIONS DURATION AGE # echo-job 1/1 16s 33s kubectl get pod # NAME READY STATUS RESTARTS AGE # echo-job-g2bf6 0/1 Completed 0 68s kubectl logs echo-job # hello world apiVersion: batch/v1 kind: Job metadata: creationTimestamp: null name: sleep-job spec: # 设置 Pod 运行的超时时间 activeDeadlineSeconds: 60 # 设置 Pod 的失败重试次数 backoffLimit: 2 # Job 完成需要运行多少个 Pod，默认是 1 completions: 4 # 它与 completions 相关，表示允许并发运行的 Pod 数量，避免过多占用资源 parallelism: 2 template: metadata: creationTimestamp: null spec: containers: - image: busybox name: echo-job resources: {} # 随机休眠 command: - sh - -c - sleep $(($RANDOM % 10 + 1)) \u0026amp;\u0026amp; echo done restartPolicy: Never status: {} kubectl apply -f sleep-job.yaml kubectl get pod -w # NAME READY STATUS RESTARTS AGE # sleep-job-92m4d 0/1 Completed 0 30s # sleep-job-g8pmj 0/1 Completed 0 15s # sleep-job-tsncl 0/1 Completed 0 30s # sleep-job-x4qlp 0/1 Completed 0 15s # cronjob kubectl create cj echo-cj --image=busybox --schedule=\u0026#34;*/1 * * * *\u0026#34; --dry-run=client -o yaml \u0026gt; echo-cj.yaml apiVersion: batch/v1 kind: CronJob metadata: creationTimestamp: null name: echo-cj spec: jobTemplate: metadata: creationTimestamp: null name: echo-cj spec: template: metadata: creationTimestamp: null spec: containers: - image: busybox name: echo-cj resources: {} # 补充输出 command: [\u0026#34;/bin/echo\u0026#34;] args: [\u0026#34;hello\u0026#34;, \u0026#34;world\u0026#34;] restartPolicy: OnFailure schedule: \u0026#34;*/1 * * * *\u0026#34; status: {} kubectl apply -f echo-cj.yaml kubectl get cj # NAME SCHEDULE SUSPEND ACTIVE LAST SCHEDULE AGE # echo-cj */1 * * * * False 1 5s 8s kubectl get pod # NAME READY STATUS RESTARTS AGE # echo-cj-27942326-qng4j 0/1 Completed 0 93s # echo-cj-27942327-vlrvs 0/1 Completed 0 33s 14 ConfigMap Secret 管理配置信息 kubectl create cm info --from-literal=name=zhao --dry-run=client -o yaml \u0026gt; cm.yml kubectl apply -f cm.yml kubectl get cm kubectl describe cm info kubectl create secret generic user --from-literal=name=root --dry-run=client -o yaml \u0026gt; secret.yml # -n 去掉字符串里隐含的换行符 echo -n \u0026#34;root\u0026#34; | base64 kubectl apply -f secret.yml kubectl get secret kubectl describe secret user kubectl explain pod.spec.containers.env.valueFrom apiVersion: v1 kind: Pod metadata: creationTimestamp: null labels: run: ngx name: ngx spec: containers: - image: nginx:alpine name: ngx resources: {} env: - name: NAME valueFrom: configMapKeyRef: name: info key: name - name: SNAME valueFrom: secretKeyRef: name: user key: name dnsPolicy: ClusterFirst restartPolicy: Always status: {} kubectl apply -f env-pod.yml kubectl exec -it ngx -- sh echo $NAME $SNAME # 以 Volume 的方式使用 ConfigMap/Secret apiVersion: v1 kind: Pod metadata: name: vol-pod spec: # Volume 属于 Pod 与 containers 同级 volumes: - name: cm-vol configMap: name: info - name: sec-vol secret: secretName: user containers: # 挂载到容器里的某个路径下 - volumeMounts: - mountPath: /tmp/cm-items name: cm-vol - mountPath: /tmp/sec-items name: sec-vol image: nginx:alpine name: ngx resources: {} dnsPolicy: ClusterFirst restartPolicy: Always status: {} vim vol-pod.yml kubectl apply -f vol-pod.yml kubectl get pod kubectl exec -it vol-pod -- sh cat /tmp/cm-items/name cat /tmp/sec-items/name # ConfigMap 和 Secret 都变成了目录的形式，而它们里面的 Key-Value 变成了一个个的文件，而文件名就是 Key。 15 玩转 Kubernetes 搭建 WordPress 环境：\n# vim mariadb-pod.yml apiVersion: v1 kind: ConfigMap metadata: name: maria-cm data: DATABASE: \u0026#34;db\u0026#34; USER: \u0026#34;wp\u0026#34; PASSWORD: \u0026#34;123\u0026#34; ROOT_PASSWORD: \u0026#34;123\u0026#34; --- apiVersion: v1 kind: Pod metadata: name: maria-pod labels: app: wordpress role: database spec: containers: - image: mariadb:10 name: maria imagePullPolicy: IfNotPresent ports: - containerPort: 3306 envFrom: - prefix: \u0026#34;MARIADB_\u0026#34; configMapRef: name: maria-cm kubectl apply -f mariadb-pod.yml # 获取 IP 地址需要加上参数 -o wide kubectl get pod -o wide # NAME READY STATUS RESTARTS AGE IP NODE NOMINATED NODE READINESS GATES # maria-pod 1/1 Running 0 64s 172.17.0.5 minikube \u0026lt;none\u0026gt; \u0026lt;none\u0026gt; # vim wp-pod.yml apiVersion: v1 kind: ConfigMap metadata: name: wp-cm data: # MariaDB Pod 的 IP HOST: \u0026#34;172.17.0.5\u0026#34; USER: \u0026#34;wp\u0026#34; PASSWORD: \u0026#34;123\u0026#34; NAME: \u0026#34;db\u0026#34; --- apiVersion: v1 kind: Pod metadata: name: wp-pod labels: app: wordpress role: website spec: containers: - image: wordpress:5 name: wp-pod imagePullPolicy: IfNotPresent ports: - containerPort: 80 envFrom: - prefix: \u0026#34;WORDPRESS_DB_\u0026#34; configMapRef: name: wp-cm kubectl apply -f wp-pod.yml kubectl get pod -o wide # NAME READY STATUS RESTARTS AGE IP NODE NOMINATED NODE READINESS GATES # maria-pod 1/1 Running 0 160m 172.17.0.5 minikube \u0026lt;none\u0026gt; \u0026lt;none\u0026gt; # wp-pod 1/1 Running 0 2m47s 172.17.0.6 minikube \u0026lt;none\u0026gt; \u0026lt;none\u0026gt; # 本地的 “8080” 映射到 WordPress Pod 的“80” kubectl port-forward wp-pod 8080:80 \u0026amp; # Forwarding from 127.0.0.1:8080 -\u0026gt; 80 # Forwarding from [::1]:8080 -\u0026gt; 80 # fg 16 初级篇总结 minikube version minikube status minikube start --kubernetes-version=v1.23.3 minikube node list kubectl version kubectl run ngx --image=nginx:alpine # apiserver 等核心组件是在 kube-system 名字空间 kubectl get pod -n kube-system kubectl api-resources kubectl explain pod.metadata export out=\u0026#34;--dry-run=client -o yaml\u0026#34; kubectl run ngx --image=nginx:alpine $out \u0026gt; pod.yml kubectl apply -f ngx-pod.yml kubectl get pod kubectl logs ngx-pod kubectl exec -it ngx-pod -- sh kubectl delete -f ngx-pod kubectl create job echo-job --image=busybox $out kubectl apply -f job.yml kubectl get job kubectl get pod kubectl logs echo-job-l52l7 kubectl create cj echo-cj --image=busybox --schedule=\u0026#34;* * * * *\u0026#34; $out kubectl apply -f cronjob.yml kubectl get cj kubectl get pod kubectl create cm info --from-literal=k=v $out kubectl get cm kubectl describe cm info kubectl create secret generic user --from-literal=name=root $out kubectl get secret kubectl describe secret user echo cm9vdA== | base64 -d References chronolaw/k8s_study | GitHub \u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2023/02/15/kubernetes-getting-started-part1/","summary":"\u003ch2 id=\"01-初识-docker\"\u003e01 初识 Docker\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eapt install -y docker.io\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eservice docker start\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eusermod -aG docker \u003cspan class=\"si\"\u003e${\u003c/span\u003e\u003cspan class=\"nv\"\u003eUSER\u003c/span\u003e\u003cspan class=\"si\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edocker version\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edocker info\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edocker ps\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edocker pull busybox\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# show all images\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edocker images\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003ca href=\"https://docs.docker.com/get-started/overview/\"\u003ehttps://docs.docker.com/get-started/overview/\u003c/a\u003e\u003c/p\u003e\n\u003ch2 id=\"02-被隔离的进程\"\u003e02 被隔离的进程\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edocker pull alpine\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edocker run -it alpine sh\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ecat /etc/os-release\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e隔离资源，保证系统安全，提高资源的利用率。\u003c/p\u003e\n\u003cp\u003e资源隔离提供了三种技术：namespace、 cgroup、chroot（pivot_rott）。\u003c/p\u003e\n\u003ch2 id=\"03-容器化的应用\"\u003e03 容器化的应用\u003c/h2\u003e\n\u003cp\u003eBuild once, Run anywhere.\u003c/p\u003e\n\u003cp\u003e应用程序不再直接和操作系统打交道，而是封装成镜像，再交给容器环境去运行。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# remove image\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edocker rmi busybox\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# 开启一个交互式操作的 Shell\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edocker run -it busybox\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# 在后台运行\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edocker run -d busybox\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# 为容器起一个名字\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edocker run -d --name xxx busybox\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# 不保存容器，只要运行完毕就自动清除\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edocker run --rm busybox \u003cspan class=\"nb\"\u003eecho\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;hello docker\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edocker stop xxx\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# remove container\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edocker rm xxx\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# show all container\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edocker ps -a\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edocker \u003cspan class=\"nb\"\u003eexec\u003c/span\u003e xxx \u003cspan class=\"nb\"\u003eecho\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;hello docker\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"05-镜像仓库\"\u003e05 镜像仓库\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/docker-library/official-images\"\u003ehttps://github.com/docker-library/official-images\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://hub.docker.com/u/library\"\u003ehttps://hub.docker.com/u/library\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003ccode\u003e用户名/应用名:标签\u003c/code\u003e 官方镜像用户名是 \u003ccode\u003elibrary\u003c/code\u003e。\u003c/p\u003e","title":"Kubernetes 入门实战 Part1"},{"content":"02 设计哲学 设计哲学之于编程语言，就好比一个人的价值观之于这个人的行为。\n简单：Go 生产力的源泉。 显式：Go 希望开发人员 明确知道自己在做什么；显式的基于值比较的错误处理方案。 组合：类型嵌入(Type Embedding)。 并发：面向多核、原生支持并发、用户层轻量级线程 goroutine。 面向工程：将解决工程问题作为 Go 的 设计原则之一，这些问题包括:程序构建慢、依赖管理失控、代码难于理 解、跨语言构建难等。 03 配好环境 https://go.dev/doc/devel/release https://golang.google.cn/dl/ 安装多个 Go 版本 go get golang.org/dl/go1.15.13 go1.15.13 download go1.15.13 version 配置 Go go env go help environment 04 Go 程序的结构 import \u0026quot;fmt\u0026quot; 一行中 fmt 代表的是包的导入路径(Import)，它表示的是标准库下的 fmt 目录，整个 import 声明语句的含义是导入标准库 fmt 目录下的包 fmt.Println 函数调用一行中的 fmt 代表的则是包名。 通常导入路径的最后一个分段名与包名是相同的，这也很容易让人误解 import 声明语句中的 fmt 指的是包名，其实并不是这样的。 gofmt main.go Go module go mod init go mod tidy 05 Go 项目的布局标准 loccount 工具\nhttps://github.com/golang/go\ntree -LF 1 . 06 解决包依赖管理 GOPATH -\u0026gt; Vendor -\u0026gt; Go Module\nGOPATH go env GOPATH=\u0026#34;/Users/v_yfanzhao/go\u0026#34; go get github.com/sirupsen/logrus vendor Go 项目必须放在 GOPATH 环境变量配置的路径下，庞大的 vendor 目录需要提交到代码仓库，不仅占用代码仓库空间，减慢仓库下载和更新的速度， 而且还会干扰代码评审，对实施代码统计等开发者效能工具也有比较大影响。 你还需要手工管理 vendor 下面的 Go 依赖包，包括项目依赖包的分析、版本的记 录、依赖包获取和存放，等等，最让开发者头疼的就是这一点。 Go Module Go Module 与 go.mod 是一一对应的。go.mod 文件所在的顶层目录也被称为 module 的根目录，module 根目录以及它子目录 下的所有 Go 包均归属于这个 Go Module，这个 module 也被称为 main module。\npackage main import \u0026#34;github.com/sirupsen/logrus\u0026#34; func main() { logrus.Println(\u0026#34;hello, go module mode\u0026#34;) } go mod init go mod tidy module go-lesson-one go 1.17 require github.com/sirupsen/logrus v1.9.0 require golang.org/x/sys v0.0.0-20220715151400-c0bba94af5f8 // indirect major.minor.patch\nGo 的语义导入版本机制：将包主版本号引入到包导入路径中。v0、v1 时不加入路径。\n因此甚至可以同时依赖一个包的两个不兼容版本：\nimport ( \u0026#34;github.com/sirupsen/logrus\u0026#34; logv2 \u0026#34;github.com/sirupsen/logrus/v2\u0026#34; ) Go 会在该项目依赖项的所有版本中，选出符合项目整体要求的“最小版本”。这与 PHP Composer 最新最大 (Latest Greatest) 版本 相反。\n07 Go Module 操作 go list -m all go list -m -versions github.com/sirupsen/logrus # 指定版本 升降级 go get github.com/sirupsen/logrus@v1.7.0 # 指定版本 升降级 go mod edit -require=github.com/sirupsen/logrus@v1.7.0 go mod tidy 使用 vendor 机制 go mod vendor go build -mod=verdor # 顶层目录下存在 vendor 目录，那么 go build 默认也会优先基于 vendor 构建，除非： go build -mod=mod 08 Go 程序的执行次序 可执行程序的 main 包必须定义 main 函数，否则 Go 编译器会报错。\n除了 main 包外，其他包也可以拥有自己的名为 main 的函数 或方法。\ninit 函数 除了前面讲过的 main.main 函数之外，Go 语言还有一个特殊函数，它就是用于进行包初始化的 init 函数了。main 函数之前，常量和变量初 始化之后。每个 init 函数在整个 Go 程序生命周期内仅会被执行一次。Go 包可以拥有不止一个 init 函数。\nGo 在进行包初始化的过程中，会采用“深度优先”的原则，递归初始化各个包的 依赖包。\npackage main |- import pkg1 |- import pkg2 |- const |- var |- init() |- const |- var |- init() |- const |- var |- init() |- main() init 函数的用途 重置包级变量值。被用于检查包级变量的初始状态。 实现对包级变量的复杂初始化。 在 init 函数中实现“注册模式”。通过在 init 函数中注册自己的实现的模式，就有效降低了 Go 包对外的直接 暴露，尤其是包级变量的暴露，从而避免了外部通过包级变量对包状态的改动。 09 构建一个 Web 服务 package main import ( \u0026#34;net/http\u0026#34; ) func main() { http.HandleFunc(\u0026#34;/\u0026#34;, func(w http.ResponseWriter, r *http.Request) { w.Write([]byte(\u0026#34;Hello World\u0026#34;)) }) http.ListenAndServe(\u0026#34;:8888\u0026#34;, nil) } curl localhost:8888 Hello World https://github.com/imzyf/go-bookstore\n10 变量声明 var a int = 10 // 将变量名放在了类型的前面 // 修饰关键字 变量名 类型 初值 // 省略类型信息的声明 var b = 12 // 显式赋予变量初值 var b = int32(13) // 声明多个 var a, b, c = 12, \u0026#39;A\u0026#39;, \u0026#34;hello\u0026#34; // 短变量声明 a := 12 b := \u0026#39;A\u0026#39; c := \u0026#34;hello\u0026#34; // 声明多个 a, b, c := 12, \u0026#39;A\u0026#39;, \u0026#34;hello\u0026#34; Go 语言的两类变量 包级变量 (package varible) 局部变量 (local varible) 包级变量的声明形式 包级变量只能使用带有 var 关键字的变量声明形式，不能使用短变量声明形式，但在形式细节上可以有一定灵活度。\nvar b int32 = 17 // 显式指定类型 var f float32 = 3.14 // 显式指定类型 var a = 13 // 使用默认类型 var b = int32(17) // 显式指定类型 var f = float32(3.14) // 显式指定类型 var a int32 var f float64 // 声明聚类 var ( netGo bool netCgo bool ) var ( aLongTimeAgo = time.Unix(1, 0) noDeadline = time.Time{} noCancel = (chan struct{})(nil) ) // 就近原则 // 尽可能在靠近第一次使用变量的位置声明这个变量 局部变量的声明形式 // 延迟初始化的局部变量 var err error // 显式初始化的局部变量 a := 17 f := float32(3.14) s := []byte(\u0026#34;hello, gopher!\u0026#34;) // 尽量在分支控制时使用短变量声明形式 11 代码块 Block 与作用域 Scope // 变量遮蔽 var a = 11 func foo(n int) { a := 1 a += n } func main() { fmt.Println(\u0026#34;a =\u0026#34;, a) // 11 foo(5) fmt.Println(\u0026#34;after calling foo, a =\u0026#34;, a) // 11 } 宇宙代码块(Universe Block) 包代码块(Package Block) 文件代码块(File Block) 分支控制语句隐式代码块 switch/select 的子句隐式代码块 一个标识符的作用域就是指：这个标识符在被声明后可以被有效使用的源码区域。\n导出标识符：\n声明在包代码块中 它名字第一个字符是一个大写的 Unicode 字符 https://github.com/imzyf/go-lesson-one/blob/main/cmd/chapter11/main.go\n12 数值类型 整型 Go 采用补码(2\u0026rsquo;s complement)作为整型的比特位编码方法。Go 的补码是通过原码逐位取反后再加 1 得到的。\nunit8 1 0 0 0 0 0 0 1 = 129 int8 1 0 0 0 0 0 0 1 = -127 0 1 1 1 1 1 1 1 127 1 0 0 0 0 0 0 0 取反 1 0 0 0 0 0 0 1 +1 -127 整型的溢出问题 https://github.com/imzyf/go-lesson-one/blob/main/cmd/chapter12/main.go\n这个问题最容易发生在循环语句的结束条件判断中，因为这也是经常使用整型变量的地方。\n浮点型 IEEE 754 符号位Sign 阶码Exponent 尾数Maintissa \\bit 位\\ 符号位 阶码 阶码偏移值 尾数 单精度 float32 1 8 127 23 双精度 float64 1 11 1023 52 eg:129.8125\n步骤一:我们要把这个浮点数值的整数部分和小数部分，分别转换为二进制形式(后缀 d 表示十进制数，后缀 b 表示二进制数): 整数部分:139d =\u0026gt; 10001011b; 小数部分:0.8125d =\u0026gt; 0.1101b(十进制小数转换为二进制可采用“乘 2 取整”的竖式计算)。 0.8125 * 2 = 1.625 …… 1 0.625 * 2 = 1.25 …… 1 0.25 * 2 = 0.5 …… 0 0.5 * 2 = 1 …… 1 139.8125d -\u0026gt; 10001011.1101b 步骤二:移动小数点，直到整数部分仅有一个 1。 10001011.1101b -\u0026gt; 1.00010111101b 小数点向左移了 7 位，这样 指数就为 `7`，尾数为 `00010111101b`。 步骤三:计算阶码。对于 float32 的单精度浮点数而言： 阶码 = 指数 + 偏移值 偏移值的计算公式为 2^(e-1)-1，其中 e 为阶码部分的 bit 位数，这里为 8，于是单精度浮点数的阶码偏移 值就为 2^(8-1)-1 = 127。 阶码 = `7` + 127 = 134d = `10000110b`。 步骤四:将符号位、阶码和尾数填到各自位置，得到最终浮点数的二进制表示 符号位 0 阶码 10000110 尾数 00010111101 不足 23 位补零 `0_0010111101_00_0000000000` 139.8125 -\u0026gt; 0_10000110_00010111101_000000000000\nGo Float32bit() result not expected | stackoverflow 复数型 矢量计算。\n创建自定义的数值类型 type MyInt int32 var m int = 5 var n int32 = 6 var a MyInt = m // error var a MyInt = n // error var a = MyInt(m) // ok var a = MyInt(n) // ok MyInt 类型的底层类型是 int32，所以它的数值性质与 int32 完全相同，但它 们仍然是完全不同的两种类型。\n类型别名(Type Alias) type MyInt = int32 var n int32 = 6 var a MyInt = n 通过类型别名语法定义的新类型与原类型别无二致，可以完全相互替代。\n13 字符串类型 why-what-how\n非原生字符串：\n不是原生类型，编译器不会对它进行类型校验，导致类型安全性差; 字符串操作时要时刻考虑结尾的 \\0，防止缓冲区溢出; 以字符数组形式定义的“字符串”，它的值是可变的，在并发场景中需要考虑同步问题; 获取一个字符串的长度代价较大，通常是 O(n) 时间复杂度; C 语言没有内置对非 ASCII 字符(如中文字符)的支持。 string 类型的数据是不可变的，提高了字符串的并发安全性和存储利用率（同一个字符串值分配同一块存储）。\nvar s string = \u0026#34;hello\u0026#34; s[0] = \u0026#39;k\u0026#39; // cannot assign to s[0] (value of type byte) s = \u0026#34;gopher\u0026#34; // ok 没有结尾 \\0，而且获取长度的时间复杂度是常数时间，消除了获取字符串长度的开销。\n反引号原生支持“所见即所得”的原始字符串，大大降低构造多行字符串时的心智负担。\n对非 ASCII 字符提供原生支持，消除了源码在不同环境下显示乱码的可能。Unicode 字符是以 UTF-8 编码格式存储在内存。\n通过单引号括起的字符字面值：\nhttps://github.com/imzyf/go-lesson-one/blob/main/cmd/chapter13/main.go\nUTF-8 编码解决的是 Unicode 码点值在计算机中如何存储和表示(位模式)的问题。UTF-8 方案使用变长度字节，从 1 个到 4 个不等。\n一个 rune 存储一个 unicode 码点或 utf-32 的四字节编码；从字节视角，string 对应的底层存储存放的是 utf8 编码。\nGo 字符串类型的内部标示\n// StringHeader 是一个 string 的运行时表示 // string 类型其实是一个“描述符” type StringHeader struct { // 一个指向底层存储的指针 Data uintptr // 字符串的长度 Len int } 直接将 string 类型通过函数或方法参数传入也不会带来太多的开销。因为传入的仅仅是一个“描述符”，而不是真正的字符串数据。\nGo 字符串类型的常见操作 下标操作；下标操作，我们获取的是字符串中特定下标上的字节，而不是字符。\n字符迭代：\nor 迭代，字节视角的迭代 字符串中 Unicode 字符的码点值，以及该字符在字符串中的偏移值（字节视角） 字符串连接；+ += strings.Builder strings.Join fmt.Sprintf。\n字符串比较；= =、!= 、\u0026gt;=、\u0026lt;=、\u0026gt; 和 \u0026lt;。\n字符串转换；string -\u0026gt; []rune []byte\n14 常量 支持无类型常量 支持隐式自动转型 可用于实现枚举 type myInt int // 无类型常量(Untyped Constant) const n = 13 func main() { var a myInt = 5 // 隐式转型 fmt.Println(a + n) } // 无类型常量 + 隐式转型：使得在 Go 这样的具有强类型系统的语言，在处理表达式混合数据类型运算的时候具有比较大的灵活性，代码编写也得到了一定程度的简化。 Go 的 const 语法提供了“隐式重复前一个非空表达式”的机制。\nconst ( Apple, Banana = iota, iota + 10 // 0, 10 (iota = 0) Strawberry, Grape // 1, 11 (iota = 1) Pear, Watermelon // 2, 12 (iota = 2) ) const ( _ = iota // 略过 iota = 0 IPV6_V6ONLY // 1 SOMAXCONN // 2 SO_ERROR // 3 ) 15 数组与切片 数组是一个固定长度的、由同构类型元素组成的连续序列。不仅是逻辑上的连续序列，而且在实际内存分配时也占据着一整块内存。\n切片不定长同构数据类型。切片可以看成是数组的“描述符”（句柄），为数组打开了一个访问与修改的“窗口”。\n// 切片 type slice struct { array unsafe.Pointer // 指向底层数组的指针 len int // 切片的长度，即切片中当前元素的个数 cap int // 底层数组的长度，也是切片的最大容量，cap 值永远大于等于 len 值 } var sl1 []int // 是声明，未初始化，是nil值，底层没有分配内存空间 var sl2 = []int{} // 初始化了，不是nil值，底层分配了内存空间，有地址。 16 map 类型 一组无序的键值对。\nmap[key_type]value_type key 的类型必须支持“==”和“!=”两种比较操作符。\nReferences The Go Playground \u0026ndash; EOF \u0026mdash;\n","permalink":"https://zyf.im/2023/02/01/go-language-lesson-one/","summary":"\u003ch2 id=\"02-设计哲学\"\u003e02 设计哲学\u003c/h2\u003e\n\u003cp\u003e设计哲学之于编程语言，就好比一个人的价值观之于这个人的行为。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e简单：Go 生产力的源泉。\u003c/li\u003e\n\u003cli\u003e显式：Go 希望开发人员 明确知道自己在做什么；显式的基于值比较的错误处理方案。\u003c/li\u003e\n\u003cli\u003e组合：类型嵌入(Type Embedding)。\u003c/li\u003e\n\u003cli\u003e并发：面向多核、原生支持并发、用户层轻量级线程 goroutine。\u003c/li\u003e\n\u003cli\u003e面向工程：将解决工程问题作为 Go 的 设计原则之一，这些问题包括:程序构建慢、依赖管理失控、代码难于理 解、跨语言构建难等。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"03-配好环境\"\u003e03 配好环境\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://go.dev/doc/devel/release\"\u003ehttps://go.dev/doc/devel/release\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://golang.google.cn/dl/\"\u003ehttps://golang.google.cn/dl/\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"安装多个-go-版本\"\u003e安装多个 Go 版本\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ego get golang.org/dl/go1.15.13\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ego1.15.13 download\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ego1.15.13 version\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"配置-go\"\u003e配置 Go\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ego env\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ego \u003cspan class=\"nb\"\u003ehelp\u003c/span\u003e environment\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"04-go-程序的结构\"\u003e04 Go 程序的结构\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003eimport \u0026quot;fmt\u0026quot;\u003c/code\u003e 一行中 \u003ccode\u003efmt\u003c/code\u003e 代表的是包的导入路径(Import)，它表示的是标准库下的 fmt 目录，整个 import 声明语句的含义是导入标准库 fmt 目录下的包\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003efmt.Println\u003c/code\u003e 函数调用一行中的 \u003ccode\u003efmt\u003c/code\u003e 代表的则是包名。\u003c/li\u003e\n\u003cli\u003e通常导入路径的最后一个分段名与包名是相同的，这也很容易让人误解 import 声明语句中的 \u003ccode\u003efmt\u003c/code\u003e 指的是包名，其实并不是这样的。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003egofmt\u003c/span\u003e \u003cspan class=\"nx\"\u003emain\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ego\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"go-module\"\u003eGo module\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ego mod init\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ego mod tidy\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"05-go-项目的布局标准\"\u003e05 Go 项目的布局标准\u003c/h2\u003e\n\u003cp\u003eloccount 工具\u003c/p\u003e","title":"Go 语言第一课"},{"content":" 犯错的人不会沉浸在错误里，而是继续战斗。 —— 管泽元 S12 总决赛 DRX vs SKT 2:2\n\u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2022/12/31/review-2022/","summary":"\u003cblockquote\u003e\n\u003cp\u003e犯错的人不会沉浸在错误里，而是继续战斗。 —— 管泽元 S12 总决赛 DRX vs SKT 2:2\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003e\u0026ndash; EOF \u0026ndash;\u003c/p\u003e","title":"回顾 2022"},{"content":" 实验环境：https://onlinephp.io/ https://www.php.net/releases/8.1/en.php https://www.php.net/manual/en/migration81.php https://php.watch/versions/8.1 https://github.com/symfony/polyfill/tree/1.x/src/Php81 PHP 8.1 contains many new features, including enums, readonly properties, first-class callable syntax, fibers, intersection types, performance improvements and more.\nNew Features 8.1 // Add native support for enumerations using enum keyword // https://www.php.net/manual/en/language.enumerations.examples.php enum Status: string { case Draft = \u0026#39;draft\u0026#39;; case Published = \u0026#39;published\u0026#39;; case Archived = \u0026#39;archived\u0026#39;; } class BlogPost { public function __construct( public Status $status = Status::Draft ) {} } // Readonly properties // Properties can be marked as immutable after initialization class User { public readonly string $uuid; public function __construct(string $uuid) { $this-\u0026gt;uuid = $uuid; } } // Fibers, new concurrency primitive for managing green threads // https://www.php.net/manual/en/language.fibers.php $fiber = new Fiber(function(): void { echo \u0026#34;Starting fiber\\n\u0026#34;; Fiber::suspend(); echo \u0026#34;Resuming fiber\\n\u0026#34;; }); $fiber-\u0026gt;start(); echo \u0026#34;...\\n\u0026#34;; $fiber-\u0026gt;resume(); // Starting fiber // ... // Resuming fiber // Intersection Types, combine multiple type constraints // 交叉类型 function countItems(Iterator\u0026amp;Countable $items): int { return count($items); } // Never Return Type // Indicates function never returns function redirect(string $url): never { header(\u0026#34;Location: $url\u0026#34;); exit(); } // First-Class Callable Syntax // Replaces Closure::fromCallable() with cleaner syntax $strlen = strlen(...); echo $strlen(\u0026#39;hello\u0026#39;); // 5 // same as $fn = Closure::fromCallable(\u0026#39;strlen\u0026#39;); echo $fn(\u0026#39;hello\u0026#39;); // 5 $words = [\u0026#39;apple\u0026#39;, \u0026#39;banana\u0026#39;]; var_dump(array_map(strlen(...), $words)); // [5, 6] class Calculator { public function add(int $a, int $b): int { return $a + $b; } public function __invoke(int $x) { return $x * 2; } } $calc = new Calculator(); $addCallable = $calc-\u0026gt;add(...); echo $addCallable(3, 5); // 8 $invocable = $calc(...); echo $invocable(10); // 20 // New Array Features // String key unpacking $arr1 = [1, \u0026#39;a\u0026#39; =\u0026gt; \u0026#39;b\u0026#39;]; var_dump([...$arr1, \u0026#39;c\u0026#39; =\u0026gt; \u0026#39;d\u0026#39;]); // [1,\u0026#39;a\u0026#39; =\u0026gt; \u0026#39;b\u0026#39;, \u0026#39;c\u0026#39; =\u0026gt; \u0026#39;d\u0026#39;] // 参数解包后的命名参数 function foo($a, $b, $c) { var_dump($a, $b, $c); } foo(...[1,2], c: 3); // File System Improvements $file = fopen(\u0026#39;data.txt\u0026#39;, \u0026#39;w\u0026#39;); fwrite($file, \u0026#39;content\u0026#39;); fsync($file); // Force write to disk fclose($file); // Objects in default parameters // 现在可以使用 new ClassName() 表达式作为参数、静态变量、全局常量初始值设定项和属性参数的默认值 // 现在也可以将对象传递给 define() class Logger { public function __construct( private Formatter $fmt = new DefaultFormatter() ) {} } // 八进制 var_dump(0o14); // int(12) New Functions 8.1 // 如果数组的键由从 0 到 count($array)-1 的连续数字组成，则数组被认为是 list array_is_list([]); // true array_is_list([\u0026#39;apple\u0026#39;, 2, 3]); // true array_is_list([0 =\u0026gt; \u0026#39;apple\u0026#39;, \u0026#39;orange\u0026#39;]); // true // The array does not start at 0 array_is_list([1 =\u0026gt; \u0026#39;apple\u0026#39;, \u0026#39;orange\u0026#39;]); // false Backward Incompatible Changes 8.1 // Usage of static Variables in Inherited Methods ¶ class A { public static function counter() { static $i = 0; return ++$i; } } class B extends A {} var_dump(A::counter()); // int(1) var_dump(A::counter()); // int(2) var_dump(B::counter()); // PHP 8.0 int(1) // PHP 8.1+ int(3) Deprecated 8.1 // Implicit incompatible float to int conversions $arr = []; $arr[3.14] = \u0026#39;value\u0026#39;; // Deprecated（键值3.14转为3） $arr[(int)3.14] = \u0026#39;value\u0026#39;; // 显式转换避免警告 \u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2022/12/21/php-migrating-80-to-81/","summary":"\u003cul\u003e\n\u003cli\u003e实验环境：\u003ca href=\"https://onlinephp.io/\"\u003ehttps://onlinephp.io/\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.php.net/releases/8.1/en.php\"\u003ehttps://www.php.net/releases/8.1/en.php\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.php.net/manual/en/migration81.php\"\u003ehttps://www.php.net/manual/en/migration81.php\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://php.watch/versions/8.1\"\u003ehttps://php.watch/versions/8.1\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/symfony/polyfill/tree/1.x/src/Php81\"\u003ehttps://github.com/symfony/polyfill/tree/1.x/src/Php81\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cblockquote\u003e\n\u003cp\u003ePHP 8.1 contains many new features, including enums, readonly properties, first-class callable syntax, fibers, intersection types, performance improvements and more.\u003c/p\u003e\u003c/blockquote\u003e\n\u003ch2 id=\"new-features-81\"\u003eNew Features 8.1\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Add native support for enumerations using enum keyword\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// https://www.php.net/manual/en/language.enumerations.examples.php\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nx\"\u003eenum\u003c/span\u003e \u003cspan class=\"nx\"\u003eStatus\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"nx\"\u003estring\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003ecase\u003c/span\u003e \u003cspan class=\"nx\"\u003eDraft\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;draft\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003ecase\u003c/span\u003e \u003cspan class=\"nx\"\u003ePublished\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;published\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003ecase\u003c/span\u003e \u003cspan class=\"nx\"\u003eArchived\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;archived\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eBlogPost\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003efunction\u003c/span\u003e \u003cspan class=\"fm\"\u003e__construct\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"nx\"\u003eStatus\u003c/span\u003e \u003cspan class=\"nv\"\u003e$status\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003eStatus\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"na\"\u003eDraft\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Readonly properties\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Properties can be marked as immutable after initialization\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eUser\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"nx\"\u003ereadonly\u003c/span\u003e \u003cspan class=\"nx\"\u003estring\u003c/span\u003e \u003cspan class=\"nv\"\u003e$uuid\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003efunction\u003c/span\u003e \u003cspan class=\"fm\"\u003e__construct\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003estring\u003c/span\u003e \u003cspan class=\"nv\"\u003e$uuid\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nv\"\u003e$this\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"na\"\u003euuid\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nv\"\u003e$uuid\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Fibers, new concurrency primitive for managing green threads\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// https://www.php.net/manual/en/language.fibers.php\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nv\"\u003e$fiber\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003eFiber\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003efunction\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"nx\"\u003evoid\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eecho\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Starting fiber\u003c/span\u003e\u003cspan class=\"se\"\u003e\\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003eFiber\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"na\"\u003esuspend\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eecho\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Resuming fiber\u003c/span\u003e\u003cspan class=\"se\"\u003e\\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e});\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$fiber\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"na\"\u003estart\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eecho\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;...\u003c/span\u003e\u003cspan class=\"se\"\u003e\\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$fiber\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"na\"\u003eresume\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Starting fiber\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// ...\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Resuming fiber\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Intersection Types, combine multiple type constraints\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 交叉类型\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003efunction\u003c/span\u003e \u003cspan class=\"nf\"\u003ecountItems\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eIterator\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"nx\"\u003eCountable\u003c/span\u003e \u003cspan class=\"nv\"\u003e$items\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"nx\"\u003eint\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nx\"\u003ecount\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$items\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Never Return Type\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Indicates function never returns\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003efunction\u003c/span\u003e \u003cspan class=\"nf\"\u003eredirect\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003estring\u003c/span\u003e \u003cspan class=\"nv\"\u003e$url\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"nx\"\u003enever\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003eheader\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;Location: \u003c/span\u003e\u003cspan class=\"si\"\u003e$url\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eexit\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// First-Class Callable Syntax\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Replaces Closure::fromCallable() with cleaner syntax\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nv\"\u003e$strlen\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003estrlen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e...\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eecho\u003c/span\u003e \u003cspan class=\"nv\"\u003e$strlen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;hello\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"c1\"\u003e// 5\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// same as\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nv\"\u003e$fn\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003eClosure\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"na\"\u003efromCallable\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;strlen\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eecho\u003c/span\u003e \u003cspan class=\"nv\"\u003e$fn\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;hello\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"c1\"\u003e// 5\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$words\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;apple\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;banana\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e];\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003earray_map\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003estrlen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e...\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"nv\"\u003e$words\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e \u003cspan class=\"c1\"\u003e// [5, 6]\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eCalculator\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003efunction\u003c/span\u003e \u003cspan class=\"nf\"\u003eadd\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eint\u003c/span\u003e \u003cspan class=\"nv\"\u003e$a\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eint\u003c/span\u003e \u003cspan class=\"nv\"\u003e$b\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"nx\"\u003eint\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nv\"\u003e$a\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"nv\"\u003e$b\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003efunction\u003c/span\u003e \u003cspan class=\"fm\"\u003e__invoke\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eint\u003c/span\u003e \u003cspan class=\"nv\"\u003e$x\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nv\"\u003e$x\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"mi\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$calc\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003eCalculator\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$addCallable\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nv\"\u003e$calc\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"na\"\u003eadd\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e...\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eecho\u003c/span\u003e \u003cspan class=\"nv\"\u003e$addCallable\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e3\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e5\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"c1\"\u003e// 8\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nv\"\u003e$invocable\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nv\"\u003e$calc\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e...\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eecho\u003c/span\u003e \u003cspan class=\"nv\"\u003e$invocable\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e10\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"c1\"\u003e// 20\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// New Array Features\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// String key unpacking\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nv\"\u003e$arr1\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;a\u0026#39;\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;b\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e];\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e([\u003c/span\u003e\u003cspan class=\"o\"\u003e...\u003c/span\u003e\u003cspan class=\"nv\"\u003e$arr1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;c\u0026#39;\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;d\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// [1,\u0026#39;a\u0026#39; =\u0026gt; \u0026#39;b\u0026#39;, \u0026#39;c\u0026#39; =\u0026gt; \u0026#39;d\u0026#39;]\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 参数解包后的命名参数\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003efunction\u003c/span\u003e \u003cspan class=\"nf\"\u003efoo\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$a\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$b\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$c\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$a\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$b\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$c\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003efoo\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e...\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"mi\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e \u003cspan class=\"nx\"\u003ec\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"mi\"\u003e3\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// File System Improvements\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nv\"\u003e$file\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003efopen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;data.txt\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;w\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003efwrite\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$file\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;content\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003efsync\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$file\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"c1\"\u003e// Force write to disk\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nx\"\u003efclose\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$file\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Objects in default parameters\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 现在可以使用 new ClassName() 表达式作为参数、静态变量、全局常量初始值设定项和属性参数的默认值\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 现在也可以将对象传递给 define()\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eLogger\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003efunction\u003c/span\u003e \u003cspan class=\"fm\"\u003e__construct\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"nx\"\u003eFormatter\u003c/span\u003e \u003cspan class=\"nv\"\u003e$fmt\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003eDefaultFormatter\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 八进制\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"nx\"\u003eo14\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// int(12)\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"new-functions-81\"\u003eNew Functions 8.1\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 如果数组的键由从 0 到 count($array)-1 的连续数字组成，则数组被认为是 list\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nx\"\u003earray_is_list\u003c/span\u003e\u003cspan class=\"p\"\u003e([]);\u003c/span\u003e \u003cspan class=\"c1\"\u003e// true\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nx\"\u003earray_is_list\u003c/span\u003e\u003cspan class=\"p\"\u003e([\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;apple\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e3\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e \u003cspan class=\"c1\"\u003e// true\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nx\"\u003earray_is_list\u003c/span\u003e\u003cspan class=\"p\"\u003e([\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;apple\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;orange\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e \u003cspan class=\"c1\"\u003e// true\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// The array does not start at 0\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nx\"\u003earray_is_list\u003c/span\u003e\u003cspan class=\"p\"\u003e([\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;apple\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;orange\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e \u003cspan class=\"c1\"\u003e// false\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"backward-incompatible-changes-81\"\u003eBackward Incompatible Changes 8.1\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Usage of static Variables in Inherited Methods ¶\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eA\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"k\"\u003efunction\u003c/span\u003e \u003cspan class=\"nf\"\u003ecounter\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"nv\"\u003e$i\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"o\"\u003e++\u003c/span\u003e\u003cspan class=\"nv\"\u003e$i\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eB\u003c/span\u003e \u003cspan class=\"k\"\u003eextends\u003c/span\u003e \u003cspan class=\"nx\"\u003eA\u003c/span\u003e \u003cspan class=\"p\"\u003e{}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eA\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"na\"\u003ecounter\u003c/span\u003e\u003cspan class=\"p\"\u003e());\u003c/span\u003e \u003cspan class=\"c1\"\u003e// int(1)\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eA\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"na\"\u003ecounter\u003c/span\u003e\u003cspan class=\"p\"\u003e());\u003c/span\u003e \u003cspan class=\"c1\"\u003e// int(2)\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eB\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"na\"\u003ecounter\u003c/span\u003e\u003cspan class=\"p\"\u003e());\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// PHP 8.0 int(1)\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// PHP 8.1+ int(3)\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"deprecated-81\"\u003eDeprecated 8.1\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Implicit incompatible float to int conversions\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nv\"\u003e$arr\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e[];\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$arr\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mf\"\u003e3.14\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;value\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"c1\"\u003e// Deprecated（键值3.14转为3）\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nv\"\u003e$arr\u003c/span\u003e\u003cspan class=\"p\"\u003e[(\u003c/span\u003e\u003cspan class=\"nx\"\u003eint\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"mf\"\u003e3.14\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;value\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"c1\"\u003e// 显式转换避免警告\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u0026ndash; EOF \u0026ndash;\u003c/p\u003e","title":"PHP Migrating 8.0 to 8.1"},{"content":" 实验环境：https://onlinephp.io/ https://www.php.net/releases/8.0/en.php https://www.php.net/manual/en/migration80.php https://php.watch/versions/8.0 https://github.com/symfony/polyfill/tree/1.x/src/Php80 PHP 8.0 contains many new features and optimizations including named arguments, union types, attributes, constructor property promotion, match expression, nullsafe operator, JIT, and improvements in the type system, error handling, and consistency.\nNew Features 8.0 // Named Parameters 命名参数 // https://www.php.net/manual/zh/functions.arguments.php#functions.named-arguments // array_fill(int $start_index, int $count, mixed $value): array var_dump(array_fill(value: 50, count: 3, start_index: 0)); // PHP80 [50, 50, 50] // 注解（Attributes） // https://www.php.net/manual/zh/language.attributes.php // 定义注解 -\u0026gt; 使用注解 -\u0026gt; （通过反射）提取注释 // 注意以后用词：Attributes 注解，Properties 属性 #[\\Attribute] class JsonSerialize { public function __construct(public ?string $fieldName = null) { var_dump(\u0026#34;JsonSerialize:$fieldName\u0026#34;); } } class VersionedObject { #[JsonSerialize(\u0026#39;json-foobar\u0026#39;)] protected string $myValue = \u0026#39;\u0026#39;; } $object = new VersionedObject(); $reflection = new ReflectionObject($object); foreach ($reflection-\u0026gt;getProperties() as $reflectionProp) { foreach ($reflectionProp-\u0026gt;getAttributes(JsonSerialize::class) as $jsonSerializeAttr) { var_dump($jsonSerializeAttr-\u0026gt;getName()); var_dump($jsonSerializeAttr-\u0026gt;getArguments()); var_dump($jsonSerializeAttr-\u0026gt;getTarget()); var_dump($jsonSerializeAttr-\u0026gt;isRepeated()); var_dump($jsonSerializeAttr-\u0026gt;newInstance()); } } // string(13) \u0026#34;JsonSerialize\u0026#34; // // array(1) { // [0]=\u0026gt; // string(11) \u0026#34;json-foobar\u0026#34; // } // // int(8) Attribute::TARGET_PROPERTY // // bool(false) // // string(25) \u0026#34;JsonSerialize:json-foobar\u0026#34; // object(JsonSerialize)#5 (1) { // [\u0026#34;fieldName\u0026#34;]=\u0026gt; // string(11) \u0026#34;json-foobar\u0026#34; // } // 构造器属性提升 Constructor Property Promotion // 当构造器参数带访问控制（visibility modifier）时，PHP 会同时把它当作对象属性和构造器参数，并赋值到属性 class Point { public function __construct(protected int $x, protected int $y = 0) {} } var_dump(new Point(2,4)); // object(Point)#1 (2) { // [\u0026#34;x\u0026#34;:protected]=\u0026gt; // int(2) // [\u0026#34;y\u0026#34;:protected]=\u0026gt; // int(4) // } class Point2 { protected int $x; protected int $y; public function __construct(protected int $x, protected int $y = 0) {} } // 此类中已经定义了具有相同名称的字段 // Fatal error: Cannot redeclare Point::$x // Union types 联合类型 // ?T is same T|null // // - 类型只能出现一次 int|string|INT 否则报错 // - 使用 mixed 会报错 // - bool 与 false or true 不能混用 // - object 与 class 不能混用 // - iterable 与 array Traversable 不能混用 // - 使用 self、parent 或 static 都会导致错误 public function parse_value(string|int|float): string|null {} // match 表达式 // https://www.php.net/manual/en/control-structures.match.php // match 表达式必须是详尽，则会抛出 UnhandledMatchError。 echo match (8.0) { \u0026#39;8.0\u0026#39; =\u0026gt; \u0026#34;Oh no!\u0026#34;, 8.0 =\u0026gt; \u0026#34;This matches\u0026#34;, }; // This matches // Nullsafe Operator $result = $repository?-\u0026gt;getUser(5)?-\u0026gt;name; // Is equivalent to the following code block: if (is_null($repository)) { $result = null; } else { $user = $repository-\u0026gt;getUser(5); if (is_null($user)) { $result = null; } else { $result = $user-\u0026gt;name; } } // Argument Unpacking echo str_replace(...[ \u0026#39;replace\u0026#39; =\u0026gt; \u0026#39;Iron Man\u0026#39;, \u0026#39;search\u0026#39; =\u0026gt; \u0026#39;Inevitable\u0026#39;, \u0026#39;subject\u0026#39; =\u0026gt; \u0026#39;I am Inevitable\u0026#39;, ]); // Named Parameters with Variadic Parameters function test($a, $b, ...$args) { var_dump($args); } test(28, 15, june: 6, september: 15, january: \u0026#34;01\u0026#34;); // array(3) { // [\u0026#34;june\u0026#34;]=\u0026gt; int(6) // [\u0026#34;september\u0026#34;]=\u0026gt; int(15) // [\u0026#34;january\u0026#34;]=\u0026gt; string(2) \u0026#34;01\u0026#34; // } // JIT Just-In-Time Compilation // php -i | grep -i opcache // php -d opcache.enable_cli=1 -d opcache.jit_buffer_size=256M -d opcache.jit=tracing -i | grep -i jit // opcache.enable=1 // opcache.enable_cli=1 // opcache.jit_buffer_size=256M \u0026lt;?php function fibonacci($n) { if ($n \u0026lt; 2) return $n; return fibonacci($n - 1) + fibonacci($n - 2); } $start = microtime(true); fibonacci(42); $end = microtime(true); echo \u0026#34;Time taken: \u0026#34; . ($end - $start) . \u0026#34; seconds\\n\u0026#34;; // php -d opcache.enable_cli=1 -d opcache.jit_buffer_size=256M -d opcache.jit=tracing test.php // The WeakMap class has been added, accepts objects as keys, similar SplObjectStorage // https://www.php.net/manual/en/class.weakmap.php // https://www.php.net/manual/en/class.splobjectstorage.php // final class WeakMap implements ArrayAccess, Countable, IteratorAggregate $wm = new WeakMap(); $o = new StdClass; class A { public function __destruct() { echo \u0026#34;Dead!\\n\u0026#34;; } } $wm[$o] = new A; var_dump(count($wm)); // int(1) unset($o); // Dead! // 销毁 var_dump(count($wm)); // int(0) // 对比 SplObjectStorage $wm = new SplObjectStorage(); $o = new StdClass; class A { public function __destruct() { echo \u0026#34;Dead!\\n\u0026#34;; } } $wm[$o] = new A; var_dump(count($wm)); // int(1) unset($o); // 未销毁 var_dump(count($wm)); // int(1) // 只要类型兼容，现在可以将任意数量的函数参数替换为可变参数 variadic argument class A { public function method(int $many, string $parameters, $here) {} } class B extends A { public function method(...$everything) {} } // OK class C extends A { public function method(int ...$everything) {} } // Fatal error: Declaration of C::method(int ...$everything) // static 后期静态绑定，现在可以用作返回类型 class Test { public function create(): static { return new static(); } } // get_class($obj) === $obj::class class Test {} $obj = new Test; var_dump($obj::class); var_dump(get_class($obj)); // new instanceof 可以与任意表达式一起使用 // new (expression)(...$args) // $obj instanceof (expression) class A{}; class B{}; new (1\u0026gt;2 ? \u0026#34;A\u0026#34; : \u0026#34;B\u0026#34;)(); // 新增 Stringable 接口。如果 class 定义了 __toString()，则自动实现了此接口 // Traits can define abstract private methods trait T { abstract private function a(); } // Throw 可以作为一个表达式 as an expression $value = $config[\u0026#39;path\u0026#39;] ?? throw new InvalidArgumentException(\u0026#39;path required\u0026#39;); $fn = fn() =\u0026gt; throw new Exception(\u0026#39;Exception in arrow function\u0026#39;); // 参数列表中现在允许使用可选的尾随逗号 function functionWithLongSignature( Type1 $parameter1, Type2 $parameter2, // \u0026lt;-- This comma is now allowed. ) {} // 允许 catch (Exception) 无需存储到变量 try {} catch (Exception) {} // 在父类上声明的私有方法不再对子类的方法强制执行任何继承规则（私有构造函数除外） class ParentClass { private function method1() {} private function method2() {} private static function method3() {} } abstract class ChildClass extends ParentClass { public abstract function method1(); public static function method2() {} public function method3() {} } // OK // New string functions str_contains(\u0026#39;Foobar\u0026#39;, \u0026#39;Foo\u0026#39;); // true str_starts_with(\u0026#39;PHP 8\u0026#39;, \u0026#39;PHP\u0026#39;); // true str_ends_with(\u0026#39;Version8\u0026#39;, \u0026#39;8\u0026#39;); // true Backward Incompatible Changes 8.0 // 字符串与数字比较 // 0 == \u0026#34;not-a-number\u0026#34; is false // 将数字转换为字符串，并使用字符串比较 var_dump(0 == \u0026#34;foo\u0026#34;); var_dump(42 == \u0026#34;42foo\u0026#34;); var_dump(0 == \u0026#34;\u0026#34;); // PHP80 PHP74 // bool(false) true // bool(false) true // bool(false) true var_dump(\u0026#34;\u0026#34; \u0026lt; 0); var_dump(\u0026#34;\u0026#34; \u0026lt; -1); var_dump(\u0026#34;a\u0026#34; \u0026lt; 0); var_dump(\u0026#34;b\u0026#34; \u0026lt; -1); var_dump(\u0026#34;ab\u0026#34; \u0026gt; 0); // PHP80 PHP74 // bool(true) false // bool(true) false // bool(false) false // bool(false) false // bool(true) false // is_callable() 在检查具有 classname 的 non-static 方法时将 false（必须检查对象实例） class Test { public function method1() {} } var_dump(is_callable([Test::class, \u0026#39;method1\u0026#39;])); var_dump(is_callable([new Test, \u0026#39;method1\u0026#39;])); // PHP80 PHP74 // bool(false) true // bool(true) true // __autoload() function has been removed // 删除了对 object 使用 array_key_exists() 的能力。isset() or property_exists() may be used instead // isset($arr[\u0026#39;key\u0026#39;]) → false（当值为 null）- 只能在 null 安全时检查，无法区分 null 与 不存在 // array_key_exists(\u0026#39;key\u0026#39;, $arr) → true（即使值为 null）- 可以区分存在但值为 null 的情况 \u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2022/12/14/php-migrating-74-to-80/","summary":"\u003cul\u003e\n\u003cli\u003e实验环境：\u003ca href=\"https://onlinephp.io/\"\u003ehttps://onlinephp.io/\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.php.net/releases/8.0/en.php\"\u003ehttps://www.php.net/releases/8.0/en.php\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.php.net/manual/en/migration80.php\"\u003ehttps://www.php.net/manual/en/migration80.php\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://php.watch/versions/8.0\"\u003ehttps://php.watch/versions/8.0\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/symfony/polyfill/tree/1.x/src/Php80\"\u003ehttps://github.com/symfony/polyfill/tree/1.x/src/Php80\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cblockquote\u003e\n\u003cp\u003ePHP 8.0 contains many new features and optimizations including named arguments, union types, attributes, constructor property promotion, match expression, nullsafe operator, JIT, and improvements in the type system, error handling, and consistency.\u003c/p\u003e\u003c/blockquote\u003e\n\u003ch2 id=\"new-features-80\"\u003eNew Features 8.0\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Named Parameters 命名参数\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// https://www.php.net/manual/zh/functions.arguments.php#functions.named-arguments\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// array_fill(int $start_index, int $count, mixed $value): array\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003earray_fill\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003evalue\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"mi\"\u003e50\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003ecount\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"mi\"\u003e3\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003estart_index\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// PHP80 [50, 50, 50]\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 注解（Attributes）\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// https://www.php.net/manual/zh/language.attributes.php\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 定义注解 -\u0026gt; 使用注解 -\u0026gt; （通过反射）提取注释\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 注意以后用词：Attributes 注解，Properties 属性\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e#[\\Attribute]\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eJsonSerialize\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003efunction\u003c/span\u003e \u003cspan class=\"fm\"\u003e__construct\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"o\"\u003e?\u003c/span\u003e\u003cspan class=\"nx\"\u003estring\u003c/span\u003e \u003cspan class=\"nv\"\u003e$fieldName\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;JsonSerialize:\u003c/span\u003e\u003cspan class=\"si\"\u003e$fieldName\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eVersionedObject\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e#[JsonSerialize(\u0026#39;json-foobar\u0026#39;)]\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e    \u003cspan class=\"k\"\u003eprotected\u003c/span\u003e \u003cspan class=\"nx\"\u003estring\u003c/span\u003e \u003cspan class=\"nv\"\u003e$myValue\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$object\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003eVersionedObject\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$reflection\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003eReflectionObject\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$object\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eforeach\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$reflection\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"na\"\u003egetProperties\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"k\"\u003eas\u003c/span\u003e \u003cspan class=\"nv\"\u003e$reflectionProp\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eforeach\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$reflectionProp\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"na\"\u003egetAttributes\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eJsonSerialize\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"na\"\u003eclass\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003eas\u003c/span\u003e \u003cspan class=\"nv\"\u003e$jsonSerializeAttr\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$jsonSerializeAttr\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"na\"\u003egetName\u003c/span\u003e\u003cspan class=\"p\"\u003e());\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$jsonSerializeAttr\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"na\"\u003egetArguments\u003c/span\u003e\u003cspan class=\"p\"\u003e());\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$jsonSerializeAttr\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"na\"\u003egetTarget\u003c/span\u003e\u003cspan class=\"p\"\u003e());\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$jsonSerializeAttr\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"na\"\u003eisRepeated\u003c/span\u003e\u003cspan class=\"p\"\u003e());\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$jsonSerializeAttr\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"na\"\u003enewInstance\u003c/span\u003e\u003cspan class=\"p\"\u003e());\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// string(13) \u0026#34;JsonSerialize\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e//\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// array(1) {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e//   [0]=\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e//   string(11) \u0026#34;json-foobar\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// }\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e//\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// int(8) Attribute::TARGET_PROPERTY\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e//\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// bool(false)\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e//\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// string(25) \u0026#34;JsonSerialize:json-foobar\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// object(JsonSerialize)#5 (1) {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e//   [\u0026#34;fieldName\u0026#34;]=\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e//   string(11) \u0026#34;json-foobar\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// }\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 构造器属性提升 Constructor Property Promotion\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 当构造器参数带访问控制（visibility modifier）时，PHP 会同时把它当作对象属性和构造器参数，并赋值到属性\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003ePoint\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003efunction\u003c/span\u003e \u003cspan class=\"fm\"\u003e__construct\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003eprotected\u003c/span\u003e \u003cspan class=\"nx\"\u003eint\u003c/span\u003e \u003cspan class=\"nv\"\u003e$x\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003eprotected\u003c/span\u003e \u003cspan class=\"nx\"\u003eint\u003c/span\u003e \u003cspan class=\"nv\"\u003e$y\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003ePoint\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"mi\"\u003e4\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// object(Point)#1 (2) {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e//   [\u0026#34;x\u0026#34;:protected]=\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e//   int(2)\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e//   [\u0026#34;y\u0026#34;:protected]=\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e//   int(4)\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// }\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003ePoint2\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eprotected\u003c/span\u003e \u003cspan class=\"nx\"\u003eint\u003c/span\u003e \u003cspan class=\"nv\"\u003e$x\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eprotected\u003c/span\u003e \u003cspan class=\"nx\"\u003eint\u003c/span\u003e \u003cspan class=\"nv\"\u003e$y\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003efunction\u003c/span\u003e \u003cspan class=\"fm\"\u003e__construct\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003eprotected\u003c/span\u003e \u003cspan class=\"nx\"\u003eint\u003c/span\u003e \u003cspan class=\"nv\"\u003e$x\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003eprotected\u003c/span\u003e \u003cspan class=\"nx\"\u003eint\u003c/span\u003e \u003cspan class=\"nv\"\u003e$y\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 此类中已经定义了具有相同名称的字段\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Fatal error: Cannot redeclare Point::$x\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Union types 联合类型\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// ?T is same T|null\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e//\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// - 类型只能出现一次 int|string|INT 否则报错\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// - 使用 mixed 会报错\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// - bool 与 false or true 不能混用\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// - object 与 class 不能混用\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// - iterable 与 array Traversable 不能混用\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// - 使用 self、parent 或 static 都会导致错误\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003efunction\u003c/span\u003e \u003cspan class=\"nf\"\u003eparse_value\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003estring\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"nx\"\u003eint\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"nx\"\u003efloat\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"nx\"\u003estring\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"k\"\u003enull\u003c/span\u003e \u003cspan class=\"p\"\u003e{}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// match 表达式\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// https://www.php.net/manual/en/control-structures.match.php\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// match 表达式必须是详尽，则会抛出 UnhandledMatchError。\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003eecho\u003c/span\u003e \u003cspan class=\"nx\"\u003ematch\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mf\"\u003e8.0\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"s1\"\u003e\u0026#39;8.0\u0026#39;\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Oh no!\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"mf\"\u003e8.0\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;This matches\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e};\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// This matches\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Nullsafe Operator\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nv\"\u003e$result\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nv\"\u003e$repository\u003c/span\u003e\u003cspan class=\"o\"\u003e?-\u0026gt;\u003c/span\u003e\u003cspan class=\"na\"\u003egetUser\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e5\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"o\"\u003e?-\u0026gt;\u003c/span\u003e\u003cspan class=\"na\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Is equivalent to the following code block:\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eis_null\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$repository\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nv\"\u003e$result\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"k\"\u003eelse\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nv\"\u003e$user\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nv\"\u003e$repository\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"na\"\u003egetUser\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e5\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eis_null\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$user\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nv\"\u003e$result\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"k\"\u003eelse\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nv\"\u003e$result\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nv\"\u003e$user\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"na\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Argument Unpacking\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003eecho\u003c/span\u003e \u003cspan class=\"nx\"\u003estr_replace\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e...\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"s1\"\u003e\u0026#39;replace\u0026#39;\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;Iron Man\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"s1\"\u003e\u0026#39;search\u0026#39;\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;Inevitable\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"s1\"\u003e\u0026#39;subject\u0026#39;\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;I am Inevitable\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Named Parameters with Variadic Parameters\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003efunction\u003c/span\u003e \u003cspan class=\"nf\"\u003etest\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$a\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$b\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"o\"\u003e...\u003c/span\u003e\u003cspan class=\"nv\"\u003e$args\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$args\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003etest\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e28\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e15\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003ejune\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"mi\"\u003e6\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eseptember\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"mi\"\u003e15\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003ejanuary\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;01\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// array(3) {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e//     [\u0026#34;june\u0026#34;]=\u0026gt; int(6)\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e//     [\u0026#34;september\u0026#34;]=\u0026gt; int(15)\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e//     [\u0026#34;january\u0026#34;]=\u0026gt; string(2) \u0026#34;01\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// }\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// JIT Just-In-Time Compilation\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// php -i | grep -i opcache\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// php -d opcache.enable_cli=1 -d opcache.jit_buffer_size=256M -d opcache.jit=tracing -i | grep -i jit\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// opcache.enable=1\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// opcache.enable_cli=1\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// opcache.jit_buffer_size=256M\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e\u0026lt;?\u003c/span\u003e\u003cspan class=\"nx\"\u003ephp\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003efunction\u003c/span\u003e \u003cspan class=\"nf\"\u003efibonacci\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$n\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$n\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"mi\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nv\"\u003e$n\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nx\"\u003efibonacci\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$n\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"nx\"\u003efibonacci\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$n\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e \u003cspan class=\"mi\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$start\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003emicrotime\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003efibonacci\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e42\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$end\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003emicrotime\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eecho\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Time taken: \u0026#34;\u003c/span\u003e \u003cspan class=\"o\"\u003e.\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$end\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e \u003cspan class=\"nv\"\u003e$start\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e.\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34; seconds\u003c/span\u003e\u003cspan class=\"se\"\u003e\\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// php -d opcache.enable_cli=1 -d opcache.jit_buffer_size=256M -d opcache.jit=tracing test.php\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// The WeakMap class has been added, accepts objects as keys, similar SplObjectStorage\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// https://www.php.net/manual/en/class.weakmap.php\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// https://www.php.net/manual/en/class.splobjectstorage.php\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// final class WeakMap implements ArrayAccess, Countable, IteratorAggregate\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nv\"\u003e$wm\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003eWeakMap\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$o\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"k\"\u003eStdClass\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eA\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003efunction\u003c/span\u003e \u003cspan class=\"fm\"\u003e__destruct\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003eecho\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Dead!\u003c/span\u003e\u003cspan class=\"se\"\u003e\\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$wm\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"nv\"\u003e$o\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003eA\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ecount\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$wm\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// int(1)\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nx\"\u003eunset\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$o\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Dead!\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 销毁\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ecount\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$wm\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// int(0)\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 对比 SplObjectStorage\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nv\"\u003e$wm\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003eSplObjectStorage\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$o\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"k\"\u003eStdClass\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eA\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003efunction\u003c/span\u003e \u003cspan class=\"fm\"\u003e__destruct\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003eecho\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Dead!\u003c/span\u003e\u003cspan class=\"se\"\u003e\\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$wm\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"nv\"\u003e$o\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003eA\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ecount\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$wm\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// int(1)\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nx\"\u003eunset\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$o\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 未销毁\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ecount\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$wm\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// int(1)\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 只要类型兼容，现在可以将任意数量的函数参数替换为可变参数 variadic argument\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eA\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003efunction\u003c/span\u003e \u003cspan class=\"nf\"\u003emethod\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eint\u003c/span\u003e \u003cspan class=\"nv\"\u003e$many\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003estring\u003c/span\u003e \u003cspan class=\"nv\"\u003e$parameters\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$here\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eB\u003c/span\u003e \u003cspan class=\"k\"\u003eextends\u003c/span\u003e \u003cspan class=\"nx\"\u003eA\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003efunction\u003c/span\u003e \u003cspan class=\"nf\"\u003emethod\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e...\u003c/span\u003e\u003cspan class=\"nv\"\u003e$everything\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// OK\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eC\u003c/span\u003e \u003cspan class=\"k\"\u003eextends\u003c/span\u003e \u003cspan class=\"nx\"\u003eA\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003efunction\u003c/span\u003e \u003cspan class=\"nf\"\u003emethod\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eint\u003c/span\u003e \u003cspan class=\"o\"\u003e...\u003c/span\u003e\u003cspan class=\"nv\"\u003e$everything\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Fatal error: Declaration of C::method(int ...$everything)\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// static 后期静态绑定，现在可以用作返回类型\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eTest\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003efunction\u003c/span\u003e \u003cspan class=\"nf\"\u003ecreate\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// get_class($obj) === $obj::class\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eTest\u003c/span\u003e \u003cspan class=\"p\"\u003e{}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$obj\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003eTest\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$obj\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"na\"\u003eclass\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eget_class\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$obj\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// new instanceof 可以与任意表达式一起使用\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// new (expression)(...$args)\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// $obj instanceof (expression)\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eA\u003c/span\u003e\u003cspan class=\"p\"\u003e{};\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eB\u003c/span\u003e\u003cspan class=\"p\"\u003e{};\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"mi\"\u003e2\u003c/span\u003e \u003cspan class=\"o\"\u003e?\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;A\u0026#34;\u003c/span\u003e \u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;B\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e)();\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 新增 Stringable 接口。如果 class 定义了 __toString()，则自动实现了此接口\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Traits can define abstract private methods\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003etrait\u003c/span\u003e \u003cspan class=\"nx\"\u003eT\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eabstract\u003c/span\u003e \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003efunction\u003c/span\u003e \u003cspan class=\"nf\"\u003ea\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Throw 可以作为一个表达式 as an expression\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nv\"\u003e$value\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nv\"\u003e$config\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;path\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e??\u003c/span\u003e \u003cspan class=\"k\"\u003ethrow\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003eInvalidArgumentException\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;path required\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$fn\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003efn\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"k\"\u003ethrow\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003eException\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;Exception in arrow function\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 参数列表中现在允许使用可选的尾随逗号\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003efunction\u003c/span\u003e \u003cspan class=\"nf\"\u003efunctionWithLongSignature\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003eType1\u003c/span\u003e \u003cspan class=\"nv\"\u003e$parameter1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003eType2\u003c/span\u003e \u003cspan class=\"nv\"\u003e$parameter2\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"c1\"\u003e// \u0026lt;-- This comma is now allowed.\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 允许 catch (Exception) 无需存储到变量\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003etry\u003c/span\u003e \u003cspan class=\"p\"\u003e{}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003ecatch\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eException\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 在父类上声明的私有方法不再对子类的方法强制执行任何继承规则（私有构造函数除外）\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eParentClass\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003efunction\u003c/span\u003e \u003cspan class=\"nf\"\u003emethod1\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003efunction\u003c/span\u003e \u003cspan class=\"nf\"\u003emethod2\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"k\"\u003efunction\u003c/span\u003e \u003cspan class=\"nf\"\u003emethod3\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eabstract\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eChildClass\u003c/span\u003e \u003cspan class=\"k\"\u003eextends\u003c/span\u003e \u003cspan class=\"nx\"\u003eParentClass\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eabstract\u003c/span\u003e \u003cspan class=\"k\"\u003efunction\u003c/span\u003e \u003cspan class=\"nf\"\u003emethod1\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"k\"\u003efunction\u003c/span\u003e \u003cspan class=\"nf\"\u003emethod2\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003efunction\u003c/span\u003e \u003cspan class=\"nf\"\u003emethod3\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// OK\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// New string functions\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nx\"\u003estr_contains\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;Foobar\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;Foo\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"c1\"\u003e// true\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nx\"\u003estr_starts_with\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;PHP 8\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;PHP\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"c1\"\u003e// true\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nx\"\u003estr_ends_with\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;Version8\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;8\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"c1\"\u003e// true\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"backward-incompatible-changes-80\"\u003eBackward Incompatible Changes 8.0\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 字符串与数字比较\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 0 == \u0026#34;not-a-number\u0026#34; is false\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 将数字转换为字符串，并使用字符串比较\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e \u003cspan class=\"o\"\u003e==\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;foo\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e42\u003c/span\u003e \u003cspan class=\"o\"\u003e==\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;42foo\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e \u003cspan class=\"o\"\u003e==\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// PHP80           PHP74\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// bool(false)     true\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// bool(false)     true\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// bool(false)     true\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u0026#34;\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u0026#34;\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;a\u0026#34;\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;b\u0026#34;\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;ab\u0026#34;\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// PHP80           PHP74\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// bool(true)      false\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// bool(true)      false\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// bool(false)     false\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// bool(false)     false\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// bool(true)      false\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// is_callable() 在检查具有 classname 的 non-static 方法时将 false（必须检查对象实例）\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eTest\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003efunction\u003c/span\u003e \u003cspan class=\"nf\"\u003emethod1\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eis_callable\u003c/span\u003e\u003cspan class=\"p\"\u003e([\u003c/span\u003e\u003cspan class=\"nx\"\u003eTest\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"na\"\u003eclass\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;method1\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e]));\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eis_callable\u003c/span\u003e\u003cspan class=\"p\"\u003e([\u003c/span\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003eTest\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;method1\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e]));\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// PHP80           PHP74\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// bool(false)     true\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// bool(true)      true\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// __autoload() function has been removed\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 删除了对 object 使用 array_key_exists() 的能力。isset() or property_exists() may be used instead\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// isset($arr[\u0026#39;key\u0026#39;]) → false（当值为 null）- 只能在 null 安全时检查，无法区分 null 与 不存在\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// array_key_exists(\u0026#39;key\u0026#39;, $arr) → true（即使值为 null）- 可以区分存在但值为 null 的情况\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u0026ndash; EOF \u0026ndash;\u003c/p\u003e","title":"PHP Migrating 7.4 to 8.0"},{"content":" 实验环境：https://onlinephp.io/ PHP7.1 to PHP7.2 https://www.php.net/manual/en/migration72.php https://php.watch/versions/7.2 Argon2 password hashing support, class constant visibility, object type, and many more.\nNew Features 7.2 // 新的 object 类型 // 可用于逆变（contravariant）参数输入和协变（covariant）返回任何对象类型 // https://www.php.net/manual/zh/language.oop5.variance.php // 协变使子类比父类方法能返回更具体的类型；逆变使子类比父类方法参数类型能接受更模糊的类型 function test(object $obj): object { return new SplQueue(); } test(new StdClass()); // 抽象类可以重写被继承的抽象类的抽象方法 abstract class A { abstract function test(string $s); } abstract class B extends A { // overridden - 仍然保持参数的逆变和返回的逆变 abstract function test($s): int; } // 重写方法和接口实现的参数类型可以省略 // 仍然是符合LSP，这种参数类型是逆变 interface A { public function test(array $input); } class B implements A { // type omitted for $input public function test($input){ return $input; } } var_dump((new B())-\u0026gt;test(1)); // PHP72 int(1) // // PHP71 Fatal error: Declaration of B::test($input) must be compatible with A::test(array $input) Backward incompatible changes 7.2 // 防止 number_format() 返回负零 var_dump(number_format(-0.01)); // PHP72 string(1) \u0026#34;0\u0026#34; // // PHP71 string(2) \u0026#34;-0\u0026#34; // 转换对象和数组中的数字键 $arr = [0 =\u0026gt; 1]; $obj = (object) $arr; var_dump($obj); var_dump($obj-\u0026gt;{\u0026#39;0\u0026#39;}, // 新写法 $obj-\u0026gt;{0} // 新写法 ); // PHP72 object(stdClass)#1 (1) { // [\u0026#34;0\u0026#34;]=\u0026gt; // int(1) // } // int(1) // int(1) // // PHP71 object(stdClass)#1 (1) { // [0]=\u0026gt; // int(1) // } // Notice: Undefined property: stdClass::$0 $obj = new class { public function __construct() { $this-\u0026gt;{1} = \u0026#34;value\u0026#34;; } }; $arr = (array) $obj; var_dump($arr); var_dump($arr[\u0026#34;1\u0026#34;]); // 整数 或者 字符串整数 含义相同 var_dump($arr[1]); // PHP71 var_dump($arr[0]); // PHP72 array(1) { // [1]=\u0026gt; // string(2) \u0026#34;my\u0026#34; // } // // PHP71 无法取整型字符串 key // array(1) { // [\u0026#34;1\u0026#34;]=\u0026gt; // string(2) \u0026#34;my\u0026#34; // } // Notice: Undefined offset: 1 // Notice: Undefined offset: 1 // Notice: Undefined offset: 0 $a = [1.3 =\u0026gt; \u0026#34;v1\u0026#34;, 1.4 =\u0026gt; \u0026#34;v2\u0026#34;]; var_dump($a); // ALL array key float 会被转换为 int // array(1) { // [1]=\u0026gt; // string(2) \u0026#34;v2\u0026#34; // } // get_class() 函数不再接受 null var_dump(get_class(null)); // PHP72 // Warning: get_class() expects parameter 1 to be object // bool(false) // // PHP71 // Warning: get_class() called without object from outside a class // bool(false) // // PHP80 // Fatal error: Uncaught TypeError: get_class(): Argument #1 ($object) must be of type object, null given // 计算非可数类型（non-countable）时发出警告 var_dump( count(null), // NULL is not countable count(1), // integers are not countable count(\u0026#39;abc\u0026#39;), // strings are not countable count(new stdclass) // objects not implementing the Countable interface are not countable ); // PHP72 // Warning: count(): Parameter must be an array or an object that implements Countable // // PHP71 // 无 Warning // // PHP80 // Fatal error: Uncaught TypeError: count(): Argument #1 ($value) must be of type Countable|array // 调用未定义的常量，现在会抛出一个 E_WARNING 错误（之前版本中为 E_NOTICE)） // PHP8 将不会转化成他们自身的字符串，同时抛出 Error 异常 var_dump(MY_CONST); // PHP72 // Warning: Use of undefined constant MY_CONST - assumed \u0026#39;MY_CONST\u0026#39; // string(8) \u0026#34;MY_CONST\u0026#34; // // PHP71 // Notice: Use of undefined constant MY_CONST // string(8) \u0026#34;MY_CONST\u0026#34; // // PHP80 // Fatal error: Uncaught Error: Undefined constant \u0026#34;MY_CONST\u0026#34; // bcmod 任意精度数字取模，添加新增参数 scale var_dump(bcmod(\u0026#34;4\u0026#34;, \u0026#34;3.5\u0026#34;)); // PHP72 // string(1) \u0026#34;0\u0026#34; // // PHP71 // string(1) \u0026#34;1\u0026#34; var_dump(bcmod(\u0026#34;4\u0026#34;, \u0026#34;3.5\u0026#34;, 1)); // PHP72 // string(3) \u0026#34;0.5\u0026#34; // // PHP71 // Warning: bcmod() expects exactly 2 parameters, 3 given // json_decode associative 允许为 null // 当为 true 时，JSON 对象将返回关联 array；当为 false 时，JSON 对象将返回 object。 // 当为 null 时，JSON 对象将返回关联 array 或 object，这取决于是否在 flags 中设置 JSON_OBJECT_AS_ARRAY // https://www.php.net/manual/zh/function.json-decode.php $json = \u0026#39;{\u0026#34;a\u0026#34;:1,\u0026#34;b\u0026#34;:2}\u0026#39;; var_dump(json_decode($json, null, 512, JSON_OBJECT_AS_ARRAY)); // PHP72 // array(2) { // [\u0026#34;a\u0026#34;]=\u0026gt; // int(1) // [\u0026#34;b\u0026#34;]=\u0026gt; // int(2) // } // // PHP71 // object(stdClass)#1 (2) { // [\u0026#34;a\u0026#34;]=\u0026gt; // int(1) // [\u0026#34;b\u0026#34;]=\u0026gt; // int(2) // } PHP7.2 to PHP7.3 https://www.php.net/manual/en/migration72.php https://php.watch/versions/7.3 Heredoc/nowdoc syntax improvements and a bunch of legacy code deprecations.\nNew Features 7.3 // Heredoc Nowdoc 不再需要后跟分号或换行符 // 结束标记可以缩进，结束时所引用的标识符必须在该行的第一列 $values = [\u0026lt;\u0026lt;\u0026lt;END a b c END, \u0026#39;d e f\u0026#39;]; var_dump($values); // PHP73 array(2) { // [0]=\u0026gt; // string(13) \u0026#34;a // b // c\u0026#34; // [1]=\u0026gt; // string(5) \u0026#34;d e f\u0026#34; // } // // PHP72 Parse error: syntax error, unexpected end of file echo \u0026lt;\u0026lt;\u0026lt;END a b c END; // PHP73 // a // b // c // // PHP72 Parse error: syntax error, unexpected end of file, expecting variable (T_VARIABLE) or heredoc end (T_END_HEREDOC) or ${ (T_DOLLAR_OPEN_CURLY_BRACES) or {$ (T_CURLY_OPEN) echo \u0026lt;\u0026lt;\u0026lt;END a b c END; // PHP73 Parse error: Invalid body indentation level // 数组解构支持引用赋值 $arr = [[1], [1]]; [\u0026amp;$a, $b] = $arr; $a[] = 2; $b[] = 3; var_dump($arr); // PHP73 array(2) { // [0]=\u0026gt; // \u0026amp;array(2) { // [0]=\u0026gt; // int(1) // [1]=\u0026gt; // int(2) // } // [1]=\u0026gt; // array(1) { // [0]=\u0026gt; // int(1) // } // } // // PHP72 Fatal error: [] and list() assignments cannot be by reference // 允许将 literals 作为第一个操作数，always false var_dump(true instanceof stdClass); // PHP73 bool(false) // // PHP72 Fatal error: instanceof expects an object instance, constant given // 调用中允许尾随逗号 function my($v) { echo \u0026#34;php-{$v}\u0026#34;; } my(73,); // PHP73 php-73 // // PHP72 Parse error: syntax error, unexpected \u0026#39;)\u0026#39; New Functions 7.3 // Gets the first key of an array array_key_first(array $array): int|string|null // Gets the last key of an array array_key_last(array $array): int|string|null // Get the system\u0026#39;s high resolution time // [seconds, nanoseconds] int（64 位平台）或 float（32 位平台） hrtime(bool $as_number = false): array|int|float|false // 验证变量的内容是否为 countable 值 // return is_array($value) || $value instanceof Countable || $value instanceof ResourceBundle || $value instanceof SimpleXmlElement; is_countable(mixed $value): bool Backward Incompatible Changes 7.3 // Continue Targeting Switch 问题警告 $foo = 0; while ($foo \u0026lt; 10) { switch ($foo) { case \u0026#34;baz\u0026#34;: continue; } $foo++; } // PHP73 Warning: \u0026#34;continue\u0026#34; targeting switch is equivalent to \u0026#34;break\u0026#34;. Did you mean to use \u0026#34;continue 2\u0026#34;? // PHP72 ok // $obj[\u0026#34;123\u0026#34;] 类型的数组访问，其中 $obj 实现 ArrayAccess 且 \u0026#34;123\u0026#34; 是整数字符串文字将不再导致隐式转换为整数 // 数组的行为不会受到任何影响，它们继续将整数字符串键隐式转换为整数 class A implements \\ArrayAccess { public function offsetExists($offset) { } public function offsetGet($offset) { var_dump($offset); } public function offsetSet($offset, $value) { } public function offsetUnset($offset) { } } $a = new A(); $a[\u0026#34;123\u0026#34;]; // PHP73 string(3) \u0026#34;123\u0026#34; // PHP72 int(123) PHP7.3 to PHP7.4 https://www.php.net/manual/en/migration74.php https://php.watch/versions/7.4 PHP 7.4, the final release in the PHP 7.x series. PHP 7.4 brings typed properties, underscore numeric separator, and other minor improvements to PHP.\nNew Features 7.4 // Typed properties class User { public int $id; // 会强制要求 $user-\u0026gt;id 只能为 int 类型，访问前必须进行处理化，?int 也要进行初始化 } // 箭头函数 Arrow functions $factor = 10; $nums = array_map(fn($n) =\u0026gt; $n * $factor, [1, 2, 3, 4]); // 有限的 Limited 返回类型协变和参数类型逆变 class A {} class B extends A {} class Producer { public function method(): A {} } class ChildProducer extends Producer { public function method(): B {} } // PHP74 ok // PHP73 Fatal error: Declaration of ChildProducer::method(): B must be compatible with Producer::method(): A // 空合并赋值运算符 $array[\u0026#39;key1\u0026#39;] ??= 1; // is roughly equivalent to if (!isset($array[\u0026#39;key2\u0026#39;])) { $array[\u0026#39;key2\u0026#39;] = 2; } var_dump($array); // array(2) { // [\u0026#34;key1\u0026#34;]=\u0026gt; // int(1) // [\u0026#34;key2\u0026#34;]=\u0026gt; // int(2) // } // Unpacking inside arrays // 可以平替 array_merge $parts = [\u0026#39;apple\u0026#39;, \u0026#39;pear\u0026#39;]; $fruits = [\u0026#39;orange\u0026#39;, ...$parts, \u0026#39;watermelon\u0026#39;]; var_dump($fruits); // array(4) { // [0]=\u0026gt; // string(6) \u0026#34;orange\u0026#34; // [1]=\u0026gt; // string(5) \u0026#34;apple\u0026#34; // [2]=\u0026gt; // string(4) \u0026#34;pear\u0026#34; // [3]=\u0026gt; // string(10) \u0026#34;watermelon\u0026#34; // } // 数字文字分隔符 6.674_083e-11; // float 299_792_458; // decimal 0xCAFE_F00D; // hexadecimal 0b0101_1111; // binary var_dump((int)\u0026#34;1_123\u0026#34;); // int(1) // WeakReference 类 // https://www.php.net/manual/zh/class.weakreference.php $obj = new stdClass; $weakref = WeakReference::create($obj); var_dump($weakref-\u0026gt;get()); unset($obj); var_dump($weakref-\u0026gt;get()); // object(stdClass)#1 (0) { // } // NULL Backward Incompatible Changes 7.4 // 以数组形式访问非数组，将会抛出 notic // null, bool, int, float or resource $i = 12; $i[\u0026#34;a\u0026#34;]; // PHP74 Notice: Trying to access array offset on value of type int // PHP73 ok // PHP80 Warning: Trying to access array offset on value of type int Deprecated Features 7.4 // 嵌套的三元运算必须明确地使用括号来指示运算的顺序 var_dump(1 ? 2 : 3 ? 4 : 5); // PHP74 Deprecated: Unparenthesized `a ? b : c ? d : e` is deprecated. Use either `(a ? b : c) ? d : e` or `a ? b : (c ? d : e)` // PHP73 int(4) \u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2022/12/12/php-migrating-to-72-73-74/","summary":"\u003cul\u003e\n\u003cli\u003e实验环境：\u003ca href=\"https://onlinephp.io/\"\u003ehttps://onlinephp.io/\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"php71-to-php72\"\u003ePHP7.1 to PHP7.2\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.php.net/manual/en/migration72.php\"\u003ehttps://www.php.net/manual/en/migration72.php\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://php.watch/versions/7.2\"\u003ehttps://php.watch/versions/7.2\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cblockquote\u003e\n\u003cp\u003eArgon2 password hashing support, class constant visibility, object type, and many more.\u003c/p\u003e\u003c/blockquote\u003e\n\u003ch3 id=\"new-features-72\"\u003eNew Features 7.2\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 新的 object 类型\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 可用于逆变（contravariant）参数输入和协变（covariant）返回任何对象类型\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// https://www.php.net/manual/zh/language.oop5.variance.php\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 协变使子类比父类方法能返回更具体的类型；逆变使子类比父类方法参数类型能接受更模糊的类型\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003efunction\u003c/span\u003e \u003cspan class=\"nf\"\u003etest\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eobject\u003c/span\u003e \u003cspan class=\"nv\"\u003e$obj\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"nx\"\u003eobject\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003eSplQueue\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003etest\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"k\"\u003eStdClass\u003c/span\u003e\u003cspan class=\"p\"\u003e());\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 抽象类可以重写被继承的抽象类的抽象方法\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003eabstract\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eA\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eabstract\u003c/span\u003e \u003cspan class=\"k\"\u003efunction\u003c/span\u003e \u003cspan class=\"nf\"\u003etest\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003estring\u003c/span\u003e \u003cspan class=\"nv\"\u003e$s\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eabstract\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eB\u003c/span\u003e \u003cspan class=\"k\"\u003eextends\u003c/span\u003e \u003cspan class=\"nx\"\u003eA\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e// overridden - 仍然保持参数的逆变和返回的逆变\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e    \u003cspan class=\"k\"\u003eabstract\u003c/span\u003e \u003cspan class=\"k\"\u003efunction\u003c/span\u003e \u003cspan class=\"nf\"\u003etest\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$s\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"nx\"\u003eint\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 重写方法和接口实现的参数类型可以省略\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 仍然是符合LSP，这种参数类型是逆变\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003einterface\u003c/span\u003e \u003cspan class=\"nx\"\u003eA\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003efunction\u003c/span\u003e \u003cspan class=\"nf\"\u003etest\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003earray\u003c/span\u003e \u003cspan class=\"nv\"\u003e$input\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eB\u003c/span\u003e \u003cspan class=\"k\"\u003eimplements\u003c/span\u003e \u003cspan class=\"nx\"\u003eA\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e// type omitted for $input\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003efunction\u003c/span\u003e \u003cspan class=\"nf\"\u003etest\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$input\u003c/span\u003e\u003cspan class=\"p\"\u003e){\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nv\"\u003e$input\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e((\u003c/span\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003eB\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"na\"\u003etest\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// PHP72 int(1)\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e//\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// PHP71 Fatal error: Declaration of B::test($input) must be compatible with A::test(array $input)\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"backward-incompatible-changes-72\"\u003eBackward incompatible changes 7.2\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 防止 number_format() 返回负零\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003enumber_format\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mf\"\u003e0.01\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// PHP72 string(1) \u0026#34;0\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e//\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// PHP71 string(2) \u0026#34;-0\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 转换对象和数组中的数字键\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nv\"\u003e$arr\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e];\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$obj\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eobject\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"nv\"\u003e$arr\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$obj\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$obj\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;0\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e},\u003c/span\u003e \u003cspan class=\"c1\"\u003e// 新写法\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e    \u003cspan class=\"nv\"\u003e$obj\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"c1\"\u003e// 新写法\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// PHP72 object(stdClass)#1 (1) {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e//   [\u0026#34;0\u0026#34;]=\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e//   int(1)\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// }\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// int(1)\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// int(1)\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e//\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// PHP71 object(stdClass)#1 (1) {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e//   [0]=\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e//   int(1)\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// }\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Notice: Undefined property: stdClass::$0\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$obj\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"err\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003efunction\u003c/span\u003e \u003cspan class=\"fm\"\u003e__construct\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nv\"\u003e$this\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;value\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e};\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$arr\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003earray\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"nv\"\u003e$obj\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$arr\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$arr\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;1\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e \u003cspan class=\"c1\"\u003e// 整数 或者 字符串整数 含义相同\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$arr\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e \u003cspan class=\"c1\"\u003e// PHP71\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$arr\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// PHP72 array(1) {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e//   [1]=\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e//   string(2) \u0026#34;my\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// }\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e//\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// PHP71 无法取整型字符串 key\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// array(1) {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e//   [\u0026#34;1\u0026#34;]=\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e//   string(2) \u0026#34;my\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// }\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Notice: Undefined offset: 1\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Notice: Undefined offset: 1\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Notice: Undefined offset: 0\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$a\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mf\"\u003e1.3\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;v1\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mf\"\u003e1.4\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;v2\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e];\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$a\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// ALL array key float 会被转换为 int\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// array(1) {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e//   [1]=\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e//   string(2) \u0026#34;v2\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// }\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// get_class() 函数不再接受 null\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eget_class\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// PHP72\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Warning: get_class() expects parameter 1 to be object\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// bool(false)\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e//\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// PHP71\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Warning: get_class() called without object from outside a class\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// bool(false)\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e//\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// PHP80\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Fatal error: Uncaught TypeError: get_class(): Argument #1 ($object) must be of type object, null given\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 计算非可数类型（non-countable）时发出警告\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003ecount\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"c1\"\u003e// NULL is not countable\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e    \u003cspan class=\"nx\"\u003ecount\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"c1\"\u003e// integers are not countable\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e    \u003cspan class=\"nx\"\u003ecount\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;abc\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"c1\"\u003e// strings are not countable\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e    \u003cspan class=\"nx\"\u003ecount\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"k\"\u003estdclass\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"c1\"\u003e// objects not implementing the Countable interface are not countable\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// PHP72\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Warning: count(): Parameter must be an array or an object that implements Countable\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e//\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// PHP71\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 无 Warning\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e//\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// PHP80\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Fatal error: Uncaught TypeError: count(): Argument #1 ($value) must be of type Countable|array\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 调用未定义的常量，现在会抛出一个 E_WARNING 错误（之前版本中为 E_NOTICE)）\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// PHP8 将不会转化成他们自身的字符串，同时抛出 Error 异常\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eMY_CONST\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// PHP72\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Warning: Use of undefined constant MY_CONST - assumed \u0026#39;MY_CONST\u0026#39;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// string(8) \u0026#34;MY_CONST\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e//\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// PHP71\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Notice: Use of undefined constant MY_CONST\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// string(8) \u0026#34;MY_CONST\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e//\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// PHP80\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Fatal error: Uncaught Error: Undefined constant \u0026#34;MY_CONST\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// bcmod 任意精度数字取模，添加新增参数 scale\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ebcmod\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;4\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;3.5\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// PHP72\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// string(1) \u0026#34;0\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e//\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// PHP71\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// string(1) \u0026#34;1\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ebcmod\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;4\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;3.5\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// PHP72\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// string(3) \u0026#34;0.5\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e//\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// PHP71\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Warning: bcmod() expects exactly 2 parameters, 3 given\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// json_decode associative 允许为 null\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 当为 true 时，JSON 对象将返回关联 array；当为 false 时，JSON 对象将返回 object。\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 当为 null 时，JSON 对象将返回关联 array 或 object，这取决于是否在 flags 中设置 JSON_OBJECT_AS_ARRAY\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// https://www.php.net/manual/zh/function.json-decode.php\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nv\"\u003e$json\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;{\u0026#34;a\u0026#34;:1,\u0026#34;b\u0026#34;:2}\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ejson_decode\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$json\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e512\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eJSON_OBJECT_AS_ARRAY\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// PHP72\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// array(2) {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e//   [\u0026#34;a\u0026#34;]=\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e//   int(1)\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e//   [\u0026#34;b\u0026#34;]=\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e//   int(2)\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// }\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e//\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// PHP71\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// object(stdClass)#1 (2) {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e//   [\u0026#34;a\u0026#34;]=\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e//   int(1)\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e//   [\u0026#34;b\u0026#34;]=\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e//   int(2)\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// }\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"php72-to-php73\"\u003ePHP7.2 to PHP7.3\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.php.net/manual/en/migration72.php\"\u003ehttps://www.php.net/manual/en/migration72.php\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://php.watch/versions/7.3\"\u003ehttps://php.watch/versions/7.3\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cblockquote\u003e\n\u003cp\u003eHeredoc/nowdoc syntax improvements and a bunch of legacy code deprecations.\u003c/p\u003e","title":"PHP Migrating to 7.2 7.3 7.4"},{"content":" 实验环境：https://onlinephp.io/ Polyfill https://github.com/symfony/polyfill/tree/main/src PHP7.0 to PHP7.1 https://www.php.net/manual/en/migration71.php\n7.1 New Features // Nullable types 可为空类型 function test(?string $name): ?string // Void 函数 function swap(\u0026amp;$left, \u0026amp;$right) : void // 获取一个 void 方法的返回值会得到 null，并且不会产生任何警告 // 对称数组解构 $data = [ [1, \u0026#39;Tom\u0026#39;], [2, \u0026#39;Fred\u0026#39;], ]; [$id, $name] = $data[0]; // 赋值部分 [, $name1] = $data[1]; foreach ($data as [$id, $name]) { // logic here with $id and $name } function swap(\u0026amp;$a, \u0026amp;$b): void { [$a, $b] = [$b, $a]; } // list 支持键名 $data = [ [\u0026#34;id\u0026#34; =\u0026gt; 1, \u0026#34;name\u0026#34; =\u0026gt; \u0026#39;Tom\u0026#39;], [\u0026#34;id\u0026#34; =\u0026gt; 2, \u0026#34;name\u0026#34; =\u0026gt; \u0026#39;Fred\u0026#39;], ]; foreach ($data as [\u0026#34;name\u0026#34; =\u0026gt; $name, \u0026#34;id\u0026#34; =\u0026gt; $id]) { // logic here with $id and $name } // 类常量支持可见性 class ConstDemo { public const PUBLIC_CONST_A = 1; } // iterable 伪类（与 callable 类似） interface Traversable extends iterable { // 这个接口没有任何方法，它的作用仅仅是作为所有可遍历类的基本接口 // Traversable as part of either Iterator or IteratorAggregate，不能直接实现 } function iterator(iterable $iter) { foreach ($iter as $val) { // ... } } // 多异常捕获处理，可以通过管道字符(|)来实现多个异常的捕获 try { // some code } catch (FirstException | SecondException $e) { // handle first and second exceptions } // 支持为负的字符串偏移量，一个负数的偏移量会被理解为一个从字符串结尾开始的偏移量 // 所有支持偏移量的字符串操作函数，都支持接受负数作为偏移量 // 中文操作要小心 var_dump(\u0026#34;abcdef\u0026#34;[-2]); // e var_dump(strpos(\u0026#34;aabbcc\u0026#34;, \u0026#34;b\u0026#34;)); // 2 var_dump(strpos(\u0026#34;aabbcc\u0026#34;, \u0026#34;b\u0026#34;, -3)); // 3 // 新增 Closure::fromCallable()，将 callable 转为一个 Closure 对象 // public static Closure::fromCallable(callable $callback): Closure class Test { public function exposeFunction() { return Closure::fromCallable([$this, \u0026#39;privateFunction\u0026#39;]); } private function privateFunction($param) { var_dump($param); } } $privFunc = (new Test)-\u0026gt;exposeFunction(); $privFunc(\u0026#39;some value\u0026#39;); // string(10) \u0026#34;some value\u0026#34; 7.1 New Functions // 否为可迭代 is_iterable() 7.1 Backward Incompatible Changes // 当传递参数过少时将抛出错误 function test($param){} test(); /* PHP71 Fatal error: Uncaught ArgumentCountError: Too few arguments to function test() PHP70 Warning: Missing argument 1 for test() */ // 禁止动态调用作用域自检函数 // $func() or array_map(\u0026#39;extract\u0026#39;, ...) // function array_map($callback, array $array, array ...$arrays): array (function () { $func = \u0026#39;func_num_args\u0026#39;; $func(); })(); /* PHP71 Warning: Cannot call func_num_args() dynamically */ // 以下名称不能用于命名 class, interface, trait // - void // - iterable // 数字字符串转换 遵循科学记数法 var_dump(intval(\u0026#39;1e5\u0026#39;)); var_dump(is_numeric(\u0026#39;1e5\u0026#39;)); var_dump(is_numeric(\u0026#39;e\u0026#39;)); // PHP71 PHP70 // int(100000) int(1) // bool(true) bool(true) // bool(false) bool(false) // call_user_func() 不再支持对传址的函数的调用 error_reporting(E_ALL); function increment(\u0026amp;$var) { $var++; } $a = 0; call_user_func(\u0026#39;increment\u0026#39;, $a); // ...expected to be a reference, value given call_user_func_array(\u0026#39;increment\u0026#39;, [\u0026amp;$a]); // 1 $increment = \u0026#39;increment\u0026#39;; $increment($a); // 2 // 字符串不再支持空索引运算符 $str = \u0026#34;\u0026#34;; $str[] = \u0026#34;abc\u0026#34;; var_dump($str); // PHP71 Fatal error: Uncaught Error: [] operator not supported for strings // PHP70 array(1) { // [0]=\u0026gt; // string(3) \u0026#34;abc\u0026#34; // } $a = \u0026#34;\u0026#34;; $a[0] = \u0026#34;hello world\u0026#34;; var_dump($a); // PHP71 string(1) \u0026#34;h\u0026#34; // PHP70 array(1) { // [0]=\u0026gt; // string(11) \u0026#34;hello world\u0026#34; // } // 通过空字符串上的字符串索引访问赋值 $str = \u0026#39;\u0026#39;; $str[10] = \u0026#39;foo\u0026#39;; var_dump($str); // PHP71 string(11) \u0026#34; f\u0026#34; // PHP70 array(1) { // [10]=\u0026gt; // string(3) \u0026#34;foo\u0026#34; // } // 当通过引用赋值引用它们自动创建这些元素时，数组中元素的顺序已更改。 $array = []; $array[\u0026#39;a\u0026#39;] = \u0026amp;$array[\u0026#39;b\u0026#39;]; $array[\u0026#39;b\u0026#39;] = 1; var_dump($array); // PHP71 array(2) { // [\u0026#34;b\u0026#34;]=\u0026gt; // \u0026amp;int(1) // [\u0026#34;a\u0026#34;]=\u0026gt; // \u0026amp;int(1) // } // PHP70 array(2) { // [\u0026#34;a\u0026#34;]=\u0026gt; // \u0026amp;int(1) // [\u0026#34;b\u0026#34;]=\u0026gt; // \u0026amp;int(1) // } // 词法绑定变量不能重用名称，以下都将 fatal error $f = function () use ($_SERVER) {}; // any superglobals $f = function () use ($this) {}; $f = function ($param) use ($param) {}; // 禁止 \u0026#34;return;\u0026#34; 对于已经在编译时键入的返回值 function test(int $i): array { $i += 1; return; } // PHP Compile Error A function with return type must return a value var_dump(\u0026#39;1b\u0026#39; + \u0026#39;something\u0026#39;); // PHP71 // Notice: A non well formed numeric value encountered // Warning: A non-numeric value encountered // int(1) // PHP70 int(1) PHP5.6 to PHP7.0 https://www.php.net/manual/en/migration70.php Backward incompatible changes // 错误和异常处理相关的变更 // set_exception_handler() 不再保证收到的一定是 Exception 对象 function handler(Exception $e) { ... } set_exception_handler(\u0026#39;handler\u0026#39;); // 兼容 PHP 5 和 7 function handler($e) { ... } // 仅支持 PHP 7 function handler(Throwable $e) { ... } // 当内部构造器失败的时候，总是抛出异常 // 间接调用的表达式的新旧解析顺序 // 现在严格遵循从左到右的顺序来解析 // 表达式 PHP 5 的解析方式 PHP 7 的解析方式 $$foo[\u0026#39;bar\u0026#39;][\u0026#39;baz\u0026#39;] ${$foo[\u0026#39;bar\u0026#39;][\u0026#39;baz\u0026#39;]} ($$foo)[\u0026#39;bar\u0026#39;][\u0026#39;baz\u0026#39;] $foo-\u0026gt;$bar[\u0026#39;baz\u0026#39;] $foo-\u0026gt;{$bar[\u0026#39;baz\u0026#39;]} ($foo-\u0026gt;$bar)[\u0026#39;baz\u0026#39;] // foreach 通过值遍历时，操作的值为数组的副本 $array = [0]; foreach ($array as $val) { var_dump($val); $array[1] = 1; } // int(0) // foreach通过引用遍历时，有更好的迭代特性 $array = [0]; foreach ($array as \u0026amp;$val) { var_dump($val); $array[1] = 1; } // PHP 7.0 // int(0) // int(1) // PHP 5.6 // int(0) // call_user_method() and call_user_method_array() 被移除。 // 应该使用 call_user_func() 和 call_user_func_array() // 在函数中检视参数值会返回 当前 的值 function foo($x) { $x++; var_dump(func_get_arg(0)); } foo(1); // int(2) PHP 7.0 // int(1) PHP 5.6 7.0 New Features // 标量类型声明 // 返回值类型声明 function arraysSum(array ...$arrays): array { return array_map(function(array $array): int { return array_sum($array); }, $arrays); } // null 合并运算符，对 isset() 的简化 $username = $_GET[\u0026#39;user\u0026#39;] ?? \u0026#39;nobody\u0026#39;; // 太空船操作符（组合比较符） echo 1 \u0026lt;=\u0026gt; 1; // 0 echo 1 \u0026lt;=\u0026gt; 2; // -1 echo 2 \u0026lt;=\u0026gt; 1; // 1 // 通过 define() 定义 常量数组 define(\u0026#39;ANIMALS\u0026#39;, [ \u0026#39;dog\u0026#39;, \u0026#39;cat\u0026#39;, \u0026#39;bird\u0026#39; ]); // 匿名类 用来替代一些“用后即焚”的完整类定义 $app = new Application; $app-\u0026gt;setLogger(new class implements Logger { public function log(string $msg) { echo $msg; } }); // Unicode codepoint 转译语法 // 这接受一个以 16 进制形式的 Unicode codepoint echo \u0026#34;\\u{9999}\u0026#34;; // 香 // Closure::call() 新方法，简化绑定一个方法到对象上闭包并调用它 // PHP 7 之前版本的代码 $getXCB = function() {return $this-\u0026gt;x;}; // function bindTo($newThis, $newScope = \u0026#39;static\u0026#39;) { } // $newScope 将闭包关联到的类作用域 $getX = $getXCB-\u0026gt;bindTo(new A, A::class); // 中间层闭包 echo $getX(); // PHP 7+ 及更高版本的代码 $getX = function() {return $this-\u0026gt;x;}; echo $getX-\u0026gt;call(new A); // 生成器委托 yield from function gen() { yield 1; yield 2; yield from gen2(); } function gen2() { yield 3; yield 4; } foreach (gen() as $val) { echo $val, PHP_EOL; } // 1 // 2 // 3 // 4 // 柯里化 function add($a) { return function($b) use ($a) { return $a + $b; }; } $result = add(10)(15); var_dump($result); // int 25 Deprecated features in PHP 7.0.x // 构造函数（方法名和类名一样）将被弃用，并在将来移除 class Foo { function foo() { echo \u0026#39;I am the constructor\u0026#39;; } } // PHP 7.0: Deprecated: Methods with the same name as their class will not be constructors in a future version of PHP // PHP 5.6: OK Other Changes // 放宽了保留词限制，以前不能用 \u0026#39;new\u0026#39;、\u0026#39;private\u0026#39; 和 \u0026#39;for\u0026#39; Project::new(\u0026#39;Project Name\u0026#39;)-\u0026gt;private()-\u0026gt;for(\u0026#39;purpose here\u0026#39;)-\u0026gt;with(\u0026#39;username here\u0026#39;); // class 关键词不能用于常量名，否则会和类名解析语法冲突（ClassName::class） New Global Constants PHP_INT_MIN \u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2022/11/28/php-migrating-to-70-71/","summary":"\u003cul\u003e\n\u003cli\u003e实验环境：\u003ca href=\"https://onlinephp.io/\"\u003ehttps://onlinephp.io/\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003ePolyfill \u003ca href=\"https://github.com/symfony/polyfill/tree/main/src\"\u003ehttps://github.com/symfony/polyfill/tree/main/src\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"php70-to-php71\"\u003ePHP7.0 to PHP7.1\u003c/h2\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ca href=\"https://www.php.net/manual/en/migration71.php\"\u003ehttps://www.php.net/manual/en/migration71.php\u003c/a\u003e\u003c/p\u003e\u003c/blockquote\u003e\n\u003ch3 id=\"71-new-features\"\u003e7.1 New Features\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Nullable types 可为空类型\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003efunction\u003c/span\u003e \u003cspan class=\"nf\"\u003etest\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e?\u003c/span\u003e\u003cspan class=\"nx\"\u003estring\u003c/span\u003e \u003cspan class=\"nv\"\u003e$name\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"o\"\u003e?\u003c/span\u003e\u003cspan class=\"nx\"\u003estring\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Void 函数\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003efunction\u003c/span\u003e \u003cspan class=\"nf\"\u003eswap\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"nv\"\u003e$left\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"nv\"\u003e$right\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"nx\"\u003evoid\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 获取一个 void 方法的返回值会得到 null，并且不会产生任何警告\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 对称数组解构\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nv\"\u003e$data\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;Tom\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;Fred\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e];\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"nv\"\u003e$id\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$name\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nv\"\u003e$data\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e];\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 赋值部分\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e[,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$name1\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nv\"\u003e$data\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e];\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eforeach\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$data\u003c/span\u003e \u003cspan class=\"k\"\u003eas\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"nv\"\u003e$id\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$name\u003c/span\u003e\u003cspan class=\"p\"\u003e])\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e// logic here with $id and $name\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003efunction\u003c/span\u003e \u003cspan class=\"nf\"\u003eswap\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"nv\"\u003e$a\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"nv\"\u003e$b\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"nx\"\u003evoid\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"nv\"\u003e$a\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$b\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"nv\"\u003e$b\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$a\u003c/span\u003e\u003cspan class=\"p\"\u003e];\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// list 支持键名\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nv\"\u003e$data\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;id\u0026#34;\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;name\u0026#34;\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;Tom\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;id\u0026#34;\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"mi\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;name\u0026#34;\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;Fred\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e];\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eforeach\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$data\u003c/span\u003e \u003cspan class=\"k\"\u003eas\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;name\u0026#34;\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"nv\"\u003e$name\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;id\u0026#34;\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"nv\"\u003e$id\u003c/span\u003e\u003cspan class=\"p\"\u003e])\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e// logic here with $id and $name\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 类常量支持可见性\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eConstDemo\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003econst\u003c/span\u003e \u003cspan class=\"no\"\u003ePUBLIC_CONST_A\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// iterable 伪类（与 callable 类似）\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003einterface\u003c/span\u003e \u003cspan class=\"nx\"\u003eTraversable\u003c/span\u003e \u003cspan class=\"k\"\u003eextends\u003c/span\u003e \u003cspan class=\"nx\"\u003eiterable\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e// 这个接口没有任何方法，它的作用仅仅是作为所有可遍历类的基本接口\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e    \u003cspan class=\"c1\"\u003e// Traversable as part of either Iterator or IteratorAggregate，不能直接实现\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003efunction\u003c/span\u003e \u003cspan class=\"nf\"\u003eiterator\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eiterable\u003c/span\u003e \u003cspan class=\"nv\"\u003e$iter\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eforeach\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$iter\u003c/span\u003e \u003cspan class=\"k\"\u003eas\u003c/span\u003e \u003cspan class=\"nv\"\u003e$val\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"c1\"\u003e// ...\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 多异常捕获处理，可以通过管道字符(|)来实现多个异常的捕获\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003etry\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e// some code\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"k\"\u003ecatch\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eFirstException\u003c/span\u003e \u003cspan class=\"o\"\u003e|\u003c/span\u003e \u003cspan class=\"nx\"\u003eSecondException\u003c/span\u003e \u003cspan class=\"nv\"\u003e$e\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e// handle first and second exceptions\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 支持为负的字符串偏移量，一个负数的偏移量会被理解为一个从字符串结尾开始的偏移量\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 所有支持偏移量的字符串操作函数，都支持接受负数作为偏移量\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 中文操作要小心\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;abcdef\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e \u003cspan class=\"c1\"\u003e// e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003estrpos\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;aabbcc\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;b\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e \u003cspan class=\"c1\"\u003e// 2\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003estrpos\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;aabbcc\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;b\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e3\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e \u003cspan class=\"c1\"\u003e// 3\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 新增 Closure::fromCallable()，将 callable 转为一个 Closure 对象\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// public static Closure::fromCallable(callable $callback): Closure\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eTest\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003efunction\u003c/span\u003e \u003cspan class=\"nf\"\u003eexposeFunction\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nx\"\u003eClosure\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"na\"\u003efromCallable\u003c/span\u003e\u003cspan class=\"p\"\u003e([\u003c/span\u003e\u003cspan class=\"nv\"\u003e$this\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;privateFunction\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003efunction\u003c/span\u003e \u003cspan class=\"nf\"\u003eprivateFunction\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$param\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$param\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$privFunc\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003eTest\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"na\"\u003eexposeFunction\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$privFunc\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;some value\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// string(10) \u0026#34;some value\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"71-new-functions\"\u003e7.1 New Functions\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 否为可迭代\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nx\"\u003eis_iterable\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"71-backward-incompatible-changes\"\u003e7.1 Backward Incompatible Changes\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 当传递参数过少时将抛出错误\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003efunction\u003c/span\u003e \u003cspan class=\"nf\"\u003etest\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$param\u003c/span\u003e\u003cspan class=\"p\"\u003e){}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003etest\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003e/*\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003ePHP71\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003eFatal error: Uncaught ArgumentCountError: Too few arguments to function test()\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003ePHP70\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003eWarning: Missing argument 1 for test()\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003e*/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 禁止动态调用作用域自检函数\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// $func() or array_map(\u0026#39;extract\u0026#39;, ...)\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// function array_map($callback, array $array, array ...$arrays): array\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003efunction\u003c/span\u003e \u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nv\"\u003e$func\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;func_num_args\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nv\"\u003e$func\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e})();\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003e/*\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003ePHP71\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003eWarning: Cannot call func_num_args() dynamically\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003e*/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 以下名称不能用于命名 class, interface, trait\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// - void\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// - iterable\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 数字字符串转换 遵循科学记数法\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eintval\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;1e5\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eis_numeric\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;1e5\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eis_numeric\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// PHP71             PHP70\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// int(100000)       int(1)\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// bool(true)        bool(true)\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// bool(false)       bool(false)\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// call_user_func() 不再支持对传址的函数的调用\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nx\"\u003eerror_reporting\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003eE_ALL\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003efunction\u003c/span\u003e \u003cspan class=\"nf\"\u003eincrement\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"nv\"\u003e$var\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nv\"\u003e$var\u003c/span\u003e\u003cspan class=\"o\"\u003e++\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$a\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003ecall_user_func\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;increment\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$a\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"c1\"\u003e// ...expected to be a reference, value given\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nx\"\u003ecall_user_func_array\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;increment\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"nv\"\u003e$a\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e \u003cspan class=\"c1\"\u003e// 1\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nv\"\u003e$increment\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;increment\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$increment\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$a\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"c1\"\u003e// 2\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 字符串不再支持空索引运算符\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nv\"\u003e$str\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$str\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;abc\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$str\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// PHP71 Fatal error: Uncaught Error: [] operator not supported for strings\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// PHP70 array(1) {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e//   [0]=\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e//   string(3) \u0026#34;abc\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// }\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$a\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$a\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;hello world\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$a\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// PHP71 string(1) \u0026#34;h\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// PHP70 array(1) {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e//   [0]=\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e//   string(11) \u0026#34;hello world\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// }\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 通过空字符串上的字符串索引访问赋值\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nv\"\u003e$str\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$str\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e10\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;foo\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$str\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// PHP71 string(11) \u0026#34;          f\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// PHP70 array(1) {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e//   [10]=\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e//   string(3) \u0026#34;foo\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// }\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 当通过引用赋值引用它们自动创建这些元素时，数组中元素的顺序已更改。\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nv\"\u003e$array\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e[];\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$array\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;a\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"nv\"\u003e$array\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;b\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e];\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$array\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;b\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$array\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// PHP71 array(2) {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e//   [\u0026#34;b\u0026#34;]=\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e//   \u0026amp;int(1)\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e//   [\u0026#34;a\u0026#34;]=\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e//   \u0026amp;int(1)\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// }\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// PHP70 array(2) {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e//   [\u0026#34;a\u0026#34;]=\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e//   \u0026amp;int(1)\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e//   [\u0026#34;b\u0026#34;]=\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e//   \u0026amp;int(1)\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// }\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 词法绑定变量不能重用名称，以下都将 fatal error\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nv\"\u003e$f\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003efunction\u003c/span\u003e \u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"k\"\u003euse\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$_SERVER\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{};\u003c/span\u003e \u003cspan class=\"c1\"\u003e// any superglobals\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nv\"\u003e$f\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003efunction\u003c/span\u003e \u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"k\"\u003euse\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$this\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{};\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$f\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003efunction\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$param\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003euse\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$param\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{};\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 禁止 \u0026#34;return;\u0026#34; 对于已经在编译时键入的返回值\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003efunction\u003c/span\u003e \u003cspan class=\"nf\"\u003etest\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eint\u003c/span\u003e \u003cspan class=\"nv\"\u003e$i\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"k\"\u003earray\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nv\"\u003e$i\u003c/span\u003e \u003cspan class=\"o\"\u003e+=\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// PHP Compile Error A function with return type must return a value\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;1b\u0026#39;\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;something\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// PHP71\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Notice: A non well formed numeric value encountered\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Warning: A non-numeric value encountered\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// int(1)\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// PHP70 int(1)\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"php56-to-php70\"\u003ePHP5.6 to PHP7.0\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.php.net/manual/en/migration70.php\"\u003ehttps://www.php.net/manual/en/migration70.php\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"backward-incompatible-changes\"\u003eBackward incompatible changes\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 错误和异常处理相关的变更\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// set_exception_handler() 不再保证收到的一定是 Exception 对象\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003efunction\u003c/span\u003e \u003cspan class=\"nf\"\u003ehandler\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eException\u003c/span\u003e \u003cspan class=\"nv\"\u003e$e\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"o\"\u003e...\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003eset_exception_handler\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;handler\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 兼容 PHP 5 和 7\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003efunction\u003c/span\u003e \u003cspan class=\"nf\"\u003ehandler\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$e\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"o\"\u003e...\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 仅支持 PHP 7\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003efunction\u003c/span\u003e \u003cspan class=\"nf\"\u003ehandler\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eThrowable\u003c/span\u003e \u003cspan class=\"nv\"\u003e$e\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"o\"\u003e...\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 当内部构造器失败的时候，总是抛出异常\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 间接调用的表达式的新旧解析顺序\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 现在严格遵循从左到右的顺序来解析\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 表达式               PHP 5 的解析方式           PHP 7 的解析方式\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nv\"\u003e$$foo\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;bar\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e][\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;baz\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e    \u003cspan class=\"err\"\u003e$\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nv\"\u003e$foo\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;bar\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e][\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;baz\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e]}\u003c/span\u003e    \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$$foo\u003c/span\u003e\u003cspan class=\"p\"\u003e)[\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;bar\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e][\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;baz\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$foo\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"nv\"\u003e$bar\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;baz\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e      \u003cspan class=\"nv\"\u003e$foo\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nv\"\u003e$bar\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;baz\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e]}\u003c/span\u003e      \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$foo\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"nv\"\u003e$bar\u003c/span\u003e\u003cspan class=\"p\"\u003e)[\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;baz\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// foreach 通过值遍历时，操作的值为数组的副本\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nv\"\u003e$array\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e];\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eforeach\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$array\u003c/span\u003e \u003cspan class=\"k\"\u003eas\u003c/span\u003e \u003cspan class=\"nv\"\u003e$val\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$val\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nv\"\u003e$array\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// int(0)\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// foreach通过引用遍历时，有更好的迭代特性\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nv\"\u003e$array\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e];\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eforeach\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$array\u003c/span\u003e \u003cspan class=\"k\"\u003eas\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"nv\"\u003e$val\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$val\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nv\"\u003e$array\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// PHP 7.0\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// int(0)\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// int(1)\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// PHP 5.6\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// int(0)\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// call_user_method() and call_user_method_array() 被移除。\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 应该使用 call_user_func() 和 call_user_func_array()\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 在函数中检视参数值会返回 当前 的值\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003efunction\u003c/span\u003e \u003cspan class=\"nf\"\u003efoo\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$x\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nv\"\u003e$x\u003c/span\u003e\u003cspan class=\"o\"\u003e++\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003efunc_get_arg\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003efoo\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// int(2) PHP 7.0\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// int(1) PHP 5.6\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"70-new-features\"\u003e7.0 New Features\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 标量类型声明\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 返回值类型声明\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003efunction\u003c/span\u003e \u003cspan class=\"nf\"\u003earraysSum\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003earray\u003c/span\u003e \u003cspan class=\"o\"\u003e...\u003c/span\u003e\u003cspan class=\"nv\"\u003e$arrays\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"k\"\u003earray\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nx\"\u003earray_map\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003efunction\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003earray\u003c/span\u003e \u003cspan class=\"nv\"\u003e$array\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"nx\"\u003eint\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nx\"\u003earray_sum\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$array\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e},\u003c/span\u003e \u003cspan class=\"nv\"\u003e$arrays\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// null 合并运算符，对 isset() 的简化\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nv\"\u003e$username\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_GET\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;user\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e??\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;nobody\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 太空船操作符（组合比较符）\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003eecho\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;=\u0026gt;\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"c1\"\u003e// 0\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003eecho\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;=\u0026gt;\u003c/span\u003e \u003cspan class=\"mi\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"c1\"\u003e// -1\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003eecho\u003c/span\u003e \u003cspan class=\"mi\"\u003e2\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;=\u0026gt;\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"c1\"\u003e// 1\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 通过 define() 定义 常量数组\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nx\"\u003edefine\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;ANIMALS\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"s1\"\u003e\u0026#39;dog\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"s1\"\u003e\u0026#39;cat\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"s1\"\u003e\u0026#39;bird\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 匿名类 用来替代一些“用后即焚”的完整类定义\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nv\"\u003e$app\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003eApplication\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$app\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"na\"\u003esetLogger\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eimplements\u003c/span\u003e \u003cspan class=\"nx\"\u003eLogger\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003efunction\u003c/span\u003e \u003cspan class=\"nf\"\u003elog\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003estring\u003c/span\u003e \u003cspan class=\"nv\"\u003e$msg\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003eecho\u003c/span\u003e \u003cspan class=\"nv\"\u003e$msg\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e});\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Unicode codepoint 转译语法\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 这接受一个以 16 进制形式的 Unicode codepoint\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003eecho\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;\\u{9999}\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"c1\"\u003e// 香\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Closure::call() 新方法，简化绑定一个方法到对象上闭包并调用它\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// PHP 7 之前版本的代码\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nv\"\u003e$getXCB\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003efunction\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nv\"\u003e$this\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"na\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e;};\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// function bindTo($newThis, $newScope = \u0026#39;static\u0026#39;) { }\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// $newScope 将闭包关联到的类作用域\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nv\"\u003e$getX\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nv\"\u003e$getXCB\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"na\"\u003ebindTo\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003eA\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eA\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"na\"\u003eclass\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"c1\"\u003e// 中间层闭包\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003eecho\u003c/span\u003e \u003cspan class=\"nv\"\u003e$getX\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// PHP 7+ 及更高版本的代码\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nv\"\u003e$getX\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003efunction\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nv\"\u003e$this\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"na\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e;};\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eecho\u003c/span\u003e \u003cspan class=\"nv\"\u003e$getX\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"na\"\u003ecall\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003eA\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 生成器委托 yield from\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003efunction\u003c/span\u003e \u003cspan class=\"nf\"\u003egen\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eyield\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eyield\u003c/span\u003e \u003cspan class=\"mi\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eyield\u003c/span\u003e \u003cspan class=\"nx\"\u003efrom\u003c/span\u003e \u003cspan class=\"nx\"\u003egen2\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003efunction\u003c/span\u003e \u003cspan class=\"nf\"\u003egen2\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eyield\u003c/span\u003e \u003cspan class=\"mi\"\u003e3\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eyield\u003c/span\u003e \u003cspan class=\"mi\"\u003e4\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eforeach\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003egen\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"k\"\u003eas\u003c/span\u003e \u003cspan class=\"nv\"\u003e$val\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eecho\u003c/span\u003e \u003cspan class=\"nv\"\u003e$val\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003ePHP_EOL\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 1\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 2\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 3\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 4\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 柯里化\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003efunction\u003c/span\u003e \u003cspan class=\"nf\"\u003eadd\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$a\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003efunction\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$b\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003euse\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$a\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nv\"\u003e$a\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"nv\"\u003e$b\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"p\"\u003e};\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$result\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003eadd\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e10\u003c/span\u003e\u003cspan class=\"p\"\u003e)(\u003c/span\u003e\u003cspan class=\"mi\"\u003e15\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$result\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"c1\"\u003e// int 25\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"deprecated-features-in-php-70x\"\u003eDeprecated features in PHP 7.0.x\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 构造函数（方法名和类名一样）将被弃用，并在将来移除\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eFoo\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003efunction\u003c/span\u003e \u003cspan class=\"nf\"\u003efoo\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003eecho\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;I am the constructor\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// PHP 7.0: Deprecated: Methods with the same name as their class will not be constructors in a future version of PHP\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// PHP 5.6: OK\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"other-changes\"\u003eOther Changes\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 放宽了保留词限制，以前不能用 \u0026#39;new\u0026#39;、\u0026#39;private\u0026#39; 和 \u0026#39;for\u0026#39;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nx\"\u003eProject\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"na\"\u003enew\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;Project Name\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"na\"\u003eprivate\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"na\"\u003efor\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;purpose here\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"na\"\u003ewith\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;username here\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// class 关键词不能用于常量名，否则会和类名解析语法冲突（ClassName::class）\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"new-global-constants\"\u003eNew Global Constants\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003ePHP_INT_MIN\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u0026ndash; EOF \u0026ndash;\u003c/p\u003e","title":"PHP Migrating to 7.0 7.1"},{"content":"Dockerfile ARG 构建参数 ARG \u0026lt;参数名\u0026gt;[=\u0026lt;默认值\u0026gt;]\n该默认值可以在构建命令 docker build 中用 \u0026ndash;build-arg \u0026lt;参数名\u0026gt;=\u0026lt;值\u0026gt; 来覆盖。\nARG LARADOCK_PHP_VERSION ARG BASE_IMAGE_TAG_PREFIX=latest FROM laradock/workspace:${BASE_IMAGE_TAG_PREFIX}-${LARADOCK_PHP_VERSION} LABEL maintainer=\u0026#34;Mahmoud Zalt \u0026lt;mahmoud@zalt.me\u0026gt;\u0026#34; # ARG 指令有生效范围，如果在 FROM 指令之前指定，那么只能用于 FROM 指令中。 # 在 FROM 之后须再次指定 ARG ARG LARADOCK_PHP_VERSION Config Setting { \u0026#34;registry-mirrors\u0026#34;: [ \u0026#34;https://mirror.ccs.tencentyun.com\u0026#34;, \u0026#34;https://reg-mirror.qiniu.com\u0026#34;, \u0026#34;https://hub-mirror.c.163.com\u0026#34;, \u0026#34;https://mirror.baidubce.com\u0026#34; ] } ","permalink":"https://zyf.im/2022/11/17/docker-code-snippet/","summary":"\u003ch2 id=\"dockerfile\"\u003eDockerfile\u003c/h2\u003e\n\u003ch3 id=\"arg-构建参数\"\u003eARG 构建参数\u003c/h3\u003e\n\u003cp\u003e\u003ccode\u003eARG \u0026lt;参数名\u0026gt;[=\u0026lt;默认值\u0026gt;]\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e该默认值可以在构建命令 docker build 中用 \u0026ndash;build-arg \u0026lt;参数名\u0026gt;=\u0026lt;值\u0026gt; 来覆盖。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-dockerfile\" data-lang=\"dockerfile\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eARG\u003c/span\u003e LARADOCK_PHP_VERSION\u003cspan class=\"err\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"err\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003eARG\u003c/span\u003e \u003cspan class=\"nv\"\u003eBASE_IMAGE_TAG_PREFIX\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003elatest\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eFROM\u003c/span\u003e\u003cspan class=\"s\"\u003e laradock/workspace:${BASE_IMAGE_TAG_PREFIX}-${LARADOCK_PHP_VERSION}\u003c/span\u003e\u003cspan class=\"err\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"err\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"err\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003eLABEL\u003c/span\u003e \u003cspan class=\"nv\"\u003emaintainer\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;Mahmoud Zalt \u0026lt;mahmoud@zalt.me\u0026gt;\u0026#34;\u003c/span\u003e\u003cspan class=\"err\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"err\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"err\"\u003e\u003c/span\u003e\u003cspan class=\"c\"\u003e# ARG 指令有生效范围，如果在 FROM 指令之前指定，那么只能用于 FROM 指令中。\u003c/span\u003e\u003cspan class=\"err\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"err\"\u003e\u003c/span\u003e\u003cspan class=\"c\"\u003e# 在 FROM 之后须再次指定 ARG\u003c/span\u003e\u003cspan class=\"err\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"err\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003eARG\u003c/span\u003e LARADOCK_PHP_VERSION\u003cspan class=\"err\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"config-setting\"\u003eConfig Setting\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-json\" data-lang=\"json\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nt\"\u003e\u0026#34;registry-mirrors\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"s2\"\u003e\u0026#34;https://mirror.ccs.tencentyun.com\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"s2\"\u003e\u0026#34;https://reg-mirror.qiniu.com\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"s2\"\u003e\u0026#34;https://hub-mirror.c.163.com\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"s2\"\u003e\u0026#34;https://mirror.baidubce.com\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","title":"Docker Code Snippet"},{"content":"Laradock 简介 Laradock 是一个基于 Docker 的完整 PHP 开发环境，专为 PHP 开发者（特别是 Laravel 开发者）设计。它提供了一套预配置的 Docker 容器，包含开发中常用的服务，如 Nginx、MySQL、Redis、PHP-FPM 等。\n主要优势 开箱即用：预配置的开发环境，无需繁琐设置 一致性：确保开发、测试和生产环境的一致性 灵活性：支持多种 PHP 版本和扩展 模块化：可以根据需要启用或禁用特定服务 跨平台：在 Windows、macOS 和 Linux 上表现一致 基本架构 Laradock 采用模块化设计，每个服务都运行在独立的容器中，通过 Docker 网络连接：\nWorkspace：包含开发工具的容器 PHP-FPM：PHP 解释器 Nginx/Apache：Web 服务器 MySQL/PostgreSQL/MongoDB：数据库 Redis/Memcached：缓存 其他辅助服务（邮件服务器、消息队列等） Dockerfile DEBIAN_FRONTEND ENV DEBIAN_FRONTEND=noninteractive DEBIAN_FRONTEND 环境变量用于告知操作系统应该从哪儿获得用户输入。\n设置为 \u0026ldquo;noninteractive\u0026rdquo; 可以实现自动安装而无需用户交互，对于 CI/CD 流程和 Docker 构建特别有用。这在运行 apt-get 命令时尤为重要，因为它会自动选择默认选项并以最快速度完成构建。\n最佳实践是在 RUN 命令中设置该变量，而不是使用 ENV 进行全局设置，因为全局设置会影响容器运行时的交互体验：\nRUN DEBIAN_FRONTEND=noninteractive apt-get update \u0026amp;\u0026amp; apt-get install -y ... 基于角色的用户配置 # 创建非 root 用户防止文件在宿主机上创建时具有 root 权限 ARG PUID=1000 ENV PUID ${PUID} ARG PGID=1000 ENV PGID ${PGID} RUN set -xe; \\ groupadd -g ${PGID} laradock \u0026amp;\u0026amp; \\ useradd -l -u ${PUID} -g laradock -m laradock -G docker_env \u0026amp;\u0026amp; \\ usermod -p \u0026#34;*\u0026#34; laradock -s /bin/bash 这段配置创建了一个非 root 用户 laradock，解决了容器和宿主机之间文件权限问题：\n可配置的 UID/GID：通过 ARG 和 ENV 指令使用户 ID 和组 ID 可配置 权限一致性：将容器内用户的 UID/GID 与宿主机用户匹配，确保文件权限一致 改善开发体验：设置 bash 作为默认 shell，并且不需要密码 实际使用中，可以通过 .env 文件配置这些值：\nPUID=1000 PGID=1000 通过 id -u 和 id -g 命令可以获取当前用户的 UID 和 GID。\nPHP 扩展安装示例 Swoole 安装 Swoole 是一个高性能的 PHP 异步网络通信引擎。安装 Swoole 时，可以使用 PECL：\n# php7.1 echo \u0026#39;\u0026#39; | pecl -q install --configureoptions \u0026#39;enable-openssl=\u0026#34;yes\u0026#34; enable-mysqlnd=\u0026#34;yes\u0026#34; enable-swoole-curl=\u0026#34;yes\u0026#34;\u0026#39; swoole-4.5.11; 这个命令通过 PECL 安装 Swoole 4.5.11，并启用了 OpenSSL、MySQL Native Driver 和 cURL 支持。安装后可以通过以下命令验证 OpenSSL 支持：\nphp -r \u0026#34;new swoole_server(\u0026#39;0.0.0.0\u0026#39;, 443, SWOOLE_PROCESS, SWOOLE_SOCK_TCP | SWOOLE_SSL);\u0026#34; 如果没有错误输出，说明 OpenSSL 支持已正确启用。\nPHP 版本智能检测 RUN if [ $(php -r \u0026#34;echo PHP_MAJOR_VERSION;\u0026#34;) = \u0026#34;8\u0026#34; ] || { [ $(php -r \u0026#34;echo PHP_MAJOR_VERSION;\u0026#34;) = \u0026#34;7\u0026#34; ] \u0026amp;\u0026amp; { [ $(php -r \u0026#34;echo PHP_MINOR_VERSION;\u0026#34;) = \u0026#34;4\u0026#34; ] || [ $(php -r \u0026#34;echo PHP_MINOR_VERSION;\u0026#34;) = \u0026#34;3\u0026#34; ] ;} ;}; then \\ # PHP 8.x 或 PHP 7.3/7.4 的配置 pecl install xdebug-3.1.6; \\ else \\ if [ $(php -r \u0026#34;echo PHP_MAJOR_VERSION;\u0026#34;) = \u0026#34;5\u0026#34; ]; then \\ # PHP 5.x 的配置 pecl install xdebug-2.5.5; \\ else \\ # 其他 PHP 7.x 版本的配置 if [ $(php -r \u0026#34;echo PHP_MINOR_VERSION;\u0026#34;) = \u0026#34;0\u0026#34; ]; then \\ pecl install xdebug-2.9.0; \\ else \\ pecl install xdebug-2.9.8; \\ fi \\ fi \\ fi Laradock 的 Dockerfile 中大量使用 PHP 版本检测，确保安装与当前 PHP 版本兼容的扩展和工具：\n使用 php -r 内联执行 PHP 命令获取版本信息 通过嵌套条件语句处理不同的 PHP 版本需求 支持多种 PHP 版本（从 5.x 到 8.x）使用同一个 Dockerfile 这种方法使得一个 Dockerfile 可以适应多个 PHP 版本，极大简化了维护工作。\nComposer 双版本安装 # 更新 composer ARG COMPOSER_VERSION=2 ENV COMPOSER_VERSION ${COMPOSER_VERSION} RUN set -eux; \\ if [ \u0026#34;$COMPOSER_VERSION\u0026#34; = \u0026#34;1\u0026#34; ] || [ \u0026#34;$COMPOSER_VERSION\u0026#34; = \u0026#34;2\u0026#34; ] || [ \u0026#34;$COMPOSER_VERSION\u0026#34; = \u0026#34;2.2\u0026#34; ]; then \\ composer self-update --${COMPOSER_VERSION}; \\ else \\ composer self-update ${COMPOSER_VERSION}; \\ fi Laradock 支持灵活选择 Composer 版本：\n允许通过环境变量切换 Composer 1.x、2.x 或特定版本 适应不同项目的兼容性需求 方便在旧项目和新项目之间切换 实用场景：某些旧项目可能与 Composer 2.x 不兼容，而新项目需要更新的 Composer 功能。\ndocker-compose.yml 配置技巧 主机名解析 extra_hosts: - \u0026#34;dockerhost:${DOCKER_HOST_IP}\u0026#34; 这个配置会在容器的 /etc/hosts 文件中添加一条记录：\n10.0.75.1 dockerhost 这样，容器内的应用可以通过 dockerhost 域名访问宿主机，无需使用动态 IP 地址。\n模块化服务架构 Laradock 的 docker-compose.yml 文件采用高度模块化的设计：\nservices: workspace: build: context: ./workspace args: - PHP_VERSION=${PHP_VERSION} volumes: - ${APP_CODE_PATH_HOST}:${APP_CODE_PATH_CONTAINER} networks: - frontend - backend php-fpm: build: context: ./php-fpm args: - PHP_VERSION=${PHP_VERSION} volumes: - ${APP_CODE_PATH_HOST}:${APP_CODE_PATH_CONTAINER} depends_on: - workspace networks: - backend 主要特点：\n每个服务独立配置：可以只启动需要的服务 明确的依赖关系：使用 depends_on 确保正确的启动顺序 统一的环境变量：从 .env 文件加载配置 网络配置 networks: frontend: driver: bridge backend: driver: bridge Laradock 采用前后端分离的网络设计：\n前端网络：连接 Web 服务器和负载均衡器 后端网络：连接应用服务（PHP-FPM）和数据库 安全隔离：数据库等服务不直接暴露给前端 这种设计增强了安全性，防止外部直接访问敏感服务。\n卷管理策略 volumes: mysql: driver: ${VOLUMES_DRIVER} redis: driver: ${VOLUMES_DRIVER} postgres: driver: ${VOLUMES_DRIVER} Laradock 使用命名卷而非绑定挂载来提高性能和可移植性：\n集中式数据路径：使用 ${DATA_PATH_HOST} 管理所有持久化数据 可配置驱动：支持本地存储或网络存储 性能优化：命名卷在某些平台（特别是 Windows 和 macOS）上性能更好 实际使用示例：\n# 查看卷列表 docker volume ls # 备份数据卷 docker run --rm -v laradock_mysql:/source -v $(pwd):/backup alpine tar -czvf /backup/mysql_backup.tar.gz -C /source . 资源限制配置 php-fpm: ulimits: nproc: 65535 nofile: soft: 20000 hard: 40000 mem_limit: 1024m Laradock 支持为服务配置资源限制：\n进程数限制：控制可创建的进程数 文件描述符限制：影响并发连接能力 内存限制：防止单个容器消耗过多资源 这些设置对于生产环境特别重要，可以防止单个服务耗尽系统资源。\n端口映射策略 mysql: ports: - \u0026#34;${MYSQL_PORT}:3306\u0026#34; Laradock 采用可配置的端口映射策略：\n所有端口都可配置：通过环境变量定义外部端口 避免默认暴露端口：增强安全性 灵活处理端口冲突：可以在不同项目使用不同端口 端口冲突是多项目开发中常见的问题，这种设计可以轻松避免。\nPHP 扩展管理 常用开发扩展 Xdebug ARG INSTALL_XDEBUG=false RUN if [ ${INSTALL_XDEBUG} = true ]; then \\ # 安装 Xdebug 并配置 pecl install xdebug \u0026amp;\u0026amp; \\ docker-php-ext-enable xdebug \\ fi Xdebug 是 PHP 的调试和分析工具。在 Laradock 中，可以通过环境变量控制是否安装：\nWORKSPACE_INSTALL_XDEBUG=true PHP_FPM_INSTALL_XDEBUG=true 实际使用配置（php.ini）：\n[xdebug] xdebug.mode=debug xdebug.client_host=host.docker.internal xdebug.client_port=9003 xdebug.start_with_request=yes PCOV PCOV 是一个轻量级代码覆盖率驱动，比 Xdebug 更快：\n专注于代码覆盖率分析 与 PHPUnit 完全兼容 性能影响比 Xdebug 小 在 Laravel 项目中使用示例：\nphp -dpcov.enabled=1 vendor/bin/phpunit --coverage-html coverage Taint Taint 是由 PHP 核心开发者鸟哥（惠新宸）开发的 PHP 扩展，用于检测 XSS 代码：\n自动检测可能的 XSS 漏洞 低运行时开销 适合在开发环境中使用 数据库相关扩展 OCI8 ARG INSTALL_OCI8=false ARG ORACLE_INSTANT_CLIENT_MIRROR=https://github.com/the-paulus/oracle-instantclient/raw/master/ ARG ORACLE_INSTANT_CLIENT_ARCH=x86_64 ARG ORACLE_INSTANT_CLIENT_MAJOR=18 ARG ORACLE_INSTANT_CLIENT_MINOR=3 RUN if [ ${INSTALL_OCI8} = true ]; then \\ # 安装 Oracle Instantclient 和 PHP OCI8 扩展 ... fi OCI8 用于连接 Oracle 数据库，通过 Oracle Call Interface 提供完整的功能：\n支持 Oracle 的所有数据类型 处理大型对象（LOB） 支持绑定变量和存储过程 示例代码：\n$conn = oci_connect(\u0026#39;username\u0026#39;, \u0026#39;password\u0026#39;, \u0026#39;localhost/XE\u0026#39;); $stmt = oci_parse($conn, \u0026#39;SELECT * FROM employees\u0026#39;); oci_execute($stmt); while ($row = oci_fetch_array($stmt, OCI_ASSOC+OCI_RETURN_NULLS)) { var_dump($row); } Redis Laradock 支持两种 Redis 扩展：\nPhpRedis：C 扩展，性能更好 Predis：纯 PHP 实现，更灵活 PhpRedis 安装示例：\nARG INSTALL_PHPREDIS=false RUN if [ ${INSTALL_PHPREDIS} = true ]; then \\ pecl install redis \u0026amp;\u0026amp; \\ docker-php-ext-enable redis \\ fi 性能优化扩展 OPcache OPcache 通过将 PHP 脚本预编译的字节码存储在共享内存中来提高性能，减少加载和解析的开销：\n[opcache] opcache.enable=1 opcache.memory_consumption=128 opcache.interned_strings_buffer=8 opcache.max_accelerated_files=4000 opcache.validate_timestamps=0 opcache.save_comments=1 opcache.fast_shutdown=0 在生产环境中，可以设置 validate_timestamps=0 来防止 OPcache 检查文件变化，进一步提高性能。\nAPCu APCu 是一个用户数据缓存系统，可以在 PHP 进程中存储 key-value 数据：\napcu_store(\u0026#39;my_key\u0026#39;, \u0026#39;my_value\u0026#39;, 3600); // 存储数据，过期时间为 1 小时 $value = apcu_fetch(\u0026#39;my_key\u0026#39;); // 读取数据 与 OPcache 不同，APCu 专注于用户数据缓存，而非代码缓存。\n实用工具与配置 软件源和镜像 # 将应用源从 deb.debian.org 更改为阿里云源 sed -i \u0026#39;s/deb.debian.org/mirrors.tuna.tsinghua.edu.cn/\u0026#39; /etc/apt/sources.list \u0026amp;\u0026amp; \\ sed -i \u0026#39;s/security.debian.org/mirrors.tuna.tsinghua.edu.cn/\u0026#39; /etc/apt/sources.list \u0026amp;\u0026amp; \\ sed -i \u0026#39;s/security-cdn.debian.org/mirrors.tuna.tsinghua.edu.cn/\u0026#39; /etc/apt/sources.list \\ 在国内环境使用 Laradock 时，配置国内镜像源可以大幅提升构建速度：\n系统源：使用 TUNA 或阿里云源 Composer：配置 Packagist 中国镜像 NPM：配置淘宝 NPM 镜像 可以在 .env 文件中设置：\nWORKSPACE_NPM_REGISTRY=https://registry.npm.taobao.org/ WORKSPACE_COMPOSER_REPO_PACKAGIST=https://mirrors.aliyun.com/composer/ Node.js 配置 ARG INSTALL_NODE=false ARG NODE_VERSION=node ARG INSTALL_NPM_GULP=false ARG INSTALL_NPM_BOWER=false ARG INSTALL_NPM_VUE_CLI=false ARG INSTALL_NPM_ANGULAR_CLI=false ARG NPM_REGISTRY RUN if [ ${INSTALL_NODE} = true ]; then \\ # 安装 nvm 和 Node.js ... fi Laradock 的 Node.js 配置非常灵活：\n使用 NVM 管理 Node.js 版本 支持配置 NPM 镜像源 可选安装常用前端工具（Vue CLI、Angular CLI 等） 支持 Yarn 和 PNPM 等现代包管理器 使用案例：\nWORKSPACE_INSTALL_NODE=true WORKSPACE_NODE_VERSION=16 WORKSPACE_NPM_REGISTRY=https://registry.npm.taobao.org/ WORKSPACE_INSTALL_NPM_VUE_CLI=true 常用命令工具 update-alternatives update-alternatives 用于管理 Linux 系统中的命令替代版本：\n# 设置默认 PHP 版本 update-alternatives --set php /usr/bin/php7.4 Laradock 使用这个命令管理多个 PHP 版本。\ndocker-php-ext-disable # 禁用不需要的扩展（不需要重新编译） docker-php-ext-disable xdebug pcov Laradock 特有的实用脚本，允许：\n在生产环境中禁用性能密集型扩展 保留扩展文件但不加载，避免重新编译 需要时快速重新启用扩展 这对于开发/生产环境切换非常有用，可以保持相同的镜像但有不同的扩展启用状态。\n常用操作指南 基本使用流程 # 克隆 Laradock 仓库 git clone https://github.com/laradock/laradock.git # 复制环境配置文件 cp .env.example .env # 编辑配置文件，设置项目路径等 vim .env # 构建并启动容器 docker compose up -d nginx mysql redis 常用维护命令 # 构建特定服务 docker compose build workspace php-fpm # 进入容器 docker compose exec workspace bash # 查看日志 docker compose logs nginx # 停止所有容器 docker compose down 故障排除 端口冲突：修改 .env 文件中的端口映射\nNGINX_HOST_HTTP_PORT=8080 MYSQL_PORT=33060 权限问题：确保 PUID/PGID 设置正确\nPUID=$(id -u) PGID=$(id -g) 内存不足：增加 Docker 分配的资源，或减少启用的服务\ndocker compose up -d nginx php-fpm mysql 高级功能 多项目环境 Laradock 支持同时运行多个项目：\n. ├── laradock/ │ ├── docker-compose.yml │ └── .env ├── project1/ ├── project2/ └── project3/ 配置示例：\nAPP_CODE_PATH_HOST=../:/var/www NGINX_SITES_PATH=./nginx/sites/ 然后为每个项目创建 Nginx 配置文件：\n# ./nginx/sites/project1.conf server { server_name project1.test; root /var/www/project1/public; # ... } 多架构支持 # 支持 ARM 和 x86 架构 FROM --platform=${TARGETPLATFORM} php:${PHP_VERSION}-fpm-alpine ARG TARGETPLATFORM ARG BUILDPLATFORM Laradock 现代版本支持：\n使用 Docker BuildKit 进行多架构构建 在 ARM 设备（M1/M2 Mac、树莓派）上本地开发 通过 GitHub Actions 实现跨平台自动构建 使用多架构镜像的命令：\n# 显示支持的架构 docker manifest inspect laradock/workspace:latest # 构建多架构镜像 docker buildx build --platform linux/amd64,linux/arm64 -t myname/myapp:latest . CI/CD 集成 Laradock 可以与各种 CI/CD 工具集成：\n# .gitlab-ci.yml 示例 stages: - build - test - deploy build: stage: build script: - cd laradock - docker compose build php-fpm workspace test: stage: test script: - cd laradock - docker compose up -d php-fpm mysql - docker compose exec workspace php artisan test 可以使用 Docker Compose 的 --profile 参数为不同环境创建配置：\n# 开发环境 docker compose --profile dev up -d # 测试环境 docker compose --profile test up -d 最佳实践 优化构建速度 使用 BuildKit：\nDOCKER_BUILDKIT=1 docker compose build 创建层缓存：\n# 先复制依赖文件，安装依赖，然后再复制应用代码 COPY composer.json composer.lock ./ RUN composer install --no-scripts --no-autoloader COPY . . RUN composer dump-autoload --optimize 多阶段构建：\nFROM php:7.4-fpm AS builder # 安装构建依赖... FROM php:7.4-fpm # 只复制需要的文件 COPY --from=builder /var/www/vendor /var/www/vendor 安全最佳实践 避免使用 root 用户：\nUSER laradock 限制容器能力：\nsecurity_opt: - no-new-privileges:true 使用健康检查：\nhealthcheck: test: [\u0026#34;CMD\u0026#34;, \u0026#34;php\u0026#34;, \u0026#34;-v\u0026#34;] interval: 30s timeout: 10s retries: 3 定期更新基础镜像：\ndocker compose pull docker compose build --pull References Laradock 官方文档 Laradock GitHub 仓库 Docker 官方文档 PHP 官方文档 Laradock - A PHP Developer\u0026rsquo;s best friend. | dev.to 如何优化 Docker 镜像构建 Docker Compose 参考 ","permalink":"https://zyf.im/2022/11/09/explore-laradock/","summary":"\u003ch2 id=\"laradock-简介\"\u003eLaradock 简介\u003c/h2\u003e\n\u003cp\u003eLaradock 是一个基于 Docker 的完整 PHP 开发环境，专为 PHP 开发者（特别是 Laravel 开发者）设计。它提供了一套预配置的 Docker 容器，包含开发中常用的服务，如 Nginx、MySQL、Redis、PHP-FPM 等。\u003c/p\u003e\n\u003ch3 id=\"主要优势\"\u003e主要优势\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003e开箱即用\u003c/strong\u003e：预配置的开发环境，无需繁琐设置\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003e一致性\u003c/strong\u003e：确保开发、测试和生产环境的一致性\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003e灵活性\u003c/strong\u003e：支持多种 PHP 版本和扩展\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003e模块化\u003c/strong\u003e：可以根据需要启用或禁用特定服务\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003e跨平台\u003c/strong\u003e：在 Windows、macOS 和 Linux 上表现一致\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"基本架构\"\u003e基本架构\u003c/h3\u003e\n\u003cp\u003eLaradock 采用模块化设计，每个服务都运行在独立的容器中，通过 Docker 网络连接：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eWorkspace\u003c/strong\u003e：包含开发工具的容器\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ePHP-FPM\u003c/strong\u003e：PHP 解释器\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eNginx/Apache\u003c/strong\u003e：Web 服务器\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eMySQL/PostgreSQL/MongoDB\u003c/strong\u003e：数据库\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRedis/Memcached\u003c/strong\u003e：缓存\u003c/li\u003e\n\u003cli\u003e其他辅助服务（邮件服务器、消息队列等）\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"dockerfile\"\u003eDockerfile\u003c/h2\u003e\n\u003ch3 id=\"debian_frontend\"\u003eDEBIAN_FRONTEND\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-dockerfile\" data-lang=\"dockerfile\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eENV\u003c/span\u003e \u003cspan class=\"nv\"\u003eDEBIAN_FRONTEND\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003enoninteractive\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eDEBIAN_FRONTEND 环境变量用于告知操作系统应该从哪儿获得用户输入。\u003c/p\u003e\n\u003cp\u003e设置为 \u0026ldquo;noninteractive\u0026rdquo; 可以实现自动安装而无需用户交互，对于 CI/CD 流程和 Docker 构建特别有用。这在运行 apt-get 命令时尤为重要，因为它会自动选择默认选项并以最快速度完成构建。\u003c/p\u003e\n\u003cp\u003e最佳实践是在 RUN 命令中设置该变量，而不是使用 ENV 进行全局设置，因为全局设置会影响容器运行时的交互体验：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-dockerfile\" data-lang=\"dockerfile\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eRUN\u003c/span\u003e \u003cspan class=\"nv\"\u003eDEBIAN_FRONTEND\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003enoninteractive apt-get update \u003cspan class=\"o\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e apt-get install -y ...\u003cspan class=\"err\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"基于角色的用户配置\"\u003e基于角色的用户配置\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-dockerfile\" data-lang=\"dockerfile\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c\"\u003e# 创建非 root 用户防止文件在宿主机上创建时具有 root 权限\u003c/span\u003e\u003cspan class=\"err\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"err\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003eARG\u003c/span\u003e \u003cspan class=\"nv\"\u003ePUID\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e1000\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eENV\u003c/span\u003e PUID \u003cspan class=\"si\"\u003e${\u003c/span\u003e\u003cspan class=\"nv\"\u003ePUID\u003c/span\u003e\u003cspan class=\"si\"\u003e}\u003c/span\u003e\u003cspan class=\"err\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"err\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003eARG\u003c/span\u003e \u003cspan class=\"nv\"\u003ePGID\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e1000\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eENV\u003c/span\u003e PGID \u003cspan class=\"si\"\u003e${\u003c/span\u003e\u003cspan class=\"nv\"\u003ePGID\u003c/span\u003e\u003cspan class=\"si\"\u003e}\u003c/span\u003e\u003cspan class=\"err\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"err\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"err\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003eRUN\u003c/span\u003e \u003cspan class=\"nb\"\u003eset\u003c/span\u003e -xe\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e    groupadd -g \u003cspan class=\"si\"\u003e${\u003c/span\u003e\u003cspan class=\"nv\"\u003ePGID\u003c/span\u003e\u003cspan class=\"si\"\u003e}\u003c/span\u003e laradock \u003cspan class=\"o\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e    useradd -l -u \u003cspan class=\"si\"\u003e${\u003c/span\u003e\u003cspan class=\"nv\"\u003ePUID\u003c/span\u003e\u003cspan class=\"si\"\u003e}\u003c/span\u003e -g laradock -m laradock -G docker_env \u003cspan class=\"o\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e    usermod -p \u003cspan class=\"s2\"\u003e\u0026#34;*\u0026#34;\u003c/span\u003e laradock -s /bin/bash\u003cspan class=\"err\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e这段配置创建了一个非 root 用户 \u003ccode\u003elaradock\u003c/code\u003e，解决了容器和宿主机之间文件权限问题：\u003c/p\u003e","title":"Laradock 学习笔记"},{"content":"建立独立的分支 当想在项目中使用一个独立分支进行项目文档的管理时，或者当我们想要发布一个软件的开源版本但又不希望将软件的版本历史暴露给外界时，都可以使用以下的方法建立一个独立分支：\ngit help checkout # git checkout --orphan \u0026lt;new-branch\u0026gt; \u0026lt;start-point\u0026gt; 修改提交时间 # 指定本次提交时间 git commit -m \u0026#34;fix...\u0026#34; --date=`date -R` git commit -m \u0026#34;fix...\u0026#34; --date=\u0026#34;$(date -R)\u0026#34; git commit -m \u0026#34;fix...\u0026#34; --date=\u0026#34;Tue, 11 Jun 2019 17:50:50 +0800\u0026#34; # 修改上次提交时间 git commit --amend --date=`date -R` # 风险操作。会修改 history hash. 忽略文件权限修改 # Git 默认会记录文件权限的修改，可关闭 git config core.filemode false git status 中文文件名乱码 git config --global core.quotepath false 当 core.quotepath 设置为 false 时，Git 将不会对路径名进行 quoting，这意味着路径名中的特殊字符将不被转义。\nGit 中文显示问题解决\n工作区中删除未跟踪的文件 # 查看文档 git help clean git clean -h # git clean [-d] [-f] [-i] [-n] [-q] [-e \u0026lt;pattern\u0026gt;] [-x | -X] [--] [\u0026lt;pathspec\u0026gt;...] # 【查看】有哪些文件将被删除 git clean -n # 【查看】删除 Git【忽略】的文件与文件夹 git clean -Xn # 【查看】删除【src 路径下】下的【未跟踪】文件以及文件夹 git clean -d -- src # 如果想执行删除 -n 替换为 -f，注意风险。 Git 清除未跟踪文件 | github.io\nrebase git rebase in depth Gitflow workflow Gitflow workflow A successful Git branching model 相关站点 Git教程 | 廖雪峰的官方网站 git - 简明指南 语义化版本 2.0.0 | semver.org Git from the Bottom Up Tower\u0026rsquo;s Learning Resources A successful Git branching model References 圖解 Git 版本控制: Cola Git GUI (1) \u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2022/10/01/git-code-snippet/","summary":"\u003ch2 id=\"建立独立的分支\"\u003e建立独立的分支\u003c/h2\u003e\n\u003cp\u003e当想在项目中使用一个独立分支进行项目文档的管理时，或者当我们想要发布一个软件的开源版本但又不希望将软件的版本历史暴露给外界时，都可以使用以下的方法建立一个独立分支：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit \u003cspan class=\"nb\"\u003ehelp\u003c/span\u003e checkout\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# git checkout --orphan \u0026lt;new-branch\u0026gt; \u0026lt;start-point\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"修改提交时间\"\u003e修改提交时间\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# 指定本次提交时间\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit commit -m \u003cspan class=\"s2\"\u003e\u0026#34;fix...\u0026#34;\u003c/span\u003e --date\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"sb\"\u003e`\u003c/span\u003edate -R\u003cspan class=\"sb\"\u003e`\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit commit -m \u003cspan class=\"s2\"\u003e\u0026#34;fix...\u0026#34;\u003c/span\u003e --date\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"k\"\u003e$(\u003c/span\u003edate -R\u003cspan class=\"k\"\u003e)\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit commit -m \u003cspan class=\"s2\"\u003e\u0026#34;fix...\u0026#34;\u003c/span\u003e --date\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;Tue, 11 Jun 2019 17:50:50 +0800\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# 修改上次提交时间\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit commit --amend --date\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"sb\"\u003e`\u003c/span\u003edate -R\u003cspan class=\"sb\"\u003e`\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# 风险操作。会修改 history hash.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"忽略文件权限修改\"\u003e忽略文件权限修改\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Git 默认会记录文件权限的修改，可关闭\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit config core.filemode \u003cspan class=\"nb\"\u003efalse\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"git-status-中文文件名乱码\"\u003egit status 中文文件名乱码\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit config --global core.quotepath \u003cspan class=\"nb\"\u003efalse\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e当 \u003ccode\u003ecore.quotepath\u003c/code\u003e 设置为 \u003ccode\u003efalse\u003c/code\u003e 时，Git 将不会对路径名进行 quoting，这意味着路径名中的特殊字符将不被转义。\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ca href=\"http://xstarcd.github.io/wiki/shell/git_chinese.html\"\u003eGit 中文显示问题解决\u003c/a\u003e\u003c/p\u003e\u003c/blockquote\u003e\n\u003ch2 id=\"工作区中删除未跟踪的文件\"\u003e工作区中删除未跟踪的文件\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# 查看文档\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit \u003cspan class=\"nb\"\u003ehelp\u003c/span\u003e clean\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit clean -h\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# git clean [-d] [-f] [-i] [-n] [-q] [-e \u0026lt;pattern\u0026gt;] [-x | -X] [--] [\u0026lt;pathspec\u0026gt;...]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# 【查看】有哪些文件将被删除\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit clean -n\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# 【查看】删除 Git【忽略】的文件与文件夹\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit clean -Xn\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# 【查看】删除【src 路径下】下的【未跟踪】文件以及文件夹\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit clean -d -- src\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# 如果想执行删除 -n 替换为 -f，注意风险。\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cblockquote\u003e\n\u003cp\u003e\u003ca href=\"http://glgjing.github.io/blog/2015/01/09/git-qing-chu-wei-gen-zong-wen-jian/\"\u003eGit 清除未跟踪文件 | github.io\u003c/a\u003e\u003c/p\u003e","title":"Git Code Snippet"},{"content":" MySQL 实战 45 讲 | 林晓斌\n","permalink":"https://zyf.im/2022/09/14/mysql-course-45-part2/","summary":"\u003cblockquote\u003e\n\u003cp\u003e\u003ca href=\"http://gk.link/a/11AmM\"\u003eMySQL 实战 45 讲 | 林晓斌\u003c/a\u003e\u003c/p\u003e\u003c/blockquote\u003e","title":"MySQL 实战 45 讲 Part2"},{"content":" MySQL 实战 45 讲 | 林晓斌\n01 | 基础架构：一条 SQL 查询语句是如何执行的？ 连接器：跟客户端建立连接、获取权限、维持和管理连接。\nSHOW PROCESSLIST; 137462239 db 10.135.4.7:41261 db Query 0 starting show processlist -- 一个空闲连接 137462293 db 10.130.128.1:47174 db Sleep 24 -- 客户端如果太长时间没动静，连接器就会自动将它断开 select @@wait_timeout; show variables like \u0026#39;wait_timeout\u0026#39;; -- 28800 8h 通过执行 mysql_reset_connection 来重新初始化连接资源，这是个接口函数，不是一个 SQL 语句。\n查询缓存：不建议使用。在一个表上有更新的时候，跟这个表有关的查询缓存都会失效。\nselect @@query_cache_type; -- OFF sysvar_query_cache_type | mysql 分析器：词法分析、语法分析。进行分词和验证语法规则。解析器和预处理器。\n解析器处理语法和解析查询，生成一课对应的解析树。 预处理器进一步检查解析树的合法。比如: 数据表和数据列是否存在，别名是否有歧义等。如果通过则生成新的解析树，再提交给优化器。 优化器：决定使用哪个索引，决定各个表的连接顺序。\n执行器：有没有执行查询的权限，操作引擎，返回结果。执行器调用的次数（rows_examined）与引擎总共扫描行数可能是不等的，后文有例子。\n读写、存取数据在 engine 引擎层，连接、鉴权、计算在 server 服务层。\n连接的长短是由客户端来决定的，MySQL 服务端不会主动断开连接，除非到了 waiting_timeout 所设置的时间。\n查询一个没用 k 列的表 1054 - Unknown column 'k' in 'field list' 是在哪阶段报错的？\n答案是：分析器。分析器在词法分析阶段，需要知道 SQL 中的每个字段代表什么意思，所以在这个阶段就可以判断表中存不存在 k 这一列。 不是执行器的原因：有人说在执行器时才打开表获取数据，但是表的字段不是数据，是事先定义好的，所以可以直接读取的，不需要打开表。 02 | 日志系统：一条 SQL 更新语句是如何执行的？ WAL 的全称是 Write-Ahead Logging，先写日志，再写磁盘。\nredo log 是 InnoDB 引擎特有的；binlog 是 MySQL 的 Server 层实现的，所有引擎都可以使用 redo log 是物理日志，记录的是“在某个数据页上做了什么修改”；binlog 是逻辑日志，记录的是这个语句的原始逻辑，比如“给 ID=2 这一行的 c 字段加 1”。 redo log 是循环写的，空间固定会用完；binlog 是可以追加写入的。“追加写”是指 binlog 文件写到一定大小后会切换到下一个，并不会覆盖以前的日志。 物理：InnoDB 存储引擎提供接口给执行器调用（操作数据），数据库的数据是存在磁盘上的（或者说硬盘上），那么 redo log 记录存储引擎修改硬盘上的数据的操作就叫做物理操作；物理日志就只有“我”自己能用，别人没有共享我的“物理格式”。 逻辑：binlog 归档日志，有两种模式 1 statement 记录 SQL；2 row 格式记录两条数据，数据修改前的样子，数据修改后的样子。记录的是一种逻辑上的变化 。逻辑日志可以给别的数据库，别的引擎使用，已经大家都讲得通这个“逻辑”。 把 binlog 夹在 redo log 中间，就是为了保证如果 redo 提交前的任何失败，都会带来回滚，binlog 的写入也应该不会成功，只有这样，才能保证两个一致。\n如果提交了 binlog，提交事务接口崩溃了，恢复时 redo log 有日志记录，binlog 有日志记录，一致，直接自动提交事务，事务完成确认数据修改成功。 如果提交 binlog 前就崩了，redo log 是 prepare 阶段，binlog 没有记录不一致，事务回滚，事务执行失败。 redo log 负责事务、crash-safe；binlog 负责归档恢复。redo log 是物理的，binlog 是逻辑的。\nredo log 是顺序写，数据文件是随机写。\nMySQL 的记录是以“页”为单位存取的，默认大小 16K。也就是说，你要访问磁盘中一个记录，不会只读这个记录，而会把它所在的 16K 数据一起读入内存。\n-- 每个 binlog 文件的大小 SELECT @@max_binlog_size / 1024 / 1024; -- 256.00000000 -- 一页数据大小 SELECT @@innodb_page_size / 1024; -- 16.0000 redo log 和 binlog 都可以用于表示事务的提交状态，而两阶段提交就是让这两个状态保持逻辑上的一致。\n-- 保证 crash-safe 能力；每次事务的 redo log 都直接持久化到磁盘 select @@innodb_flush_log_at_trx_commit; -- 2 -- 每次事务的 binlog 都持久化到磁盘 select @@sync_binlog; -- 0 SELECT @@binlog_format; -- STATEMENT 是记 SQL 语句，但是有风险比如时间函数 -- ROW 记录行的内容，记两条，更新前和更新后都有 彻底搞懂三大 MySQL 日志，Redo Log、Undo Log、Bin Log 彻底搞懂 mysql 日志系统 binlog,redolog,undolog 03 | 事务隔离：为什么你改了我还看不见？ 脏读（dirty read）读到其他事务未提交的数据，仅发生在读未提交的的隔离级别下：\n-- session1 当数据库中一个事务A正在修改一个数据但是还未提交或者回滚 BEGIN; SELECT k FROM T1 WHERE id=1; -- 1 UPDATE T1 SET k=2 WHERE id=1; -- session2 SET SESSION TRANSACTION ISOLATION LEVEL READ UNCOMMITTED; SELECT k FROM T1 WHERE id=1; -- 2 session2 出现脏读 不可重复读（non-repeatable read）前后读取的记录内容不一致，发生在读未提交、读提交的隔离级别：\n-- session1 在一个事务A中多次操作数据，在事务操作过程中(未最终提交) SET SESSION TRANSACTION ISOLATION LEVEL READ COMMITTED; BEGIN; SELECT k FROM T1 WHERE id=1; -- 1 -- session2 修改改值 UPDATE T1 SET k=2 WHERE id=1; -- session1 SELECT k FROM T1 WHERE id=1; -- 2 session1 出现不可重复读 幻读（phantom read）前后读取的记录数量不一致，发生在读未提交、读提交的隔离级别，InnoDB RR 不发生幻读：\n-- session1 获取当前行数量 SET SESSION TRANSACTION ISOLATION LEVEL READ COMMITTED; BEGIN; SELECT * FROM T1 WHERE k=1; -- 1 -- session2 插入一行数 INSERT INTO T1 (k) VALUES (1); -- session1 SELECT count(*) FROM T1; -- 2 -- session1 表数据 BEGIN; SELECT * FROM T1; -- id,k 1,1 只有一行数据 -- session2 更新 id 主键 UPDATE T1 SET id=5 WHERE id=1; -- session1 SELECT * FROM T1; -- id,k 1,1 UPDATE T1 SET id=id+1; -- ok SELECT * FROM T1; -- 竟然看到了两行 1,1 6,1 -- 1,1 MVCC 保证了 1,1 的存在 -- 因为主键的 UPDATE 在 MySQL 里是以 insert+delete 方式执行的。这个 6 和 1 在 MySQL 看来已经不是同一行数据了，1 的 delete version 是在事务 1 的可见范围，所以才能看得到。如果是非主键就只用一行，就是下面的例子. -- 这个例子不能被归类为幻读，只不过是当前最新读带来的问题。 -- session1 获取 id=1 的 k BEGIN; SELECT k FROM T1; -- 1 一行数据 -- session2 更新 UPDATE T1 SET k=2; -- session1 SELECT k FROM T1; -- 1 UPDATE T1 SET k=k+1; -- ok SELECT k FROM T1; -- 3 关于幻读，可重复读的真实用例是什么？| zhihu 不可重复读和幻读区别：由于在 InnoDB RR 下模拟不出幻读的场景，退回到 RC 隔离级别的话就容易把幻读和不可重复读搞混淆。理论上 RR 级别是无法解决幻读的问题, 但是由于 InnoDB 引擎的 RR 级别还使用了 MVCC，所以也就避免了幻读的出现。\n后文有讲到 FOR UPDATE 下的幻读。\n事务隔离级别：\n读未提交（READ UNCOMMITTED）一个事务还没提交时，它做的变更就能被别的事务看到。直接返回记录上的最新值，没有视图概念。 读提交（READ COMMITTED）一个事务提交之后，它做的变更才会被其他事务看到。这个视图是在每个 SQL 语句开始执行的时候创建的。 可重复读（REPEATABLE READ）一个事务执行过程中看到的数据，总是跟这个事务在启动时看到的数据是一致的 read-view。当然在可重复读隔离级别下，未提交变更对其他事务也是不可见的。这个视图是在事务启动时（第一个 SQL 执行时）创建的，整个事务存在期间都用这个视图。 串行化（SERIALIZABLE）对于同一行记录，“写”会加“写锁”，“读”会加“读锁”。当出现读写锁冲突的时候，后访问的事务必须等前一个事务执行完成，才能继续执行。用加锁的方式来避免并行访问。 show variables like \u0026#39;%tx_isolation%\u0026#39;; show variables like \u0026#39;transaction_isolation\u0026#39;; -- tx_isolation REPEATABLE-READ select @@tx_isolation; -- REPEATABLE-READ SET SESSION TRANSACTION ISOLATION LEVEL READ UNCOMMITTED; -- 修改 session 事务隔离级别 SET TRANSACTION Statement | mysql\n多版本并发控制（MVCC）\nset autocommit=0，这个命令会将这个线程的自动提交关掉。\n-- 持续时间超过 60s 的事务 select * from information_schema.innodb_trx where TIME_TO_SEC(timediff(now(),trx_started))\u0026gt;60; commit work and chain; -- 等价于 commit; begin; 如何避免长事务对业务的影响？\n确认是否使用了 set autocommit=0，如果没有，则可以使用 set autocommit=1 来避免长事务对业务的影响。 确认是否有不必要的只读事务。有些框架会习惯不管什么语句先用 begin/commit 框起来。 业务连接数据库的时候，根据业务本身的预估，通过 SET MAX_EXECUTION_TIME 命令，来控制每个语句执行的最长时间，避免单个语句意外执行太长时间。 监控 information_schema.Innodb_trx 表，设置长事务阈值。 开发测试阶段输出所用 general_log，分析日志提前发现问题。 04 | 深入浅出索引（上） 哈希表：这种结构适用于只有等值查询的场景。 有序数组：有序数组在等值查询和范围查询场景中的性能就都非常优秀。但有序数组索引只适用于静态存储引擎 搜索树：平衡二叉树是 O(log(N)) 的查询复杂度；N 叉树，以 InnoDB 整数字段索引为例，这个 N 差不多是 1200。 MySQL 默认一个节点的长度为 16K，一个整数（bigint）字段索引的长度为 8B，另外每个索引还跟着 6B 的指向其子树的指针；所以 16K/14B ≈ 1170\ninnodb B+树主键索引的叶子节点存的是什么：\n回复 1：\nInnoDB 磁盘管理的最小单位就是“页”，也就是说无论是叶子节点、非叶子节点和行数据，都是存放在页当中。页组成结构有头部数据、主体数据和尾部数据。头部数据主要存的是页相关数据，例如上一页、下一页、当前页号等。是一个双向链表结构。主体数据主要关注索引和数据的存储，也就是我们常说的索引和数据的存储位置。主体数据当中有一个“User Records”的概念，用来存储索引和数据，是一个单链表结构。 User Records 根据节点的不同，User Records 又分为四种不同类型：主键索引树叶子节点和非叶子节点，二级索引树叶子节点和非叶子节点。 有了页和 User Records 的认识，其实说叶子节点存的是页是一种笼统的回答，基于我的理解，我认为叶子节点（主键索引树叶子节点）存放的是行数据更为贴切。\n回复 2：\nB+树的叶子节点是 page（页），一个页里面可以存多个行。 B+树的结点跟 innoDB 的“页”都属于一种抽象逻辑概念。如果你要问“存”的是什么？我觉得回答行数据没毛病。因为存的不可能是“页”。这一逻辑概念，只能说这个叶结点大小等于 innoDB 里设置的页大小，或者说这个叶结点其实就是“页”。但存的是什么？那当然是数据，什么数据？当然是表中的行数据。\n索引类型分为主键索引和非主键索引。\n主键索引也被称为聚簇索引（clustered index） 非主键索引也被称为二级索引（secondary index） 基于非主键索引的查询需要多扫描一棵索引树，也就是主键索引树，也就是回表操作。\n自增主键的意义：\n性能方面：每次插入一条新记录，都是追加操作，都不涉及到挪动其他记录，也不会触发叶子节点的分裂（页分裂）。 存储空间方面：主键长度越小，普通索引的叶子节点就越小，普通索引占用的空间也就越小。 有没有什么场景适合用业务字段直接做主键的呢？\n只有一个索引 该索引必须是唯一索引 即典型的 KV 场景。\n非聚集索引上为啥叶子节点的 value 为什么不是地址，这样可以直接定位到整条数据，而不用再次对整棵树进行查询？\n这个叫作“堆组织表”，MyISAM 就是这样的，各有利弊。你想一下如果修改了数据的位置的情况，InnoDB 这种模式是不是就方便些。主键索引页分裂的场景，就可能会导致主键记录的地址发生变化，这时候需要更新每一个索引上面对主键记录地址的引用。\n05 | 深入浅出索引（下） 覆盖索引：在查询里索引已经覆盖了查询需要的列。覆盖索引可以减少树的搜索次数，显著提升查询性能，是一个常用的性能优化手段。\nselect * from T where k between 3 and 5; 表中 k 的值是：1，2，3，5，6，7。引擎内部使用覆盖索引在索引 k 上其实读了三个记录（第一次 3，第二次 3 的下一个 5，第三次 5 的下一个 6 不满足 ），但是对于 MySQL 的 Server 层来说，它只是找引擎拿到了两条记录，因此 MySQL 认为扫描行数是 2。这就是引擎实际扫描条数不等于 MySQL explain 语句中的 rows 字段的原因。\n最左前缀原则：B+树这种索引结构，可以利用索引的“最左前缀”，来定位记录。\n第一原则是，如果通过调整顺序，可以少维护一个索引，那么这个顺序往往就是需要优先考虑采用的。\n如果需要常查人的名字与年龄。可以建立索引 (name,age) 与 (age)，而不是 (age,name) 与 (age)，考虑的原则就是空间。\n索引下推优化（index condition pushdown)：\n联合索引（name,age）为例，名字第一个字是张，而且年龄是 10 岁的所有男孩：\nselect * from tuser where name like \u0026#39;张%\u0026#39; and age=10 and ismale=1; 这个语句在搜索索引树的时候，只能用 “张”。\n在 MySQL 5.6 之前，只能从符合 \u0026lsquo;张%\u0026rsquo; 开始一个个回表。到主键索引上找出数据行，再对比字段值。 而 MySQL 5.6 引入的索引下推优化（index condition pushdown)，可以在索引遍历过程中，对索引中包含的字段先做判断，直接过滤掉不满足条件的记录，减少回表次数。 InnoDB 在（name,age）索引内部就判断了 age 是否等于 10，对于不等于 10 的记录，直接判断并跳过。\n联合索引中是按索引列的顺序，来排序的。（name,age）先排 name 列的值，再排 age 列的值。\n在满足语句需求的情况下，尽量少地访问资源是数据库设计的重要原则之一。\n06 | 全局锁和表锁：给表加个字段怎么有这么多阻碍？ 全局锁：\n-- 加全局读锁 FTWRL，整个库处于只读状态；做全库逻辑备份 FLUSH TABLES WITH READ LOCK; -- 插入一行数据 SHOW PROCESSLIST; -- Waiting for global read lock -- 释放锁 UNLOCK TABLES; 但是让整库都只读，听上去就很危险：\n如果你在主库上备份，那么在备份期间都不能执行更新，业务基本上就得停摆。 如果你在从库上备份，那么备份期间从库不能执行主库同步过来的 binlog，会导致主从延迟。 在可重复读隔离级别下开启一个事务，来确保拿到一致性视图。mysqldump 使用参数 -single-transaction 就是如此执行的。而由于 MVCC 的支持，这个过程中数据是可以正常更新的。\n有了可重复读的事务隔离级别却还需要 FTWRL 的原因是：引擎不都支持这个事务隔离级别。\n既然要全库只读，为什么不使用 set global readonly=true 的方式\n在有些系统中，readonly 的值会被用来做其他逻辑，比如用来判断一个库是主库还是备库。修改 global 变量的方式影响面更大。 在异常处理机制上有差异。如果执行 FTWRL 命令之后由于客户端发生异常断开，那么 MySQL 会自动释放这个全局锁，整个库回到可以正常更新的状态。而将 整个库设置为 readonly 之后，如果客户端发生异常，则数据库就会一直保持 readonly 状态，这样会导致整个库长时间处于不可写状态，风险较高。 表级锁：\n第一类表锁：lock-tables | mysql\nLOCK TABLES T1 READ, T2 WRITE; -- 其他线程 写 T1、读写 T2 的语句都会被阻塞 -- 当前线程也只能执行 读 T1、读写 T2 的操作，其他表都不能访问 -- 当前线程读 T2 -- Waiting for table metadata lock -- 当前线程读 T3 -- 1100 - Table \u0026#39;T3\u0026#39; was not locked with LOCK TABLES -- 查看表锁 SHOW OPEN TABLES WHERE In_use \u0026gt; 0; 第二类 MDL（metadata lock)：\nMDL 不需要显式使用：\n当对一个表做增删改查操作的时候，加 MDL 读锁。读锁之间不互斥，因此你可以有多个线程同时对一张表增删改查。共享锁。 当要对表做结构变更操作的时候，加 MDL 写锁。读写锁之间、写锁之间是互斥的，用来保证变更表结构操作的安全性。如果有两个线程要同时给一个表加字段，其中一个要等另一个执行完才能开始执行。排他锁。 给一个小表加个字段，导致整个库挂了：\n-- session1 SET autocommit = 0; -- 关闭自动提交 BEGIN; -- 开启使用 SELECT * FROM T; -- 查询 T 表，一切 ok -- 获取 MDL 读锁 ok，因为在事务中，查询结束后没有释放读锁。 -- 事务中的 MDL 锁，在语句执行开始时申请，但是语句结束后并不会马上释放，而会等到整个事务提交后再释放。 SELECT * FROM information_schema.innodb_trx; -- 查询事务有个 RUNNING -- session2 SELECT * FROM T; -- 查询 T 表，一切 ok -- 获取 MDL 读锁 ok，查询结束后释放读锁。 -- session3 ALTER TABLE `T` ADD COLUMN `c2` varchar(255) NULL; -- 修改字段，卡住 -- blocked 原因：是因为 session1 的 MDL 读锁还没有释放，而 session3 需要 MDL 写锁，因此只能被阻塞。 SHOW OPEN TABLES WHERE In_use \u0026gt; 0; -- In_use 1 -- session4 SELECT * FROM T; -- 查询 T 表，卡住 -- blocked 原因：对表的增删改查操作都需要先申请 MDL 读锁，都被 session3 阻塞。 这里自己想了一个问题：session4 卡住后，session1 COMMIT 后，session4 的 SELECT 执行结果是否有 session3 的新列呢？\n从结果上看是没有的。开始以为是事务级别，但是调整为 READ UNCOMMITTED，session4 仍然没有新列。后来了解到 online DDL 意识到应该有关系。测试后得出 session3 在获取写锁后，在做 DDL 前会释放写锁加读锁，这时 session4 就可以执行了，但是这时 DDL 还没有执行，所以 session4 的执行结果没有新列。\n如果 session3 执行语句是：\nALTER TABLE `T` ADD COLUMN `c2` varchar(255) NULL, LOCK=EXCLUSIVE; -- NONE：允许并发查询和DML操作； -- SHARED：允许并发查询，但不允许DML操作； -- DEFAULT：允许尽可能多的并发查询或DML操作(或两者都允许)，没指定LOCK选项默认就为DEFAULT； -- EXCLUSIVE：不允许并发查询和DML操作。 EXCLUSIVE 时写锁会一直持有，一直等到 DDL 完毕 session4 才开始执行，所以 session4 的执行结果有新列。\n衍生问题：session3 如果没有 LOCK=EXCLUSIVE，session4 查询前 BEGIN; 开启事务那结果是如何呢？实验结果：session1 提交后，session3 session4 依然阻塞。\n衍生问题：session3 添加 LOCK=EXCLUSIVE，session4 查询前 BEGIN; 开启事务那结果是如何呢？实验结果：ssession1 提交后，session3 session4 正常结束。\n分析猜测 session3 阻塞的原因是：session1 提交后释放了读锁，session3 session4 拿到读锁，session3 DDL 操作完成后又要拿写锁，但是 session4 的读锁未释放，所以 session3 阻塞。那 session4 为啥阻塞呢？session4 可以获取读锁就应该可以执行完毕，遗留问题。\n如何安全地给小表加字段？\n解决长事务，事务不提交，就会一直占着 MDL 锁。 在 ALTER TABLE 语句里面设定等待时间，如果在这个指定的等待时间里面能够拿到 MDL 写锁最好，拿不到也不要阻塞后面的业务语句，先放弃。 ALTER TABLE tbl_name NOWAIT add column ... ALTER TABLE tbl_name WAIT N add column ... 实测：MySQL 5.7.30 不支持。腾讯云 MySQL 5.7.18-txsql-log 支持。\n支持 NOWAIT 语法 | cloud.tencent 07 | 行锁功过：怎么减少行锁对性能的影响？ 在 InnoDB 事务中，行锁是在需要的时候才加上的，但并不是不需要了就立刻释放，而是要等到事务结束时才释放。这个就是两阶段锁协议。\n如果事务中需要锁多个行，要把最可能造成锁冲突、最可能影响并发度的锁尽量往后放。\n举例：\n从顾客 A 账户余额中扣除电影票价；UPDATE 给影院 B 的账户余额增加这张电影票价；UPDATE 最容易发送锁等待的地方 记录一条交易日志。INSERT 以 3、1、2 顺序执行可以最大程度地减少了事务之间的锁等待，提升了并发度。\n当并发系统中不同线程出现循环资源依赖，涉及的线程都在等待别的线程释放资源时，就会导致这几个线程都进入无限等待的状态，称为死锁。\n上图 session1 在等 session2 id=2 的锁，session2 在等 session1 id=1 的锁，进入死锁状态。\n-- 所等待超时时间 s SELECT @@innodb_lock_wait_timeout; -- 7200 2h -- 死锁检测，发现死锁后，主动回滚死锁链条中的某一个事务 SELECT @@innodb_deadlock_detect; -- 1213 - Deadlock found when trying to get lock; try restarting transaction 主动死锁检测在发生死锁的时候，是能够快速发现并进行处理的，但是它也是有额外负担的：\n每当一个事务被锁的时候，就要看看它所依赖的线程有没有被别人锁住，如此循环，最后判断是否出现了循环等待，也就是死锁。\n每个新来的被堵住的线程，都要判断会不会由于自己的加入导致了死锁，这是一个时间复杂度是 O(n)的操作。假设有 1000 个并发线程要同时更新同一行，那么死锁检测操作就是 100 万这个量级的。这期间要消耗大量的 CPU 资源。即：热点行更新导致的性能问题。\n可以通过尝试将热点数据拆分多行进行处理，提高并发处理。\n08 | 事务到底是隔离的还是不隔离的？ begin/start transaction 命令并不是一个事务的起点，在执行到它们之后的第一个操作 InnoDB 表的语句，事务才真正启动。如果你想要马上启动一个事务：\nSTART TRANSACTION WITH CONSISTENT SNAPSHOT; 有两个“视图”的概念：\n一个是 view。它是一个用查询语句定义的虚拟表，在调用的时候执行查询语句并生成结果。创建视图的语法是 create view \u0026hellip;，而它的查询方法与表一样。 另一个是 InnoDB 在实现 MVCC 时用到的一致性读视图，即 consistent read view，用于支持 RC（Read Committed，读提交）和 RR（Repeatable Read，可重复读）隔离级别的实现。 在可重复读隔离级别下，事务在启动的时候就“拍了个快照”。注意，这个快照是基于整库的。\nInnoDB 里面每个事务有一个唯一的事务 ID，叫作 transaction id。它是在事务开始的时候向 InnoDB 的事务系统申请的，是按申请顺序严格递增的。\n","permalink":"https://zyf.im/2022/08/14/mysql-course-45-part1/","summary":"\u003cblockquote\u003e\n\u003cp\u003e\u003ca href=\"http://gk.link/a/11AmM\"\u003eMySQL 实战 45 讲 | 林晓斌\u003c/a\u003e\u003c/p\u003e\u003c/blockquote\u003e\n\u003ch2 id=\"01--基础架构一条-sql-查询语句是如何执行的\"\u003e01 | 基础架构：一条 SQL 查询语句是如何执行的？\u003c/h2\u003e\n\u003cimg alt=\"image\" src=\"https://user-images.githubusercontent.com/9289792/184530380-826038a0-335a-45f7-a56e-cff7b336b4a4.png\" style=\"width: 480px\" /\u003e\n\u003cp\u003e连接器：跟客户端建立连接、获取权限、维持和管理连接。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sql\" data-lang=\"sql\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eSHOW\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ePROCESSLIST\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"mi\"\u003e137462239\u003c/span\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"n\"\u003edb\u003c/span\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"mi\"\u003e10\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"mi\"\u003e135\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"mi\"\u003e4\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"mi\"\u003e7\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"mi\"\u003e41261\u003c/span\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"n\"\u003edb\u003c/span\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"n\"\u003eQuery\u003c/span\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"n\"\u003estarting\u003c/span\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"k\"\u003eshow\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eprocesslist\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"c1\"\u003e-- 一个空闲连接\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"mi\"\u003e137462293\u003c/span\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"n\"\u003edb\u003c/span\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"mi\"\u003e10\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"mi\"\u003e130\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"mi\"\u003e128\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"mi\"\u003e47174\u003c/span\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"n\"\u003edb\u003c/span\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"n\"\u003eSleep\u003c/span\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"mi\"\u003e24\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sql\" data-lang=\"sql\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e-- 客户端如果太长时间没动静，连接器就会自动将它断开\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003eselect\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e@@\u003c/span\u003e\u003cspan class=\"n\"\u003ewait_timeout\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003eshow\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003evariables\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003elike\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;wait_timeout\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"c1\"\u003e-- 28800 8h\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e通过执行 \u003ccode\u003emysql_reset_connection\u003c/code\u003e 来重新初始化连接资源，这是个接口函数，不是一个 SQL 语句。\u003c/p\u003e\n\u003cp\u003e查询缓存：不建议使用。在一个表上有更新的时候，跟这个表有关的查询缓存都会失效。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sql\" data-lang=\"sql\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eselect\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e@@\u003c/span\u003e\u003cspan class=\"n\"\u003equery_cache_type\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"c1\"\u003e-- OFF\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://dev.mysql.com/doc/refman/5.7/en/server-system-variables.html#sysvar_query_cache_type\"\u003esysvar_query_cache_type | mysql\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e分析器：词法分析、语法分析。进行分词和验证语法规则。解析器和预处理器。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e解析器处理语法和解析查询，生成一课对应的解析树。\u003c/li\u003e\n\u003cli\u003e预处理器进一步检查解析树的合法。比如: 数据表和数据列是否存在，别名是否有歧义等。如果通过则生成新的解析树，再提交给优化器。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e优化器：决定使用哪个索引，决定各个表的连接顺序。\u003c/p\u003e\n\u003cp\u003e执行器：有没有执行查询的权限，操作引擎，返回结果。执行器调用的次数（rows_examined）与引擎总共扫描行数可能是不等的，后文有例子。\u003c/p\u003e\n\u003cp\u003e读写、存取数据在 engine 引擎层，连接、鉴权、计算在 server 服务层。\u003c/p\u003e","title":"MySQL 实战 45 讲 Part1"},{"content":"Package Management Find Packages with pkgs.org pkgs.org is a Linux package search website that helps you find software packages for various Linux distributions.\n# Check installed package versions (Red Hat/CentOS) rpm -qa | grep docker Process Management Run Commands in Background # Run in background (will stop when terminal closes) cmd \u0026amp; # Run in background (continues after terminal closes) nohup cmd \u0026amp; Control Background Jobs Ctrl + Z - Pause the current foreground job and move it to background jobs - List all background jobs (jobs -l shows PIDs) fg - Bring the most recent background job to foreground fg %N - Bring job number N to foreground bg - Resume the most recent job in the background bg %N - Resume job number N in the background Using fg Command # Restore the most recent background job fg # Restore a specific job by number fg 1 # Restore using % syntax fg %2 # Restore by process name fg %vim # List all background jobs jobs DNS Operations Lookup CNAME Records CNAME (Canonical Name) records map one domain name to another, commonly used for subdomains or third-party hosted services.\n# Using dig dig example.com cname # Output: example.com. 300 IN CNAME target-domain.com. # Using host command host -t CNAME example.com # Output: example.com is an alias for target-domain.com. # Using nslookup nslookup -type=CNAME example.com # Output: example.com canonical name = target-domain.com. # Check multiple domains at once dig +short CNAME www.example.com blog.example.com # See full DNS lookup path dig +trace example.com File System Operations Find Large Files # Find and display the 3 largest files/folders in current directory du -sh ./* | sort -rh | head -3 # Find files larger than 100MB find . -type f -size +100M # Find large files and show human-readable sizes find . -type f -size +50M -exec du -h {} \\; | sort -rh Dealing with Deleted Files That Still Use Space When you delete a file but the disk space isn\u0026rsquo;t freed, it\u0026rsquo;s usually because a process is still using the file.\n# Find deleted files still in use lsof | grep deleted # Clear file content without deleting the file echo \u0026#34;\u0026#34; \u0026gt; /var/log/large_logfile.log # Or more safely: truncate -s 0 /var/log/large_logfile.log Search Text in Files Recursively The Set Builtin Bash 脚本 set 命令教程 # Search for text in all files in current directory and subdirectories grep -r \u0026#34;search text\u0026#34; . # Limit search to specific file types grep -r \u0026#34;search text\u0026#34; --include=\u0026#34;*.php\u0026#34; . # Show line numbers in results grep -rn \u0026#34;search text\u0026#34; . # Case-insensitive search grep -ri \u0026#34;search text\u0026#34; . Script Safety with set The set command controls shell behavior and can make scripts safer.\n#!/usr/bin/env bash # Stop script if any command fails set -o errexit # Same as set -e # Treat unset variables as errors set -o nounset # Same as set -u # Make pipeline fail if any command in it fails set -o pipefail # Print commands before execution (useful for debugging) set -o xtrace # Same as set -x # Common combined safety settings set -euxo pipefail Error Handling Patterns # Stop if command fails command || exit 1 # With error message command || { echo \u0026#34;Command failed\u0026#34;; exit 1; } # Using if statement if ! command; then echo \u0026#34;Command failed\u0026#34; exit 1 fi # Other way command if [ \u0026#34;$?\u0026#34; -ne 0 ]; then echo \u0026#34;command failed\u0026#34;; exit 1; fi # Execute second command only if first succeeds command1 \u0026amp;\u0026amp; command2 Navigation Shortcuts Using CDPATH CDPATH creates shortcuts for the cd command by checking multiple locations.\n# Add directories to CDPATH export CDPATH=.:/etc:~/projects # Now you can directly cd to subdirectories of those paths cd project1 # Changes to ~/projects/project1 cd mail # Changes to /etc/mail # Unset CDPATH (useful in scripts for predictability) unset CDPATH System Configuration Set Timezone in Ubuntu # Interactive timezone selection sudo dpkg-reconfigure tzdata # Set timezone directly sudo timedatectl set-timezone Asia/Shanghai # Restart logging service (may be needed for cron) sudo systemctl restart rsyslog # Or /etc/init.d/rsyslog restart Open PDF Files from Terminal # Open PDF without loading file explorer evince document.pdf # Alternative PDF viewers xpdf document.pdf okular document.pdf References setting timezone from terminal - Ask Ubuntu cron - How do you set the timezone for crontab? - Ask Ubuntu Ubuntu 命令行打开 PDF 文件 - bigmarco 的专栏 Linux 文件删除，但是 df 之后磁盘空间没有释放 | cnblogs How to lookup CNAME records | nslookup.io Linux 命令后台运行 \u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2022/07/28/shell-code-snippet/","summary":"\u003ch2 id=\"package-management\"\u003ePackage Management\u003c/h2\u003e\n\u003ch3 id=\"find-packages-with-pkgsorg\"\u003eFind Packages with pkgs.org\u003c/h3\u003e\n\u003cp\u003e\u003ca href=\"https://pkgs.org/\"\u003epkgs.org\u003c/a\u003e is a Linux package search website that helps you find software packages for various Linux distributions.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Check installed package versions (Red Hat/CentOS)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003erpm -qa \u003cspan class=\"p\"\u003e|\u003c/span\u003e grep docker\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"process-management\"\u003eProcess Management\u003c/h2\u003e\n\u003ch3 id=\"run-commands-in-background\"\u003eRun Commands in Background\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Run in background (will stop when terminal closes)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ecmd \u003cspan class=\"p\"\u003e\u0026amp;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Run in background (continues after terminal closes)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enohup cmd \u003cspan class=\"p\"\u003e\u0026amp;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"control-background-jobs\"\u003eControl Background Jobs\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003eCtrl + Z\u003c/code\u003e - Pause the current foreground job and move it to background\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003ejobs\u003c/code\u003e - List all background jobs (\u003ccode\u003ejobs -l\u003c/code\u003e shows PIDs)\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003efg\u003c/code\u003e - Bring the most recent background job to foreground\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003efg %N\u003c/code\u003e - Bring job number N to foreground\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003ebg\u003c/code\u003e - Resume the most recent job in the background\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003ebg %N\u003c/code\u003e - Resume job number N in the background\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"using-fg-command\"\u003eUsing fg Command\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Restore the most recent background job\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003efg\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Restore a specific job by number\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003efg\u003c/span\u003e \u003cspan class=\"m\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Restore using % syntax\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003efg\u003c/span\u003e %2\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Restore by process name\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003efg\u003c/span\u003e %vim\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# List all background jobs\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003ejobs\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"dns-operations\"\u003eDNS Operations\u003c/h2\u003e\n\u003ch3 id=\"lookup-cname-records\"\u003eLookup CNAME Records\u003c/h3\u003e\n\u003cp\u003eCNAME (Canonical Name) records map one domain name to another, commonly used for subdomains or third-party hosted services.\u003c/p\u003e","title":"Shell Code Snippet"},{"content":"库推荐 nrm Pana/nrm\nnrm can help you easy and fast switch between different npm registries, now include: npm, cnpm, taobao, nj(nodejitsu).\nnpm install -g nrm nrm ls nrm use tencent Website W3Techs - World Wide Web Technology Surveys nodejs release schedule 安装 Node.js 与常见问题 2025-02-17：推荐使用 proto。\nNode.js 安装 推荐使用 nvm 安装管理 node.js\nthe nvm method is definitely much more flexible.\ncreationix/nvm: Node Version Manager - Simple bash script to manage multiple active node.js versions\nTo install or update nvm.\ncurl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.34.0/install.sh | bash # Uses automatic LTS (long-term support) alias `lts/*`, if available. nvm ls-remote --lts # 安装最新 lts nvm install --lts # v10 lts nvm install --lts=Dubnium # 安装指定版本 nvm install v6.11.0 # Usually, nvm will switch to use the most recently installed version nvm use v6.11.0 # You can see the version currently being used node -v # 其他命令可以查看帮助 nvm help node-sass sh: node: command not found config unsafe-perm | npmjs\n解决办法：\nnpm install --unsafe-perm node-sass npm 出于安全考虑不支持以 root 用户运行，即使你用 root 用户身份运行了，npm 会自动转成一个叫 nobody 的用户来运行，而这个用户几乎没有任何权限。这样的话如果你脚本里有一些需要权限的操作，比如写文件（尤其是写 /root/.node-gyp），就会报错了。\n为了避免这种情况，要么按照 npm 的规矩来，专门建一个用于运行 npm 的高权限用户。要么加 --unsafe-perm 参数，这样就不会切换到 nobody 上，运行时是哪个用户就是哪个用户，即使是 root。\n再或尝试：\nnpm rebuild node-sass version \u0026ldquo;N/A -\u0026gt; N/A\u0026rdquo; is not yet installed 出现了这个报错提示：\nN/A: version \u0026#34;N/A -\u0026gt; N/A\u0026#34; is not yet installed. You need to run \u0026#34;nvm install N/A\u0026#34; to install it before using it List installed versions\nnvm ls -\u0026gt; v6.11.0 v8.2.1 default -\u0026gt; 4 (-\u0026gt; N/A) node -\u0026gt; stable (-\u0026gt; v8.2.1) (default) stable -\u0026gt; 8.2 (-\u0026gt; v8.2.1) (default) iojs -\u0026gt; N/A (default) lts/* -\u0026gt; lts/boron (-\u0026gt; N/A) lts/argon -\u0026gt; v4.8.4 (-\u0026gt; N/A) lts/boron -\u0026gt; v6.11.1 (-\u0026gt; N/A) Try nvm install in that directory to ensure it\u0026rsquo;s installed.\nnvm install --lts nvm install iojs nvm alias default v6.11.1 How To Install Node.js on Ubuntu 16.04 | DigitalOcean nvm node is recognised by npm install script. | GitHub npm 的 \u0026ndash;unsafe-perm 参数是有何作用呢？| segmentfault npx 调用项目安装的模块 npx 是 npm 的自带模块，可以直接使用，手动安装为：\nnpm install -g npx npx - execute npm package binaries. 它解决的问题是：更方便的从本地 node_modules/.bin 或中央缓存中执行命令。\n比如项目安装了 gulp 需要执行命令时需要：\nnode_modules/.bin/gulp -v 如果使用 npx 只需要：\nnpx gulp -v npx 的原理很简单，就是运行的时候，会到 node_modules/.bin 路径和环境变量 $PATH 里面，检查命令是否存在。由于 npx 会检查环境变量 $PATH，所以系统命令也可以调用。\n# 等同于 ls npx ls 注意，Bash 内置的命令不在 $PATH 里面，所以不能用。比如，cd 是 Bash 命令，因此就不能用 npx cd。\n避免全局安装模块 create-react-app 这个模块是全局安装，npx 可以运行它，而且不进行全局安装：\nnpx create-react-app my-react-app 上面代码运行时，npx 将 create-react-app 下载到一个临时目录，使用以后再删除。以后再次执行上面的命令，会重新下载 create-react-app。\n注意，只要 npx 后面的模块无法在本地发现，就会下载同名模块。比如，本地没有安装 http-server 模块，下面的命令会自动下载该模块，在当前目录启动一个 Web 服务。\nnpx http-server --no-install 和 --ignore-existing 参数 如果想让 npx 强制使用本地模块，不下载远程模块，可以使用 --no-install 参数。如果本地不存在该模块，就会报错。\nnpx --no-install http-server 反过来，如果忽略本地的同名模块，强制安装使用远程模块，可以使用 --ignore-existing 参数。\n使用不同版本的 Node 可以指定某个版本的 Node 运行脚本，某些场景下，这个方法用来切换 Node 版本，要比 nvm 那样的版本管理器方便一些。\nnpx node@0.12.8 -v v0.12.8 -p 参数 -p 参数用于指定 npx 所要安装的模块，所以上一节的命令可以写成下面这样。\nnpx -p node@0.12.8 node -v v0.12.8 上面命令先指定安装 node@0.12.8 ，然后再执行 node -v 命令。\n所以开头时的疑问 npx -p touch nodetouch gulpfile.js 也就解答了，就是先安装 touch 在执行 nodetouch gulpfile.js。\n执行 GitHub 源码 # 执行 Gist 代码 npx https://gist.github.com/zkat/4bc19503fe9e9309e2bfaa2c58074d32 # 执行仓库代码 npx github:piuccio/cowsay hellos 注意，远程代码必须是一个模块，即必须包含 package.json 和入口脚本。\nnpx 使用教程 - 阮一峰\n\u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2022/07/26/front-end-code-snippet/","summary":"\u003ch2 id=\"库推荐\"\u003e库推荐\u003c/h2\u003e\n\u003ch3 id=\"nrm\"\u003enrm\u003c/h3\u003e\n\u003cp\u003e\u003ca href=\"https://github.com/Pana/nrm\"\u003ePana/nrm\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003enrm can help you easy and fast switch between different npm registries, now include: npm, cnpm, taobao, nj(nodejitsu).\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enpm install -g nrm\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enrm ls\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enrm use tencent\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"website\"\u003eWebsite\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w3techs.com/\"\u003eW3Techs - World Wide Web Technology Surveys\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/nodejs/release#release-schedule\"\u003enodejs release schedule\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"安装-nodejs-与常见问题\"\u003e安装 Node.js 与常见问题\u003c/h2\u003e\n\u003cp\u003e2025-02-17：推荐使用 \u003ca href=\"https://moonrepo.dev/docs/proto\"\u003eproto\u003c/a\u003e。\u003c/p\u003e\n\u003ch3 id=\"nodejs-安装\"\u003eNode.js 安装\u003c/h3\u003e\n\u003cp\u003e推荐使用 nvm 安装管理 node.js\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003ethe nvm method is definitely much more flexible.\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003e\u003ca href=\"https://github.com/creationix/nvm#installation\"\u003ecreationix/nvm: Node Version Manager - Simple bash script to manage multiple active node.js versions\u003c/a\u003e\u003c/p\u003e","title":"Front-end Code Snippet"},{"content":" JavaScript 教程 | 网道（WangDoc.com）\nJavaScript 语言的历史 ECMAScript 只用来标准化 JavaScript 这种语言的基本语法结构，与部署环境相关的标准都由其他标准规定，比如 DOM 的标准就是由 W3C 组织（World Wide Web Consortium）制定的。\n2011 年 6 月，ECMAScript 5.1 版发布，并且成为 ISO 国际标准（ISO/IEC 16262:2011）。到了 2012 年底，所有主要浏览器都支持 ECMAScript 5.1 版的全部功能。\n2015 年 6 月，ECMAScript 6 正式发布，并且更名为“ECMAScript 2015”。这是因为 TC39 委员会计划，以后每年发布一个 ECMAScript 的版本，下一个版本在 2016 年发布，称为“ECMAScript 2016”，2017 年发布“ECMAScript 2017”，以此类推。\nJavaScript 的基本语法 如果只是声明变量而没有赋值，则该变量的值是 undefined。undefined 是一个特殊的值，表示“无定义”。\nvar a; a; // undefined JavaScript 是一种动态类型语言，也就是说，变量的类型没有限制，变量可以随时更改类型。\nvar a = 1; a = \u0026#34;hello\u0026#34;; 如果使用 var 重新声明一个已经存在的变量，是无效的。\nvar x = 1; var x; x; // 1 JavaScript 引擎的工作方式是，先解析代码，获取所有被声明的变量，然后再一行一行地运行。这造成的结果，就是所有的变量的声明语句，都会被提升到代码的头部，这就叫做变量提升（hoisting）。\nconsole.log(a); var a = 1; // 在控制台（console）显示变量a的值。这时变量a还没有声明和赋值，所以这是一种错误的做法，但是实际上不会报错。因为存在变量提升，真正运行的是下面的代码。 var a; console.log(a); a = 1; 标识符命名规则如下：\n第一个字符，可以是任意 Unicode 字母（包括英文字母和其他语言的字母），以及美元符号（$）和下划线（_）。 第二个字符及后面的字符，除了 Unicode 字母、美元符号和下划线，还可以用数字 0-9。 对于 var 命令来说，JavaScript 的区块不构成单独的作用域（scope）。\n{ var a = 1; } a; // 1 else 代码块总是与离自己最近的那个 if 语句配对。\nvar m = 1; var n = 2; if (m !== 1) if (n === 2) console.log(\u0026#34;hello\u0026#34;); else console.log(\u0026#34;world\u0026#34;); // 相当于 if (m !== 1) { if (n === 2) { console.log(\u0026#34;hello\u0026#34;); } else { console.log(\u0026#34;world\u0026#34;); } } switch 语句后面的表达式，与 case 语句后面的表示式比较运行结果时，采用的是严格相等运算符（===），而不是相等运算符（==），这意味着比较时不会发生类型转换。\nvar x = 1; switch (x) { case true: console.log(\u0026#34;x 发生类型转换\u0026#34;); break; default: console.log(\u0026#34;x 没有发生类型转换\u0026#34;); } // x 没有发生类型转换 for 语句的三个部分（initialize、test、increment），可以省略任何一个，也可以全部省略。\nfor (;;) { console.log(\u0026#34;Hello World\u0026#34;); } 上面代码省略了 for 语句表达式的三个部分，结果就导致了一个无限循环。\nJavaScript 语言允许，语句的前面有标签（label），相当于定位符，用于跳转到程序的任意位置，标签的格式如下。\n标签通常与 break 语句和 continue 语句配合使用，跳出特定的循环。\ntop: for (var i = 0; i \u0026lt; 3; i++) { for (var j = 0; j \u0026lt; 3; j++) { if (i === 1 \u0026amp;\u0026amp; j === 1) break top; console.log(\u0026#34;i=\u0026#34; + i + \u0026#34;, j=\u0026#34; + j); } } // i=0, j=0 // i=0, j=1 // i=0, j=2 // i=1, j=0 top: for (var i = 0; i \u0026lt; 3; i++) { for (var j = 0; j \u0026lt; 3; j++) { if (i === 1 \u0026amp;\u0026amp; j === 1) continue top; console.log(\u0026#34;i=\u0026#34; + i + \u0026#34;, j=\u0026#34; + j); } } // i=0, j=0 // i=0, j=1 // i=0, j=2 // i=1, j=0 // i=2, j=0 // i=2, j=1 // i=2, j=2 数据类型概述 JavaScript 语言的每一个值，都属于某一种数据类型。JavaScript 的数据类型，共有六种。（ES6 又新增了第七种 Symbol 类型的值，本教程不涉及。）\n数值（number）：整数和小数（比如 1 和 3.14）。 字符串（string）：文本（比如 Hello World）。 布尔值（boolean）：表示真伪的两个特殊值，即 true（真）和 false（假）。 undefined：表示“未定义”或不存在，即由于目前没有定义，所以此处暂时没有任何值。 null：表示空值，即此处的值为空。 对象（object）：各种值组成的集合。 通常，数值、字符串、布尔值这三种类型，合称为原始类型（primitive type）的值，即它们是最基本的数据类型，不能再细分了。\n对象则称为合成类型（complex type）的值，因为一个对象往往是多个原始类型的值的合成，可以看作是一个存放各种值的容器。\n至于 undefined 和 null，一般将它们看成两个特殊值。\n对象是最复杂的数据类型，又可以分成三个子类型。\n狭义的对象（object） 数组（array） 函数（function） 函数其实是处理数据的方法，JavaScript 把它当成一种数据类型，可以赋值给变量，这为编程带来了很大的灵活性，也为 JavaScript 的“函数式编程”奠定了基础。\nJavaScript 有三种方法，可以确定一个值到底是什么类型。\ntypeof 运算符 instanceof 运算符 Object.prototype.toString 方法 typeof 123; // \u0026#34;number\u0026#34; typeof \u0026#34;123\u0026#34;; // \u0026#34;string\u0026#34; typeof false; // \u0026#34;boolean\u0026#34; function f() {} typeof f; // \u0026#34;function\u0026#34; typeof undefined; // \u0026#34;undefined\u0026#34; 利用这一点，typeof 可以用来检查一个没有声明的变量，而不报错。\nv; // ReferenceError: v is not defined typeof v; // \u0026#34;undefined\u0026#34; // 错误的写法 if (v) { // ... } // ReferenceError: v is not defined // 正确的写法 if (typeof v === \u0026#34;undefined\u0026#34;) { // ... } typeof window; // \u0026#34;object\u0026#34; typeof {}; // \u0026#34;object\u0026#34; typeof []; // \u0026#34;object\u0026#34; 上面代码中，空数组（[]）的类型也是 object，这表示在 JavaScript 内部，数组本质上只是一种特殊的对象。instanceof 运算符可以区分数组和对象。\nvar o = {}; var a = []; o instanceof Array; // false o instanceof Object; // true a instanceof Array; // true a instanceof Object; // false null 的类型是 object，这是由于历史原因造成的。1995 年的 JavaScript 语言第一版，只设计了五种数据类型（对象、整数、浮点数、字符串和布尔值），没考虑 null，只把它当作 object 的一种特殊值。后来 null 独立出来，作为一种单独的数据类型，为了兼容以前的代码，typeof null 返回 object 就没法改变了。\ntypeof null; // \u0026#34;object\u0026#34; null, undefined 和布尔值 null 与 undefined 都可以表示“没有”，含义非常相似。将一个变量赋值为 undefined 或 null，语法效果几乎没区别。\nif (!undefined) { console.log(\u0026#34;undefined is false\u0026#34;); } // undefined is false if (!null) { console.log(\u0026#34;null is false\u0026#34;); } // null is false undefined == null; // true 1995 年 JavaScript 诞生时，最初像 Java 一样，只设置了 null 表示\u0026quot;无\u0026quot;。根据 C 语言的传统，null 可以自动转为 0。\nNumber(null); // 0 5 + null; // 5 但是，JavaScript 的设计者 Brendan Eich，觉得这样做还不够。首先，第一版的 JavaScript 里面，null 就像在 Java 里一样，被当成一个对象，Brendan Eich 觉得表示“无”的值最好不是对象。其次，那时的 JavaScript 不包括错误处理机制，Brendan Eich 觉得，如果 null 自动转为 0，很不容易发现错误。\n因此，他又设计了一个 undefined。区别是这样的：null 是一个表示“空”的对象，转为数值时为 0；undefined 是一个表示\u0026quot;此处无定义\u0026quot;的原始值，转为数值时为 NaN。\nNumber(undefined); // NaN 5 + undefined; // NaN null 表示空值，即该处的值现在为空。调用函数时，某个参数未设置任何值，这时就可以传入 null，表示该参数为空。比如，某个函数接受引擎抛出的错误作为参数，如果运行过程中未出错，那么这个参数就会传入 null，表示未发生错误。 undefined 表示“未定义”，下面是返回 undefined 的典型场景。 // 变量声明了，但没有赋值 var i; i; // undefined // 调用函数时，应该提供的参数没有提供，该参数等于 undefined function f(x) { return x; } f(); // undefined // 对象没有赋值的属性 var o = new Object(); o.p; // undefined // 函数没有返回值时，默认返回 undefined function f() {} f(); // undefined 如果 JavaScript 预期某个位置应该是布尔值，会将该位置上现有的值自动转为布尔值。转换规则是除了下面六个值被转为 false，其他值都视为 true。\nundefined null false 0 NaN \u0026ldquo;\u0026ldquo;或\u0026rsquo;\u0026rsquo;（空字符串） 注意，空数组（[]）和空对象（{}）对应的布尔值，都是 true。\n数值 JavaScript 内部，所有数字都是以 64 位浮点数形式储存，即使整数也是如此。所以，1 与 1.0 是相同的，是同一个数。\n这就是说，JavaScript 语言的底层根本没有整数，所有数字都是小数（64 位浮点数）。\n容易造成混淆的是，某些运算只有整数才能完成，此时 JavaScript 会自动把 64 位浮点数，转成 32 位整数，然后再进行运算。\n1 === 1.0; // true 由于浮点数不是精确的值，所以涉及小数的比较和运算要特别小心。\n0.1 + 0.2 === 0.3; // false 0.3 / 0.1( // 2.9999999999999996 0.3 - 0.2 ) === 0.2 - 0.1; // false 根据国际标准 IEEE 754，JavaScript 浮点数的 64 个二进制位，从最左边开始，是这样组成的。\n第 1 位：符号位，0 表示正数，1 表示负数 第 2 位到第 12 位（共 11 位）：指数部分 第 13 位到第 64 位（共 52 位）：小数部分（即有效数字） 符号位决定了一个数的正负，指数部分决定了数值的大小，小数部分决定了数值的精度。\nMath.pow(2, 53); // 9007199254740992 // 多出的三个有效数字，将无法保存 9007199254740992111; // 9007199254740992000 Math.pow(2, 1024); // Infinity “正向溢出” Math.pow(2, -1075); // 0 Number.MAX_VALUE; // 1.7976931348623157e+308 Number.MIN_VALUE; // 5e-324 123e3; // 123000 123e-3; // 0.123 -3.1e12; 0.1e-23; // 小数点前的数字多于21位。 1234567890123456789012; // 1.2345678901234568e+21 123456789012345678901; // 123456789012345680000 // 小数点后的零多于5个。 // 小数点后紧跟5个以上的零，就自动转为科学计数法 0.0000003; // 3e-7 // 否则，就保持原来的字面形式 0.000003; // 0.000003 十进制：没有前导 0 的数值。 八进制：有前缀 0o 或 0O 的数值，或者有前导 0、且只用到 0-7 的八个阿拉伯数字的数值。 十六进制：有前缀 0x 或 0X 的数值。 二进制：有前缀 0b 或 0B 的数值。 有前导 0 的数值会被视为八进制，但是如果前导 0 后面有数字 8 和 9，则该数值被视为十进制。\n0888; // 888 0777; // 511 JavaScript 的 64 位浮点数之中，有一个二进制位是符号位。这意味着，任何一个数都有一个对应的负值，就连 0 也不例外。\nJavaScript 内部实际上存在 2 个 0：一个是 +0，一个是 -0，区别就是 64 位浮点数表示法的符号位不同。它们是等价的。\n-0 === +0; // true 0 === -0; // true 0 === +0; // true +0; // 0 -0; // 0 (-0).toString(); // \u0026#39;0\u0026#39; (+0).toString(); // \u0026#39;0\u0026#39; 1 / +0 === 1 / -0; // false // +Infinity !== -Infinity NaN 是 JavaScript 的特殊值，表示“非数字” Not a Number，主要出现在将字符串解析成数字出错的场合。\n5 - \u0026#34;x\u0026#34;; // NaN Math.acos(2); // NaN Math.log(-1); // NaN Math.sqrt(-1); // NaN 0 / 0; // NaN NaN 不是独立的数据类型，而是一个特殊数值，它的数据类型依然属于 Number。\ntypeof NaN; // \u0026#39;number\u0026#39; NaN === NaN; // false [NaN].indexOf(NaN); // -1 Boolean(NaN); // false NaN + 32; // NaN NaN - 32; // NaN NaN * 32; // NaN NaN / 32; // NaN // 场景一 Math.pow(2, 1024); // Infinity // 场景二 0 / 0; // NaN 1 / 0; // Infinity Infinity === -Infinity; // false 1 / -0; // -Infinity 1 / -0; // Infinity Infinity \u0026gt; 1000; // true -Infinity \u0026lt; -1000; // true Infinity \u0026gt; NaN; // false -Infinity \u0026gt; NaN; // false Infinity \u0026lt; NaN; // false -Infinity \u0026lt; NaN; // false 5 * Infinity; // Infinity 5 - Infinity; // -Infinity Infinity / 5; // Infinity 5 / Infinity; // 0 0 * Infinity; // NaN 0 / Infinity; // 0 Infinity / 0; // Infinity Infinity + Infinity; // Infinity Infinity * Infinity; // Infinity Infinity - Infinity; // NaN Infinity / Infinity; // NaN null * Infinity; // NaN null / Infinity; // 0 Infinity / null; // Infinity undefined + Infinity; // NaN undefined - Infinity; // NaN undefined * Infinity; // NaN undefined / Infinity; // NaN Infinity / undefined; // NaN 与数值相关的全局方法 parseInt(\u0026#34;123\u0026#34;); // 123 // 如果字符串头部有空格，空格会被自动去除。 parseInt(\u0026#34; 81\u0026#34;); // 81 // 如果parseInt的参数不是字符串，则会先转为字符串再转换。 parseInt(1.23); // 1 // 等同于 parseInt(\u0026#34;1.23\u0026#34;); // 1 // 字符串转为整数的时候，是一个个字符依次转换，如果遇到不能转为数字的字符，就不再进行下去，返回已经转好的部分。 parseInt(\u0026#34;8a\u0026#34;); // 8 parseInt(\u0026#34;12**\u0026#34;); // 12 parseInt(\u0026#34;12.34\u0026#34;); // 12 parseInt(\u0026#34;15e2\u0026#34;); // 15 parseInt(\u0026#34;15px\u0026#34;); // 15 // 如果字符串的第一个字符不能转化为数字（后面跟着数字的正负号除外），返回NaN。 parseInt(\u0026#34;abc\u0026#34;); // NaN parseInt(\u0026#34;.3\u0026#34;); // NaN parseInt(\u0026#34;\u0026#34;); // NaN parseInt(\u0026#34;+\u0026#34;); // NaN parseInt(\u0026#34;+1\u0026#34;); // 1 // parseInt的返回值只有两种可能，要么是一个十进制整数，要么是NaN。 parseInt(\u0026#34;0x10\u0026#34;); // 16 parseInt(\u0026#34;011\u0026#34;); // 11 // 对于那些会自动转为科学计数法的数字，parseInt会将科学计数法的表示方法视为字符串，因此导致一些奇怪的结果。 parseInt(1000000000000000000000.5); // 1 // 等同于 parseInt(\u0026#34;1e+21\u0026#34;); // 1 parseInt(0.0000008); // 8 // 等同于 parseInt(\u0026#34;8e-7\u0026#34;); // 8 parseInt(\u0026#34;1000\u0026#34;, 2); // 8 parseInt(\u0026#34;1000\u0026#34;, 6); // 216 parseInt(\u0026#34;1000\u0026#34;, 8); // 512 // 第二个参数是0、undefined和null，则直接忽略。 parseInt(\u0026#34;10\u0026#34;, 37); // NaN parseInt(\u0026#34;10\u0026#34;, 1); // NaN parseInt(\u0026#34;10\u0026#34;, 0); // 10 parseInt(\u0026#34;10\u0026#34;, null); // 10 parseInt(\u0026#34;10\u0026#34;, undefined); // 10 parseInt(\u0026#34;1546\u0026#34;, 2); // 1 parseInt(\u0026#34;546\u0026#34;, 2); // NaN // 如果parseInt的第一个参数不是字符串，会被先转为字符串。这会导致一些令人意外的结果。 parseInt(0x11, 36); // 43 parseInt(0x11, 2); // 1 // 等同于 parseInt(String(0x11), 36); // 43 parseInt(String(0x11), 2); // 1 // 等同于 parseInt(\u0026#34;17\u0026#34;, 36); // 43 parseInt(\u0026#34;17\u0026#34;, 2); // 1 // 上面代码中，十六进制的0x11会被先转为十进制的17，再转为字符串。然后，再用36进制或二进制解读字符串17，最后返回结果43和1 parseInt(011, 2); // NaN // 等同于 parseInt(String(011), 2); // NaN // 等同于 parseInt(String(9), 2); // NaN ","permalink":"https://zyf.im/2022/06/09/javascript-wangdoc-reading-notes/","summary":"\u003cblockquote\u003e\n\u003cp\u003e\u003ca href=\"https://wangdoc.com/javascript/index.html\"\u003eJavaScript 教程 | 网道（WangDoc.com）\u003c/a\u003e\u003c/p\u003e\u003c/blockquote\u003e\n\u003ch2 id=\"javascript-语言的历史\"\u003eJavaScript 语言的历史\u003c/h2\u003e\n\u003cp\u003eECMAScript 只用来标准化 JavaScript 这种语言的基本语法结构，与部署环境相关的标准都由其他标准规定，比如 DOM 的标准就是由 W3C 组织（World Wide Web Consortium）制定的。\u003c/p\u003e\n\u003cp\u003e2011 年 6 月，ECMAScript 5.1 版发布，并且成为 ISO 国际标准（ISO/IEC 16262:2011）。到了 2012 年底，所有主要浏览器都支持 ECMAScript 5.1 版的全部功能。\u003c/p\u003e\n\u003cp\u003e2015 年 6 月，ECMAScript 6 正式发布，并且更名为“ECMAScript 2015”。这是因为 TC39 委员会计划，以后每年发布一个 ECMAScript 的版本，下一个版本在 2016 年发布，称为“ECMAScript 2016”，2017 年发布“ECMAScript 2017”，以此类推。\u003c/p\u003e\n\u003ch2 id=\"javascript-的基本语法\"\u003eJavaScript 的基本语法\u003c/h2\u003e\n\u003cp\u003e如果只是声明变量而没有赋值，则该变量的值是 undefined。undefined 是一个特殊的值，表示“无定义”。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-js\" data-lang=\"js\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003ea\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003ea\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"c1\"\u003e// undefined\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eJavaScript 是一种动态类型语言，也就是说，变量的类型没有限制，变量可以随时更改类型。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-js\" data-lang=\"js\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003ea\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003ea\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;hello\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e如果使用 var 重新声明一个已经存在的变量，是无效的。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-js\" data-lang=\"js\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003ex\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"c1\"\u003e// 1\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eJavaScript 引擎的工作方式是，先解析代码，获取所有被声明的变量，然后再一行一行地运行。这造成的结果，就是所有的变量的声明语句，都会被提升到代码的头部，这就叫做变量提升（hoisting）。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-js\" data-lang=\"js\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003econsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003elog\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ea\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003ea\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 在控制台（console）显示变量a的值。这时变量a还没有声明和赋值，所以这是一种错误的做法，但是实际上不会报错。因为存在变量提升，真正运行的是下面的代码。\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003ea\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003econsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003elog\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ea\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003ea\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e标识符命名规则如下：\u003c/p\u003e","title":"【JavaScript 教程 | 网道】笔记"},{"content":"今日在生产环境发生了：因为 GROUP_CONCAT 聚合的数据列发生截断导致异常，原来 GROUP_CONCAT 是有大小限制的。\nSELECT @@GROUP_CONCAT_MAX_LEN; -- 1024 bytes References group_concat_max_len | mysql\n\u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2022/01/10/group-concat-max-len/","summary":"\u003cp\u003e今日在生产环境发生了：因为 \u003ccode\u003eGROUP_CONCAT\u003c/code\u003e 聚合的数据列发生截断导致异常，原来 \u003ccode\u003eGROUP_CONCAT\u003c/code\u003e 是有大小限制的。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sql\" data-lang=\"sql\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eSELECT\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e@@\u003c/span\u003e\u003cspan class=\"n\"\u003eGROUP_CONCAT_MAX_LEN\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"c1\"\u003e-- 1024 bytes\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"references\"\u003eReferences\u003c/h2\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ca href=\"https://dev.mysql.com/doc/refman/5.7/en/server-system-variables.html#sysvar_group_concat_max_len\"\u003egroup_concat_max_len | mysql\u003c/a\u003e\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003e\u0026ndash; EOF \u0026ndash;\u003c/p\u003e","title":"GROUP_CONCAT 截断"},{"content":"直到对的人来 · 追星族乐队\n我想跟他说：那家餐厅太美了，我一定要和你去一次。但是那个菜其实很一般的，那个老板娘戴的耳环特别漂亮。\n\u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2021/12/31/review-2021/","summary":"\u003cp\u003e\u003ca href=\"https://music.163.com/#/song?id=25638375\"\u003e直到对的人来 · 追星族乐队\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e我想跟他说：那家餐厅太美了，我一定要和你去一次。但是那个菜其实很一般的，那个老板娘戴的耳环特别漂亮。\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003e\u0026ndash; EOF \u0026ndash;\u003c/p\u003e","title":"回顾 2021"},{"content":"ENV cat /etc/redhat-release CentOS Linux release 7.2 (Final) uname -a Linux xxx-xxx 3.10.107-1-tlinux2_kvm_guest-0052 #1 SMP Wed Jan 15 18:42:19 CST 2020 x86_64 x86_64 x86_64 GNU/Linux PECL pecl install grpc 如果遇到：\nConnection to `ssl://pecl.php.net:443′ failed: 参考：\nPHP Swoft 框架环境配置 | ZYF.IM\nBuild 通用手动安装 PECL 扩展 For this to work, you’ll need to have root access to your server, and you’ll most probably need developer tools installed as well.\nhttps://pecl.php.net/\n# 创建临时目录 mkdir /tmp/download/ \u0026amp;\u0026amp; cd /tmp/download/ # 下载 wget http://pecl.php.net/get/[extension].tgz # 解压 tar -xvf [extension].tgz cd [extension] # 配置 phpize # 查看参数 ./configure --help # 设置参考 以实际情况为准 ./configure --enable-[extension] # 编译 make \u0026amp;\u0026amp; make test # 安装 make install # 查看 ini 路径 php --ini # 开启 vi [php-ini].ini extension=[extension].so gcc is currently not installed yum install gcc ...already installed and latest version... gcc ...gcc is currently not installed. yum reinstall gcc # 重新安装后解决 GrpcLb::TokenAndClientStatsAttribute::ToString() const 原因：gcc 版本过低。\nyum install centos-release-scl yum install devtoolset-8-gcc* scl enable devtoolset-8 bash source /opt/rh/devtoolset-8/enable References 安装适用于 PHP 的 gRPC | cloud.google PHP 安装 grpc 扩展报错 | jianshu \u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2021/10/13/php-install-grpc/","summary":"\u003ch2 id=\"env\"\u003eENV\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ecat /etc/redhat-release\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eCentOS Linux release 7.2 \u003cspan class=\"o\"\u003e(\u003c/span\u003eFinal\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003euname -a\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eLinux xxx-xxx 3.10.107-1-tlinux2_kvm_guest-0052 \u003cspan class=\"c1\"\u003e#1 SMP Wed Jan 15 18:42:19 CST 2020 x86_64 x86_64 x86_64 GNU/Linux\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"pecl\"\u003ePECL\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003epecl install grpc\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e如果遇到：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eConnection to \u003cspan class=\"sb\"\u003e`\u003c/span\u003essl://pecl.php.net:443′ failed:\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e参考：\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"/2020/08/07/deploy-swoft-framework/\"\u003ePHP Swoft 框架环境配置 | ZYF.IM\u003c/a\u003e\u003c/p\u003e\n\u003ch2 id=\"build\"\u003eBuild\u003c/h2\u003e\n\u003ch3 id=\"通用手动安装-pecl-扩展\"\u003e通用手动安装 PECL 扩展\u003c/h3\u003e\n\u003cp\u003eFor this to work, you’ll need to have root access to your server, and you’ll most probably need developer tools installed as well.\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ca href=\"https://pecl.php.net/\"\u003ehttps://pecl.php.net/\u003c/a\u003e\u003c/p\u003e\u003c/blockquote\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# 创建临时目录\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003emkdir /tmp/download/ \u003cspan class=\"o\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan class=\"nb\"\u003ecd\u003c/span\u003e /tmp/download/\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# 下载\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ewget http://pecl.php.net/get/\u003cspan class=\"o\"\u003e[\u003c/span\u003eextension\u003cspan class=\"o\"\u003e]\u003c/span\u003e.tgz\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# 解压\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003etar -xvf \u003cspan class=\"o\"\u003e[\u003c/span\u003eextension\u003cspan class=\"o\"\u003e]\u003c/span\u003e.tgz\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003ecd\u003c/span\u003e \u003cspan class=\"o\"\u003e[\u003c/span\u003eextension\u003cspan class=\"o\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# 配置\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ephpize\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# 查看参数\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e./configure --help\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# 设置参考 以实际情况为准\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e./configure --enable-\u003cspan class=\"o\"\u003e[\u003c/span\u003eextension\u003cspan class=\"o\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# 编译\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003emake \u003cspan class=\"o\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e make \u003cspan class=\"nb\"\u003etest\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# 安装\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003emake install\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# 查看 ini 路径\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ephp --ini\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# 开启\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003evi \u003cspan class=\"o\"\u003e[\u003c/span\u003ephp-ini\u003cspan class=\"o\"\u003e]\u003c/span\u003e.ini\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003eextension\u003c/span\u003e\u003cspan class=\"o\"\u003e=[\u003c/span\u003eextension\u003cspan class=\"o\"\u003e]\u003c/span\u003e.so\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"gcc-is-currently-not-installed\"\u003egcc is currently not installed\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eyum install gcc\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e...already installed and latest version...\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egcc\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e...gcc is currently not installed.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eyum reinstall gcc\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# 重新安装后解决\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"grpclbtokenandclientstatsattributetostring-const\"\u003eGrpcLb::TokenAndClientStatsAttribute::ToString() const\u003c/h3\u003e\n\u003cp\u003e原因：gcc 版本过低。\u003c/p\u003e","title":"PHP 安装 gRPC"},{"content":"在 HIVE 中 最近在使用 HIVE，需要统计 当年累计和 这样的指标，请教同事后发现了 OVER(PARTITION BY) 开窗函数。\n分析函数用于计算基于组的某种聚合值，它和聚合函数的不同之处是：对于每个组返回多行，而聚合函数对于每个组只返回一行。\n开窗函数指定了分析函数工作的数据窗口大小，这个数据窗口大小可能会随着行的变化而变化。\n测试语句：\nCREATE TABLE default.test_over_partition ( `fdate` Date, `year` Int, `month` Int, `category1` String, `category2` String, `income` Double ); INSERT INTO hdp_fin_dash_ods.test_over_partition (`fdate`,`year`,`month`,`category1`,`category2`,`income`) VALUES (\u0026#39;2020-01-01\u0026#39;,2020,1,\u0026#39;3C\u0026#39;,\u0026#39;电脑\u0026#39;,\u0026#39;1010\u0026#39;), (\u0026#39;2020-01-01\u0026#39;,2020,1,\u0026#39;3C\u0026#39;,\u0026#39;手机\u0026#39;,\u0026#39;1011\u0026#39;), (\u0026#39;2020-02-01\u0026#39;,2020,2,\u0026#39;3C\u0026#39;,\u0026#39;电脑\u0026#39;,\u0026#39;1012\u0026#39;), (\u0026#39;2020-02-01\u0026#39;,2020,2,\u0026#39;3C\u0026#39;,\u0026#39;手机\u0026#39;,\u0026#39;1013\u0026#39;), (\u0026#39;2020-03-01\u0026#39;,2020,3,\u0026#39;3C\u0026#39;,\u0026#39;电脑\u0026#39;,\u0026#39;1014\u0026#39;), (\u0026#39;2020-03-01\u0026#39;,2020,3,\u0026#39;3C\u0026#39;,\u0026#39;手机\u0026#39;,\u0026#39;1015\u0026#39;), (\u0026#39;2021-04-01\u0026#39;,2021,4,\u0026#39;3C\u0026#39;,\u0026#39;电脑\u0026#39;,\u0026#39;1016\u0026#39;), (\u0026#39;2021-04-01\u0026#39;,2021,4,\u0026#39;3C\u0026#39;,\u0026#39;手机\u0026#39;,\u0026#39;1017\u0026#39;), (\u0026#39;2021-05-01\u0026#39;,2021,5,\u0026#39;3C\u0026#39;,\u0026#39;电脑\u0026#39;,\u0026#39;1018\u0026#39;), (\u0026#39;2021-05-01\u0026#39;,2021,5,\u0026#39;3C\u0026#39;,\u0026#39;手机\u0026#39;,\u0026#39;1019\u0026#39;); -- 查询每年每 category2 日累计 income SELECT `fdate`,`year`,`month`,`category1`,`category2`,`income` ,SUM(income) OVER (PARTITION BY `year`,`category1`,`category2` ORDER BY fdate) AS ttl_year_income FROM hdp_fin_dash_ods.test_over_partition; 在 MySQL 中 Before MySQL 8.0 you can\u0026rsquo;t use window functions like ROW_NUMBER.\nReferences Mysql 分组聚合实现 over partition by 功能 | cnblogs Emulating PARTITION OVER with MySQL 5.7 | stackoverflow \u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2021/09/14/sql-over-partition-by/","summary":"\u003ch2 id=\"在-hive-中\"\u003e在 HIVE 中\u003c/h2\u003e\n\u003cp\u003e最近在使用 HIVE，需要统计 \u003ccode\u003e当年累计和\u003c/code\u003e 这样的指标，请教同事后发现了 \u003ccode\u003eOVER(PARTITION BY)\u003c/code\u003e 开窗函数。\u003c/p\u003e\n\u003cp\u003e分析函数用于计算基于组的某种聚合值，它和聚合函数的不同之处是：对于每个组返回多行，而聚合函数对于每个组只返回一行。\u003c/p\u003e\n\u003cp\u003e开窗函数指定了分析函数工作的数据窗口大小，这个数据窗口大小可能会随着行的变化而变化。\u003c/p\u003e\n\u003cp\u003e测试语句：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sql\" data-lang=\"sql\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eCREATE\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eTABLE\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003edefault\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003etest_over_partition\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"n\"\u003efdate\u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nb\"\u003eDate\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"k\"\u003eyear\u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nb\"\u003eInt\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"k\"\u003emonth\u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nb\"\u003eInt\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"n\"\u003ecategory1\u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"n\"\u003ecategory2\u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"n\"\u003eincome\u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eDouble\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003eINSERT\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eINTO\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ehdp_fin_dash_ods\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003etest_over_partition\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"n\"\u003efdate\u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"k\"\u003eyear\u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"k\"\u003emonth\u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"n\"\u003ecategory1\u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"n\"\u003ecategory2\u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"n\"\u003eincome\u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eVALUES\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;2020-01-01\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"mi\"\u003e2020\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;3C\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;电脑\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;1010\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;2020-01-01\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"mi\"\u003e2020\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;3C\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;手机\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;1011\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;2020-02-01\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"mi\"\u003e2020\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"mi\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;3C\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;电脑\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;1012\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;2020-02-01\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"mi\"\u003e2020\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"mi\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;3C\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;手机\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;1013\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;2020-03-01\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"mi\"\u003e2020\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"mi\"\u003e3\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;3C\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;电脑\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;1014\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;2020-03-01\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"mi\"\u003e2020\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"mi\"\u003e3\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;3C\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;手机\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;1015\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;2021-04-01\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"mi\"\u003e2021\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"mi\"\u003e4\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;3C\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;电脑\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;1016\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;2021-04-01\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"mi\"\u003e2021\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"mi\"\u003e4\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;3C\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;手机\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;1017\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;2021-05-01\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"mi\"\u003e2021\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"mi\"\u003e5\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;3C\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;电脑\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;1018\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;2021-05-01\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"mi\"\u003e2021\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"mi\"\u003e5\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;3C\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;手机\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;1019\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"c1\"\u003e-- 查询每年每 category2 日累计 income\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003eSELECT\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"n\"\u003efdate\u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"k\"\u003eyear\u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"k\"\u003emonth\u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"n\"\u003ecategory1\u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"n\"\u003ecategory2\u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"n\"\u003eincome\u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"k\"\u003eSUM\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eincome\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eOVER\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ePARTITION\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eBY\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"k\"\u003eyear\u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"n\"\u003ecategory1\u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"n\"\u003ecategory2\u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eORDER\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eBY\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003efdate\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eAS\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ettl_year_income\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003eFROM\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ehdp_fin_dash_ods\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003etest_over_partition\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cimg src=\"https://user-images.githubusercontent.com/9289792/133225004-be0d2c88-e713-407b-b41d-da44e16ac960.png\" /\u003e\n\u003ch2 id=\"在-mysql-中\"\u003e在 MySQL 中\u003c/h2\u003e\n\u003cblockquote\u003e\n\u003cp\u003eBefore MySQL 8.0 you can\u0026rsquo;t use window functions like ROW_NUMBER.\u003c/p\u003e","title":"分组聚合 OVER PARTITION BY"},{"content":"why they are magic? Because they are magically called by PHP when specific actions happen.\nThe __invoke() method is called when a script tries to call an object as a function.\n\u0026lt;?php class CallableClass { public function __invoke($x) { var_dump($x); } } $obj = new CallableClass; $obj(5); var_dump(is_callable($obj)); int(5) bool(true) 使用明显的操作方法初始化 例如，当我们有一个提供者时，就会发生这种情况。\naws-sdk-php/src/Endpoint/PatternEndpointProvider.php\npublic function __invoke(array $args = []) { $service = isset($args[\u0026#39;service\u0026#39;]) ? $args[\u0026#39;service\u0026#39;] : \u0026#39;\u0026#39;; $region = isset($args[\u0026#39;region\u0026#39;]) ? $args[\u0026#39;region\u0026#39;] : \u0026#39;\u0026#39;; $keys = [\u0026#34;{$region}/{$service}\u0026#34;, \u0026#34;{$region}/*\u0026#34;, \u0026#34;*/{$service}\u0026#34;, \u0026#34;*/*\u0026#34;]; foreach ($keys as $key) { if (isset($this-\u0026gt;patterns[$key])) { return $this-\u0026gt;expand( $this-\u0026gt;patterns[$key], isset($args[\u0026#39;scheme\u0026#39;]) ? $args[\u0026#39;scheme\u0026#39;] : \u0026#39;https\u0026#39;, $service, $region ); } } return null; } 它使用 invoke 使用一些参数提供端点。我们如何使用这个类？\npublic function testReturnsNullWhenUnresolved() { $e = new PatternEndpointProvider([\u0026#39;foo\u0026#39; =\u0026gt; [\u0026#39;rules\u0026#39; =\u0026gt; []]]); $this-\u0026gt;assertNull($e([\u0026#39;service\u0026#39; =\u0026gt; \u0026#39;foo\u0026#39;, \u0026#39;region\u0026#39; =\u0026gt; \u0026#39;bar\u0026#39;])); } 尝试使用单动作控制器？ 控制器应该大而广泛？他们不应该。我们应该有瘦控制器和胖服务。\n在这里，invoke 可以帮助我们，因为我们可以定义一个只处理单个动作的控制器，并在其上放置单个 invoke 方法。\n这也有助于我们实现单一职责原则，即 SOLID 中的 S，这是前五个面向对象设计 (OOD) 原则的首字母缩写词。\nA class should have one and only one reason to change, meaning that a class should have only one job.\n在 Laravel 中的例子：Single Action Controllers | laravel：\n\u0026lt;?php namespace App\\Http\\Controllers; use App\\User; use App\\Http\\Controllers\\Controller; class ShowProfile extends Controller { /** * Show the profile for the given user. * * @param int $id * @return View */ public function __invoke($id) { return view(\u0026#39;user.profile\u0026#39;, [\u0026#39;user\u0026#39; =\u0026gt; User::findOrFail($id)]); } } 然后，在注册路由时，我们不需要指定方法名称。只有类名。\n\u0026lt;?php Route::get(\u0026#39;user/{id}\u0026#39;, \u0026#39;ShowProfile\u0026#39;); This way we can have Single Action Controllers.\n实现回调函数 by GPT class Sorter { public function __invoke($a, $b) { return $a \u0026lt;=\u0026gt; $b; // 比较函数 } } $numbers = [3, 1, 4, 1, 5, 9, 2, 6, 5]; usort($numbers, new Sorter()); print_r($numbers); // 输出排序后的数组 实现函数式编程 by GPT class Adder { private $value; public function __construct($value) { $this-\u0026gt;value = $value; } public function __invoke($x) { return $this-\u0026gt;value + $x; } } $add5 = new Adder(5); $result = $add5(3); // 结果为 8 References PHP invoke: is anybody using it? | medium __invoke() | php \u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2021/07/20/php-invoke-is-anybody-using-it/","summary":"\u003cp\u003ewhy they are magic? Because they are magically called by PHP when specific actions happen.\u003c/p\u003e\n\u003cp\u003eThe \u003ccode\u003e__invoke()\u003c/code\u003e method is called when a script tries to call an object as a function.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e\u0026lt;?\u003c/span\u003e\u003cspan class=\"nx\"\u003ephp\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eCallableClass\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003efunction\u003c/span\u003e \u003cspan class=\"fm\"\u003e__invoke\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$x\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$x\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$obj\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003eCallableClass\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$obj\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e5\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eis_callable\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$obj\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eint\u003cspan class=\"o\"\u003e(\u003c/span\u003e5\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ebool\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nb\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"使用明显的操作方法初始化\"\u003e使用明显的操作方法初始化\u003c/h2\u003e\n\u003cp\u003e例如，当我们有一个提供者时，就会发生这种情况。\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://github.com/aws/aws-sdk-php/blob/master/src/Endpoint/PatternEndpointProvider.php\"\u003eaws-sdk-php/src/Endpoint/PatternEndpointProvider.php\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003efunction\u003c/span\u003e \u003cspan class=\"fm\"\u003e__invoke\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003earray\u003c/span\u003e \u003cspan class=\"nv\"\u003e$args\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e[])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nv\"\u003e$service\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003eisset\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$args\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;service\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e])\u003c/span\u003e \u003cspan class=\"o\"\u003e?\u003c/span\u003e \u003cspan class=\"nv\"\u003e$args\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;service\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nv\"\u003e$region\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003eisset\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$args\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;region\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e])\u003c/span\u003e \u003cspan class=\"o\"\u003e?\u003c/span\u003e \u003cspan class=\"nv\"\u003e$args\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;region\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nv\"\u003e$keys\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"si\"\u003e{\u003c/span\u003e\u003cspan class=\"nv\"\u003e$region\u003c/span\u003e\u003cspan class=\"si\"\u003e}\u003c/span\u003e\u003cspan class=\"s2\"\u003e/\u003c/span\u003e\u003cspan class=\"si\"\u003e{\u003c/span\u003e\u003cspan class=\"nv\"\u003e$service\u003c/span\u003e\u003cspan class=\"si\"\u003e}\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"si\"\u003e{\u003c/span\u003e\u003cspan class=\"nv\"\u003e$region\u003c/span\u003e\u003cspan class=\"si\"\u003e}\u003c/span\u003e\u003cspan class=\"s2\"\u003e/*\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;*/\u003c/span\u003e\u003cspan class=\"si\"\u003e{\u003c/span\u003e\u003cspan class=\"nv\"\u003e$service\u003c/span\u003e\u003cspan class=\"si\"\u003e}\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;*/*\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e];\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eforeach\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$keys\u003c/span\u003e \u003cspan class=\"k\"\u003eas\u003c/span\u003e \u003cspan class=\"nv\"\u003e$key\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eisset\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$this\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"na\"\u003epatterns\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"nv\"\u003e$key\u003c/span\u003e\u003cspan class=\"p\"\u003e]))\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nv\"\u003e$this\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"na\"\u003eexpand\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                \u003cspan class=\"nv\"\u003e$this\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"na\"\u003epatterns\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"nv\"\u003e$key\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                \u003cspan class=\"nx\"\u003eisset\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$args\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;scheme\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e])\u003c/span\u003e \u003cspan class=\"o\"\u003e?\u003c/span\u003e \u003cspan class=\"nv\"\u003e$args\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;scheme\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;https\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                \u003cspan class=\"nv\"\u003e$service\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                \u003cspan class=\"nv\"\u003e$region\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e它使用 invoke 使用一些参数提供端点。我们如何使用这个类？\u003c/p\u003e","title":"PHP __invoke 使用"},{"content":" 严格模式的声明 必须 放在文件的顶部。 严格模式不仅作用于函数参数的类型声明，也作用于函数的返回值类型。 声明 PHP 文件作为严格模式的一个好事是，实际上只适用于当前文件。这确保了这个文件是严格类型，但是他没有影响到整个项目中的其他文件。这允许你一步一步的迁移非严格模式的代码。\n使用提示类型没有 strict_types 可能导致微妙的错误。\n严格类型之前，int $x 意味着 $x must have a value coercible to an int。\na float (example: 13.1459 -\u0026gt; 13) a bool (example: true -\u0026gt; 1) a null (example: null -\u0026gt; 0) a string with leading digits (example: “15 Trees” -\u0026gt; 15) 设置严格模式后，you tell the engine that int $x means $x must only be an int proper, no type coercion allowed。\n谁给更关心 strict_type 这行？is more for the reader than for the writer. Why? Bacause it will explicitly tell the reader:\nThe types in this current scope are treated strictly.\n对比 \u0026lt;?php function add(int $a, int $b): int { return $a + $b; } var_dump(add(1.0, 2.0)); 运行输出 int(3)。\n\u0026lt;?php declare(strict_types=1); function add(int $a, int $b): int { return $a + $b; } var_dump(add(1.0, 2.0)); 运行输出：\nPHP Fatal error: Uncaught TypeError: Argument 1 passed to add() must be of the type int, float given, ... 声明位置 必须在脚本最前。不能写在脚本的中间，如下写法是错误的：\n\u0026lt;?php function add(int $a, int $b): int { return $a + $b; } declare(strict_types=1); var_dump(add(1.0, 2.0)); 运行后报错：\nPHP Fatal error: strict_types declaration must be the very first statement in the script in ... 不得使用 block mode 进行声明：\n\u0026lt;?php declare(strict_types=1) { var_dump(1); } 运行后报错：\nPHP Fatal error: strict_types declaration must not use block mode in ... 多文件场景 例子 1 A.php\n\u0026lt;?php // 严格模式 declare(strict_types=1); function add(int $a, int $b): int { return $a + $b; } B.php\n\u0026lt;?php // 非严格模式 require \u0026#39;A.php\u0026#39;; // 违反了 A 的定义 var_dump(add(1.0, 2.0)); 运行\nphp B.php int(3) 例子 2 A.php\n\u0026lt;?php // 非严格模式 function add(int $a, int $b): int { return $a + $b; } B.php\n\u0026lt;?php // 严格模式 declare(strict_types=1); require \u0026#39;A.php\u0026#39;; // 违反了 A 的定义 var_dump(add(1.0, 2.0)); 运行\nphp B.php PHP Fatal error: Uncaught TypeError: Argument 1 passed to add() must be of the type int, float given, called in ... 小结 函数定义时的严格模式，行为并不会出现什么不同。 函数执行时的，严格模式会出现差异。 declare(strict_types=1); 的声明本身在 A.php 文件中完成。被 B.php 文件 require，而 B.php 并没有定义严格模式，那么执行 require 的 B.php 文件不会变成严格模式。 总结 只有在写 declare 的文件的执行部分才会执行严格模式，该文件中调用的其它函数（其它文件中的函数）也会被影响。\n若果想完全使用严格模式，比较简单的方法是在所有 php 文件都写上 declare(strict_types=1);。\n工具 推荐自动格式化工具：symplify/easy-coding-standard。\nReferences 关于 declare(strict_types=1) 的有效范围 | segmentfault Strict Types in PHP | medium Scalar type declarations | php Strict typing | php \u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2021/07/19/php-strict-types/","summary":"\u003cul\u003e\n\u003cli\u003e严格模式的声明 \u003cem\u003e必须\u003c/em\u003e 放在文件的顶部。\u003c/li\u003e\n\u003cli\u003e严格模式不仅作用于函数参数的类型声明，也作用于函数的返回值类型。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e声明 PHP 文件作为严格模式的一个好事是，实际上只适用于当前文件。这确保了这个文件是严格类型，但是他没有影响到整个项目中的其他文件。这允许你一步一步的迁移非严格模式的代码。\u003c/p\u003e\n\u003cp\u003e使用提示类型没有 strict_types 可能导致微妙的错误。\u003c/p\u003e\n\u003cp\u003e严格类型之前，\u003ccode\u003eint $x\u003c/code\u003e 意味着 \u003ccode\u003e$x must have a value coercible to an int\u003c/code\u003e。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003ea float (example: 13.1459 -\u0026gt; 13)\u003c/li\u003e\n\u003cli\u003ea bool (example: true -\u0026gt; 1)\u003c/li\u003e\n\u003cli\u003ea null (example: null -\u0026gt; 0)\u003c/li\u003e\n\u003cli\u003ea string with leading digits (example: “15 Trees” -\u0026gt; 15)\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e设置严格模式后，you tell the engine that \u003ccode\u003eint $x\u003c/code\u003e means \u003ccode\u003e$x must only be an int proper, no type coercion allowed\u003c/code\u003e。\u003c/p\u003e\n\u003cp\u003e谁给更关心 \u003ccode\u003estrict_type\u003c/code\u003e 这行？is more for the reader than for the writer. Why? Bacause it will explicitly tell the reader:\u003c/p\u003e","title":"PHP strict_types 严格模式"},{"content":"记住密码 Git 记住密码配置后，不用每次 pull、push 都需要输入密码：\ngit config --global credential.helper store 会在 cat ~/.gitconfig 看到：\n[credential] helper = store 快速检出上一个分支 git checkout - 提交空改动 git commit -m \u0026#34;empty commit\u0026#34; --allow-empty 在如下几种情况下是有意义：\n标记一批工作或一个新功能的开始。 记录你对项目进行了跟代码无关的改动。 跟使用你仓库的其他人交流。 作为仓库的第一次提交，因为第一次提交日后是不能被 rebase 的：git commit -m \u0026quot;init repo\u0026quot; --allow-empty。 更直观的 status git status -sb 更直观的 log git log --all --graph --pretty=format:\u0026#39;%Cred%h%Creset -%C(yellow)%d%Creset %s %Cgreen(%cr) %C(bold blue)\u0026lt;%an %ae\u0026gt;%Creset\u0026#39; --abbrev-commit --date=relative 提交信息查询 找到其中和搜索条件相匹配的最近的一条。query （区别大小写）是你想要搜索的词语。\ngit show :/query 分支合并 显示所有已经合并到你当前分支的分支列表：\ngit branch --merged 相反地：\ngit branch --no-merged .gitconfig 打开编辑：\nvim ~/.gitconfig 命令修改：\ngit config --global alias.co \u0026#39;checkout\u0026#39; git config --global alias.ac \u0026#39;add -A . \u0026amp;\u0026amp; commit\u0026#39; git config --global alias.lg \u0026#34;log --color --graph --pretty=format:\u0026#39;%Cred%h%Creset -%C(yellow)%d%Creset %s %Cgreen(%cr) %C(bold blue)\u0026lt;%an %ae\u0026gt;%Creset\u0026#39; --abbrev-commit\u0026#34; GitHub 整行高亮 多行高亮也可以，比如用 #L53-L60 选择范围，或者按住 shift 键，然后再点击选择的两行。\nhttps://github.com/rails/rails/blob/master/activemodel/lib/active_model.rb#L53-L60 用 commit 信息关闭 issue 如果某个提交修复了一个 Issue，当提交到 master 分支时，提交信息里可以使用 fix/fixes/fixed , close/closes/closed 或者 resolve/resolves/resolved 等关键词，后面再跟上 Issue 号，这样就会关闭这个 Issue。\ngit commit -m \u0026#34;Fix screwup, fixes #12\u0026#34; 链接其他仓库的 Issue 如果你想引用到同一个仓库中的一个 Issue，只需使用井号 # 加上 Issue 号，这样就会自动创建到此 Issue 的链接。\n要链接到其他仓库的 Issue，就使用 user_name/repo_name#ISSUE_NUMBER 的方式，例如 tiimgreen/toc#12。\nReference Git and GitHub Secrets | speakerdeck More Git and GitHub Secrets | speakerdeck \u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2021/07/12/git-and-github-secrets/","summary":"\u003ch2 id=\"记住密码\"\u003e记住密码\u003c/h2\u003e\n\u003cp\u003eGit 记住密码配置后，不用每次 pull、push 都需要输入密码：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit config --global credential.helper store\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e会在 \u003ccode\u003ecat ~/.gitconfig\u003c/code\u003e 看到：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003ecredential\u003cspan class=\"o\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nv\"\u003ehelper\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e store\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"快速检出上一个分支\"\u003e快速检出上一个分支\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit checkout -\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"提交空改动\"\u003e提交空改动\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit commit -m \u003cspan class=\"s2\"\u003e\u0026#34;empty commit\u0026#34;\u003c/span\u003e --allow-empty\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e在如下几种情况下是有意义：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e标记一批工作或一个新功能的开始。\u003c/li\u003e\n\u003cli\u003e记录你对项目进行了跟代码无关的改动。\u003c/li\u003e\n\u003cli\u003e跟使用你仓库的其他人交流。\u003c/li\u003e\n\u003cli\u003e作为仓库的第一次提交，因为第一次提交日后是不能被 rebase 的：\u003ccode\u003egit commit -m \u0026quot;init repo\u0026quot; --allow-empty\u003c/code\u003e。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"更直观的-status\"\u003e更直观的 status\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit status -sb\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"更直观的-log\"\u003e更直观的 log\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit log --all --graph --pretty\u003cspan class=\"o\"\u003e=\u003c/span\u003eformat:\u003cspan class=\"s1\"\u003e\u0026#39;%Cred%h%Creset -%C(yellow)%d%Creset %s %Cgreen(%cr) %C(bold blue)\u0026lt;%an %ae\u0026gt;%Creset\u0026#39;\u003c/span\u003e --abbrev-commit --date\u003cspan class=\"o\"\u003e=\u003c/span\u003erelative\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"提交信息查询\"\u003e提交信息查询\u003c/h2\u003e\n\u003cp\u003e找到其中和搜索条件相匹配的最近的一条。query （区别大小写）是你想要搜索的词语。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit show :/query\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"分支合并\"\u003e分支合并\u003c/h2\u003e\n\u003cp\u003e显示所有已经合并到你当前分支的分支列表：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit branch --merged\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e相反地：\u003c/p\u003e","title":"Git and GitHub Secrets"},{"content":"《如何做好技术协同及管理 —— 合作伙伴篇》一次沙龙后的笔记。\n招人 注重招人环节；在这一步要卡严，因为入职后再折腾就更费时费力了。 要关注的点：基础水平（工程能力）、离职原因（是否能长久）、个人性格（气场是否相合）。 入职 主动沟通是重要的特质。还有责任心、可塑性、执行力。 前紧后松；前期要做 code review，养成好习惯。 关注测试同学以及其他同学对其的反馈。了解工作状态、质量。 在突破底线后应该当机立断，无需心存幻想。 心态 没有归宿感；owner 意识。 每一位都是组内的一员。 管理 早会；任务安排，跟踪进度。不能不闻不问，最后容易抓瞎。 超过 30min 解决不了的问题，直接沟通，避免团队时间的浪费。 读书会，组内分享；打造一个好的技术氛围，这里不只是工作，还能成长。 要对任务的工作量有判断；并且明确开发规模，并且进行核对，防止 “大事小做，小题大做”。 通过先编写好单元测试、框架结构、interface，控制需求实现、代码质量。 在无法进行横向对比的情况下，可以对比加入前后是否释放自身生产力来进行判断。 三个卡点：需求评审、技术实现评审、测试用例评审，把关质量。 \u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2021/07/08/how-to-do-technical-management/","summary":"\u003cp\u003e《如何做好技术协同及管理 —— 合作伙伴篇》一次沙龙后的笔记。\u003c/p\u003e\n\u003ch2 id=\"招人\"\u003e招人\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e注重招人环节；在这一步要卡严，因为入职后再折腾就更费时费力了。\u003c/li\u003e\n\u003cli\u003e要关注的点：基础水平（工程能力）、离职原因（是否能长久）、个人性格（气场是否相合）。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"入职\"\u003e入职\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e主动沟通是重要的特质。还有责任心、可塑性、执行力。\u003c/li\u003e\n\u003cli\u003e前紧后松；前期要做 code review，养成好习惯。\u003c/li\u003e\n\u003cli\u003e关注测试同学以及其他同学对其的反馈。了解工作状态、质量。\u003c/li\u003e\n\u003cli\u003e在突破底线后应该当机立断，无需心存幻想。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"心态\"\u003e心态\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e没有归宿感；owner 意识。\u003c/li\u003e\n\u003cli\u003e每一位都是组内的一员。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"管理\"\u003e管理\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e早会；任务安排，跟踪进度。不能不闻不问，最后容易抓瞎。\u003c/li\u003e\n\u003cli\u003e超过 30min 解决不了的问题，直接沟通，避免团队时间的浪费。\u003c/li\u003e\n\u003cli\u003e读书会，组内分享；打造一个好的技术氛围，这里不只是工作，还能成长。\u003c/li\u003e\n\u003cli\u003e要对任务的工作量有判断；并且明确开发规模，并且进行核对，防止 “大事小做，小题大做”。\u003c/li\u003e\n\u003cli\u003e通过先编写好单元测试、框架结构、interface，控制需求实现、代码质量。\u003c/li\u003e\n\u003cli\u003e在无法进行横向对比的情况下，可以对比加入前后是否释放自身生产力来进行判断。\u003c/li\u003e\n\u003cli\u003e三个卡点：需求评审、技术实现评审、测试用例评审，把关质量。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u0026ndash; EOF \u0026ndash;\u003c/p\u003e","title":"如何做好技术协同及管理"},{"content":"11 领域驱动设计（Domain Driven Design，简称 DDD）。\n什么是基于贫血模型的传统开发模式？ UserEntity 和 UserRepository 组成了数据访问层，UserBo 和 UserService 组成了业务逻辑层，UserVo 和 UserController 在这里属于接口层。\nService 层的数据和业务逻辑，被分割为 BO 和 Service 两个类中。像 UserBo 这样，只包含数据，不包含业务逻辑的类，就叫作贫血模型（Anemic Domain Model）。\n这种贫血模型将数据与操作分离，破坏了面向对象的封装特性，是一种典型的面向过程的编程风格。\n什么是基于充血模型的 DDD 开发模式？ 领域驱动设计，即 DDD，主要是用来指导如何解耦业务系统，划分业务模块，定义业务领域模型及其交互。\n基于贫血模型的传统的开发模式，重 Service 轻 BO；基于充血模型的 DDD 开发模式，轻 Service 重 Domain。\n为什么基于贫血模型的传统开发模式如此受欢迎？ 系统业务可能都比较简单，简单到就是基于 SQL 的 CRUD 操作 充血模型的设计要比贫血模型更加有难度。我们从一开始就要设计好针对数据要暴露哪些操作，定义哪些业务逻辑。而不是像贫血模型那样，我们只需要定义数据，之后有什么功能开发需求，我们就在 Service 层定义什么操作，不需要事先做太多设计。 思维已固化，转型有成本。 什么项目应该考虑使用基于充血模型的 DDD 开发模式？ 适合业务复杂的系统开发。比如，包含各种利息计算模型、还款模型等复杂业务的金融系统。\n两种不同的开发模式会导致不同的开发流程。基于充血模型的 DDD 开发模式的开发流程，在应对复杂业务系统的开发的时候更加有优势。\nDDD 这种开发模式下，我们需要事先理清楚所有的业务，定义领域模型所包含的属性和方法。领域模型相当于可复用的业务中间层。新功能需求的开发，都基于之前定义好的这些领域模型来完成。\n12 一个虚拟钱包系统 充值、提现、支付、查询余额、查询交易流水。甚至还有冻结、透支、转赠等。\n整个钱包系统一部分单纯跟应用内的虚拟钱包账户打交道，另一部分单纯跟银行账户打交道。我们基于这样一个业务划分，给系统解耦，将整个钱包系统拆分为两个子系统：虚拟钱包系统和三方支付系统。\n不保证数据的强一致性，只实现数据的最终一致性。\npublic class VirtualWalletService { // 通过构造函数或者 IOC 框架注入 private VirtualWalletRepository walletRepo; private VirtualWalletTransactionRepository transactionRepo; public VirtualWallet getVirtualWallet(Long walletId ) { VirtualWalletEntity walletEntity = walletRepo.getWalletEntity(walletId); VirtualWallet wallet = convert(walletEntity); return wallet; } public BigDecimal getBalance(Long walletId) { return virtualWalletRepo.getBalance(walletId); } public void debit(Long walletId, BigDecimal amount) { VirtualWalletEntity walletEntity = walletRepo.getWalletEntity(walletId); // 贫血型 // BigDecimal balance = walletEntity.getBalance(); // if (balance.compareTo(amount) \u0026lt; 0) { // throw new NoSufficientBalanceException(...); // } // walletRepo.updateBalance(walletId, balance.subtract(amount)); // DDD VirtualWallet wallet = convert(walletEntity); wallet.debit(amount); walletRepo.updateBalance(walletId, wallet.balance()); } public void credit(Long walletId, BigDecimal amount) { VirtualWalletEntity walletEntity = walletRepo.getWalletEntity(walletId); // 贫血型 // BigDecimal balance = walletEntity.getBalance(); // walletRepo.updateBalance(walletId, balance.add(amount)); // DDD VirtualWallet wallet = convert(walletEntity); wallet.credit(amount); walletRepo.updateBalance(walletId, wallet.balance()); } public void transfer(Long fromWalletId, Long toWalletId, BigDecimal amount) { VirtualWalletTransactionEntity transactionEntity = new VirtualWalletTransactionEntity(); transactionEntity.setAmount(amount); transactionEntity.setCreateTime(System.currentTimeMillis()); transactionEntity.setFromWalletId(fromWalletId); transactionEntity.setToWalletId(toWalletId); transactionEntity.setStatus(Status.TO_BE_EXECUTED); Long transactionId = transactionRepo.saveTransaction(transactionEntity); try { debit(fromWalletId, amount); credit(toWalletId, amount); } catch (InsufficientBalanceException e) { transactionRepo.updateStatus(transactionId, Status.CLOSED); // ...rethrow exception e... } catch (Exception e) { transactionRepo.updateStatus(transactionId, Status.FAILED); // ...rethrow exception e... } transactionRepo.updateStatus(transactionId, Status.EXECUTED); } } 领域模型 VirtualWallet 类很单薄，包含的业务逻辑很简单。相对于原来的贫血模型的设计思路，这种充血模型的设计思路，貌似并没有太大优势。这也是大部分业务系统都使用基于贫血模型开发的原因。不过，如果虚拟钱包系统需要支持更复杂的业务逻辑，那充血模型的优势就显现出来了。比如，我们要支持透支一定额度和冻结部分余额的功能。这个时候，我们重新来看一下 VirtualWallet 类的实现代码。\npublic class VirtualWallet { private Long id; private Long createTime = System.currentTimeMillis(); private BigDecimal balance = BigDecimal.ZERO; private boolean isAllowedOverdraft = true; private BigDecimal overdraftAmount = BigDecimal.ZERO; private BigDecimal frozenAmount = BigDecimal.ZERO; public VirtualWallet(Long preAllocatedId) { this.id = preAllocatedId; } public BigDecimal balance() { return this.balance; } public BigDecimal getAvaliableBalance() { BigDecimal totalAvaliableBalance = this.balance.subtract(this.frozenAmount); if (isAllowedOverdraft) { totalAvaliableBalance += this.overdraftAmount; } return totalAvaliableBalance; } public void debit(BigDecimal amount) {} public void credit(BigDecimal amount) {} public void freeze(BigDecimal amount) { ... } public void unfreeze(BigDecimal amount) { ...} public void increaseOverdraftAmount(BigDecimal amount) { ... } public void decreaseOverdraftAmount(BigDecimal amount) { ... } public void closeOverdraft() { ... } public void openOverdraft() { ... } } 如果功能继续演进，我们可以增加更加细化的冻结策略、透支策略、支持钱包账号（VirtualWallet id 字段）自动生成的逻辑（不是通过构造函数经外部传入 ID，而是通过分布式 ID 生成算法来自动生成 ID）等等。\n辩证思考与灵活应用 两种代码设计与实现中，并没有完全将 Service 类去掉，这是为什么？或者说，Service 类在这种情况下担当的职责是什么？哪些功能逻辑会放到 Service 类中？\nService 类负责与 Repository 交流。获取数据库中的数据，转化成领域模型 VirtualWallet，然后由领域模型 VirtualWallet 来完成业务逻辑，最后调用 Repository 类的方法，将数据存回数据库。之所以让 VirtualWalletService 类与 Repository 打交道，而不是让领域模型 VirtualWallet 与 Repository 打交道，那是因为我们想保持领域模型的独立性，不与任何其他层的代码（Repository 层的代码）或开发框架（比如 Spring、MyBatis）耦合在一起，将流程性的代码逻辑（比如从 DB 中取数据、映射数据）与领域模型的业务逻辑解耦，让领域模型更加可复用。 Service 类负责跨领域模型的业务聚合功能。VirtualWalletService 类中的 transfer() 转账函数会涉及两个钱包的操作，因此这部分业务逻辑无法放到 VirtualWallet 类中，所以，我们暂且把转账业务放到 VirtualWalletService 类中了。当然，虽然功能演进，使得转账业务变得复杂起来之后，我们也可以将转账业务抽取出来，设计成一个独立的领域模型。 Service 类负责一些非功能性及与三方系统交互的工作。比如幂等、事务、发邮件、发消息、记录日志、调用其他系统的 RPC 接口等，都可以放到 Service 类中。 小结 基于充血模型的 DDD 开发模式跟基于贫血模型的传统开发模式相比，主要区别在 Service 层。在基于充血模型的开发模式下，我们将部分原来在 Service 类中的业务逻辑移动到了一个充血的 Domain 领域模型中，让 Service 类的实现依赖这个 Domain 类。\n在基于充血模型的 DDD 开发模式下，Service 类并不会完全移除，而是负责一些不适合放在 Domain 类中的功能。比如，负责与 Repository 层打交道、跨领域模型的业务聚合功能、幂等事务等非功能性的工作。\n基于充血模型的 DDD 开发模式跟基于贫血模型的传统开发模式相比，Controller 层和 Repository 层的代码基本上相同。这是因为，Repository 层的 Entity 生命周期有限，Controller 层的 VO 只是单纯作为一种 DTO。两部分的业务逻辑都不会太复杂。业务逻辑主要集中在 Service 层。所以，Repository 层和 Controller 层继续沿用贫血模型的设计思路是没有问题的。\n遗留问题：Entity 与 Domain 的转换应该放在哪里？\n13 如何对接口鉴权这样一个功能开发做面向对象分析？ 面向对象分析（OOA）、面向对象设计（OOD）、面向对象编程（OOP），是面向对象开发的三个主要环节。\n我们需要通过沟通、挖掘、分析、假设、梳理，搞清楚具体的需求有哪些，哪些是现在要做的，哪些是未来可能要做的，哪些是不用考虑做的。\n加密之后的密码及 AppID，可能被 重放攻击。\n调用方将请求接口的 URL 跟 AppID、密码拼接在一起，然后进行加密，生成一个 token。\n这样的设计仍然存在重放攻击的风险。\n为了解决这个问题，我们可以进一步优化 token 生成算法，引入一个随机变量，让每次接口请求生成的 token 都不一样。\n微服务端在收到这些数据之后，会验证当前时间戳跟传递过来的时间戳，是否在一定的时间窗口内（比如一分钟）。\n14 把 URL、AppID、密码、时间戳拼接为一个字符串； 对字符串通过加密算法加密生成 token； 将 token、AppID、时间戳拼接到 URL 中，形成新的 URL； 解析 URL，得到 token、AppID、时间戳等信息； 从存储中取出 AppID 和对应的密码； 根据时间戳判断 token 是否过期失效； 验证两个 token 是否匹配； 1、2、6、7 都是跟 token 有关，负责 token 的生成、验证；3、4 都是在处理 URL，负责 URL 的拼接、解析；5 是操作 AppID 和密码，负责从存储中读取 AppID 和密码。AuthToken、Url、CredentialStorage。\n15 ","permalink":"https://zyf.im/2021/02/06/the-beauty-of-design-patterns-part2/","summary":"\u003ch2 id=\"11\"\u003e11\u003c/h2\u003e\n\u003cp\u003e领域驱动设计（Domain Driven Design，简称 DDD）。\u003c/p\u003e\n\u003ch3 id=\"什么是基于贫血模型的传统开发模式\"\u003e什么是基于贫血模型的传统开发模式？\u003c/h3\u003e\n\u003cp\u003eUserEntity 和 UserRepository 组成了数据访问层，UserBo 和 UserService 组成了业务逻辑层，UserVo 和 UserController 在这里属于接口层。\u003c/p\u003e\n\u003cp\u003eService 层的数据和业务逻辑，被分割为 BO 和 Service 两个类中。像 UserBo 这样，只包含数据，不包含业务逻辑的类，就叫作贫血模型（Anemic Domain Model）。\u003c/p\u003e\n\u003cp\u003e这种贫血模型将数据与操作分离，破坏了面向对象的封装特性，是一种典型的面向过程的编程风格。\u003c/p\u003e\n\u003ch3 id=\"什么是基于充血模型的-ddd-开发模式\"\u003e什么是基于充血模型的 DDD 开发模式？\u003c/h3\u003e\n\u003cp\u003e领域驱动设计，即 DDD，主要是用来指导如何解耦业务系统，划分业务模块，定义业务领域模型及其交互。\u003c/p\u003e\n\u003cp\u003e基于贫血模型的传统的开发模式，重 Service 轻 BO；基于充血模型的 DDD 开发模式，轻 Service 重 Domain。\u003c/p\u003e\n\u003ch3 id=\"为什么基于贫血模型的传统开发模式如此受欢迎\"\u003e为什么基于贫血模型的传统开发模式如此受欢迎？\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e系统业务可能都比较简单，简单到就是基于 SQL 的 CRUD 操作\u003c/li\u003e\n\u003cli\u003e充血模型的设计要比贫血模型更加有难度。我们从一开始就要设计好针对数据要暴露哪些操作，定义哪些业务逻辑。而不是像贫血模型那样，我们只需要定义数据，之后有什么功能开发需求，我们就在 Service 层定义什么操作，不需要事先做太多设计。\u003c/li\u003e\n\u003cli\u003e思维已固化，转型有成本。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"什么项目应该考虑使用基于充血模型的-ddd-开发模式\"\u003e什么项目应该考虑使用基于充血模型的 DDD 开发模式？\u003c/h3\u003e\n\u003cp\u003e适合业务复杂的系统开发。比如，包含各种利息计算模型、还款模型等复杂业务的金融系统。\u003c/p\u003e\n\u003cp\u003e两种不同的开发模式会导致不同的开发流程。基于充血模型的 DDD 开发模式的开发流程，在应对复杂业务系统的开发的时候更加有优势。\u003c/p\u003e\n\u003cp\u003eDDD 这种开发模式下，我们需要事先理清楚所有的业务，定义领域模型所包含的属性和方法。领域模型相当于可复用的业务中间层。新功能需求的开发，都基于之前定义好的这些领域模型来完成。\u003c/p\u003e\n\u003ch2 id=\"12\"\u003e12\u003c/h2\u003e\n\u003ch3 id=\"一个虚拟钱包系统\"\u003e一个虚拟钱包系统\u003c/h3\u003e\n\u003cp\u003e充值、提现、支付、查询余额、查询交易流水。甚至还有冻结、透支、转赠等。\u003c/p\u003e\n\u003cp\u003e整个钱包系统一部分单纯跟应用内的虚拟钱包账户打交道，另一部分单纯跟银行账户打交道。我们基于这样一个业务划分，给系统解耦，将整个钱包系统拆分为两个子系统：虚拟钱包系统和三方支付系统。\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"image\" loading=\"lazy\" src=\"https://user-images.githubusercontent.com/9289792/107135323-ba50b780-6934-11eb-8b85-1738440f42bc.png\"\u003e\u003c/p\u003e\n\u003cp\u003e不保证数据的强一致性，只实现数据的最终一致性。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003epublic\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kd\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eVirtualWalletService\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"c1\"\u003e// 通过构造函数或者 IOC 框架注入\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"kd\"\u003eprivate\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eVirtualWalletRepository\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ewalletRepo\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"kd\"\u003eprivate\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eVirtualWalletTransactionRepository\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003etransactionRepo\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"kd\"\u003epublic\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eVirtualWallet\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nf\"\u003egetVirtualWallet\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eLong\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ewalletId\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"n\"\u003eVirtualWalletEntity\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ewalletEntity\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ewalletRepo\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003egetWalletEntity\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ewalletId\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"n\"\u003eVirtualWallet\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ewallet\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003econvert\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ewalletEntity\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"k\"\u003ereturn\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ewallet\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"kd\"\u003epublic\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eBigDecimal\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nf\"\u003egetBalance\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eLong\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ewalletId\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"k\"\u003ereturn\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003evirtualWalletRepo\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003egetBalance\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ewalletId\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"kd\"\u003epublic\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kt\"\u003evoid\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nf\"\u003edebit\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eLong\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ewalletId\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eBigDecimal\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eamount\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"n\"\u003eVirtualWalletEntity\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ewalletEntity\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ewalletRepo\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003egetWalletEntity\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ewalletId\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"c1\"\u003e// 贫血型\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"c1\"\u003e// BigDecimal balance = walletEntity.getBalance();\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"c1\"\u003e// if (balance.compareTo(amount) \u0026lt; 0) {\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"c1\"\u003e//   throw new NoSufficientBalanceException(...);\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"c1\"\u003e// }\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"c1\"\u003e// walletRepo.updateBalance(walletId, balance.subtract(amount));\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"c1\"\u003e// DDD\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"n\"\u003eVirtualWallet\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ewallet\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003econvert\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ewalletEntity\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"n\"\u003ewallet\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003edebit\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eamount\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"n\"\u003ewalletRepo\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eupdateBalance\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ewalletId\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ewallet\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003ebalance\u003c/span\u003e\u003cspan class=\"p\"\u003e());\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"kd\"\u003epublic\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kt\"\u003evoid\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nf\"\u003ecredit\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eLong\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ewalletId\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eBigDecimal\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eamount\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"n\"\u003eVirtualWalletEntity\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ewalletEntity\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ewalletRepo\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003egetWalletEntity\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ewalletId\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"c1\"\u003e// 贫血型\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"c1\"\u003e// BigDecimal balance = walletEntity.getBalance();\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"c1\"\u003e// walletRepo.updateBalance(walletId, balance.add(amount));\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"c1\"\u003e// DDD\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"n\"\u003eVirtualWallet\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ewallet\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003econvert\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ewalletEntity\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"n\"\u003ewallet\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003ecredit\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eamount\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"n\"\u003ewalletRepo\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eupdateBalance\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ewalletId\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ewallet\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003ebalance\u003c/span\u003e\u003cspan class=\"p\"\u003e());\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"kd\"\u003epublic\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kt\"\u003evoid\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nf\"\u003etransfer\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eLong\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003efromWalletId\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eLong\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003etoWalletId\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eBigDecimal\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eamount\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"n\"\u003eVirtualWalletTransactionEntity\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003etransactionEntity\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eVirtualWalletTransactionEntity\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"n\"\u003etransactionEntity\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003esetAmount\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eamount\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"n\"\u003etransactionEntity\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003esetCreateTime\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003ecurrentTimeMillis\u003c/span\u003e\u003cspan class=\"p\"\u003e());\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"n\"\u003etransactionEntity\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003esetFromWalletId\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003efromWalletId\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"n\"\u003etransactionEntity\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003esetToWalletId\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etoWalletId\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"n\"\u003etransactionEntity\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003esetStatus\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eStatus\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eTO_BE_EXECUTED\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"n\"\u003eLong\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003etransactionId\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003etransactionRepo\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003esaveTransaction\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etransactionEntity\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"k\"\u003etry\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"n\"\u003edebit\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003efromWalletId\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eamount\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"n\"\u003ecredit\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etoWalletId\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eamount\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003ecatch\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eInsufficientBalanceException\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"n\"\u003etransactionRepo\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eupdateStatus\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etransactionId\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eStatus\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eCLOSED\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"c1\"\u003e// ...rethrow exception e...\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003ecatch\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eException\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"n\"\u003etransactionRepo\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eupdateStatus\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etransactionId\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eStatus\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eFAILED\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"c1\"\u003e// ...rethrow exception e...\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"n\"\u003etransactionRepo\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eupdateStatus\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etransactionId\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eStatus\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eEXECUTED\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e领域模型 VirtualWallet 类很单薄，包含的业务逻辑很简单。相对于原来的贫血模型的设计思路，这种充血模型的设计思路，貌似并没有太大优势。这也是大部分业务系统都使用基于贫血模型开发的原因。不过，如果虚拟钱包系统需要支持更复杂的业务逻辑，那充血模型的优势就显现出来了。比如，我们要支持透支一定额度和冻结部分余额的功能。这个时候，我们重新来看一下 VirtualWallet 类的实现代码。\u003c/p\u003e","title":"设计模式之美 Part2"},{"content":"00 KISS 原则（Keep It Simple and Stupid），这个原则理解起来很简单，一看貌似就懂了，那我问你，怎样的代码才算是足够简单呢？怎样才算不够简单需要优化呢？\n“Talk is cheap, show me the code.”\n01 为什么要学习设计模式：应对面试中的设计模式相关问题；告别写被人吐槽的烂代码；提高复杂代码的设计和开发能力；让读源码、学框架事半功倍；为你的职场发展做铺垫。\n02 灵活性（flexibility）、可扩展性（extensibility）、可维护性（maintainability）、可读性（readability）、可理解性（understandability）、易修改性（changeability）、可复用（reusability）、可测试性（testability）、模块化（modularity）、高内聚低耦合（high cohesion loose coupling）、高效（high effciency）、高性能（highperformance）、安全性（security）、兼容性（compatibility）、易用性（usability）、整洁（clean）、清晰（clarity）、简单（simple）、直接（straightforward）、少即是多（less code is more）、文档详尽（well-documented）、分层清晰（well-layered）、正确性（correctness、bug free）、健壮性（robustness）、鲁棒性（robustness）、可用性（reliability）、可伸缩性（scalability）、稳定性（stability）、优雅（elegant）、好（good）、坏（bad）\n我们并不能通过单一的维度去评价一段代码写的好坏。比如，即使一段代码的可扩展性很好，但可读性很差，那我们也不能说这段代码质量高。\n如果用数字来量化代码的可读性的话，它应该是一个连续的区间值，而非 0、1 这样的离散值。\n代码质量的评价有很强的主观性。\n有些词语过于笼统、抽象，比较偏向对于整体的描述，比如优雅、好、坏、整洁、清晰等；有些过于细节、偏重方法论，比如模块化、高内聚低耦合、文档详尽、分层清晰等；有些可能并不仅仅局限于编码，跟架构设计等也有关系，比如可伸缩性、可用性、稳定性等。\n可维护性（maintainability） 破坏原有代码设计、不引入新的 bug 的情况下，能够快速地修改或者添加代码。与之相反，修改或者添加代码需要冒着极大的引入新 bug 的风险，并且需要花费很长的时间才能完成。\n码分层清晰、模块化好、高内聚低耦合、遵从基于接口而非实现编程的设计原则等等，那就可能意味着代码易维护。\n可读性（readability） “任何傻瓜都会编写计算机能理解的代码。好的程序员能够编写人能够理解的代码。”\n是否符合编码规范、命名是否达意、注释是否详尽、函数是否长短合适、模块划分是否清晰、是否符合高内聚低耦合等等。\ncode review 是一个很好的测验代码可读性的手段。如果你的同事可以轻松地读懂你写的代码，那说明你的代码可读性很好；如果同事在读你的代码时，有很多疑问，那就说明你的代码可读性有待提高了。\n可扩展性（extensibility） 我们在不修改或少量修改原有代码的情况下，通过扩展的方式添加新的功能代码。说直白点就是，代码预留了一些功能扩展点，你可以把新功能代码，直接插到扩展点上，而不需要因为要添加一个功能而大动干戈，改动大量的原始代码。\n“对修改关闭，对扩展开放”。\n灵活性（flexibility） 如果一段代码易扩展、易复用或者易用，我们都可以称这段代码写得比较灵活。\n当我们添加一个新的功能代码的时候，原有的代码已经预留好了扩展点，我们不需要修改原有的代码，只要在扩展点上添加新的代码即可。这个时候，我们除了可以说代码易扩展，还可以说代码写得好灵活。 当我们要实现一个功能的时候，发现原有代码中，已经抽象出了很多底层可以复用的模块、类等代码，我们可以拿来直接使用。这个时候，我们除了可以说代码易复用之外，还可以说代码写得好灵活。 当我们使用某组接口的时候，如果这组接口可以应对各种使用场景，满足各种不同的需求，我们除了可以说接口易用之外，还可以说这个接口设计得好灵活或者代码写得好灵活。 简洁性（simplicity） 尽量保持代码简单。代码简单、逻辑清晰，也就意味着易读、易维护。我们在编写代码的时候，往往也会把简单、清晰放到首位。\nKISS 原则，思从深而行从简，真正的高手能云淡风轻地用最简单的方法解决最复杂的问题。这也是一个编程老手跟编程新手的本质区别之一。\n可复用性（reusability） 尽量减少重复代码的编写，复用已有的代码。\n当讲到面向对象特性的时候，我们会讲到继承、多态存在的目的之一，就是为了提高代码的可复用性；当讲到设计原则的时候，我们会讲到单一职责原则也跟代码的可复用性相关；当讲到重构技巧的时候，我们会讲到解耦、高内聚、模块化等都能提高代码的可复用性。可见，可复用性也是一个非常重要的代码评价标准，是很多设计原则、思想、模式等所要达到的最终效果。\nDRY（Don’t Repeat Yourself）设计原则。\n可测试性（testability） 代码可测试性的好坏，能从侧面上非常准确地反应代码质量的好坏。代码的可测试性差，比较难写单元测试，那基本上就能说明代码设计得有问题。\n03 面向对象 面向对象的四大特性：封装、抽象、继承、多态面 向对象编程与面向过程编程的区别和联系 面向对象分析、面向对象设计、面向对象编程 接口和抽象类的区别以及各自的应用场景 基于接口而非实现编程的设计思想 多用组合少用继承的设计思想 面向过程的贫血模型和面向对象的充血模型 设计原则 指导我们代码设计的一些经验总结。\nSOLID 原则 SRP 单一职责原则 SOLID 原则 OCP 开闭原则 SOLID 原则 SP 里式替换原则 SOLID 原则 ISP 接口隔离原则 SOLID 原则 DIP 依赖倒置原则 DRY 原则、KISS 原则、YAGNI 原则、LOD 法则 设计模式 针对软件开发中经常遇到的一些设计问题，总结出来的一套解决方案或者设计思路。\n大部分设计模式要解决的都是代码的可扩展性问题。\n创建型 常用的有：单例模式、工厂模式（工厂方法和抽象工厂）、建造者模式。不常用的有：原型模式。 结构型 常用的有：代理模式、桥接模式、装饰者模式、适配器模式。不常用的有：门面模式、组合模式、享元模式。 行为型 常用的有：观察者模式、模板模式、策略模式、职责链模式、迭代器模式、状态模式。不常用的有：访问者模式、备忘录模式、命令模式、解释器模式、中介模式。 编程规范 主要解决的是代码的可读性问题。\n代码重构 在软件开发中，只要软件在不停地迭代，就没有一劳永逸的设计。\n在开发初期，除非特别必须，我们一定不要过度设计，应用复杂的设计模式。而是当代码出现问题的时候，我们再针对问题，应用原则和模式进行重构。这样就能有效避免前期的过度设计。\n重构的目的（why）、对象（what）、时机（when）、方法（how）； 保证重构不出错的技术手段：单元测试和代码的可测试性； 两种不同规模的重构：大重构（大规模高层次）和小重构（小规模低层次）。 五者联系 面向对象编程因为其具有丰富的特性（封装、抽象、继承、多态），可以实现很多复杂的设计思路，是很多设计原则、设计模式等编码实现的基础。\n设计原则是指导我们代码设计的一些经验总结，对于某些场景下，是否应该应用某种设计模式，具有指导意义。比如，“开闭原则”是很多设计模式（策略、模板等）的指导原则。\n设计模式是针对软件开发中经常遇到的一些设计问题，总结出来的一套解决方案或者设计思路。应用设计模式的主要目的是提高代码的可扩展性。从抽象程度上来讲，设计原则比设计模式更抽象。设计模式更加具体、更加可执行。\n编程规范主要解决的是代码的可读性问题。编码规范相对于设计原则、设计模式，更加具体、更加偏重代码细节、更加能落地。持续的小重构依赖的理论基础主要就是编程规范。\n重构作为保持代码质量不下降的有效手段，利用的就是面向对象、设计原则、设计模式、编码规范这些理论。\n04 面向对象编程是一种编程范式或编程风格。它以类或对象作为组织代码的基本单元，并将封装、抽象、继承、多态四个特性，作为代码设计和实现的基石。\n05 封装（Encapsulation） 封装也叫作信息隐藏或者数据访问保护。类通过暴露有限的访问接口，授权外部仅能通过类提供的方式来访问内部信息或者数据。\n封装特性存在的意义，一方面是保护数据不被随意修改，提高代码的可维护性；另一方面是仅暴露有限的必要接口，提高类的易用性。\n抽象（Abstraction） 抽象可以通过接口类或者抽象类来实现，但也并不需要特殊的语法机制来支持。\n抽象存在的意义，一方面是提高代码的可扩展性、维护性，修改实现不需要改变定义，减少代码的改动范围；另一方面，它也是处理复杂系统的有效手段，能有效地过滤掉不必要关注的信息。\n提供“函数”这一非常基础的语法机制，就可以实现抽象特性、所以，它没有很强的“特异性”，有时候并不被看作面向对象编程的特性之一。\n在定义（或者叫命名）类的方法的时候，也要有抽象思维，不要在方法定义中，暴露太多的实现细节，以保证在某个时间点需要改变方法的实现逻辑的时候，不用去修改其定义。getPictureUrl 好于 getAliyunPictureUrl。\n继承（Inheritance） 继承是用来表示类之间的 is-a 关系。继承主要是用来解决代码复用的问题。\n多用组合少用继承。\n多态（Polymorphism） 多态是指子类可以替换父类，在实际的代码运行过程中，调用子类的方法实现。\n多态这种特性也需要编程语言提供特殊的语法机制来实现，比如继承、接口类、duck-typing。多态可以提高代码的扩展性和复用性，是很多设计模式、设计原则、编程技巧的代码实现基础。\n只要两个类具有相同的方法，就可以实现多态，并不要求两个类之间有任何关系，这就是所谓的 duck-typing，是一些动态语言所特有的语法机制。\n06 相较于面向对象编程以类为组织代码的基本单元，面向过程编程则是以过程（或方法）作为组织代码的基本单元。它最主要的特点就是数据和方法相分离。相较于面向对象编程语言，面向过程编程语言最大的特点就是不支持丰富的面向对象编程特性，比如继承、多态、封装。\n面向对象编程相比面向过程编程有哪些优势？\n对于大规模复杂程序的开发，程序的处理流程并非单一的一条主线，而是错综复杂的网状结构。 面向对象编程比起面向过程编程，更能应对这种复杂类型的程序开发。面向对象编程相比面向过程编程，具有更加丰富的特性（封装、抽象、继承、多态）。利用这些特性编写出来的代码，更加易扩展、易复用、易维护。 从编程语言跟机器打交道的方式的演进规律中，我们可以总结出：面向对象编程语言比起面向过程编程语言，更加人性化、更加高级、更加智能。 07 滥用 getter、setter 方法 尽管 getter 方法相对 setter 方法要安全些，但是如果返回的是集合容器（比如例子中的 List 容器），也要防范集合内部数据被修改的危险。\npublic class ShoppingCart { // ... 省略其他代码... public List\u0026lt;ShoppingCartItem\u0026gt; getItems() { return Collections.unmodifiableList(this.items); } } public class UnmodifiableList\u0026lt;E\u0026gt; extends UnmodifiableCollection\u0026lt;E\u0026gt; implements List\u0026lt;E\u0026gt; { public boolean add(E e) { throw new UnsupportedOperationException(); } public void clear() { throw new UnsupportedOperationException(); } // ... 省略其他代码... } 滥用全局变量和全局方法 Constants 类、Utils 类的设计尽量能做到职责单一，定义一些细化的小类。\n静态成员变量归属于类上的数据，被所有的实例化对象所共享，也相当于一定程度上的全局变量。\n静态方法将方法与数据分离，破坏了封装特性，是典型的面向过程风格。\n只包含静态方法不包含任何属性的 Utils 类，是彻彻底底的面向过程的编程风格。要尽量避免滥用，不要不加思考地随意去定义 Utils 类。\n定义数据和方法分离的类 Controller 层负责暴露接口给前端调用，Service 层负责核心业务逻辑，Repository 层负责数据读写。\n而在每一层中，我们又会定义相应的 VO（View Object）、BO（Business Object）、Entity。一般情况下，VO、BO、Entity 中只会定义数据，不会定义方法，所有操作这些数据的业务逻辑都定义在对应的 Controller 类、Service 类、Repository 类中。这就是典型的面向过程的编程风格。\n实际上，这种开发模式叫作基于 贫血模型的开发模式，也是我们现在非常常用的一种 Web 项目的开发模式。看到这里，你内心里应该有很多疑惑吧？既然这种开发模式明显违背面向对象的编程风格，为什么大部分 Web 项目都是基于这种开发模式来开发呢？\n在面向对象编程中，为什么容易写出面向过程风格的代码？ 面向过程编程风格恰恰符合人的这种流程化思维方式。而面向对象编程风格正好相反。它是一种自底向上的思考方式。\n它不是先去按照执行流程来分解任务，而是将任务翻译成一个一个的小的模块（也就是类），设计类之间的交互，最后按照流程将类组装起来，完成整个任务。\n在面向对象编程中，类的设计还是挺需要技巧，挺需要一定设计经验的。你要去思考如何封装合适的数据和方法到一个类里，如何设计类之间的关系，如何设计类之间的交互等等诸多设计问题。\n面向过程编程及面向过程编程语言就真的无用武之地了吗？ 如果我们开发的是微小程序，或者是一个数据处理相关的代码，以算法为主，数据为辅，那脚本式的面向过程的编程风格就更适合一些。\n08 抽象类和接口的语法特性 抽象类不允许被实例化，只能被继承。它可以包含属性和方法。方法既可以包含代码实现，也可以不包含代码实现。不包含代码实现的方法叫作抽象方法。子类继承抽象类，必须实现抽象类中的所有抽象方法。接口不能包含属性，只能声明方法，方法不能包含代码实现。类实现接口的时候，必须实现接口中声明的所有方法。\n抽象类和接口存在的意义 抽象类是对成员变量和方法的抽象，是一种 is-a 关系，是为了解决代码复用问题。接口仅仅是对方法的抽象，是一种 has-a 关系，表示具有某一组行为特性，是为了解决解耦问题，隔离接口和具体的实现，提高代码的扩展性。\n从类的继承层次上来看，抽象类是一种自下而上的设计思路，先有子类的代码重复，然后再抽象成上层的父类（也就是抽象类）。而接口正好相反，它是一种自上而下的设计思路。\n09 “Program to an interface, not animplementation”。“基于抽象而非实现编程”。\n越抽象、越顶层、越脱离具体某一实现的设计，越能提高代码的灵活性，越能应对未来的需求变化。好的代码设计，不仅能应对当下的需求，而且在将来需求发生变化的时候，仍然能够在不破坏原有代码设计的情况下灵活应对。\n“细节是魔鬼”。\n函数的命名不能暴露任何实现细节。 封装具体的实现细节。 为实现类定义抽象的接口。 抽象意识、封装意识、接口意识。\n10 继承层次过深、过复杂，也会影响到代码的可维护性。\n鸟 -\u0026gt; 会飞、不会飞、会叫、不会叫、会下蛋、不会下蛋。\n利用组合（composition）、接口、委托（delegation 解决。\n// 接口 public interface Flyable { void fly(); } // 提高复用性 public class FlyAbility implements Flyable { @Override public void fly() { //... } } public class Sparrow implements Flyable { // 组合 private FlyAbility flyAbility = new FlyAbility(); @Override public void fly() { // 委托 flyAbility.fly(); } } 继承改写成组合意味着要做更细粒度的类的拆分。这也就意味着，我们要定义更多的类和接口。类和接口的增多也就或多或少地增加代码的复杂程度和维护成本。\n组合并不完美，继承也不是一无是处。\n如果类之间的继承结构稳定，层次比较浅，关系不复杂，我们就可以大胆地使用继承。反之，我们就尽量使用组合来替代继承。除此之外，还有一些设计模式、特殊的应用场景，会固定使用继承（模板模式（template pattern））或者组合（装饰者模式（decoratorpattern）、策略模式（strategy pattern）、组合模式（composite pattern））。\n\u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2021/02/05/the-beauty-of-design-patterns-part1/","summary":"\u003ch2 id=\"00\"\u003e00\u003c/h2\u003e\n\u003cp\u003eKISS 原则（Keep It Simple and Stupid），这个原则理解起来很简单，一看貌似就懂了，那我问你，怎样的代码才算是足够简单呢？怎样才算不够简单需要优化呢？\u003c/p\u003e\n\u003cp\u003e“Talk is cheap, show me the code.”\u003c/p\u003e\n\u003ch2 id=\"01\"\u003e01\u003c/h2\u003e\n\u003cp\u003e为什么要学习设计模式：应对面试中的设计模式相关问题；告别写被人吐槽的烂代码；提高复杂代码的设计和开发能力；让读源码、学框架事半功倍；为你的职场发展做铺垫。\u003c/p\u003e\n\u003ch2 id=\"02\"\u003e02\u003c/h2\u003e\n\u003cp\u003e灵活性（flexibility）、可扩展性（extensibility）、可维护性（maintainability）、可读性（readability）、可理解性（understandability）、易修改性（changeability）、可复用（reusability）、可测试性（testability）、模块化（modularity）、高内聚低耦合（high cohesion loose coupling）、高效（high effciency）、高性能（highperformance）、安全性（security）、兼容性（compatibility）、易用性（usability）、整洁（clean）、清晰（clarity）、简单（simple）、直接（straightforward）、少即是多（less code is more）、文档详尽（well-documented）、分层清晰（well-layered）、正确性（correctness、bug free）、健壮性（robustness）、鲁棒性（robustness）、可用性（reliability）、可伸缩性（scalability）、稳定性（stability）、优雅（elegant）、好（good）、坏（bad）\u003c/p\u003e\n\u003cp\u003e我们并不能通过单一的维度去评价一段代码写的好坏。比如，即使一段代码的可扩展性很好，但可读性很差，那我们也不能说这段代码质量高。\u003c/p\u003e\n\u003cp\u003e如果用数字来量化代码的可读性的话，它应该是一个连续的区间值，而非 0、1 这样的离散值。\u003c/p\u003e\n\u003cp\u003e代码质量的评价有很强的主观性。\u003c/p\u003e\n\u003cp\u003e有些词语过于笼统、抽象，比较偏向对于整体的描述，比如优雅、好、坏、整洁、清晰等；有些过于细节、偏重方法论，比如模块化、高内聚低耦合、文档详尽、分层清晰等；有些可能并不仅仅局限于编码，跟架构设计等也有关系，比如可伸缩性、可用性、稳定性等。\u003c/p\u003e\n\u003ch3 id=\"可维护性maintainability\"\u003e可维护性（maintainability）\u003c/h3\u003e\n\u003cp\u003e破坏原有代码设计、不引入新的 bug 的情况下，能够快速地修改或者添加代码。与之相反，修改或者添加代码需要冒着极大的引入新 bug 的风险，并且需要花费很长的时间才能完成。\u003c/p\u003e\n\u003cp\u003e码分层清晰、模块化好、高内聚低耦合、遵从基于接口而非实现编程的设计原则等等，那就可能意味着代码易维护。\u003c/p\u003e\n\u003ch3 id=\"可读性readability\"\u003e可读性（readability）\u003c/h3\u003e\n\u003cp\u003e“任何傻瓜都会编写计算机能理解的代码。好的程序员能够编写人能够理解的代码。”\u003c/p\u003e\n\u003cp\u003e是否符合编码规范、命名是否达意、注释是否详尽、函数是否长短合适、模块划分是否清晰、是否符合高内聚低耦合等等。\u003c/p\u003e\n\u003cp\u003ecode review 是一个很好的测验代码可读性的手段。如果你的同事可以轻松地读懂你写的代码，那说明你的代码可读性很好；如果同事在读你的代码时，有很多疑问，那就说明你的代码可读性有待提高了。\u003c/p\u003e\n\u003ch3 id=\"可扩展性extensibility\"\u003e可扩展性（extensibility）\u003c/h3\u003e\n\u003cp\u003e我们在不修改或少量修改原有代码的情况下，通过扩展的方式添加新的功能代码。说直白点就是，代码预留了一些功能扩展点，你可以把新功能代码，直接插到扩展点上，而不需要因为要添加一个功能而大动干戈，改动大量的原始代码。\u003c/p\u003e\n\u003cp\u003e“对修改关闭，对扩展开放”。\u003c/p\u003e\n\u003ch3 id=\"灵活性flexibility\"\u003e灵活性（flexibility）\u003c/h3\u003e\n\u003cp\u003e如果一段代码易扩展、易复用或者易用，我们都可以称这段代码写得比较灵活。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e当我们添加一个新的功能代码的时候，原有的代码已经预留好了扩展点，我们不需要修改原有的代码，只要在扩展点上添加新的代码即可。这个时候，我们除了可以说代码易扩展，还可以说代码写得好灵活。\u003c/li\u003e\n\u003cli\u003e当我们要实现一个功能的时候，发现原有代码中，已经抽象出了很多底层可以复用的模块、类等代码，我们可以拿来直接使用。这个时候，我们除了可以说代码易复用之外，还可以说代码写得好灵活。\u003c/li\u003e\n\u003cli\u003e当我们使用某组接口的时候，如果这组接口可以应对各种使用场景，满足各种不同的需求，我们除了可以说接口易用之外，还可以说这个接口设计得好灵活或者代码写得好灵活。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"简洁性simplicity\"\u003e简洁性（simplicity）\u003c/h3\u003e\n\u003cp\u003e尽量保持代码简单。代码简单、逻辑清晰，也就意味着易读、易维护。我们在编写代码的时候，往往也会把简单、清晰放到首位。\u003c/p\u003e\n\u003cp\u003eKISS 原则，思从深而行从简，真正的高手能云淡风轻地用最简单的方法解决最复杂的问题。这也是一个编程老手跟编程新手的本质区别之一。\u003c/p\u003e\n\u003ch3 id=\"可复用性reusability\"\u003e可复用性（reusability）\u003c/h3\u003e\n\u003cp\u003e尽量减少重复代码的编写，复用已有的代码。\u003c/p\u003e\n\u003cp\u003e当讲到面向对象特性的时候，我们会讲到继承、多态存在的目的之一，就是为了提高代码的可复用性；当讲到设计原则的时候，我们会讲到单一职责原则也跟代码的可复用性相关；当讲到重构技巧的时候，我们会讲到解耦、高内聚、模块化等都能提高代码的可复用性。可见，可复用性也是一个非常重要的代码评价标准，是很多设计原则、思想、模式等所要达到的最终效果。\u003c/p\u003e\n\u003cp\u003eDRY（Don’t Repeat Yourself）设计原则。\u003c/p\u003e\n\u003ch3 id=\"可测试性testability\"\u003e可测试性（testability）\u003c/h3\u003e\n\u003cp\u003e代码可测试性的好坏，能从侧面上非常准确地反应代码质量的好坏。代码的可测试性差，比较难写单元测试，那基本上就能说明代码设计得有问题。\u003c/p\u003e\n\u003ch2 id=\"03\"\u003e03\u003c/h2\u003e\n\u003ch3 id=\"面向对象\"\u003e面向对象\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e面向对象的四大特性：封装、抽象、继承、多态面\u003c/li\u003e\n\u003cli\u003e向对象编程与面向过程编程的区别和联系\u003c/li\u003e\n\u003cli\u003e面向对象分析、面向对象设计、面向对象编程\u003c/li\u003e\n\u003cli\u003e接口和抽象类的区别以及各自的应用场景\u003c/li\u003e\n\u003cli\u003e基于接口而非实现编程的设计思想\u003c/li\u003e\n\u003cli\u003e多用组合少用继承的设计思想\u003c/li\u003e\n\u003cli\u003e面向过程的贫血模型和面向对象的充血模型\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"设计原则\"\u003e设计原则\u003c/h3\u003e\n\u003cp\u003e指导我们代码设计的一些经验总结。\u003c/p\u003e","title":"设计模式之美 Part1"},{"content":"Tips SQL -- 追踪优化器 Trace 功能 -- optimizer_trace_enabled=1 -- optimizer_trace_file=optimizer_trace.log SELECT @@optimizer_trace; SET optimizer_trace = \u0026#39;enabled=on\u0026#39;; -- \u0026lt;your query\u0026gt;; SET optimizer_trace = \u0026#39;enabled=off\u0026#39;; select * from INFORMATION_SCHEMA.OPTIMIZER_TRACE; -- 查看优化后的 SQL -- 在联表查询时比较有效果 EXPLAIN \u0026lt;你的 SQL\u0026gt;; SHOW WARNINGS; -- 查看处理 SHOW PROCESSLIST; -- 查看结构 DESC user; SHOW COLUMNS FROM user; DESCRIBE user; 视图更新 CREATE OR REPLACE VIEW 视图名 AS SELECT[...] FROM [...] 字符集转换 LEFT JOIN code_value b ON a.cost_type = CONVERT ( b.`code` USING utf8mb4 ) COLLATE utf8mb4_unicode_ci Function -- https://www.w3schools.com/sql/func_mysql_find_in_set.asp select FIND_IN_SET(\u0026#39;bb\u0026#39;, \u0026#39;aa,bb,cc\u0026#39;); select FIND_IN_SET(null, \u0026#39;0\u0026#39;); -- COALESCE 函数用于返回参数列表中第一个非 NULL 值。如果所有参数都为 NULL，则返回 NULL COALESCE ( `code_value`.`name`, \u0026#39;\u0026#39; ) AS cost_type_name, ON vs USING MySQL ON vs USING? | stackoverflow\n删除重复数据 DELETE FROM student WHERE id NOT IN ( SELECT id FROM ( SELECT MIN( id ) AS id FROM student GROUP BY `name` ) tmp) 要多加一层 tmp 包装，否则会遇到：1093 - You can't specify target table 'student' for update in FROM clause\n备份表 -- 创建同结构备份表 create table zzz_my_table_220727 like my_table; -- 将需要数据写入备份表 insert into zzz_my_table_220727 select * from my_table ORDER BY id desc LIMIT 1000; -- 情况原表 truncate table my_table; SQL AND OR 执行优先级 select id from table01 where condition1 or condition2 and condition3; -- 等价于： select id from table01 where condition1 or (condition2 and condition3); -- 而非： select id from table01 where (condition1 or condition2) and condition3; and 级别高于 or。相当于可以把 and 看成 乘号 *，把 or 看成 加号 +。\n事务 //对读取的记录加共享锁 select ... lock in share mode; -- //对读取的记录加独占锁 select ... for update; References 编程小技巧（3）：查看优化后的 SQL \u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2021/01/29/mysql-code-snippet/","summary":"\u003ch2 id=\"tips-sql\"\u003eTips SQL\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sql\" data-lang=\"sql\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e-- 追踪优化器 Trace 功能\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e--  optimizer_trace_enabled=1\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e--  optimizer_trace_file=optimizer_trace.log\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003eSELECT\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e@@\u003c/span\u003e\u003cspan class=\"n\"\u003eoptimizer_trace\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003eSET\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eoptimizer_trace\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;enabled=on\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"c1\"\u003e-- \u0026lt;your query\u0026gt;;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003eSET\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eoptimizer_trace\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;enabled=off\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003eselect\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003efrom\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eINFORMATION_SCHEMA\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eOPTIMIZER_TRACE\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"c1\"\u003e-- 查看优化后的 SQL\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e-- 在联表查询时比较有效果\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003eEXPLAIN\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"err\"\u003e你的\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eSQL\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003eSHOW\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eWARNINGS\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"c1\"\u003e-- 查看处理\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003eSHOW\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ePROCESSLIST\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"c1\"\u003e-- 查看结构\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003eDESC\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003euser\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003eSHOW\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eCOLUMNS\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eFROM\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003euser\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003eDESCRIBE\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003euser\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"视图更新\"\u003e视图更新\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sql\" data-lang=\"sql\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eCREATE\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eOR\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eREPLACE\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eVIEW\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"err\"\u003e视图名\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eAS\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eSELECT\u003c/span\u003e\u003cspan class=\"p\"\u003e[...]\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eFROM\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e[...]\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"字符集转换\"\u003e字符集转换\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sql\" data-lang=\"sql\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eLEFT\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eJOIN\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ecode_value\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eb\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eON\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ea\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecost_type\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eCONVERT\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eb\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"n\"\u003ecode\u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eUSING\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eutf8mb4\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eCOLLATE\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eutf8mb4_unicode_ci\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"function\"\u003eFunction\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sql\" data-lang=\"sql\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e-- https://www.w3schools.com/sql/func_mysql_find_in_set.asp\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003eselect\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eFIND_IN_SET\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;bb\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;aa,bb,cc\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003eselect\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eFIND_IN_SET\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;0\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"c1\"\u003e-- COALESCE 函数用于返回参数列表中第一个非 NULL 值。如果所有参数都为 NULL，则返回 NULL\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"n\"\u003eCOALESCE\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"n\"\u003ecode_value\u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"n\"\u003ename\u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eAS\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ecost_type_name\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"on-vs-using\"\u003eON vs USING\u003c/h2\u003e\n\u003cp\u003e\u003ca href=\"https://stackoverflow.com/questions/11366006/mysql-on-vs-using\"\u003eMySQL ON vs USING? | stackoverflow\u003c/a\u003e\u003c/p\u003e","title":"MySQL Code Snippet"},{"content":"看现象 var_dump(date(\u0026#34;Y-m-d\u0026#34;, strtotime(\u0026#34;+1 month\u0026#34;, strtotime(\u0026#34;2020-07-31\u0026#34;)))); // string(10) \u0026#34;2020-08-31\u0026#34; 符合预期 var_dump(date(\u0026#34;Y-m-d\u0026#34;, strtotime(\u0026#34;+1 month\u0026#34;, strtotime(\u0026#34;2020-05-31\u0026#34;)))); // string(10) \u0026#34;2020-07-01\u0026#34; 不符合预期，预期 2020-06-30 var_dump(date(\u0026#34;Y-m-d\u0026#34;, strtotime(\u0026#34;-1 month\u0026#34;, strtotime(\u0026#34;2020-02-29\u0026#34;)))); // string(10) \u0026#34;2020-01-29\u0026#34; 符合预期 var_dump(date(\u0026#34;Y-m-d\u0026#34;, strtotime(\u0026#34;-1 month\u0026#34;, strtotime(\u0026#34;2020-03-31\u0026#34;)))); // string(10) \u0026#34;2020-03-02\u0026#34; 不符合预期，预期 2020-02-29 // Carbon\\Carbon Carbon::parse(\u0026#34;2020-07-31\u0026#34;)-\u0026gt;addMonth()-\u0026gt;toDateString(); // \u0026#34;2020-08-31\u0026#34; Carbon::parse(\u0026#34;2020-05-31\u0026#34;)-\u0026gt;addMonth()-\u0026gt;toDateString(); // \u0026#34;2020-07-01\u0026#34; Carbon::parse(\u0026#34;2020-02-29\u0026#34;)-\u0026gt;subMonth()-\u0026gt;toDateString(); // \u0026#34;2020-01-29\u0026#34; Carbon::parse(\u0026#34;2020-03-31\u0026#34;)-\u0026gt;subMonth()-\u0026gt;toDateString(); // \u0026#34;2020-03-02\u0026#34; // 结果与 strtotime 一致。 原因 var_dump(date(\u0026#34;Y-m-d\u0026#34;, strtotime(\u0026#34;+1 month\u0026#34;, strtotime(\u0026#34;2020-05-31\u0026#34;)))); // string(10) \u0026#34;2020-07-01\u0026#34; date 内部的处理逻辑：\n2020-05-31 做 +1 month 也就是 2020-06-31。 再做日期规范化，因为没有 06-31，所以 06-31 就等于了 07-01。 var_dump(date(\u0026#34;Y-m-d\u0026#34;, strtotime(\u0026#34;2020-06-31\u0026#34;))); // string(10) \u0026#34;2017-07-01\u0026#34; var_dump(date(\u0026#34;Y-m-d\u0026#34;, strtotime(\u0026#34;next month\u0026#34;, strtotime(\u0026#34;2017-01-31\u0026#34;)))); // string(10) \u0026#34;2017-03-03\u0026#34; var_dump(date(\u0026#34;Y-m-d\u0026#34;, strtotime(\u0026#34;last month\u0026#34;, strtotime(\u0026#34;2017-03-31\u0026#34;)))); // string(10) \u0026#34;2017-03-03\u0026#34; 解决方案 var_dump(date(\u0026#34;Y-m-d\u0026#34;, strtotime(\u0026#34;last day of -1 month\u0026#34;, strtotime(\u0026#34;2017-03-31\u0026#34;)))); // string(10) \u0026#34;2017-02-28\u0026#34; var_dump(date(\u0026#34;Y-m-d\u0026#34;, strtotime(\u0026#34;first day of +1 month\u0026#34;, strtotime(\u0026#34;2017-08-31\u0026#34;)))); // string(10) \u0026#34;2017-09-01\u0026#34; // 但要注意短语的含义： var_dump(date(\u0026#34;Y-m-d\u0026#34;, strtotime(\u0026#34;last day of -1 month\u0026#34;, strtotime(\u0026#34;2017-03-01\u0026#34;)))); // string(10) \u0026#34;2017-02-28\u0026#34; 如果使用 Carbon\\Carbon 可以用 subMonthNoOverflow 与 addMonthNoOverflow 防止进位：\nCarbon::parse(\u0026#39;2020-03-31\u0026#39;)-\u0026gt;subMonthNoOverflow()-\u0026gt;toDateString(); // \u0026#34;2020-02-29\u0026#34; Carbon::parse(\u0026#34;2020-05-31\u0026#34;)-\u0026gt;addMonthNoOverflow()-\u0026gt;toDateString(); // \u0026#34;2020-06-30\u0026#34; Ym 类似问题 在当日是 31 号场景下：\nCarbon::createFromFormat(\u0026#39;Ym\u0026#39;, \u0026#39;202206\u0026#39;)-\u0026gt;format(\u0026#39;Y-m\u0026#39;); // 结果是 2022-07 不符合本意 DateTimeImmutable::createFromFormat | php ! Resets all fields (year, month, day, hour, minute, second, fraction and timezone information) to zero-like values ( 0 for hour, minute, second and fraction, 1 for month and day, 1970 for year and UTC for timezone information)\nWithout !, all fields will be set to the current date and time.\n如果 format 包含字符 !，则未在 format 中提供的生成日期/时间部分以及 ! 左侧的值将设置为 Unix 纪元的相应值。\nThe Unix epoch is 1970-01-01 00:00:00 UTC.\nCarbon::createFromFormat(\u0026#39;!Ym\u0026#39;, \u0026#39;202206\u0026#39;)-\u0026gt;format(\u0026#39;Y-m\u0026#39;); // 结果是 2022-06 Carbon::createFromFormat(\u0026#39;Ym|\u0026#39;, \u0026#39;202206\u0026#39;)-\u0026gt;format(\u0026#39;Y-m\u0026#39;); // 结果是 2022-06 $format = \u0026#39;Y-m-!d H:i:s\u0026#39;; $date = DateTimeImmutable::createFromFormat($format, \u0026#39;2009-02-15 15:16:17\u0026#39;); echo \u0026#34;Format: $format; \u0026#34; . $date-\u0026gt;format(\u0026#39;Y-m-d H:i:s\u0026#39;) . \u0026#34;\\n\u0026#34;; // Format: Y-m-!d H:i:s; 1970-01-15 15:16:17 References Why does subMonth not work correctly? | github 令人困惑的 strtotime | laruence \u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2021/01/27/php-strtotime-month/","summary":"\u003ch2 id=\"看现象\"\u003e看现象\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003edate\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;Y-m-d\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003estrtotime\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;+1 month\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003estrtotime\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;2020-07-31\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e))));\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// string(10) \u0026#34;2020-08-31\u0026#34; 符合预期\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003edate\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;Y-m-d\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003estrtotime\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;+1 month\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003estrtotime\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;2020-05-31\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e))));\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// string(10) \u0026#34;2020-07-01\u0026#34; 不符合预期，预期 2020-06-30\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003edate\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;Y-m-d\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003estrtotime\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;-1 month\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003estrtotime\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;2020-02-29\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e))));\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// string(10) \u0026#34;2020-01-29\u0026#34; 符合预期\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003edate\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;Y-m-d\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003estrtotime\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;-1 month\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003estrtotime\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;2020-03-31\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e))));\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// string(10) \u0026#34;2020-03-02\u0026#34; 不符合预期，预期 2020-02-29\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Carbon\\Carbon\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nx\"\u003eCarbon\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"na\"\u003eparse\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;2020-07-31\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"na\"\u003eaddMonth\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"na\"\u003etoDateString\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// \u0026#34;2020-08-31\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nx\"\u003eCarbon\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"na\"\u003eparse\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;2020-05-31\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"na\"\u003eaddMonth\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"na\"\u003etoDateString\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// \u0026#34;2020-07-01\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nx\"\u003eCarbon\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"na\"\u003eparse\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;2020-02-29\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"na\"\u003esubMonth\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"na\"\u003etoDateString\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// \u0026#34;2020-01-29\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nx\"\u003eCarbon\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"na\"\u003eparse\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;2020-03-31\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"na\"\u003esubMonth\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"na\"\u003etoDateString\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// \u0026#34;2020-03-02\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 结果与 strtotime 一致。\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"原因\"\u003e原因\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003edate\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;Y-m-d\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003estrtotime\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;+1 month\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003estrtotime\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;2020-05-31\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e))));\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// string(10) \u0026#34;2020-07-01\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003edate 内部的处理逻辑：\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\u003ccode\u003e2020-05-31\u003c/code\u003e 做 \u003ccode\u003e+1 month\u003c/code\u003e 也就是 \u003ccode\u003e2020-06-31\u003c/code\u003e。\u003c/li\u003e\n\u003cli\u003e再做日期规范化，因为没有 \u003ccode\u003e06-31\u003c/code\u003e，所以 \u003ccode\u003e06-31\u003c/code\u003e 就等于了 \u003ccode\u003e07-01\u003c/code\u003e。\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003edate\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;Y-m-d\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003estrtotime\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;2020-06-31\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e)));\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// string(10) \u0026#34;2017-07-01\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003edate\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;Y-m-d\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003estrtotime\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;next month\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003estrtotime\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;2017-01-31\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e))));\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// string(10) \u0026#34;2017-03-03\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003edate\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;Y-m-d\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003estrtotime\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;last month\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003estrtotime\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;2017-03-31\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e))));\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// string(10) \u0026#34;2017-03-03\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"解决方案\"\u003e解决方案\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003edate\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;Y-m-d\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003estrtotime\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;last day of -1 month\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003estrtotime\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;2017-03-31\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e))));\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// string(10) \u0026#34;2017-02-28\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003edate\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;Y-m-d\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003estrtotime\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;first day of +1 month\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003estrtotime\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;2017-08-31\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e))));\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// string(10) \u0026#34;2017-09-01\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 但要注意短语的含义：\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003edate\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;Y-m-d\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003estrtotime\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;last day of -1 month\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003estrtotime\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;2017-03-01\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e))));\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// string(10) \u0026#34;2017-02-28\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e如果使用 \u003ccode\u003eCarbon\\Carbon\u003c/code\u003e 可以用 \u003ccode\u003esubMonthNoOverflow\u003c/code\u003e 与 \u003ccode\u003eaddMonthNoOverflow\u003c/code\u003e 防止进位：\u003c/p\u003e","title":"PHP 月份加减问题"},{"content":"2025-02-15：已告别 Yii2，文章内容不再维护。\ngii CLI php yii help gii/mode php yii gii/model --generateLabelsFromComments=1 --overwrite=1 --standardizeCapitals=1 --ns=\u0026#39;app\\models\\gii\u0026#39; --tableName=\u0026#34;*\u0026#34; # 多数据库 php yii gii/model --generateLabelsFromComments=1 --overwrite=1 --standardizeCapitals=1 --db=\u0026#34;hub_db\u0026#34; --ns=\u0026#39;app\\models\\hub\\gii\u0026#39; --tableName=\u0026#34;*\u0026#34; 连接数据库时设置时区 \u0026#39;class\u0026#39; =\u0026gt; \u0026#39;yii\\db\\Connection\u0026#39;, \u0026#39;dsn\u0026#39; =\u0026gt; \u0026#39;mysql:host=mysql;port=3306;dbname=hub\u0026#39;, \u0026#39;username\u0026#39; =\u0026gt; \u0026#39;root\u0026#39;, \u0026#39;password\u0026#39; =\u0026gt; \u0026#39;root\u0026#39;, \u0026#39;charset\u0026#39; =\u0026gt; \u0026#39;utf8\u0026#39;, // 关闭日志记录，防止被 logs 平台拿走 \u0026#39;enableLogging\u0026#39; =\u0026gt; YII_DEBUG ? true : false, \u0026#39;enableProfiling\u0026#39; =\u0026gt; YII_DEBUG ? true : false, // 设置时区 \u0026#39;on afterOpen\u0026#39; =\u0026gt; static function ($event) { // set \u0026#39;Asia/Bangkok\u0026#39; timezone $event-\u0026gt;sender-\u0026gt;createCommand(\u0026#34;SET time_zone=\u0026#39;+08:00\u0026#39;;\u0026#34;)-\u0026gt;execute(); }, ActiveRecord one yii\\db\\ActiveRecord::findOne() 和 yii\\db\\ActiveQuery::one() 都不会添加 LIMIT 1 到 生成的 SQL 语句中。如果你的查询会返回很多行的数据， 你明确的应该加上 limit(1) 来提高性能，比如 Customer::find()-\u0026gt;limit(1)-\u0026gt;one()。\nDB where 查询构建器 | yiiframework YII where 条件 | csdn\n字符串格式，例如：'status=1' 哈希格式，例如： ['status' =\u0026gt; 1, 'type' =\u0026gt; 2] 操作符格式，例如：['like', 'name', 'test'] 对象格式，例如：new LikeCondition('name', 'LIKE', 'test') 简单条件 // SQL: (type = 1) AND (status = 2). $cond = [\u0026#39;type\u0026#39; =\u0026gt; 1, \u0026#39;status\u0026#39; =\u0026gt; 2] // SQL: (id IN (1, 2, 3)) AND (status = 2) $cond = [\u0026#39;id\u0026#39; =\u0026gt; [1, 2, 3], \u0026#39;status\u0026#39; =\u0026gt; 2] // SQL: status IS NULL $cond = [\u0026#39;status\u0026#39; =\u0026gt; null] AND OR // SQL: `id=1 AND id=2` $cond = [\u0026#39;and\u0026#39;, \u0026#39;id=1\u0026#39;, \u0026#39;id=2\u0026#39;] // SQL: `type=1 AND (id=1 OR id=2)` $cond = [\u0026#39;and\u0026#39;, \u0026#39;type=1\u0026#39;, [\u0026#39;or\u0026#39;, \u0026#39;id=1\u0026#39;, \u0026#39;id=2\u0026#39;]] // SQL: `type=1 AND (id=1 OR id=2)` // 此写法 \u0026#39;=\u0026#39; 可以换成其他操作符，例：in like != \u0026gt;= 等 $cond = [ \u0026#39;and\u0026#39;, [\u0026#39;=\u0026#39;, \u0026#39;type\u0026#39;, 1], [ \u0026#39;or\u0026#39;, [\u0026#39;=\u0026#39;, \u0026#39;id\u0026#39;, \u0026#39;1\u0026#39;], [\u0026#39;=\u0026#39;, \u0026#39;id\u0026#39;, \u0026#39;2\u0026#39;], ] ] NOT // SQL: `NOT (attribute IS NULL)` $cond = [\u0026#39;not\u0026#39;, [\u0026#39;attribute\u0026#39; =\u0026gt; null]] BETWEEN // not between 用法相同 // SQL: `id BETWEEN 1 AND 10` $cond = [\u0026#39;between\u0026#39;, \u0026#39;id\u0026#39;, 1, 10] IN // not in 用法相同 // SQL: `id IN (1, 2, 3)` $cond = [\u0026#39;between\u0026#39;, \u0026#39;id\u0026#39;, 1, 10] $cond = [\u0026#39;id\u0026#39; =\u0026gt; [1, 2, 3]] // IN 条件也适用于多字段 // SQL: (`id`, `name`) IN ((1, \u0026#39;foo\u0026#39;), (2, \u0026#39;bar\u0026#39;)) $cond = [\u0026#39;in\u0026#39;, [\u0026#39;id\u0026#39;, \u0026#39;name\u0026#39;], [[\u0026#39;id\u0026#39; =\u0026gt; 1, \u0026#39;name\u0026#39; =\u0026gt; \u0026#39;foo\u0026#39;], [\u0026#39;id\u0026#39; =\u0026gt; 2, \u0026#39;name\u0026#39; =\u0026gt; \u0026#39;bar\u0026#39;]]] // 也适用于内嵌 SQL 语句 $cond = [\u0026#39;in\u0026#39;, \u0026#39;user_id\u0026#39;, (new Query())-\u0026gt;select(\u0026#39;id\u0026#39;)-\u0026gt;from(\u0026#39;users\u0026#39;)-\u0026gt;where([\u0026#39;active\u0026#39; =\u0026gt; 1])] LIKE // SQL: `name LIKE \u0026#39;%tester%\u0026#39;` $cond = [\u0026#39;like\u0026#39;, \u0026#39;name\u0026#39;, \u0026#39;tester\u0026#39;] // SQL: `name LIKE \u0026#39;%test%\u0026#39; AND name LIKE \u0026#39;%sample%\u0026#39;` $cond = [\u0026#39;like\u0026#39;, \u0026#39;name\u0026#39;, [\u0026#39;test\u0026#39;, \u0026#39;sample\u0026#39;]] // SQL: `name LIKE \u0026#39;%tester\u0026#39;` $cond = [\u0026#39;like\u0026#39;, \u0026#39;name\u0026#39;, \u0026#39;%tester\u0026#39;, false] EXIST // not exists用法类似 // SQL: EXISTS (SELECT \u0026#34;id\u0026#34; FROM \u0026#34;users\u0026#34; WHERE \u0026#34;active\u0026#34;=1) $cond = [\u0026#39;exists\u0026#39;, (new Query())-\u0026gt;select(\u0026#39;id\u0026#39;)-\u0026gt;from(\u0026#39;users\u0026#39;)-\u0026gt;where([\u0026#39;active\u0026#39; =\u0026gt; 1])] Yii2 Vue 跨域问题 解决 Yii2 + Vue 前后台分离时跨域的问题 | shiqidu 跨源资源共享（CORS） | mozilla\n旧的解决办法 在控制器的 behaviors 方法中增加下面的代码：\npublic function behaviors() { $behaviors = parent::behaviors(); if (YII_ENV_DEV) { // add CORS filter $behaviors[\u0026#39;corsFilter\u0026#39;] = [ \u0026#39;class\u0026#39; =\u0026gt; Cors::class, \u0026#39;cors\u0026#39; =\u0026gt; [ \u0026#39;Origin\u0026#39; =\u0026gt; [\u0026#39;http://localhost:8080\u0026#39;], \u0026#39;Access-Control-Request-Method\u0026#39; =\u0026gt; [\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;, \u0026#39;PUT\u0026#39;, \u0026#39;PATCH\u0026#39;, \u0026#39;DELETE\u0026#39;, \u0026#39;HEAD\u0026#39;, \u0026#39;OPTIONS\u0026#39;], \u0026#39;Access-Control-Request-Headers\u0026#39; =\u0026gt; [\u0026#39;*\u0026#39;], \u0026#39;Access-Control-Allow-Credentials\u0026#39; =\u0026gt; true, \u0026#39;Access-Control-Max-Age\u0026#39; =\u0026gt; 86400, \u0026#39;Access-Control-Expose-Headers\u0026#39; =\u0026gt; [], ], ]; } return $behaviors; } 上边配置的解释：\nOrigin 即 Access-Control-Allow-Origin 表示：响应头指定了该响应的资源是否被允许与给定的 origin 共享。 Access-Control-Request-Method 用于通知服务器在真正的请求中会采用哪种 HTTP 方法。因为预检请求所使用的方法总是 OPTIONS ，与实际请求所使用的方法不一样，所以这个请求头是必要的。 Access-Control-Request-Headers 用于通知服务器在真正的请求中会采用哪些请求头。 Access-Control-Allow-Credentials 表示是否可以将对请求的响应暴露给页面。返回 true 则可以，其他值均不可以。 Access-Control-Max-Age 表示返回结果（即 Access-Control-Allow-Methods 和 Access-Control-Allow-Headers 提供的信息） 可以被缓存多久。 Access-Control-Expose-Headers 列出了哪些首部可以作为响应的一部分暴露给外部。 注意：\n如果设置 Origin 为 ['*']，即所有的前端跨域请求可以接受，同时把 Access-Control-Allow-Credentials 设置为 true，Yii 会直接报错：Allowing credentials for wildcard origins is insecure. Please specify more restrictive origins or set \u0026lsquo;credentials\u0026rsquo; to false in your CORS configuration.。\n告诉你使用通配符的凭证是不安全的，让你设置更严格的 Origin 或者把 Access-Control-Allow-Credentials 设置为 false。\n也就是说不能 Access-Control-Allow-Credentials 为 true 并且 Access-Control-Allow-Origin 为 *。\n因为 Access-Control-Allow-Credentials 的意思就是允许跨域请求在请求头中携带凭证，比如 cookie，做身份识别，但是你又把 Access-Control-Allow-Origin 设置为 *，这是说不通的，是相悖的。\n具体可参考：Reason: Credential is not supported if the CORS header \u0026lsquo;Access-Control-Allow-Origin\u0026rsquo; is \u0026lsquo;*\u0026rsquo; | mozilla\n新的问题 上面的理论上解决了跨域问题，但是新版 Chrome 根据 Cookie 的 SameSite 属性，仍然会阻止 Cookie 的发送 network show filtered out request cookies。\n参考：\nWhat’s New In DevTools (Chrome 79) | medium Cookie 的 SameSite 属性 | ruanyifeng 在开发环境根治跨域问题，使用 webpack-dev-server 代理。\n前端：abc.test 后端：abc-api.test 代理：abc.test/web-api -\u0026gt; abc-api.test\nproxy: { \u0026#39;/web-api/\u0026#39;: { target: \u0026#39;http://abc-api.test/\u0026#39;, pathRewrite: { \u0026#39;^/web-api\u0026#39;: \u0026#39;\u0026#39; }, changeOrigin: true, // 默认情况下，代理时会保留主机头的来源，您可以将 changeOrigin 设置为true 来覆盖此行为。 secure: false, // 接受在 HTTPS 上运行带有无效证书的后端服务器。 }, } 参考：dev-server devserverproxy | webpack\n\u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2021/01/19/yii2-code-snippet/","summary":"\u003cp\u003e2025-02-15：已告别 Yii2，文章内容不再维护。\u003c/p\u003e\n\u003chr\u003e\n\u003ch2 id=\"gii-cli\"\u003egii CLI\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ephp yii \u003cspan class=\"nb\"\u003ehelp\u003c/span\u003e gii/mode\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ephp yii gii/model --generateLabelsFromComments\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e --overwrite\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e --standardizeCapitals\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e --ns\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;app\\models\\gii\u0026#39;\u003c/span\u003e --tableName\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;*\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# 多数据库\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ephp yii gii/model --generateLabelsFromComments\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e --overwrite\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e --standardizeCapitals\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e --db\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;hub_db\u0026#34;\u003c/span\u003e --ns\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;app\\models\\hub\\gii\u0026#39;\u003c/span\u003e --tableName\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;*\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"连接数据库时设置时区\"\u003e连接数据库时设置时区\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"s1\"\u003e\u0026#39;class\u0026#39;\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;yii\\db\\Connection\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"s1\"\u003e\u0026#39;dsn\u0026#39;\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;mysql:host=mysql;port=3306;dbname=hub\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"s1\"\u003e\u0026#39;username\u0026#39;\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;root\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"s1\"\u003e\u0026#39;password\u0026#39;\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;root\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"s1\"\u003e\u0026#39;charset\u0026#39;\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;utf8\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"c1\"\u003e// 关闭日志记录，防止被 logs 平台拿走\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e  \u003cspan class=\"s1\"\u003e\u0026#39;enableLogging\u0026#39;\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"nx\"\u003eYII_DEBUG\u003c/span\u003e \u003cspan class=\"o\"\u003e?\u003c/span\u003e \u003cspan class=\"k\"\u003etrue\u003c/span\u003e \u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"k\"\u003efalse\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"s1\"\u003e\u0026#39;enableProfiling\u0026#39;\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"nx\"\u003eYII_DEBUG\u003c/span\u003e \u003cspan class=\"o\"\u003e?\u003c/span\u003e \u003cspan class=\"k\"\u003etrue\u003c/span\u003e \u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"k\"\u003efalse\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"c1\"\u003e// 设置时区\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e  \u003cspan class=\"s1\"\u003e\u0026#39;on afterOpen\u0026#39;\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"k\"\u003efunction\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$event\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e// set \u0026#39;Asia/Bangkok\u0026#39; timezone\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e    \u003cspan class=\"nv\"\u003e$event\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"na\"\u003esender\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"na\"\u003ecreateCommand\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;SET time_zone=\u0026#39;+08:00\u0026#39;;\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"na\"\u003eexecute\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"p\"\u003e},\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"activerecord-one\"\u003eActiveRecord one\u003c/h2\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ccode\u003eyii\\db\\ActiveRecord::findOne()\u003c/code\u003e 和 \u003ccode\u003eyii\\db\\ActiveQuery::one()\u003c/code\u003e 都不会添加 LIMIT 1 到 生成的 SQL 语句中。如果你的查询会返回很多行的数据， 你明确的应该加上 \u003ccode\u003elimit(1)\u003c/code\u003e 来提高性能，比如 \u003ccode\u003eCustomer::find()-\u0026gt;limit(1)-\u0026gt;one()\u003c/code\u003e。\u003c/p\u003e\u003c/blockquote\u003e\n\u003ch2 id=\"db-where\"\u003eDB where\u003c/h2\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ca href=\"https://www.yiiframework.com/doc/guide/2.0/zh-cn/db-query-builder\"\u003e查询构建器 | yiiframework\u003c/a\u003e\n\u003ca href=\"https://blog.csdn.net/u013697959/article/details/79687746\"\u003eYII where 条件 | csdn\u003c/a\u003e\u003c/p\u003e","title":"Yii2 Code Snippet"},{"content":"过年就在石家庄 lwl 走学 肺炎在家办公 PR 剪辑 表情包制作 自己染发剪发 \u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2020/12/31/review-2020/","summary":"\u003ch2 id=\"过年就在石家庄\"\u003e过年就在石家庄\u003c/h2\u003e\n\u003ch2 id=\"lwl-走学\"\u003elwl 走学\u003c/h2\u003e\n\u003ch2 id=\"肺炎在家办公\"\u003e肺炎在家办公\u003c/h2\u003e\n\u003ch2 id=\"pr-剪辑\"\u003ePR 剪辑\u003c/h2\u003e\n\u003ch2 id=\"表情包制作\"\u003e表情包制作\u003c/h2\u003e\n\u003ch2 id=\"自己染发剪发\"\u003e自己染发剪发\u003c/h2\u003e\n\u003cp\u003e\u0026ndash; EOF \u0026ndash;\u003c/p\u003e","title":"回顾 2020"},{"content":"看现象 创建一个测试数据库表，插入测试数据：\nCREATE TABLE `blank_space` ( `id` int(10) unsigned NOT NULL AUTO_INCREMENT, `uid` varchar(10) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT \u0026#39;\u0026#39;, `desc` varchar(10) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT \u0026#39;\u0026#39;, PRIMARY KEY (`id`), UNIQUE KEY `uniq_key` (`uid`) USING BTREE ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci; INSERT INTO `blank_space`(`id`, `uid`, `desc`) VALUES (1, \u0026#39;abc \u0026#39;, \u0026#39;末尾1个\u0026#39;); INSERT INTO `blank_space`(`id`, `uid`, `desc`) VALUES (2, \u0026#39; abc\u0026#39;, \u0026#39;开头1个\u0026#39;); INSERT INTO `blank_space`(`id`, `uid`, `desc`) VALUES (3, \u0026#39; abc\u0026#39;, \u0026#39;开头2个\u0026#39;); id uid desc 1 abc_ 末尾 1 个 2 _abc 开头 1 个 3 __abc 开头 2 个 uid 实际上没有 _，这样写是为了看到空格。\n执行操作：\nSELECT * FROM blank_space WHERE uid = \u0026#39;abc\u0026#39;; SELECT * FROM blank_space WHERE uid = \u0026#39;abc \u0026#39;; SELECT * FROM blank_space WHERE uid = \u0026#39;abc \u0026#39;; 都可以查询出：\nid uid desc 1 abc_ 末尾 1 个 执行操作：\nINSERT INTO `blank_space`(`uid`, `desc`) VALUES (\u0026#39;abc\u0026#39;, \u0026#39;无空格\u0026#39;); -- 1062 - Duplicate entry \u0026#39;abc\u0026#39; for key \u0026#39;uniq_key\u0026#39;, Time: 0.322000s INSERT INTO `blank_space`(`uid`, `desc`) VALUES (\u0026#39;abc \u0026#39;, \u0026#39;末位两个\u0026#39;); -- 1062 - Duplicate entry \u0026#39;abc\u0026#39; for key \u0026#39;uniq_key\u0026#39;, Time: 0.322000s 原因 MySQL 校对规则属于 PADSPACE，会忽略尾部空格。针对的是 varchar char text 等文本类的数据类型。此为 SQL 标准化行为。无需要设置也无法改变。\n解决方案 SELECT * FROM blank_space WHERE uid = BINARY \u0026#39;abc\u0026#39;; -- 0 records SELECT * FROM blank_space WHERE uid = BINARY \u0026#39;abc \u0026#39;; -- 1 records SELECT * FROM blank_space WHERE uid = BINARY \u0026#39;abc \u0026#39;; -- 0 records SELECT * FROM blank_space WHERE uid like \u0026#39;abc\u0026#39;; -- 0 records SELECT * FROM blank_space WHERE uid like \u0026#39;abc \u0026#39;; -- 1 records SELECT * FROM blank_space WHERE uid like \u0026#39;abc \u0026#39;; -- 0 records BINARY 不是函数，是类型转换运算符，它用来强制它后面的字符串为一个二进制字符串，可以理解成精确匹配。\n约束攻击 需要在非严格模式下。\nSET sql_mode = \u0026#39;\u0026#39;; CREATE TABLE `blank_space_attack` ( `id` int(10) unsigned NOT NULL AUTO_INCREMENT, `uid` varchar(10) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT \u0026#39;\u0026#39;, `pwd` varchar(10) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT \u0026#39;\u0026#39;, PRIMARY KEY (`id`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci; INSERT INTO `blank_space_attack`(`id`, `uid`, `pwd`) VALUES (1, \u0026#39;admin\u0026#39;, \u0026#39;123\u0026#39;); INSERT INTO `blank_space_attack`(`id`, `uid`, `pwd`) VALUES (2, \u0026#39;tim\u0026#39;, \u0026#39;234\u0026#39;); 攻击：\nINSERT INTO `blank_space_attack`(`uid`, `pwd`) VALUES (\u0026#39;admin 1\u0026#39;, \u0026#39;easy\u0026#39;); 结果：\nselect * from blank_space_attack where uid = \u0026#34;admin\u0026#34; and pwd = \u0026#34;easy\u0026#34;; id uid desc 3 admin_____ easy 限制条件 服务端没有对用户名长度进行限制。如果服务端限制了用户名长度就不能导致数据库截断，也就没有利用条件。 登陆验证的 SQL 语句必须是用户名和密码一起验证。如果是验证流程是先根据用户名查找出对应的密码，然后再比对密码的话，那么也不能进行利用。因为当使用 admin 为用户名来查询密码的话，数据库此时就会返回两条记录，而一般取第一条则是目标用户的记录，那么你传输的密码肯定是和目标用户密码匹配不上的。 验证成功后返回的必须是用户传递进来的用户名，而不是从数据库取出的用户名。因为当我们以用户 admin 和密码 easy 登陆时，其实数据库返回的是我们自己的用户信息，而我们的用户名其实是 admin_____，如果此后的业务逻辑以该用户名为准，那么就不能达到越权的目的了。 References SQL 约束攻击 | v0n 记一次数据库空格问题 | iluoy Mysql 查询条件中字符串尾部有空格也能匹配上的问题 | xjnotxj \u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2020/11/28/mysql-blank-space/","summary":"\u003ch2 id=\"看现象\"\u003e看现象\u003c/h2\u003e\n\u003cp\u003e创建一个测试数据库表，插入测试数据：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sql\" data-lang=\"sql\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eCREATE\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eTABLE\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"n\"\u003eblank_space\u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"n\"\u003eid\u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nb\"\u003eint\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e10\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eunsigned\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eNOT\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eNULL\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eAUTO_INCREMENT\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"n\"\u003euid\u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nb\"\u003evarchar\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e10\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eCOLLATE\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eutf8mb4_unicode_ci\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eNOT\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eNULL\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eDEFAULT\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"k\"\u003edesc\u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nb\"\u003evarchar\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e10\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eCOLLATE\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eutf8mb4_unicode_ci\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eNOT\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eNULL\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eDEFAULT\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"k\"\u003ePRIMARY\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eKEY\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"n\"\u003eid\u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"k\"\u003eUNIQUE\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eKEY\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"n\"\u003euniq_key\u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"n\"\u003euid\u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eUSING\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eBTREE\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eENGINE\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eInnoDB\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eDEFAULT\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eCHARSET\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eutf8mb4\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eCOLLATE\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eutf8mb4_unicode_ci\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003eINSERT\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eINTO\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"n\"\u003eblank_space\u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"n\"\u003eid\u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"n\"\u003euid\u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"k\"\u003edesc\u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eVALUES\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;abc \u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;末尾1个\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003eINSERT\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eINTO\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"n\"\u003eblank_space\u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"n\"\u003eid\u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"n\"\u003euid\u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"k\"\u003edesc\u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eVALUES\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; abc\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;开头1个\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003eINSERT\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eINTO\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"n\"\u003eblank_space\u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"n\"\u003eid\u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"n\"\u003euid\u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"k\"\u003edesc\u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eVALUES\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e3\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;  abc\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;开头2个\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eid\u003c/th\u003e\n          \u003cth\u003euid\u003c/th\u003e\n          \u003cth\u003edesc\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e1\u003c/td\u003e\n          \u003ctd\u003eabc_\u003c/td\u003e\n          \u003ctd\u003e末尾 1 个\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e2\u003c/td\u003e\n          \u003ctd\u003e_abc\u003c/td\u003e\n          \u003ctd\u003e开头 1 个\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e3\u003c/td\u003e\n          \u003ctd\u003e__abc\u003c/td\u003e\n          \u003ctd\u003e开头 2 个\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003cblockquote\u003e\n\u003cp\u003euid 实际上没有 \u003ccode\u003e_\u003c/code\u003e，这样写是为了看到空格。\u003c/p\u003e","title":"MySQL 空格问题"},{"content":"Basic usage https://getcomposer.org/doc/01-basic-usage.md\n# get a list of your locally available platform packages. # php | ext-\u0026lt;name\u0026gt; | lib-\u0026lt;name\u0026gt; composer show --platform Libraries https://getcomposer.org/doc/02-libraries.md\nLight-weight distribution packages 轻量级分发包。使用 .gitattributes 来防止不需要的文件使 zip 分发包膨胀。\n// .gitattributes /demo export-ignore phpunit.xml.dist export-ignore /.github/ export-ignore 通过检查手动生成的压缩文件进行测试：\ngit archive branchName --format zip -o file.zip Command-line interface / Commands https://getcomposer.org/doc/03-cli.md\nAs Composer uses symfony/console you can call commands by short name if it\u0026rsquo;s not ambiguous.\ncomposer dump # calls composer dump-autoload Bash Completions\ncomposer completion bash \u0026gt; completion.bash Global Options:\n--profile 显示计时和内存使用信息 install / i:\nphp composer.phar install 如果当前目录中有 composer.lock 文件，会使用其中的确切版本而不是重新解析。这确保了每个人使用的依赖版本相同。\n如果没有 composer.lock 文件，Composer 会在解析依赖后创建一个。\n常用选项：\n--prefer-install: 指定安装方式，可选 source 或 dist --no-dev: 跳过安装 require-dev 中列出的包 --optimize-autoloader (-o): 优化自动加载器，建议在生产环境使用 --classmap-authoritative (-a): 仅从 classmap 自动加载类，隐式启用 --optimize-autoloader update / u / upgrade:\nphp composer.phar update 更新所有依赖到最新版本（根据 composer.json 的约束）并更新 composer.lock 文件。\n常用选项：\n--prefer-stable: 优先使用稳定版本 --prefer-lowest: 尝试回退到最低匹配的版本 --with-dependencies: 同时更新依赖的依赖项 require / r:\nphp composer.phar require vendor/package:version 添加新的依赖包并更新 composer.json 文件。\nremove / rm / uninstall:\nphp composer.phar remove vendor/package 移除包并更新 composer.json 文件。\ndump-autoload / dumpautoload:\nphp composer.phar dump-autoload 更新自动加载器，不安装或更新任何包。在添加新类时很有用。\n选项：\n-o, --optimize: 生成优化的 autoloader --classmap-authoritative (-a): 仅从 classmap 自动加载 --no-dev: 不生成开发环境的 autoloader global:\nphp composer.phar global require vendor/package 全局安装包，存储在 COMPOSER_HOME 目录。\nsearch:\nphp composer.phar search keyword 搜索包。\nself-update / selfupdate:\nphp composer.phar self-update 更新 Composer 到最新版本。\nComposer 支持多种环境变量来控制其行为：\nCOMPOSER_HOME: 指定 Composer 主目录位置 COMPOSER_CACHE_DIR: 更改 Composer 缓存目录 COMPOSER_MEMORY_LIMIT: 设置 PHP 内存限制 COMPOSER_PROCESS_TIMEOUT: 设置命令执行超时时间（默认 300 秒） COMPOSER_NO_INTERACTION: 禁用交互模式 COMPOSER_NO_DEV: 等同于 --no-dev 选项 COMPOSER_VENDOR_DIR: 更改安装依赖的目录 The composer.json schema https://getcomposer.org/doc/04-schema.md\ncomposer.json 文件是 Composer 项目的核心配置文件，用于定义包的基本信息和依赖关系。以下是主要字段的说明：\n基本字段 name: 包名称，格式为 vendor/project，例如 monolog/monolog。必须小写，可包含短横线、下划线或点号。 description: 包的简短描述，通常为一行。 version: 包的版本号，格式如 1.0.0 或 v1.0.0。一般建议省略，由 VCS 标签推断。 type: 包类型，默认为 library。其他可选值包括 project、metapackage 和 composer-plugin。 keywords: 关键词数组，用于搜索和过滤。 homepage: 项目网站的 URL。 readme: 自述文件的相对路径，默认为 README.md。 time: 版本发布日期，格式为 YYYY-MM-DD 或 YYYY-MM-DD HH:MM:SS。 license: 包的许可证，可以是字符串或字符串数组。 作者与支持 authors: 包作者数组，每个作者为一个对象，包含 name、email、homepage 和 role 字段。 support: 提供支持的各种信息，如 email、issues、forum、wiki 等。 funding: 用于赞助包作者的 URL 数组。 依赖管理 require: 运行时必需的依赖包映射表（包名到版本约束）。 require-dev: 开发环境需要的依赖包映射表，仅对根包有效。 conflict: 与当前包冲突的包。 replace: 由当前包替换的包。 provide: 当前包提供的包（接口实现等）。 suggest: 推荐安装的包，仅起信息提示作用。 自动加载配置 autoload: 定义项目自动加载规则，支持 psr-4、psr-0、classmap 和 files。 autoload-dev: 开发环境的额外自动加载规则，仅对根包有效。 其他高级配置 repositories: 定义额外的包来源，仅对根包有效。 minimum-stability: 默认包稳定性过滤级别，仅对根包有效。 prefer-stable: 是否优先使用稳定版本，仅对根包有效。 config: 各种配置选项，仅对根包有效。 scripts: 在安装过程中各个阶段执行的脚本钩子，仅对根包有效。 extra: 供脚本使用的任意额外数据。 bin: 应作为二进制文件安装的文件集合。 示例：\n{ \u0026#34;name\u0026#34;: \u0026#34;monolog/monolog\u0026#34;, \u0026#34;description\u0026#34;: \u0026#34;Logging library\u0026#34;, \u0026#34;keywords\u0026#34;: [\u0026#34;logging\u0026#34;, \u0026#34;psr-3\u0026#34;], \u0026#34;homepage\u0026#34;: \u0026#34;https://github.com/Seldaek/monolog\u0026#34;, \u0026#34;license\u0026#34;: \u0026#34;MIT\u0026#34;, \u0026#34;authors\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;Jordi Boggiano\u0026#34;, \u0026#34;email\u0026#34;: \u0026#34;j.boggiano@seld.be\u0026#34;, \u0026#34;homepage\u0026#34;: \u0026#34;https://seld.be\u0026#34; } ], \u0026#34;require\u0026#34;: { \u0026#34;php\u0026#34;: \u0026#34;\u0026gt;=5.3.0\u0026#34;, \u0026#34;psr/log\u0026#34;: \u0026#34;~1.0\u0026#34; }, \u0026#34;autoload\u0026#34;: { \u0026#34;psr-4\u0026#34;: {\u0026#34;Monolog\\\\\u0026#34;: \u0026#34;src/Monolog\u0026#34;} } } Repositories https://getcomposer.org/doc/05-repositories.md\n仓库是包的来源，Composer 会在所有配置的仓库中查找项目所需的包。本节介绍仓库的概念和类型。\n仓库类型 1. Composer 仓库 使用单个 packages.json 文件包含所有包元数据的仓库类型，这也是 Packagist 使用的类型。\n{ \u0026#34;repositories\u0026#34;: [ { \u0026#34;type\u0026#34;: \u0026#34;composer\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://example.org\u0026#34; } ] } 2. VCS 仓库 版本控制系统（Version Control System）仓库，支持从 git、svn、fossil 或 hg 仓库安装包。\n{ \u0026#34;repositories\u0026#34;: [ { \u0026#34;type\u0026#34;: \u0026#34;vcs\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://github.com/username/repository\u0026#34; } ], \u0026#34;require\u0026#34;: { \u0026#34;vendor/package\u0026#34;: \u0026#34;dev-branch-name\u0026#34; } } 使用 VCS 仓库的主要场景包括：\n维护第三方库的自己的分支 使用私有仓库 需要直接从版本控制系统获取代码 3. Package 仓库 针对不支持 Composer 的项目，可以手动定义包的信息。\n{ \u0026#34;repositories\u0026#34;: [ { \u0026#34;type\u0026#34;: \u0026#34;package\u0026#34;, \u0026#34;package\u0026#34;: { \u0026#34;name\u0026#34;: \u0026#34;smarty/smarty\u0026#34;, \u0026#34;version\u0026#34;: \u0026#34;3.1.7\u0026#34;, \u0026#34;dist\u0026#34;: { \u0026#34;url\u0026#34;: \u0026#34;https://www.smarty.net/files/Smarty-3.1.7.zip\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;zip\u0026#34; } } } ] } 自托管仓库选项 当需要保持包私有或为项目创建独立生态系统时，可以选择自托管仓库：\nPrivate Packagist：提供私有包托管和镜像功能的托管或自托管应用。\nSatis：轻量级的静态 Composer 仓库生成器，适合小型团队。\nArtifact 仓库：使用包含 ZIP 或 TAR 归档文件的文件夹作为包源。\n{ \u0026#34;repositories\u0026#34;: [ { \u0026#34;type\u0026#34;: \u0026#34;artifact\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;path/to/directory/with/zips/\u0026#34; } ] } Path 仓库：直接依赖本地目录，对于单体仓库特别有用。\n{ \u0026#34;repositories\u0026#34;: [ { \u0026#34;type\u0026#34;: \u0026#34;path\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;../../packages/my-package\u0026#34; } ] } 禁用 Packagist.org 默认情况下，Composer 会使用 Packagist.org 作为包源。如需禁用：\n{ \u0026#34;repositories\u0026#34;: [ { \u0026#34;packagist.org\u0026#34;: false } ] } 或通过全局配置：\nphp composer.phar config -g repo.packagist false Config https://getcomposer.org/doc/06-config.md\nComposer 配置选项可以通过 composer.json 中的 config 字段设置。以下是一些常用的配置项：\n基本配置选项 process-timeout: 进程执行超时时间（秒），默认 300（5分钟）。\n{ \u0026#34;config\u0026#34;: { \u0026#34;process-timeout\u0026#34;: 900 } } allow-plugins: 控制哪些 Composer 插件可以执行代码（Composer 2.2.0+）。\n{ \u0026#34;config\u0026#34;: { \u0026#34;allow-plugins\u0026#34;: { \u0026#34;vendor/plugin-name\u0026#34;: true, \u0026#34;another-vendor/*\u0026#34;: true } } } preferred-install: 首选安装方式，可为 source、dist 或 auto。\n{ \u0026#34;config\u0026#34;: { \u0026#34;preferred-install\u0026#34;: { \u0026#34;vendor/*\u0026#34;: \u0026#34;source\u0026#34;, \u0026#34;*\u0026#34;: \u0026#34;dist\u0026#34; } } } 仓库与认证 github-protocols: 克隆 GitHub 仓库使用的协议列表，默认 [\u0026quot;https\u0026quot;, \u0026quot;ssh\u0026quot;, \u0026quot;git\u0026quot;]。\ngithub-oauth: GitHub OAuth 令牌列表。\ngitlab-oauth/gitlab-token: GitLab OAuth 令牌或私有令牌列表。\nhttp-basic: HTTP 基本认证信息。\n{ \u0026#34;config\u0026#34;: { \u0026#34;http-basic\u0026#34;: { \u0026#34;example.org\u0026#34;: { \u0026#34;username\u0026#34;: \u0026#34;username\u0026#34;, \u0026#34;password\u0026#34;: \u0026#34;password\u0026#34; } } } } 目录与缓存 vendor-dir: 安装依赖的目录，默认为 vendor。 bin-dir: 二进制文件链接目录，默认为 vendor/bin。 cache-dir: 缓存目录。 cache-files-ttl: 缓存文件的存活时间（秒），默认 15552000（6个月）。 cache-files-maxsize: 缓存可使用的最大空间，默认 \u0026ldquo;300MiB\u0026rdquo;。 自动加载相关 optimize-autoloader: 始终优化自动加载器，默认 false。 prepend-autoloader: 是否将 Composer 自动加载器前置到已存在的自动加载器，默认 true。 classmap-authoritative: 设为 true 时，自动加载器只会从 classmap 加载类，默认 false。 apcu-autoloader: 是否使用 APCu 缓存查找的类，默认 false。 安全与其他 platform-check: 平台检查级别，默认 php-only，可设为 true 或 false。 secure-http: 是否只允许通过 HTTPS 下载包，默认 true。 discard-changes: 处理脏更新的方式，默认 false，可设为 true 或 stash。 sort-packages: 添加新包时是否按名称排序，默认 false。 全局配置 某些配置可通过命令行全局设置：\nphp composer.phar config -g repo.packagist false php composer.phar config -g process-timeout 900 Runtime Composer utilities https://getcomposer.org/doc/07-runtime.md\nComposer 除了安装和管理依赖外，还提供了一些运行时实用工具。如果需要依赖特定版本的这些功能，可以通过 composer-runtime-api 包实现。\n自动加载 最常用的运行时工具是自动加载器，在所有 Composer 版本中可用。\nrequire __DIR__ . \u0026#39;/vendor/autoload.php\u0026#39;; // 现在可以使用项目的依赖了 $log = new Monolog\\Logger(\u0026#39;name\u0026#39;); 已安装版本信息 Composer 2.0 引入了 Composer\\InstalledVersions 类，提供了检查已安装包的静态方法。\n检查包是否存在 \\Composer\\InstalledVersions::isInstalled(\u0026#39;vendor/package\u0026#39;); // 返回布尔值 \\Composer\\InstalledVersions::isInstalled(\u0026#39;psr/log-implementation\u0026#39;); // 检查虚拟包 从 Composer 2.1 开始，还可以检查包是否通过 require-dev 安装：\n\\Composer\\InstalledVersions::isInstalled(\u0026#39;vendor/package\u0026#39;, false); // 仅检查 require 中的包 检查包版本 use Composer\\Semver\\VersionParser; // 检查包是否满足版本约束 \\Composer\\InstalledVersions::satisfies(new VersionParser, \u0026#39;vendor/package\u0026#39;, \u0026#39;2.0.*\u0026#39;); // 获取包的版本号 $version = \\Composer\\InstalledVersions::getVersion(\u0026#39;vendor/package\u0026#39;); // 标准化版本 (如 1.2.3.0) $prettyVersion = \\Composer\\InstalledVersions::getPrettyVersion(\u0026#39;vendor/package\u0026#39;); // 原始版本 (如 v1.2.3) 获取包的安装路径 // 获取包安装的绝对路径 $path = \\Composer\\InstalledVersions::getInstallPath(\u0026#39;vendor/package\u0026#39;); 查找指定类型的已安装包 // 获取所有类型为 \u0026#39;foo-plugin\u0026#39; 的已安装包 $packages = \\Composer\\InstalledVersions::getInstalledPackagesByType(\u0026#39;foo-plugin\u0026#39;); 平台检查 Composer 2.0 引入了 vendor/composer/platform_check.php 文件，会在包含自动加载器时自动执行。它会验证当前 PHP 环境是否满足平台要求，如 PHP 版本和扩展。\n默认情况下，只检查 PHP 版本（php-only）。可以通过 platform-check 配置选项修改行为：\n{ \u0026#34;config\u0026#34;: { \u0026#34;platform-check\u0026#34;: true // 也检查 PHP 扩展 } } 如果要禁用此安全检查：\n{ \u0026#34;config\u0026#34;: { \u0026#34;platform-check\u0026#34;: false } } 二进制文件中的自动加载器路径 Composer 2.2 引入了全局变量 $_composer_autoload_path，它在运行 Composer 安装的二进制文件时设置。\n二进制文件中的 bin-dir 路径 Composer 2.2.2 引入了全局变量 $_composer_bin_dir，它在运行 Composer 安装的二进制文件时设置。\n","permalink":"https://zyf.im/2020/10/28/composer-document-note/","summary":"\u003ch2 id=\"basic-usage\"\u003eBasic usage\u003c/h2\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ca href=\"https://getcomposer.org/doc/01-basic-usage.md\"\u003ehttps://getcomposer.org/doc/01-basic-usage.md\u003c/a\u003e\u003c/p\u003e\u003c/blockquote\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# get a list of your locally available platform packages.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# php | ext-\u0026lt;name\u0026gt; | lib-\u0026lt;name\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ecomposer show --platform\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"libraries\"\u003eLibraries\u003c/h3\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ca href=\"https://getcomposer.org/doc/02-libraries.md\"\u003ehttps://getcomposer.org/doc/02-libraries.md\u003c/a\u003e\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003eLight-weight distribution packages 轻量级分发包。使用 \u003ccode\u003e.gitattributes\u003c/code\u003e 来防止不需要的文件使 zip 分发包膨胀。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-txt\" data-lang=\"txt\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e// .gitattributes\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e/demo export-ignore\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ephpunit.xml.dist export-ignore\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e/.github/ export-ignore\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e通过检查手动生成的压缩文件进行测试：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit archive branchName --format zip -o file.zip\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"command-line-interface--commands\"\u003eCommand-line interface / Commands\u003c/h2\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ca href=\"https://getcomposer.org/doc/03-cli.md\"\u003ehttps://getcomposer.org/doc/03-cli.md\u003c/a\u003e\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003eAs Composer uses symfony/console you can call commands by short name if it\u0026rsquo;s not ambiguous.\u003c/p\u003e","title":"Composer 文档笔记"},{"content":"当代框架基本都是有组件构成，这使得框架变得更加灵活。The Laravel Components | github Laravel 中有不少优质组件，那如何在 Laravel 之外使用 illuminate 组件呢？\nilluminate/validation 以 illuminate/validation 为例，validation 有丰富的数据验证功能。\n在项目的 composer.json 文件中添加：\n... \u0026#34;require\u0026#34;: { ... \u0026#34;illuminate/validation\u0026#34;: \u0026#34;^5.8\u0026#34;, ... 从 Laravel-Lang/lang 项目中复制需要的语言文件放到自己的项目中。\n例如：在 Yii2 项目中，复制对应语言文件到项目中的 assets/lang/zh-CN/validation.php。\n创建 common/Validator.php：\n\u0026lt;?php namespace app\\common; use Illuminate\\Filesystem\\Filesystem; use Illuminate\\Translation\\FileLoader; use Illuminate\\Translation\\Translator; use Illuminate\\Validation\\Factory; class Validator { private static $instance = null; private function __construct() { } public static function getInstance(): Factory { if (null === static::$instance) { $translationPath = get_alias(\u0026#39;@assets/lang\u0026#39;); $translationLocale = \u0026#39;zh-CN\u0026#39;; $transFileLoader = new FileLoader(new Filesystem(), $translationPath); $translator = new Translator($transFileLoader, $translationLocale); static::$instance = new Factory($translator); } return static::$instance; } } 在全局函数文件添加：\n// https://learnku.com/docs/laravel/5.8/validation/3899#manually-creating-validators // $rules = [ // \u0026#39;name\u0026#39; =\u0026gt; \u0026#39;required|string|min:2|max:5\u0026#39;, // \u0026#39;code\u0026#39; =\u0026gt; \u0026#39;required|string|min:2|max:5\u0026#39;, // ]; function validator(array $data, array $rules, array $messages = [], array $customAttributes = []) { return \\app\\common\\Validator::getInstance()-\u0026gt;make($data, $rules, $messages, $customAttributes); } 测试使用：\n$rules = [\u0026#39;name\u0026#39; =\u0026gt; \u0026#39;required|numeric\u0026#39;]; $customAttributes = [\u0026#39;name\u0026#39; =\u0026gt; \u0026#39;My name\u0026#39;]; $messages = [\u0026#39;name.required\u0026#39; =\u0026gt; \u0026#39;A name is required\u0026#39;,]; $validator = validator($data, $rules, $customAttributes, $messages); if ($validator-\u0026gt;fails()) { $errors = $validator-\u0026gt;errors()-\u0026gt;all(); Response::error(Errors::ParamsInvalid, implode(\u0026#39;,\u0026#39;, $errors), $errors); } \u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2020/09/11/use-illuminate-components-without-laravel/","summary":"\u003cp\u003e当代框架基本都是有组件构成，这使得框架变得更加灵活。\u003ca href=\"https://github.com/illuminate\"\u003eThe Laravel Components | github\u003c/a\u003e Laravel 中有不少优质组件，那如何在 Laravel 之外使用 illuminate 组件呢？\u003c/p\u003e\n\u003ch2 id=\"illuminatevalidation\"\u003eilluminate/validation\u003c/h2\u003e\n\u003cp\u003e以 \u003ca href=\"https://github.com/illuminate/validation\"\u003eilluminate/validation\u003c/a\u003e 为例，validation 有丰富的数据验证功能。\u003c/p\u003e\n\u003cp\u003e在项目的 \u003ccode\u003ecomposer.json\u003c/code\u003e 文件中添加：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-json\" data-lang=\"json\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"err\"\u003e...\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"s2\"\u003e\u0026#34;require\u0026#34;\u003c/span\u003e\u003cspan class=\"err\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      \u003cspan class=\"err\"\u003e...\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      \u003cspan class=\"nt\"\u003e\u0026#34;illuminate/validation\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;^5.8\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"err\"\u003e...\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e从 \u003ca href=\"https://github.com/Laravel-Lang/lang/tree/master/src/zh_CN\"\u003eLaravel-Lang/lang\u003c/a\u003e 项目中复制需要的语言文件放到自己的项目中。\u003c/p\u003e\n\u003cp\u003e例如：在 Yii2 项目中，复制对应语言文件到项目中的 \u003ccode\u003eassets/lang/zh-CN/validation.php\u003c/code\u003e。\u003c/p\u003e\n\u003cp\u003e创建 \u003ccode\u003ecommon/Validator.php\u003c/code\u003e：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e\u0026lt;?\u003c/span\u003e\u003cspan class=\"nx\"\u003ephp\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003enamespace\u003c/span\u003e \u003cspan class=\"nx\"\u003eapp\\common\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003euse\u003c/span\u003e \u003cspan class=\"nx\"\u003eIlluminate\\Filesystem\\Filesystem\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003euse\u003c/span\u003e \u003cspan class=\"nx\"\u003eIlluminate\\Translation\\FileLoader\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003euse\u003c/span\u003e \u003cspan class=\"nx\"\u003eIlluminate\\Translation\\Translator\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003euse\u003c/span\u003e \u003cspan class=\"nx\"\u003eIlluminate\\Validation\\Factory\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eValidator\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"nv\"\u003e$instance\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"k\"\u003eprivate\u003c/span\u003e \u003cspan class=\"k\"\u003efunction\u003c/span\u003e \u003cspan class=\"fm\"\u003e__construct\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"k\"\u003efunction\u003c/span\u003e \u003cspan class=\"nf\"\u003egetInstance\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"nx\"\u003eFactory\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003enull\u003c/span\u003e \u003cspan class=\"o\"\u003e===\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"nv\"\u003e$instance\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      \u003cspan class=\"nv\"\u003e$translationPath\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003eget_alias\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;@assets/lang\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      \u003cspan class=\"nv\"\u003e$translationLocale\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;zh-CN\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      \u003cspan class=\"nv\"\u003e$transFileLoader\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003eFileLoader\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003eFilesystem\u003c/span\u003e\u003cspan class=\"p\"\u003e(),\u003c/span\u003e \u003cspan class=\"nv\"\u003e$translationPath\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      \u003cspan class=\"nv\"\u003e$translator\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003eTranslator\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$transFileLoader\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$translationLocale\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      \u003cspan class=\"k\"\u003estatic\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"nv\"\u003e$instance\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003eFactory\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$translator\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"nv\"\u003e$instance\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e在全局函数文件添加：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// https://learnku.com/docs/laravel/5.8/validation/3899#manually-creating-validators\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// $rules = [\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e//   \u0026#39;name\u0026#39; =\u0026gt; \u0026#39;required|string|min:2|max:5\u0026#39;,\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e//   \u0026#39;code\u0026#39; =\u0026gt; \u0026#39;required|string|min:2|max:5\u0026#39;,\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// ];\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003efunction\u003c/span\u003e \u003cspan class=\"nf\"\u003evalidator\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003earray\u003c/span\u003e \u003cspan class=\"nv\"\u003e$data\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003earray\u003c/span\u003e \u003cspan class=\"nv\"\u003e$rules\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003earray\u003c/span\u003e \u003cspan class=\"nv\"\u003e$messages\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e[],\u003c/span\u003e \u003cspan class=\"k\"\u003earray\u003c/span\u003e \u003cspan class=\"nv\"\u003e$customAttributes\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e[])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nx\"\u003e\\app\\common\\Validator\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"na\"\u003egetInstance\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"na\"\u003emake\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$data\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$rules\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$messages\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$customAttributes\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e测试使用：\u003c/p\u003e","title":"在 Laravel 之外使用 illuminate 组件"},{"content":"EVAL \u0026#34;return redis.call(\u0026#39;del\u0026#39;, \u0026#39;defaultKey\u0026#39;, unpack(redis.call(\u0026#39;keys\u0026#39;, ARGV[1])))\u0026#34; 0 prefix:* 循环删除：\nEVAL \u0026#34;local keys = redis.call(\u0026#39;keys\u0026#39;, ARGV[1]) \\n for i=1,#keys,5000 do \\n redis.call(\u0026#39;del\u0026#39;, unpack(keys, i, math.min(i+4999, #keys))) \\n end \\n return keys\u0026#34; 0 prefix:* References How to atomically delete keys matching a pattern using Redis | stackoverflow \u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2020/08/17/redis-matching-a-pattern-delete-keys/","summary":"\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-lua\" data-lang=\"lua\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003eEVAL\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;return redis.call(\u0026#39;del\u0026#39;, \u0026#39;defaultKey\u0026#39;, unpack(redis.call(\u0026#39;keys\u0026#39;, ARGV[1])))\u0026#34;\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e \u003cspan class=\"n\"\u003eprefix\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e循环删除：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-lua\" data-lang=\"lua\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003eEVAL\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;local keys = redis.call(\u0026#39;keys\u0026#39;, ARGV[1]) \u003c/span\u003e\u003cspan class=\"se\"\u003e\\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e for i=1,#keys,5000 do \u003c/span\u003e\u003cspan class=\"se\"\u003e\\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e redis.call(\u0026#39;del\u0026#39;, unpack(keys, i, math.min(i+4999, #keys))) \u003c/span\u003e\u003cspan class=\"se\"\u003e\\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e end \u003c/span\u003e\u003cspan class=\"se\"\u003e\\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e return keys\u0026#34;\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e \u003cspan class=\"n\"\u003eprefix\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"references\"\u003eReferences\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://stackoverflow.com/questions/4006324/how-to-atomically-delete-keys-matching-a-pattern-using-redis\"\u003eHow to atomically delete keys matching a pattern using Redis | stackoverflow\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u0026ndash; EOF \u0026ndash;\u003c/p\u003e","title":"Redis 正则批量删除 key"},{"content":"The JSON Data Type | mysql\nAs of MySQL 5.7.8, MySQL supports a native JSON data type\nJSON Function Reference | mysql\nA JSON column cannot have a non-NULL default value.\n索引 设置虚拟列 -\u0026gt; 虚拟列建立索引\n在 MySQL 5.7 中，支持两种 Generated Column，即 Virtual Generated Column 和 Stored Generated Column，前者只将 Generated Column 保存在数据字典中（表的元数据），并不会将这一列数据持久化到磁盘上；后者会将 Generated Column 持久化到磁盘上，而不是每次读取的时候计算所得。很明显，后者存放了可以通过已有数据计算而得的数据，需要更多的磁盘空间，与 Virtual Column 相比并没有优势，因此，MySQL 5.7 中，不指定 Generated Column 的类型，默认是 Virtual Column。\n如果需要 Stored Generated Golumn 的话，可能在 Virtual Generated Column 上建立索引更加合适，一般情况下，都使用 Virtual Generated Column，这也是 MySQL 默认的方式。\n{ \u0026#34;id\u0026#34;: 1, \u0026#34;name\u0026#34;: \u0026#34;Sally\u0026#34;, \u0026#34;games_played\u0026#34;: { \u0026#34;Battlefield\u0026#34;: { \u0026#34;weapon\u0026#34;: \u0026#34;sniper rifle\u0026#34;, \u0026#34;rank\u0026#34;: \u0026#34;Sergeant V\u0026#34;, \u0026#34;level\u0026#34;: 20 } } } CREATE TABLE `players` ( `id` INT UNSIGNED NOT NULL, `player_and_games` JSON NOT NULL, `names_virtual` VARCHAR(20) GENERATED ALWAYS AS (`player_and_games` -\u0026gt;\u0026gt; \u0026#39;$.name\u0026#39;) NOT NULL, PRIMARY KEY (`id`) ); 在 Yii2 中的使用 $query = static::find() -\u0026gt;andWhere([\u0026#39;=\u0026#39;, new Expression(\u0026#34;`json_value` -\u0026gt; \u0026#39;$.source\u0026#39;\u0026#34;), new JsonExpression($array_param)]); References MySQL 5.7 新特性 JSON 的创建，插入，查询，更新 MySQL · 最佳实践 · 如何索引 JSON 字段 MySQL 常用 Json 函数 | cnblogs \u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2020/08/14/mysql-json-data-type/","summary":"\u003cp\u003e\u003ca href=\"https://dev.mysql.com/doc/refman/5.7/en/json.html\"\u003eThe JSON Data Type | mysql\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eAs of MySQL 5.7.8, MySQL supports a native JSON data type\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003e\u003ca href=\"https://dev.mysql.com/doc/refman/5.7/en/json-function-reference.html\"\u003eJSON Function Reference | mysql\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eA JSON column cannot have a non-NULL default value.\u003c/p\u003e\n\u003ch2 id=\"索引\"\u003e索引\u003c/h2\u003e\n\u003cp\u003e设置虚拟列 -\u0026gt; 虚拟列建立索引\u003c/p\u003e\n\u003cp\u003e在 MySQL 5.7 中，支持两种 Generated Column，即 Virtual Generated Column 和 Stored Generated Column，前者只将 Generated Column 保存在数据字典中（表的元数据），并不会将这一列数据持久化到磁盘上；后者会将 Generated Column 持久化到磁盘上，而不是每次读取的时候计算所得。很明显，后者存放了可以通过已有数据计算而得的数据，需要更多的磁盘空间，与 Virtual Column 相比并没有优势，因此，MySQL 5.7 中，不指定 Generated Column 的类型，默认是 Virtual Column。\u003c/p\u003e\n\u003cp\u003e如果需要 Stored Generated Golumn 的话，可能在 Virtual Generated Column 上建立索引更加合适，一般情况下，都使用 Virtual Generated Column，这也是 MySQL 默认的方式。\u003c/p\u003e","title":"MySQL JSON 数据类型"},{"content":"应该将 vendor 提交到 Git 吗 一般建议是 不。vendor 目录应添加到 .gitignore。\n最佳实践是让所有开发人员使用 Composer 来安装依赖项。类似地，构建服务器、CI、部署工具等都应该作为项目启动的一部分来运行 Composer。\n虽然在某些环境下这样做很诱人，但也会导致一些问题：\n大型 VCS 存储库的大小和更新代码时的差异。 在你自己的 VCS 复制你所有依赖的历史。 将通过 git 安装的依赖项添加到 git repo 中将显示为 submodules。这是有问题的，因为它们不是真正的 submodules，您将会遇到问题。 如果你真的觉得你必须这样做，你有几个选择：\n限制自己安装带标记的版本（没有 dev 版本），这样就只能安装压缩版，并避免与 git submodules 有关的问题。 Use --prefer-dist or set preferred-install to dist in your config. Remove the .git directory of every dependency after the installation, then you can add them to your git repo. You can do that with rm -rf vendor/\\*\\*/.git in ZSH or find vendor/ -type d -name \u0026quot;.git\u0026quot; -exec rm -rf {} \\; in Bash. 但这意味着您必须在运行 composer 更新之前从磁盘中删除这些依赖项。 Add a .gitignore rule /vendor/**/.git to ignore all the vendor .git folders. 这种方法不需要在运行编写器更新之前从磁盘删除依赖项。 我的做法 问题解决了，但是不确信做法是否正确。\n因为网络环境与部署的原因，在生产环境下是将 vendor 目录提交到 git 中的。使用过程中确实出现了，部分类库成为了 submodules，无法把真实的代码提交进 git。\n可尝试执行：\ngit rm rf --cache vendor git add . git commit -m \u0026#34;add vendor\u0026#34; References Should I commit the dependencies in my vendor directory? | getcomposer \u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2020/08/10/commit-composer-vendor-to-git/","summary":"\u003ch2 id=\"应该将-vendor-提交到-git-吗\"\u003e应该将 vendor 提交到 Git 吗\u003c/h2\u003e\n\u003cp\u003e一般建议是 \u003cstrong\u003e不\u003c/strong\u003e。\u003ccode\u003evendor\u003c/code\u003e 目录应添加到 \u003ccode\u003e.gitignore\u003c/code\u003e。\u003c/p\u003e\n\u003cp\u003e最佳实践是让所有开发人员使用 Composer 来安装依赖项。类似地，构建服务器、CI、部署工具等都应该作为项目启动的一部分来运行 Composer。\u003c/p\u003e\n\u003cp\u003e虽然在某些环境下这样做很诱人，但也会导致一些问题：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e大型 VCS 存储库的大小和更新代码时的差异。\u003c/li\u003e\n\u003cli\u003e在你自己的 VCS 复制你所有依赖的历史。\u003c/li\u003e\n\u003cli\u003e将通过 git 安装的依赖项添加到 git repo 中将显示为 \u003ccode\u003esubmodules\u003c/code\u003e。这是有问题的，因为它们不是真正的 \u003ccode\u003esubmodules\u003c/code\u003e，您将会遇到问题。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e如果你真的觉得你必须这样做，你有几个选择：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e限制自己安装带标记的版本（没有 dev 版本），这样就只能安装压缩版，并避免与 git \u003ccode\u003esubmodules\u003c/code\u003e 有关的问题。\u003c/li\u003e\n\u003cli\u003eUse \u003ccode\u003e--prefer-dist\u003c/code\u003e or set \u003ccode\u003epreferred-install\u003c/code\u003e to \u003ccode\u003edist\u003c/code\u003e in your config.\u003c/li\u003e\n\u003cli\u003eRemove the \u003ccode\u003e.git\u003c/code\u003e directory of every dependency after the installation, then you can add them to your git repo. You can do that with \u003ccode\u003erm -rf vendor/\\*\\*/.git\u003c/code\u003e in ZSH or \u003ccode\u003efind vendor/ -type d -name \u0026quot;.git\u0026quot; -exec rm -rf {} \\;\u003c/code\u003e in Bash. 但这意味着您必须在运行 composer 更新之前从磁盘中删除这些依赖项。\u003c/li\u003e\n\u003cli\u003eAdd a \u003ccode\u003e.gitignore\u003c/code\u003e rule \u003ccode\u003e/vendor/**/.git\u003c/code\u003e to ignore all the vendor \u003ccode\u003e.git\u003c/code\u003e folders. 这种方法不需要在运行编写器更新之前从磁盘删除依赖项。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"我的做法\"\u003e我的做法\u003c/h2\u003e\n\u003cblockquote\u003e\n\u003cp\u003e问题解决了，但是不确信做法是否正确。\u003c/p\u003e","title":"Composer vendor 提交至 Git"},{"content":"2023-12-22：内容不再维护，推荐使用 Docker。\n安装 Swoole pecl install swoole 可能出现：\nConnection to `ssl://pecl.php.net:443′ failed: # 检查 php -r \u0026#34;print_r(openssl_get_cert_locations());\u0026#34; Array ( [default_cert_file] =\u0026gt; /private/etc/ssl/cert.pem [default_cert_file_env] =\u0026gt; SSL_CERT_FILE [default_cert_dir] =\u0026gt; /private/etc/ssl/certs [default_cert_dir_env] =\u0026gt; SSL_CERT_DIR [default_private_dir] =\u0026gt; /private/etc/ssl/private [default_default_cert_area] =\u0026gt; /private/etc/ssl [ini_cafile] =\u0026gt; [ini_capath] =\u0026gt; ) ls /private/etc/ssl/ # 现没有 cert.pem 这个证书 # 下载证书 wget -c https://curl.haxx.se/ca/cacert.pem /private/etc/ssl/cert.pem --no-check-certificate # 再次执行 pecl install swoole PEAR PECL Composer PEAR：PHP Extension and Application Repository，PEAR 将 PHP 程序开发过程中常用的功能编写成类库，涵盖了页面呈现、数据库访问、文件操作、数据结构、缓存操作、网络协议、WebService 等许多方面，用户可以通过下载这些类库并适当的作一些定制以实现自己需要的功能。避免重复发明“车轮”。PEAR 的出现大大提高了 PHP 程序的开发效率和开发质量。使用的时候，要在代码中进行 Include 才能够使用。但基本已经没落，被 Composer 取而代之。\nPECL：PHP Extension Community Library，是使用 C 语言开发的，通常用于补充一些用 PHP 难以完成的底层功能，往往需要重新编译或者在配置文件中设置后才能在用户自己的代码中使用。相对来说是比较底层的扩展。PECL 是 PEAR 的一部分。\n官网说明：https://pecl.php.net/\neg：安装 Reids 扩展 https://pecl.php.net/package/redis\npecl install redis Composer：PHP 的包管理工具，优点在于仅需要提供一个 composer.json 文件，申明需要用到的三方库，一个简单的命令就能将其依赖全部装好。\n目前，我们使用 Composer 来管理 PHP 代码包，使用 PECL 来管理 C 扩展。\nReferences 关于 PHP 的扩展 PECL、PEAR、Composer | su520 \u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2020/08/07/deploy-swoft-framework/","summary":"\u003cp\u003e2023-12-22：内容不再维护，推荐使用 Docker。\u003c/p\u003e\n\u003chr\u003e\n\u003ch2 id=\"安装-swoole\"\u003e安装 Swoole\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003epecl install swoole\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e可能出现：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-txt\" data-lang=\"txt\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eConnection to `ssl://pecl.php.net:443′ failed:\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# 检查\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ephp -r \u003cspan class=\"s2\"\u003e\u0026#34;print_r(openssl_get_cert_locations());\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eArray\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"o\"\u003e[\u003c/span\u003edefault_cert_file\u003cspan class=\"o\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e\u0026gt; /private/etc/ssl/cert.pem\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"o\"\u003e[\u003c/span\u003edefault_cert_file_env\u003cspan class=\"o\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e\u0026gt; SSL_CERT_FILE\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"o\"\u003e[\u003c/span\u003edefault_cert_dir\u003cspan class=\"o\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e\u0026gt; /private/etc/ssl/certs\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"o\"\u003e[\u003c/span\u003edefault_cert_dir_env\u003cspan class=\"o\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e\u0026gt; SSL_CERT_DIR\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"o\"\u003e[\u003c/span\u003edefault_private_dir\u003cspan class=\"o\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e\u0026gt; /private/etc/ssl/private\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"o\"\u003e[\u003c/span\u003edefault_default_cert_area\u003cspan class=\"o\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e\u0026gt; /private/etc/ssl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"o\"\u003e[\u003c/span\u003eini_cafile\u003cspan class=\"o\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"o\"\u003e[\u003c/span\u003eini_capath\u003cspan class=\"o\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003els /private/etc/ssl/\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# 现没有 cert.pem 这个证书\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# 下载证书\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ewget -c https://curl.haxx.se/ca/cacert.pem /private/etc/ssl/cert.pem --no-check-certificate\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# 再次执行\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003epecl install swoole\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"pear-pecl-composer\"\u003ePEAR PECL Composer\u003c/h2\u003e\n\u003cp\u003e\u003ca href=\"http://pear.php.net/\"\u003ePEAR\u003c/a\u003e：PHP Extension and Application Repository，PEAR 将 PHP 程序开发过程中常用的功能编写成类库，涵盖了页面呈现、数据库访问、文件操作、数据结构、缓存操作、网络协议、WebService 等许多方面，用户可以通过下载这些类库并适当的作一些定制以实现自己需要的功能。避免重复发明“车轮”。PEAR 的出现大大提高了 PHP 程序的开发效率和开发质量。使用的时候，要在代码中进行 Include 才能够使用。但基本已经没落，被 Composer 取而代之。\u003c/p\u003e","title":"PHP Swoft 框架环境配置"},{"content":"tcpdump 是 Unix/Linux 下的抓包工具，可以针对指定网卡、端口、协议进行抓包。\n字太多不看 sudo tcpdump host api.test and tcp port 80 -A -nn sudo tcpdump dst api.test and tcp port 80 -A 一举成名天下知 man tcpdump 获取适配器列表 tcpdump -D tcpdump --list-interfaces 1.en0 [Up, Running] 2.p2p0 [Up, Running] 3.awdl0 [Up, Running] 4.llw0 [Up, Running] 5.utun0 [Up, Running] 6.utun1 [Up, Running] 7.utun2 [Up, Running] 8.en5 [Up, Running] 9.lo0 [Up, Running, Loopback] 10.bridge0 [Up, Running] 11.en1 [Up, Running] 12.en2 [Up, Running] 13.en3 [Up, Running] 14.en4 [Up, Running] 15.gif0 [none] 16.stf0 [none] 17.XHC0 [none] 18.XHC1 [none] 19.ap1 [none] 20.XHC20 [none] 21.VHC128 [none] 监听适配器 Listen on interface.\nmacOS 下监听适配器，必须使用 root 权限。\nsudo tcpdump -i en0 sudo tcpdump -i 1 过滤监听适配器 过滤主机 # 抓取所有经过 en0，目的或源地址是 192.168.50.1 的网络数据 sudo tcpdump -i en0 host 192.168.50.1 # 源地址 sudo tcpdump -i en0 src host 192.168.50.1 # 目的地址 sudo tcpdump -i en0 dst host 192.168.50.1 过滤端口 sudo tcpdump -i en0 port 8080 过滤网段 sudo tcpdump -i en0 net 192.168 协议过滤 sudo tcpdump -i en0 tcp sudo tcpdump -i en0 udp sudo tcpdump -i en0 ip sudo tcpdump -i en0 arp sudo tcpdump -i en0 icmp 使用表达式 与：\u0026amp;\u0026amp; 或 and 或：|| 或 or 非：! 或 not 选项 tcpdump 默认只会截取前 96 字节的内容，要想截取所有的报文内容，可以使用 -s number， number 就是你要截取的报文字节数，如果是 0 的话，表示截取报文全部内容。\n-i any 监听所有的网卡 -n 不要解析域名，会优先暂时主机的名字 -nn 不展示主机名和端口名（比如 443 端口会被展示成 https） -A 只使用 ascii 打印报文的全部数据，不要和 -X 一起使用。截取 http 请求的时候可以用 sudo tcpdump -nSA port 80 -X 同时用 hex 和 ascii 显示报文的内容 -XX 同 -X，但同时显示以太网头部 -S 显示绝对的序列号（sequence number），而不是相对编号 -s 截取的包字节长度，默认情况下 tcpdump 会展示 96 字节的长度，要获取完整的长度可以用 -s0 或者 -s1600。 -v, -vv, -vvv：显示更多的详细信息 -c number 截取 number 个报文，然后结束 Flags tcpdump Flags | readthedocs\nTCP Flag Flag Meaning SYN S Syn packet, a session establishment request. 一个会话建立请求 ACK A Ack packet, acknowledge sender’s data. 确认发送方的数据 FIN F Finish flag, indication of termination. 终止的的标识 RESET R Reset, indication of immediate abort of conn. 指令立即中止 PUSH P Push, immediate push of data from sender. 从发送方立即推送数据 URGENT U Urgent, takes precedence over other data. 优先于其他数据 NONE A dot . Placeholder, usually used for ACK. 占位符，通常用于 ACK 实例 抓取所有经过 eth1，目的地址是 192.168.1.254 或 192.168.1.200 端口是 80 的 TCP 数据：\nsudo tcpdump -i eth1 \u0026#39;((tcp) and (port 80) and ((dst host 192.168.1.254) or (dst host 192.168.1.200)))\u0026#39; 抓取所有经过 eth1，目的网络是 192.168，但目的主机不是 192.168.1.200 的 TCP 数据：\nsudo tcpdump -i eth1 \u0026#39;((tcp) and ((dst net 192.168) and (not dst host 192.168.1.200)))\u0026#39; 只抓 SYN 包：\nsudo tcpdump -i eth1 \u0026#39;tcp[tcpflags] = tcp-syn\u0026#39; 抓 SYN, ACK：\nsudo tcpdump -i eth1 \u0026#39;tcp[tcpflags] \u0026amp; tcp-syn != 0 and tcp[tcpflags] \u0026amp; tcp-ack != 0\u0026#39; 抓 DNS 请求数据：\nsudo tcpdump -i en0 udp dst port 53 -c 参数对于运维人员来说也比较常用，因为流量比较大的服务器，靠人工 CTRL+C 还是抓的太多，于是可以用 -c 参数指定抓多少个包：\nsudo time tcpdump -nn -i en0 \u0026#39;tcp[tcpflags] = tcp-syn\u0026#39; -c 10000 \u0026gt; /dev/null 实时抓取端口号 8000 的 GET 包，然后写入 GET.log：\nsudo tcpdump -i eth0 \u0026#39;((port 8000) and (tcp[(tcp[12]\u0026gt;\u0026gt;2):4]=0x47455420))\u0026#39; -nnAl -w /tmp/GET.log 三次握手 四次挥手 TCP 连接建立（三次握手） 客户端 A，服务器 B，初始序号 seq，确认号 ack。\n初始状态：B 处于监听状态，A 处于打开状态。\nA -\u0026gt; B : seq = x （A 向 B 发送连接请求报文段，A 进入同步发送状态 SYN-SENT） B -\u0026gt; A : ack = x + 1,seq = y （B 收到报文段，向 A 发送确认，B 进入同步收到状态 SYN-RCVD） A -\u0026gt; B : ack = y + 1 （A 收到 B 的确认后，再次确认，A 进入连接状态 ESTABLISHED） 连接后的状态：B 收到 A 的确认后，进入连接状态 ESTABLISHED。\n为什么要握手要三次？防止失效的连接请求突然传到服务器端，让服务器端误认为要建立连接。\nTCP 连接释放（四次挥手） A -\u0026gt; B : seq = u （A 发出连接释放报文段，进入终止等待 1 状态 FIN-WAIT-1） B -\u0026gt; A : ack = u + 1,seq = v （B 收到报文段，发出确认，TCP 处于半关闭，B 还可向 A 发数据，B 进入关闭等待状态 WAIT） B -\u0026gt; A : ack = u + 1,seq = w （B 重复发送确认号，进入最后确认状态 LAST-ACK） A -\u0026gt; B : ack = w + 1,seq = u + 1 （A 发出确认，进入时间等待状态 TIME-WAIT） 经过时间等待计时器设置的时间 2MSL 后，A 才进入 CLOSED 状态。\n为什么 A 进入 TIME-WAIT 后必须等待 2MSL：\n保证 A 发送的最后一个 ACK 报文段能达到 B 防止失效的报文段出现在连接中 需要思考的问题 问题 1: 请详细描述三次握手和四次挥手的过程 要求熟悉三次握手和四次挥手的机制，要求画出状态图。\n问题 2: 四次挥手中 TIME_WAIT 状态存在的目的是什么? 这个问题是画出四次挥手状态图，会引申问你。不排除还会问为什么四次挥手是四次不是二次等问题。最好是把相关问题均掌握。\n问题 3: TCP 是通过什么机制保障可靠性的? 从四个方面进行回答，ACK 确认机制、超时重传、滑动窗口以及流量控制，深入的话要求详细讲出流量控制的机制。\n抓包分析握手过程 sudo tcpdump -i en0 host www.qq.com and tcp -S -c 50 References macOS 下使用 tcpdump 抓包 | jianshu tcpdump | readthedocs TCP 三次握手、四次挥手与 TcpDump 抓包分析 | 清泉白石 \u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2020/06/29/tcpdump-getting-started/","summary":"\u003cp\u003etcpdump 是 Unix/Linux 下的抓包工具，可以针对指定网卡、端口、协议进行抓包。\u003c/p\u003e\n\u003c!-- more --\u003e\n\u003ch2 id=\"字太多不看\"\u003e字太多不看\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo tcpdump host api.test and tcp port \u003cspan class=\"m\"\u003e80\u003c/span\u003e -A -nn\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo tcpdump dst api.test and tcp port \u003cspan class=\"m\"\u003e80\u003c/span\u003e -A\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"一举成名天下知\"\u003e一举成名天下知\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eman tcpdump\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"获取适配器列表\"\u003e获取适配器列表\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003etcpdump -D\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003etcpdump --list-interfaces\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e1.en0 \u003cspan class=\"o\"\u003e[\u003c/span\u003eUp, Running\u003cspan class=\"o\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e2.p2p0 \u003cspan class=\"o\"\u003e[\u003c/span\u003eUp, Running\u003cspan class=\"o\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e3.awdl0 \u003cspan class=\"o\"\u003e[\u003c/span\u003eUp, Running\u003cspan class=\"o\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e4.llw0 \u003cspan class=\"o\"\u003e[\u003c/span\u003eUp, Running\u003cspan class=\"o\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e5.utun0 \u003cspan class=\"o\"\u003e[\u003c/span\u003eUp, Running\u003cspan class=\"o\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e6.utun1 \u003cspan class=\"o\"\u003e[\u003c/span\u003eUp, Running\u003cspan class=\"o\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e7.utun2 \u003cspan class=\"o\"\u003e[\u003c/span\u003eUp, Running\u003cspan class=\"o\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e8.en5 \u003cspan class=\"o\"\u003e[\u003c/span\u003eUp, Running\u003cspan class=\"o\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e9.lo0 \u003cspan class=\"o\"\u003e[\u003c/span\u003eUp, Running, Loopback\u003cspan class=\"o\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e10.bridge0 \u003cspan class=\"o\"\u003e[\u003c/span\u003eUp, Running\u003cspan class=\"o\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e11.en1 \u003cspan class=\"o\"\u003e[\u003c/span\u003eUp, Running\u003cspan class=\"o\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e12.en2 \u003cspan class=\"o\"\u003e[\u003c/span\u003eUp, Running\u003cspan class=\"o\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e13.en3 \u003cspan class=\"o\"\u003e[\u003c/span\u003eUp, Running\u003cspan class=\"o\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e14.en4 \u003cspan class=\"o\"\u003e[\u003c/span\u003eUp, Running\u003cspan class=\"o\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e15.gif0 \u003cspan class=\"o\"\u003e[\u003c/span\u003enone\u003cspan class=\"o\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e16.stf0 \u003cspan class=\"o\"\u003e[\u003c/span\u003enone\u003cspan class=\"o\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e17.XHC0 \u003cspan class=\"o\"\u003e[\u003c/span\u003enone\u003cspan class=\"o\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e18.XHC1 \u003cspan class=\"o\"\u003e[\u003c/span\u003enone\u003cspan class=\"o\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e19.ap1 \u003cspan class=\"o\"\u003e[\u003c/span\u003enone\u003cspan class=\"o\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e20.XHC20 \u003cspan class=\"o\"\u003e[\u003c/span\u003enone\u003cspan class=\"o\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e21.VHC128 \u003cspan class=\"o\"\u003e[\u003c/span\u003enone\u003cspan class=\"o\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"监听适配器\"\u003e监听适配器\u003c/h2\u003e\n\u003cp\u003eListen on interface.\u003c/p\u003e","title":"tcpdump 入门使用"},{"content":"最近在学习 Yii2 的源码，为了方便调试所以研究下 Laradock + PhpStorm + Xdubug 的配置。\n环境 macOS Laradock v10.0 请保证 Laradock 是最新的版本，可以减少不必要的麻烦。也推荐使用我精简过的项目 imzyf/my-dock | github。\n配置 Laradock vim .env WORKSPACE_INSTALL_XDEBUG=true PHP_FPM_INSTALL_XDEBUG=true 重新编译 php-fpm 和 workspace 容器：\ndocker-compose build php-fpm workspace 配置 PhpStorm 配置 Docker Preferences \u0026gt; Build, Execution, Deploymnent \u0026gt; Docker\n配置 PHP Preferences \u0026gt; Languages \u0026amp; Frameworks \u0026gt; PHP，PHP CLI Interpreter 点 ...\n点击 +，选择 From Docker, Vagrant\u0026hellip;\nDebugger 可以显示出 Xdebug。\n配置 Servers Preferences \u0026gt; Languages \u0026amp; Frameworks \u0026gt; PHP \u0026gt; Servers\n注意：Name 必须填写 Laradock 中的 PHP_IDE_CONFIG 也就就是 laradock。\n配置 Xdebug Preferences \u0026gt; Languages \u0026amp; Frameworks \u0026gt; PHP \u0026gt; Debug。点击 Validate，填写。\nrun \u0026gt; Edit Configurations，添加 PHP Remote Debug。IDE key 为 PHPSTORM。\n配置 Chrome 下载插件 Xdebug helper，右键图标 配置。\nenjoy 开启 debug，然后访问页面。\n芜湖起飞。\nReferences Laradock 使用 PhpStorm Debug 代码 | learnku Set Debugger Using Xdebug With PHPStorm \u0026amp; Laradock | medium \u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2020/05/26/config-laradock-phpstorm-xdubug/","summary":"\u003cp\u003e最近在学习 Yii2 的源码，为了方便调试所以研究下 Laradock + PhpStorm + Xdubug 的配置。\u003c/p\u003e\n\u003ch2 id=\"环境\"\u003e环境\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003emacOS\u003c/li\u003e\n\u003cli\u003eLaradock v10.0\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e请保证 Laradock 是最新的版本，可以减少不必要的麻烦。也推荐使用我精简过的项目 \u003ca href=\"https://github.com/imzyf/my-dock\"\u003eimzyf/my-dock | github\u003c/a\u003e。\u003c/p\u003e\n\u003c!-- more --\u003e\n\u003ch2 id=\"配置-laradock\"\u003e配置 Laradock\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003evim .env\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003eWORKSPACE_INSTALL_XDEBUG\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"nb\"\u003etrue\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003ePHP_FPM_INSTALL_XDEBUG\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"nb\"\u003etrue\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e重新编译 php-fpm 和 workspace 容器：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edocker-compose build php-fpm workspace\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"配置-phpstorm\"\u003e配置 PhpStorm\u003c/h2\u003e\n\u003ch3 id=\"配置-docker\"\u003e配置 Docker\u003c/h3\u003e\n\u003cp\u003ePreferences \u0026gt; Build, Execution, Deploymnent \u0026gt; Docker\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"docker\" loading=\"lazy\" src=\"https://user-images.githubusercontent.com/9289792/82999144-302d2100-a03b-11ea-8a21-08bc67838fc2.png\"\u003e\u003c/p\u003e\n\u003ch3 id=\"配置-php\"\u003e配置 PHP\u003c/h3\u003e\n\u003cp\u003ePreferences \u0026gt; Languages \u0026amp; Frameworks \u0026gt; PHP，PHP CLI Interpreter 点 \u003ccode\u003e...\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"php 1\" loading=\"lazy\" src=\"https://user-images.githubusercontent.com/9289792/82997395-e7746880-a038-11ea-98ca-d68052d5bd22.png\"\u003e\u003c/p\u003e\n\u003cp\u003e点击 +，选择 From Docker, Vagrant\u0026hellip;\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"php 2\" loading=\"lazy\" src=\"https://user-images.githubusercontent.com/9289792/82997724-55209480-a039-11ea-8235-4a0479aeb832.png\"\u003e\u003c/p\u003e","title":"配置 Laradock PhpStorm Xdubug"},{"content":"实例 1 $a = 1.1; var_dump(gettype($a)); // string(6) \u0026#34;double\u0026#34; var_dump($a); // float(1.1) 实例 2 $a = \u0026#34;123456789.1100110011\u0026#34;; $a = (float) $a; var_dump($a); // float(123456789.11001) var_dump(sprintf(\u0026#39;%.11f\u0026#39;, $a)); // string(21) \u0026#34;123456789.11001099646\u0026#34; $b = 123456789.11001; var_dump($b); // float(123456789.11001) var_dump(sprintf(\u0026#39;%.11f\u0026#39;, $b)); // string(21) \u0026#34;123456789.11000999808\u0026#34; $c = \u0026#39;123456789.1100110011\u0026#39;; $c = (float) $c; var_dump($c); // float(123456789.11001) $c = (string) $c; var_dump($c); // string(15) \u0026#34;123456789.11001\u0026#34; $c = (float) $c; var_dump($c); // float(123456789.11001) var_dump(sprintf(\u0026#39;%.11f\u0026#39;, $c)); // string(21) \u0026#34;123456789.11000999808\u0026#34; var_dump($a === $b); // bool(false) - 说明 $a 还是携带着 float 的精度 var_dump($b === $c); // bool(true) 实例 3 // # 1 var_dump(120085 === 1200.85 * 100); // bool(false) // # 2 var_dump(120085 == 1200.85 * 100); // bool(false) // # 3 var_dump(120081 == 1200.81 * 100); // bool(true) // # 4 var_dump(120085 - 1200.85 * 100); // float(1.4551915228367E-11) 实例 4 $a = 0.1; $b = 0.9; $c = 1; var_dump(($a + $b) == $c); // bool(true) var_dump(($c - $b) == $a); // bool(false) var_dump(sprintf(\u0026#39;%.20f\u0026#39;, $a + $b)); // string(22) \u0026#34;1.00000000000000000000\u0026#34; var_dump(sprintf(\u0026#39;%.20f\u0026#39;, $c - $b)); // string(22) \u0026#34;0.09999999999999997780\u0026#34; var_dump((0.5 - 0.25) === 0.25); // bool(true) 0.5 二进制 0.1，0.25 二进制 0.01 var_dump((0.25 + 0.25) === 0.5); // bool(true) 实例 5 $n = 19.99; dump($n * 100); // 1999.0 dump((int) ($n * 100)); // 1998 !!! dump((string) ($n * 100)); // \u0026#34;1999\u0026#34; dump((int) (string) ($n * 100)); // 1999 dump(round($n * 100)); // 1999.0 !!! dump((int) round($n * 100)); // 1999 分析 看文档：\ngettype | php.net Float 浮点型 | php.net 浮点型（也叫浮点数 float，双精度数 double 或实数 real） 浮点数的字长和平台相关，尽管通常最大值是 1.8e308 并具有 14 位十进制数字的精度（64 位 IEEE 格式）。 所以永远不要相信浮点数结果精确到了最后一位，也永远不要比较两个浮点数是否相等。如果确实需要更高的精度，应该使用任意精度数学函数或者 gmp 函数。\n实例 1：说明在 PHP 中 float 与 dobule 是一回事。在 C 级别，所有内容都存储为 double。\n实例 2、3：float 的比较结果是 视情况而定，永远不要相信浮点数结果精确到了最后一位。\n实例 4：出现这个问题是因为浮点数计算涉及精度，当浮点数转为二进制时有可能会造成精度丢失。\nArbitrary-precision arithmetic library for PHP https://github.com/brick/math 浮点数转二进制方法 整数部分采用除以 2 取余方法，小数部分采用乘以 2 取整方法。\n例如：把数字 8.5 转为二进制：\n整数部分是 8：\n8/2=4 8%2=0 4/2=2 4%2=0 2/2=1 2%2=0 1 比 2 小，因此不需要计算下去，整数 8 的二进制为 1000 小数部分是 0.5：\n0.5x2 = 1.0 因取整后小数部分为 0，因此不需要再计算下去，小数 0.5 的二进制为 0.1 8.5 的二进制为 1000.1。\n计算数字 0.9 的二进制：\n0.9x2 = 1.8 0.8x2 = 1.6 0.6x2 = 1.2 0.2x2 = 0.4 0.4x2 = 0.8 0.8x2 = 1.6 \u0026hellip; 之后不断循环下去，当截取精度为 N 时，N 后的数会被舍去，导致精度丢失。 实例 4 中 0.9 在转为二进制时精度丢失，导致比较时出现错误。\n你看似有穷的小数，在计算机的二进制表示里却是无穷的。\n计算数字 0.25 的二进制：\n0.25x2 = 0.5 0.5x2 = 1.0 0.25 的二进制为 0.01。\nfloat 比较方法 使用 round 方法处理后再比较 var_dump(120085 == round(1200.85 * 100)); // bool(true) var_dump(12008.5 === round(1200.85 * 10, 1)); // bool(true) var_dump(1200.85 === round(1200.8499999, 2)); // bool(true) 使用高精度运算方法 见文档 BC 数学 函数 | php.net。\nvar_dump((1 - 0.9) == 0.1); // bool(false) var_dump(bcsub(1, 0.9, 40) == 0.1); // bool(true) var_dump((float) bcsub(1, 0.9, 40) === 0.1); // bool(true) References PHP 浮点型与整型比较的小坑 | codecasts php 浮点数比较方法 | csdn PHP 浮点数的一个常见问题的解答 | laruence \u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2020/05/09/php-float-precision/","summary":"\u003ch2 id=\"实例-1\"\u003e实例 1\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$a\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mf\"\u003e1.1\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003egettype\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$a\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e \u003cspan class=\"c1\"\u003e// string(6) \u0026#34;double\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$a\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"c1\"\u003e// float(1.1)\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"实例-2\"\u003e实例 2\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$a\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;123456789.1100110011\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$a\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003efloat\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"nv\"\u003e$a\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$a\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"c1\"\u003e// float(123456789.11001)\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003esprintf\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;%.11f\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$a\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e \u003cspan class=\"c1\"\u003e// string(21) \u0026#34;123456789.11001099646\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$b\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mf\"\u003e123456789.11001\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$b\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"c1\"\u003e// float(123456789.11001)\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003esprintf\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;%.11f\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$b\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e \u003cspan class=\"c1\"\u003e// string(21) \u0026#34;123456789.11000999808\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$c\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;123456789.1100110011\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$c\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003efloat\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"nv\"\u003e$c\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$c\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"c1\"\u003e// float(123456789.11001)\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nv\"\u003e$c\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"nv\"\u003e$c\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$c\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"c1\"\u003e// string(15) \u0026#34;123456789.11001\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nv\"\u003e$c\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003efloat\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"nv\"\u003e$c\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$c\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"c1\"\u003e// float(123456789.11001)\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003esprintf\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;%.11f\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$c\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e \u003cspan class=\"c1\"\u003e// string(21) \u0026#34;123456789.11000999808\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$a\u003c/span\u003e \u003cspan class=\"o\"\u003e===\u003c/span\u003e \u003cspan class=\"nv\"\u003e$b\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"c1\"\u003e// bool(false) - 说明 $a 还是携带着 float 的精度\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$b\u003c/span\u003e \u003cspan class=\"o\"\u003e===\u003c/span\u003e \u003cspan class=\"nv\"\u003e$c\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"c1\"\u003e// bool(true)\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"实例-3\"\u003e实例 3\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// # 1\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e120085\u003c/span\u003e \u003cspan class=\"o\"\u003e===\u003c/span\u003e \u003cspan class=\"mf\"\u003e1200.85\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"mi\"\u003e100\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"c1\"\u003e// bool(false)\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// # 2\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e120085\u003c/span\u003e \u003cspan class=\"o\"\u003e==\u003c/span\u003e \u003cspan class=\"mf\"\u003e1200.85\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"mi\"\u003e100\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"c1\"\u003e// bool(false)\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// # 3\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e120081\u003c/span\u003e \u003cspan class=\"o\"\u003e==\u003c/span\u003e \u003cspan class=\"mf\"\u003e1200.81\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"mi\"\u003e100\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"c1\"\u003e// bool(true)\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// # 4\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e120085\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e \u003cspan class=\"mf\"\u003e1200.85\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"mi\"\u003e100\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"c1\"\u003e// float(1.4551915228367E-11)\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"实例-4\"\u003e实例 4\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$a\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mf\"\u003e0.1\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$b\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mf\"\u003e0.9\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$c\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e((\u003c/span\u003e\u003cspan class=\"nv\"\u003e$a\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"nv\"\u003e$b\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e==\u003c/span\u003e \u003cspan class=\"nv\"\u003e$c\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"c1\"\u003e// bool(true)\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e((\u003c/span\u003e\u003cspan class=\"nv\"\u003e$c\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e \u003cspan class=\"nv\"\u003e$b\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e==\u003c/span\u003e \u003cspan class=\"nv\"\u003e$a\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"c1\"\u003e// bool(false)\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003esprintf\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;%.20f\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$a\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"nv\"\u003e$b\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e \u003cspan class=\"c1\"\u003e// string(22) \u0026#34;1.00000000000000000000\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003esprintf\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;%.20f\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$c\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e \u003cspan class=\"nv\"\u003e$b\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e \u003cspan class=\"c1\"\u003e// string(22) \u0026#34;0.09999999999999997780\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e((\u003c/span\u003e\u003cspan class=\"mf\"\u003e0.5\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e \u003cspan class=\"mf\"\u003e0.25\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e===\u003c/span\u003e \u003cspan class=\"mf\"\u003e0.25\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"c1\"\u003e// bool(true) 0.5 二进制 0.1，0.25 二进制 0.01\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e((\u003c/span\u003e\u003cspan class=\"mf\"\u003e0.25\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"mf\"\u003e0.25\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e===\u003c/span\u003e \u003cspan class=\"mf\"\u003e0.5\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"c1\"\u003e// bool(true)\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"实例-5\"\u003e实例 5\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$n\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mf\"\u003e19.99\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003edump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$n\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"mi\"\u003e100\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"c1\"\u003e// 1999.0\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nx\"\u003edump\u003c/span\u003e\u003cspan class=\"p\"\u003e((\u003c/span\u003e\u003cspan class=\"nx\"\u003eint\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$n\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"mi\"\u003e100\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e \u003cspan class=\"c1\"\u003e// 1998 !!!\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nx\"\u003edump\u003c/span\u003e\u003cspan class=\"p\"\u003e((\u003c/span\u003e\u003cspan class=\"nx\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$n\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"mi\"\u003e100\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e \u003cspan class=\"c1\"\u003e// \u0026#34;1999\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nx\"\u003edump\u003c/span\u003e\u003cspan class=\"p\"\u003e((\u003c/span\u003e\u003cspan class=\"nx\"\u003eint\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$n\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"mi\"\u003e100\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e \u003cspan class=\"c1\"\u003e// 1999\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nx\"\u003edump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eround\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$n\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"mi\"\u003e100\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e \u003cspan class=\"c1\"\u003e// 1999.0 !!!\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nx\"\u003edump\u003c/span\u003e\u003cspan class=\"p\"\u003e((\u003c/span\u003e\u003cspan class=\"nx\"\u003eint\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"nx\"\u003eround\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$n\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"mi\"\u003e100\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e \u003cspan class=\"c1\"\u003e// 1999\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"分析\"\u003e分析\u003c/h2\u003e\n\u003cp\u003e看文档：\u003c/p\u003e","title":"PHP float 精度"},{"content":"2023-12-22：内容不再维护，推荐使用 Docker。\n环境 CentOS 7.4 PHP 5.6.40 下载 PHP 源码地址：https://www.php.net/releases/#5.6.40\ncd /tmp wget https://www.php.net/distributions/php-5.6.40.tar.gz --no-check-certificate tar zxvf php-5.6.40.tar.gz 安装相关库 yum groupinstall \u0026#34;Development tools\u0026#34; 配置 核心配置选项列表 | php.net\n# 查看配置参数 ./configure --help ./configure --help | grep openssl # 注意替换 --prefix ./configure --prefix=/usr/local/php56 \\ --with-openssl \\ --enable-mbstring \\ --enable-ftp 编译安装 # 4核编译 make clean \u0026amp;\u0026amp; make -j4 make install \u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2020/04/29/make-install-php-on-centos/","summary":"\u003cp\u003e2023-12-22：内容不再维护，推荐使用 Docker。\u003c/p\u003e\n\u003chr\u003e\n\u003ch2 id=\"环境\"\u003e环境\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eCentOS 7.4\u003c/li\u003e\n\u003cli\u003ePHP 5.6.40\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"下载-php\"\u003e下载 PHP\u003c/h2\u003e\n\u003cp\u003e源码地址：\u003ca href=\"https://www.php.net/releases/#5.6.40\"\u003ehttps://www.php.net/releases/#5.6.40\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003ecd\u003c/span\u003e /tmp\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ewget https://www.php.net/distributions/php-5.6.40.tar.gz --no-check-certificate\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003etar zxvf php-5.6.40.tar.gz\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"安装相关库\"\u003e安装相关库\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eyum groupinstall \u003cspan class=\"s2\"\u003e\u0026#34;Development tools\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"配置\"\u003e配置\u003c/h2\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ca href=\"https://www.php.net/manual/zh/configure.about.php\"\u003e核心配置选项列表 | php.net\u003c/a\u003e\u003c/p\u003e\u003c/blockquote\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# 查看配置参数\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e./configure --help\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e./configure --help \u003cspan class=\"p\"\u003e|\u003c/span\u003e grep openssl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# 注意替换 --prefix\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e./configure --prefix\u003cspan class=\"o\"\u003e=\u003c/span\u003e/usr/local/php56 \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e--with-openssl \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e--enable-mbstring \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e--enable-ftp\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"编译安装\"\u003e编译安装\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# 4核编译\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003emake clean \u003cspan class=\"o\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e make -j4\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003emake install\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u0026ndash; EOF \u0026ndash;\u003c/p\u003e","title":"在 CentOS 编译安装 PHP"},{"content":"2023-12-22：内容不再维护，推荐使用 Docker。\n环境 macOS 10.15.7 PHP 7.1.33 下载 PHP 源码地址：https://www.php.net/releases/#7.1.33\ncd /tmp wget https://www.php.net/distributions/php-7.1.33.tar.gz --no-check-certificate tar zxvf php-7.1.33.tar.gz 安装相关库 确保 Xcode 正确版本正常安装。\n# libiconv brew install libiconv # openssl brew install openssl # zlib 实现 GZIP 压缩页面 brew install zlib 配置编译安装 核心配置选项列表 | php.net\n# 查看配置参数 ./configure --help ./configure --help | grep openssl # 注意替换 --prefix # 按需进行调整 ./configure --prefix=/Users/yifan/php/php71 \\ --enable-bcmath \\ --enable-calendar \\ --enable-dba \\ --enable-debug \\ --enable-exif \\ --enable-ftp \\ --enable-fpm \\ --enable-mbregex \\ --enable-mbstring \\ --enable-mysqlnd \\ --enable-opcache-file \\ --enable-soap \\ --enable-sockets \\ --enable-zip \\ --with-curl=/usr/local/opt/curl \\ --with-freetype-dir=/usr/local/opt/freetype \\ --with-gd \\ --with-mysqli=mysqlnd \\ --with-pdo-mysql=mysqlnd \\ --with-iconv=/usr/local/opt/libiconv \\ --with-icu-dir=/usr/local/opt/icu4c \\ --with-jpeg-dir=/usr/local/opt/jpeg \\ --with-libzip \\ --with-openssl=/usr/local/opt/openssl@1.1 \\ --with-bz2=/usr/local/opt/bzip2 \\ --with-libxml-dir=/usr/local/opt/libxml2 \\ --with-zlib=/usr/local/opt/zlib # 4核编译 make clean \u0026amp;\u0026amp; make -j4 make install 安装常用库：\n[https://pecl.php.net/]\n./bin/pecl install grpc ./bin/pecl install rdkafka ./bin/pecl install redis ./bin/pecl install mongodb # PHP7.1 ./bin/pecl install https://pecl.php.net/get/mongodb-1.11.1.tgz ./bin/pecl install swoole # PHP7.1 ./bin/pecl install https://pecl.php.net/get/swoole-4.5.11.tgz 遇到的问题 \u0026ldquo;_libiconv\u0026rdquo;, referenced from Undefined symbols for architecture x86_64: \u0026#34;_libiconv\u0026#34;, referenced from: _php_iconv_string in iconv.o __php_iconv_strlen in iconv.o __php_iconv_substr in iconv.o __php_iconv_strpos in iconv.o __php_iconv_mime_encode in iconv.o __php_iconv_appendl in iconv.o _php_iconv_stream_filter_append_bucket in iconv.o ... ld: symbol(s) not found for architecture x86_64 clang: error: linker command failed with exit code 1 (use -v to see invocation) make: *** [sapi/cli/php] Error 1 解决方法：打开 Makefile 找到：\nEXTRA_LDFLAGS EXTRA_LDFLAGS_PROGRAM 删除后面的 -L/Library/Developer/CommandLineTools/SDKs/MacOSX.sdk/usr/lib 相关。\nmake clean \u0026amp;\u0026amp; make -j4 make install php --ri curl Please specify the install prefix of iconv with \u0026ndash;with-iconv=\u0026lt;DIR\u0026gt; brew install libiconv Cannot find OpenSSL\u0026rsquo;s configure: error: Cannot find OpenSSL\u0026rsquo;s \u0026lt;evp.h\u0026gt;\nbrew install openssl ./configure --with-openssl-dir=(brew --prefix openssl) error: implicit declaration of function \u0026lsquo;getpid\u0026rsquo; is invalid in C99 /Users/.../php/php-7.1.33/ext/zip/lib/mkstemp.c:75:8: error: implicit declaration of function \u0026#39;getpid\u0026#39; is invalid in C99 [-Werror,-Wimplicit-function-declaration] pid = getpid(); ^ 1 error generated. make: *** [ext/zip/lib/mkstemp.lo] Error 1 make: *** Waiting for unfinished jobs.... brew install libzip # ./configure add --with-libzip=(brew --prefix libzip) \\ reentrancy.c error: too few arguments to function call /Users/.../php/php-7.1.33/main/reentrancy.c:139:23: error: too few arguments to function call, expected 3, have 2 readdir_r(dirp, entry); ~~~~~~~~~ ^ /Library/Developer/CommandLineTools/SDKs/MacOSX.sdk/usr/include/dirent.h:110:1: note: \u0026#39;readdir_r\u0026#39; declared here int readdir_r(DIR *, struct dirent *, struct dirent **) __DARWIN_INODE64... ^ 1 error generated. make: *** [main/reentrancy.lo] Error 1 make: *** Waiting for unfinished jobs.... 查找：\n.../php-src/main/reentrancy.c int readdir_r(DIR *, struct dirent *, struct dirent **) eaddir_r(dirp, entry) 修改为：\nreaddir_r(dirp, entry) 修改为 readdir_r(dirp, entry, \u0026amp;entry) PEAR package PHP_Archive not installed opcache.a(shared_alloc_shm.o) has no symbols PEAR package PHP_Archive not installed: generated phar will require PHP\u0026#39;s phar extension be enabled. directorytreeiterator.inc clicommand.inc directorygraphiterator.inc invertedregexiterator.inc pharcommand.inc make: *** [ext/phar/phar.phar] Segmentation fault: 11 make: *** Waiting for unfinished jobs.... ./configure --without-pear --disable-phar 注意：不能加这个选项，会影响 composer 的使用。\nXCode 对编译的影响 请保证 Xcode 正确的版本安装，否则可能有异常情况。如果系统不是最新版本可以通过下面的链接安装指定版本。\n[https://developer.apple.com/download/all/?q=11.5]\nReferences Mac Pro 编译安装 PHP 5.6.21 及 问题汇总 | cnblogs PHP7 编译安装 | cloud.tencent Mac に php 7.0.3 を phpenv でインストールした時のメモ | qiita php Make 编译 PEAR package PHP_Archive not installed | cnblogs Mac 编译安装 php5.4.45 踩坑记录 1 | zhihu \u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2020/04/28/make-install-php-on-macos/","summary":"\u003cp\u003e2023-12-22：内容不再维护，推荐使用 Docker。\u003c/p\u003e\n\u003chr\u003e\n\u003ch2 id=\"环境\"\u003e环境\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003emacOS 10.15.7\u003c/li\u003e\n\u003cli\u003ePHP 7.1.33\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"下载-php\"\u003e下载 PHP\u003c/h2\u003e\n\u003cp\u003e源码地址：\u003ca href=\"https://www.php.net/releases/#7.1.33\"\u003ehttps://www.php.net/releases/#7.1.33\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003ecd\u003c/span\u003e /tmp\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ewget https://www.php.net/distributions/php-7.1.33.tar.gz --no-check-certificate\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003etar zxvf php-7.1.33.tar.gz\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"安装相关库\"\u003e安装相关库\u003c/h2\u003e\n\u003cp\u003e确保 Xcode 正确版本正常安装。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# libiconv\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ebrew install libiconv\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# openssl\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ebrew install openssl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# zlib 实现 GZIP 压缩页面\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ebrew install zlib\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"配置编译安装\"\u003e配置编译安装\u003c/h2\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ca href=\"https://www.php.net/manual/zh/configure.about.php\"\u003e核心配置选项列表 | php.net\u003c/a\u003e\u003c/p\u003e\u003c/blockquote\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# 查看配置参数\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e./configure --help\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e./configure --help \u003cspan class=\"p\"\u003e|\u003c/span\u003e grep openssl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# 注意替换 --prefix\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# 按需进行调整\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e./configure --prefix\u003cspan class=\"o\"\u003e=\u003c/span\u003e/Users/yifan/php/php71 \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e--enable-bcmath \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e--enable-calendar \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e--enable-dba \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e--enable-debug \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e--enable-exif \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e--enable-ftp \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e--enable-fpm \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e--enable-mbregex \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e--enable-mbstring \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e--enable-mysqlnd \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e--enable-opcache-file \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e--enable-soap \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e--enable-sockets \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e--enable-zip \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e--with-curl\u003cspan class=\"o\"\u003e=\u003c/span\u003e/usr/local/opt/curl \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e--with-freetype-dir\u003cspan class=\"o\"\u003e=\u003c/span\u003e/usr/local/opt/freetype \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e--with-gd \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e--with-mysqli\u003cspan class=\"o\"\u003e=\u003c/span\u003emysqlnd \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e--with-pdo-mysql\u003cspan class=\"o\"\u003e=\u003c/span\u003emysqlnd \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e--with-iconv\u003cspan class=\"o\"\u003e=\u003c/span\u003e/usr/local/opt/libiconv \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e--with-icu-dir\u003cspan class=\"o\"\u003e=\u003c/span\u003e/usr/local/opt/icu4c \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e--with-jpeg-dir\u003cspan class=\"o\"\u003e=\u003c/span\u003e/usr/local/opt/jpeg \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e--with-libzip \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e--with-openssl\u003cspan class=\"o\"\u003e=\u003c/span\u003e/usr/local/opt/openssl@1.1 \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e--with-bz2\u003cspan class=\"o\"\u003e=\u003c/span\u003e/usr/local/opt/bzip2 \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e--with-libxml-dir\u003cspan class=\"o\"\u003e=\u003c/span\u003e/usr/local/opt/libxml2 \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e--with-zlib\u003cspan class=\"o\"\u003e=\u003c/span\u003e/usr/local/opt/zlib\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# 4核编译\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003emake clean \u003cspan class=\"o\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e make -j4\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003emake install\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e安装常用库：\u003c/p\u003e","title":"在 macOS 编译安装 PHP"},{"content":"常用 全选（高亮显示）：按 esc 后，然后 ggvG 或者 ggVG 全部复制：按 esc 后，然后 ggyG 全部删除：按 esc 后，然后 dG 粘贴到终端 vim 缩进错乱 https://stackoverflow.com/questions/2514445/turning-off-auto-indent-when-pasting-text-into-vim/38258720#38258720\n在 vim 中粘贴前先输入：\n:set paste 原因：在终端的 vim 中没有相应的程序来处理这个从其他应用复制粘贴的过程，所以 vim 通过插入键盘输入的 buffer 来模拟这个粘贴的过程，这个时候 vim 会以为这是用户输入的。\n问题就是出在这：当上一行结束，光标进入下一行时 vim 会自动以上一行的的缩进为初始位置。这样就会破坏原始文件的缩进。\n基础命令 gg 是让光标移到首行，在 vim 才有效，vi 中无效 G 光标移到最后一行 d 删除选中内容 y 复制选中内容到 0 号寄存器 References vim 全选，全部复制，全部删除 | cnblogs 用 vim 打开后中文乱码怎么办？ | zhihu \u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2020/04/28/vim-code-snippet/","summary":"\u003ch2 id=\"常用\"\u003e常用\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e全选（高亮显示）：按 esc 后，然后 \u003ccode\u003eggvG\u003c/code\u003e 或者 \u003ccode\u003eggVG\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e全部复制：按 esc 后，然后 \u003ccode\u003eggyG\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e全部删除：按 esc 后，然后 \u003ccode\u003edG\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"粘贴到终端-vim-缩进错乱\"\u003e粘贴到终端 vim 缩进错乱\u003c/h2\u003e\n\u003cp\u003e\u003ca href=\"https://stackoverflow.com/questions/2514445/turning-off-auto-indent-when-pasting-text-into-vim/38258720#38258720\"\u003ehttps://stackoverflow.com/questions/2514445/turning-off-auto-indent-when-pasting-text-into-vim/38258720#38258720\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e在 vim 中粘贴前先输入：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e:set paste\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e原因：在终端的 vim 中没有相应的程序来处理这个从其他应用复制粘贴的过程，所以 vim 通过插入键盘输入的 buffer 来模拟这个粘贴的过程，这个时候 vim 会以为这是用户输入的。\u003c/p\u003e\n\u003cp\u003e问题就是出在这：当上一行结束，光标进入下一行时 vim 会自动以上一行的的缩进为初始位置。这样就会破坏原始文件的缩进。\u003c/p\u003e\n\u003ch2 id=\"基础命令\"\u003e基础命令\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003egg\u003c/code\u003e 是让光标移到首行，在 vim 才有效，vi 中无效\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eG\u003c/code\u003e 光标移到最后一行\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003ed\u003c/code\u003e 删除选中内容\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003ey\u003c/code\u003e 复制选中内容到 0 号寄存器\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"references\"\u003eReferences\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.cnblogs.com/yangzailu/p/11531972.html\"\u003evim 全选，全部复制，全部删除 | cnblogs\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.zhihu.com/question/22363620\"\u003e用 vim 打开后中文乱码怎么办？ | zhihu\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u0026ndash; EOF \u0026ndash;\u003c/p\u003e","title":"vim Code Snippet"},{"content":"GD 安装、配置 考虑到功能需要使用字体库、图像格式 jpeg\\png 所以先安装相关库。\n字体库 FreeType 2 https://www.freetype.org/\n# 在临时目录进行操作 cd /tmp # https://download.savannah.gnu.org/releases/freetype/ wget http://download.savannah.gnu.org/releases/freetype/freetype-2.10.1.tar.gz tar zxvf freetype-2.10.1.tar.gz cd freetype-2.10.1 ./configure --prefix=/usr/local/freetype \u0026amp;\u0026amp; make \u0026amp;\u0026amp; make install 图像格式 jpeg cd /tmp # http://www.ijg.org/ wget http://www.ijg.org/files/jpegsrc.v9d.tar.gz tar zxvf jpegsrc.v9.tar.gz cd jpeg-9/ ./configure --prefix=/usr/local/jpeg \u0026amp;\u0026amp; make \u0026amp;\u0026amp; make install 图像格式 png cd /tmp # http://www.libpng.org/pub/png/libpng.html wget https://download.sourceforge.net/libpng/libpng-1.6.37.tar.gz --no-check-certificate tar zxvf libpng-1.6.37.tar.gz cd libpng-1.6.37 ./configure --prefix=/usr/local/libpng \u0026amp;\u0026amp; make \u0026amp;\u0026amp; make install 安装 GD 背景：服务器 php 7.1 通过编译自行安装的。\n# 到 php 源码 dir cd {php-source-dir}/ext/gd/ # 生成 configure 文件 {php-dir}/bin/phpize # 查看可用参数 ./configure --help # 设置参数 ./configure --with-php-config={php-dir}/bin/php-config --with-jpeg-dir=/usr/local/jpeg --with-png-dir=/usr/local/libpng --with-freetype-dir=/usr/local/freetype --enable-gd-native-ttf make \u0026amp;\u0026amp; make install vim {php-dir}/lib/php.ini # 最底下增加一行 extension=gd.so service php-fpm reload # 检查 php -r \u0026#34;var_dump(gd_info());\u0026#34; 编译前一定要记得 make clean 清除上次的编译内容，尤其是已经编译安装过的。\n实例 $pic = imagecreate($maxWidth, $maxHeight); //定义颜色 $black = imagecolorallocate($pic, 0, 0, 0); $white = imagecolorallocate($pic, 255, 255, 255); // 白底 imagefill($pic, 0, 0, $white); // 打水印 imagettftext($pic, $fontSize, 30, $x, $y, $lightGrey, $fontFile, $mark); imagejpeg($pic, $resultPath, 100); imagedestroy($pic); 文字右对齐：\n// https://php.golaravel.com/function.imagettfbbox.html $bbox = imagettfbbox($fontSize, 0, $fontFile, $text); $offset = $colWidth - $bbox[2] - 50; imagettftext($pic, $fontSize, 0, $x + $offset, $y, $_color, $fontFile, $text); 遇到的报错 Call to undefined function imagettftext() 出现此问题应该就是 FreeType 没有装好，可参考上面的步骤。\nReferences php 中文手册 | golaravel PHP Fatal error: Call to undefined function imagettftext() | stackoverflow \u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2020/04/16/php-gd-getting-started/","summary":"\u003ch2 id=\"gd-安装配置\"\u003eGD 安装、配置\u003c/h2\u003e\n\u003cp\u003e考虑到功能需要使用字体库、图像格式 jpeg\\png 所以先安装相关库。\u003c/p\u003e\n\u003ch3 id=\"字体库-freetype-2\"\u003e字体库 FreeType 2\u003c/h3\u003e\n\u003cp\u003e\u003ca href=\"https://www.freetype.org/\"\u003ehttps://www.freetype.org/\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# 在临时目录进行操作\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003ecd\u003c/span\u003e /tmp\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# https://download.savannah.gnu.org/releases/freetype/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ewget http://download.savannah.gnu.org/releases/freetype/freetype-2.10.1.tar.gz\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003etar zxvf freetype-2.10.1.tar.gz\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003ecd\u003c/span\u003e freetype-2.10.1\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e./configure --prefix\u003cspan class=\"o\"\u003e=\u003c/span\u003e/usr/local/freetype \u003cspan class=\"o\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e make \u003cspan class=\"o\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e make install\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"图像格式-jpeg\"\u003e图像格式 jpeg\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003ecd\u003c/span\u003e /tmp\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# http://www.ijg.org/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ewget http://www.ijg.org/files/jpegsrc.v9d.tar.gz\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003etar zxvf jpegsrc.v9.tar.gz\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003ecd\u003c/span\u003e jpeg-9/\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e./configure --prefix\u003cspan class=\"o\"\u003e=\u003c/span\u003e/usr/local/jpeg \u003cspan class=\"o\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e make \u003cspan class=\"o\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e make install\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"图像格式-png\"\u003e图像格式 png\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003ecd\u003c/span\u003e /tmp\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# http://www.libpng.org/pub/png/libpng.html\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ewget https://download.sourceforge.net/libpng/libpng-1.6.37.tar.gz --no-check-certificate\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003etar zxvf libpng-1.6.37.tar.gz\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003ecd\u003c/span\u003e libpng-1.6.37\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e./configure --prefix\u003cspan class=\"o\"\u003e=\u003c/span\u003e/usr/local/libpng \u003cspan class=\"o\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e make \u003cspan class=\"o\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e make install\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"安装-gd\"\u003e安装 GD\u003c/h3\u003e\n\u003cp\u003e\u003cimg alt=\"GD 安装、配置\" loading=\"lazy\" src=\"https://user-images.githubusercontent.com/9289792/80169757-e35bc200-8618-11ea-8851-a4bc7411f6f9.png\"\u003e\u003c/p\u003e","title":"PHP GD 入门使用"},{"content":"PHP Sandbox Online PHP editor | 3v4l.org PHP Sandbox | onlinephp.io PHP.net Supported Versions | PHP.net Unsupported Branches | PHP.net References PHP News, Articles, Upcoming Changes, and more | PHP.Watch Laravel illuminate # https://github.com/illuminate/database/blob/master/README.md $capsule = new Capsule(); $capsule-\u0026gt;addConnection($this-\u0026gt;dbConfig); $capsule-\u0026gt;setAsGlobal(); // Setup the Eloquent ORM... (optional; unless you\u0026#39;ve used setEventDispatcher()) $capsule-\u0026gt;bootEloquent(); $capsule-\u0026gt;getDatabaseManager()-\u0026gt;extend(\u0026#39;mongodb\u0026#39;, function ($config, $name) { $config[\u0026#39;name\u0026#39;] = $name; return new \\Jenssegers\\Mongodb\\Connection($config); }); 参数查看 # 查看 PHP 编译时的参数 php -r \u0026#34;phpinfo();\u0026#34; | grep configure # 查看 .ini 配置文件路径 php --ini php -r \u0026#34;phpinfo();\u0026#34; | grep \u0026#34;Configuration File\u0026#34; # 查看 Modules php -m # 显示扩展配置 php --ri gd # 检查扩展是否存在 php --re decimal # 交互式运行模式。具有函数、常量、类名、变量、静态方法调用和类常量的 `tab` 补全功能 # http://php.net/manual/en/features.commandline.interactive.php php -a 查看、修改内存限制 php -r \u0026#34;echo ini_get(\u0026#39;memory_limit\u0026#39;);\u0026#34; php -r \u0026#34;phpinfo();\u0026#34; | grep memory memory_limit = 1024M; // 临时设置最大内存占用 ini_set(\u0026#39;memory_limit\u0026#39;, \u0026#39;1024M\u0026#39;); // 设置脚本最大执行时间为 0 永不过期 set_time_limit(0); Too Many Open Files PHP-FPM Too Many Open Files 24 Error (set open file descriptor limit)\nvim php-fpm.conf ;rlimit_files = 1024 rlimit_files = 4096 重启 PHP-FPM。\nComposer aliyun repo 阿里云 Composer 全量镜像\ncomposer config -g repo.packagist composer https://mirrors.aliyun.com/composer/ \u0026#34;config\u0026#34;: { \u0026#34;disable-tls\u0026#34;: true, \u0026#34;gitlab-domains\u0026#34;: [], \u0026#34;optimize-autoloader\u0026#34;: true, \u0026#34;preferred-install\u0026#34;: { \u0026#34;*\u0026#34;: \u0026#34;dist\u0026#34; } \u0026#34;secure-http\u0026#34;: false, \u0026#34;sort-packages\u0026#34;: true, }, \u0026#34;repositories\u0026#34;: [ { \u0026#34;type\u0026#34;: \u0026#34;cvs\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;...\u0026#34; }, { \u0026#34;type\u0026#34;: \u0026#34;composer\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://mirrors.tencent.com/composer/\u0026#34; }, { \u0026#34;type\u0026#34;: \u0026#34;composer\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://mirrors.aliyun.com/composer/\u0026#34; }, { \u0026#34;type\u0026#34;: \u0026#34;composer\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://asset-packagist.org\u0026#34; } ] 忽略 php 版本限制 这个是极不推荐的，这样会造成库安装的版本错误。不应该使用。\ncomposer require hellogerard/jobby --ignore-platform-reqs 推荐做法：\nwhich composer # /usr/local/bin/composer {正确的 PHP 版本}/bin/php /usr/local/bin/composer require hellogerard/jobby /usr/local/opt/php@7.1/bin/php -d memory_limit=-1 /usr/local/bin/composer update -vvv emory-limit-errors for more info on how to handle out of memory errors php -d memory_limit=-1 /usr/local/bin/composer update 更新 composer.lock 若项目之前已通过其他源安装，则需要更新 composer.lock 文件：\ncomposer update --lock homebrew PHP How to Install/Upgrade PHP 8.3 on MacOS with Homebrew | PHP.Watch\nshivammathur/homebrew-php\nbrew tap shivammathur/php brew install shivammathur/php/php@8.1 -vvv brew link --overwrite --force shivammathur/php/php@8.1 php -v 旧版本 MacOS 可以安装报错时尝试删除 XCode。\nbrew untap shivammathur/php shivammathur/homebrew-extensions nicoverbruggen/phpmon phpbrew/phpbrew 多 PHP 版本管理 https://ostechnix.com/how-to-switch-between-multiple-php-versions-in-ubuntu/ Managing Multiple PHP versions via the ondrej/php PPA update-alternatives(1) — Linux manual page Real Client IP function getRealClientIP(): string { // List of headers to check for IP address $ipHeaders = [ \u0026#39;HTTP_CLIENT_IP\u0026#39;, \u0026#39;HTTP_X_FORWARDED_FOR\u0026#39;, \u0026#39;HTTP_X_FORWARDED\u0026#39;, \u0026#39;HTTP_X_CLUSTER_CLIENT_IP\u0026#39;, \u0026#39;HTTP_FORWARDED_FOR\u0026#39;, \u0026#39;HTTP_FORWARDED\u0026#39;, \u0026#39;REMOTE_ADDR\u0026#39; ]; foreach ($ipHeaders as $header) { if (!empty($_SERVER[$header])) { // Split for multiple IP addresses $ips = explode(\u0026#39;,\u0026#39;, $_SERVER[$header]); // Return the first non-empty value foreach ($ips as $ip) { $ip = trim($ip); if (filter_var($ip, FILTER_VALIDATE_IP, FILTER_FLAG_NO_PRIV_RANGE | FILTER_FLAG_NO_RES_RANGE)) { return $ip; } } } } // Fallback to REMOTE_ADDR if no valid IP found return $_SERVER[\u0026#39;REMOTE_ADDR\u0026#39;] ?? \u0026#39;0.0.0.0\u0026#39;; } 动态实例化类 class Test1{ public function __construct(){ echo \u0026#34;Test1\u0026lt;br\u0026gt;\u0026#34;; } } // 方法一 $class1 = \u0026#34;Test1\u0026#34;; new $class1(); // 方法二 $class2 = \u0026#34;Test2\u0026#34;; // 建立类的反射 $class2 = new ReflectionClass($class2); // 相当于实例化类 $instance = $class2-\u0026gt;newInstance(); PHPStan class Foo { public const WHEELER = [ \u0026#39;car\u0026#39; =\u0026gt; 4, \u0026#39;bike\u0026#39; =\u0026gt; 2, ]; } /** * @param key-of\u0026lt;Foo::WHEELER\u0026gt; $type * @param value-of\u0026lt;Foo::WHEELER\u0026gt; $wheels */ function repair(string $type, int $wheels): void { // $type is \u0026#39;bike\u0026#39;|\u0026#39;car\u0026#39; // $wheels is 2|4 } repair(\u0026#34;bus\u0026#34;, 2); // Parameter #1 $type of function repair expects \u0026#39;bike\u0026#39;|\u0026#39;car\u0026#39;, \u0026#39;bus\u0026#39; given. \u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2020/04/15/php-code-snippet/","summary":"\u003ch2 id=\"php-sandbox\"\u003ePHP Sandbox\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://3v4l.org/\"\u003eOnline PHP editor | 3v4l.org\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://onlinephp.io/\"\u003ePHP Sandbox | onlinephp.io\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"phpnet\"\u003ePHP.net\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.php.net/supported-versions.php\"\u003eSupported Versions | PHP.net\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.php.net/eol.php\"\u003eUnsupported Branches | PHP.net\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"references\"\u003eReferences\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://php.watch/\"\u003ePHP News, Articles, Upcoming Changes, and more | PHP.Watch\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"laravel-illuminate\"\u003eLaravel illuminate\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# https://github.com/illuminate/database/blob/master/README.md\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nv\"\u003e$capsule\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003eCapsule\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$capsule\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"na\"\u003eaddConnection\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$this\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"na\"\u003edbConfig\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$capsule\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"na\"\u003esetAsGlobal\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Setup the Eloquent ORM... (optional; unless you\u0026#39;ve used setEventDispatcher())\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nv\"\u003e$capsule\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"na\"\u003ebootEloquent\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$capsule\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"na\"\u003egetDatabaseManager\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"na\"\u003eextend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;mongodb\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003efunction\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$config\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$name\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nv\"\u003e$config\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;name\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nv\"\u003e$name\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003e\\Jenssegers\\Mongodb\\Connection\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$config\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e});\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"参数查看\"\u003e参数查看\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# 查看 PHP 编译时的参数\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ephp -r \u003cspan class=\"s2\"\u003e\u0026#34;phpinfo();\u0026#34;\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e grep configure\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# 查看 .ini 配置文件路径\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ephp --ini\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ephp -r \u003cspan class=\"s2\"\u003e\u0026#34;phpinfo();\u0026#34;\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e grep \u003cspan class=\"s2\"\u003e\u0026#34;Configuration File\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# 查看 Modules\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ephp -m\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# 显示扩展配置\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ephp --ri gd\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# 检查扩展是否存在\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ephp --re decimal\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# 交互式运行模式。具有函数、常量、类名、变量、静态方法调用和类常量的 `tab` 补全功能\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# http://php.net/manual/en/features.commandline.interactive.php\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ephp -a\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"查看修改内存限制\"\u003e查看、修改内存限制\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ephp -r \u003cspan class=\"s2\"\u003e\u0026#34;echo ini_get(\u0026#39;memory_limit\u0026#39;);\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ephp -r \u003cspan class=\"s2\"\u003e\u0026#34;phpinfo();\u0026#34;\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e grep memory\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-ini\" data-lang=\"ini\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"na\"\u003ememory_limit\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e1024M;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 临时设置最大内存占用\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nx\"\u003eini_set\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;memory_limit\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;1024M\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 设置脚本最大执行时间为 0 永不过期\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nx\"\u003eset_time_limit\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"too-many-open-files\"\u003eToo Many Open Files\u003c/h3\u003e\n\u003cblockquote\u003e\n\u003cp\u003ePHP-FPM Too Many Open Files 24 Error (set open file descriptor limit)\u003c/p\u003e","title":"PHP Code Snippet"},{"content":"Illegal mix of collations (utf8mb4_general_ci,IMPLICIT) and (utf8mb4_unicode_ci,IMPLICIT) for operation utf8mb4_unicode_ci 和 utf8_general_ci 列不能混合查询\n解决方法 1 统一字段 varchar 的编码集，我推荐使用 utf8mb4_unicode_ci。\n解决方法 2 在查询 SQL 中需要转化的字段后面加 COLLATE utf8mb4_unicode_ci.\n对比 准确性：\nutf8mb4_unicode_ci 是基于标准的 Unicode 来排序和比较，能够在各种语言之间精确排序。 utf8mb4_general_ci 没有实现 Unicode 排序规则，在遇到某些特殊语言或者字符集，排序结果可能不一致。 性能：\nutf8mb4_unicode_ci 在特殊情况下，Unicode 排序规则为了能够处理特殊字符的情况，实现了略微复杂的排序算法。但是在绝大多数情况下发，不会发生此类复杂比较。相比选择哪一 collation，使用者更应该关心字符集与排序规则在 db 里需要统一。 utf8mb4_general_ci 在比较和排序的时候更快。 utf8mb4 mb4 是 most bytes 4 的意思，专门用来兼容四字节的 unicode。\nReferences Illegal mix of collations | 少年阿斌 \u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2020/04/14/mysql-illegal-mix-of-collations/","summary":"\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sql\" data-lang=\"sql\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003eIllegal\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003emix\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eof\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ecollations\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eutf8mb4_general_ci\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"k\"\u003eIMPLICIT\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eand\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eutf8mb4_unicode_ci\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"k\"\u003eIMPLICIT\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003efor\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eoperation\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c!-- more --\u003e\n\u003cp\u003e\u003ccode\u003eutf8mb4_unicode_ci\u003c/code\u003e 和 \u003ccode\u003eutf8_general_ci\u003c/code\u003e 列不能混合查询\u003c/p\u003e\n\u003ch2 id=\"解决方法-1\"\u003e解决方法 1\u003c/h2\u003e\n\u003cp\u003e统一字段 varchar 的编码集，我推荐使用 \u003ccode\u003eutf8mb4_unicode_ci\u003c/code\u003e。\u003c/p\u003e\n\u003ch2 id=\"解决方法-2\"\u003e解决方法 2\u003c/h2\u003e\n\u003cp\u003e在查询 SQL 中需要转化的字段后面加 \u003ccode\u003eCOLLATE utf8mb4_unicode_ci\u003c/code\u003e.\u003c/p\u003e\n\u003ch2 id=\"对比\"\u003e对比\u003c/h2\u003e\n\u003cp\u003e准确性：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eutf8mb4_unicode_ci 是基于标准的 Unicode 来排序和比较，能够在各种语言之间精确排序。\u003c/li\u003e\n\u003cli\u003eutf8mb4_general_ci 没有实现 Unicode 排序规则，在遇到某些特殊语言或者字符集，排序结果可能不一致。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e性能：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eutf8mb4_unicode_ci 在特殊情况下，Unicode 排序规则为了能够处理特殊字符的情况，实现了略微复杂的排序算法。但是在绝大多数情况下发，不会发生此类复杂比较。相比选择哪一 collation，使用者更应该关心字符集与排序规则在 db 里需要统一。\u003c/li\u003e\n\u003cli\u003eutf8mb4_general_ci 在比较和排序的时候更快。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"utf8mb4\"\u003eutf8mb4\u003c/h2\u003e\n\u003cp\u003emb4 是 most bytes 4 的意思，专门用来兼容四字节的 unicode。\u003c/p\u003e\n\u003ch2 id=\"references\"\u003eReferences\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.cnblogs.com/wqbin/p/11852376.html\"\u003eIllegal mix of collations | 少年阿斌\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u0026ndash; EOF \u0026ndash;\u003c/p\u003e","title":"MySQL Illegal mix of collations"},{"content":"前后端分离的开发已是主流，本文主要是记录前后端分离项目的 NGINX 配置。\n前端 Vue web 入口 host.test 后端 PHP Yii service 入口 host.test/api server { listen 80; server_name host.test; root /data/project/web/dist/; index index.html index.php; location ^~/api { root /data/project/service/web/; access_log logs/service-access.log; error_log logs/service-error.log; fastcgi_pass 127.0.0.1:9000; include fastcgi.conf; fastcgi_param SCRIPT_FILENAME /data/project/service/web/index.php; fastcgi_param SCRIPT_NAME /api/index.php; } location /index.html { add_header Cache-Control \u0026#34;no-cache, no-store\u0026#34;; } location ^~ / { alias /data/project/web/dist/; access_log logs/web-access.log; error_log logs/web-error.log; } } 负载均衡场景 前端 Vue web 入口 host.test 后端 PHP Yii service 入口 host.test/api 代理到 api.host.test WEB server { listen 80; server_name host.test; root /data/project/web/dist/; access_log logs/web-access.log; error_log logs/web-error.log; location /index.html { add_header Cache-Control \u0026#34;no-cache, no-store\u0026#34;; } location / { index index.php index.html index.htm; try_files $uri $uri/ /index.html; } location ^~/api/ { proxy_set_header Host api.host.test; proxy_set_header X-Real-IP $remote_addr; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; proxy_set_header X-NginX-Proxy true; proxy_pass http://api.host.test/; } } SERVICE server { listen 80; server_name api.host.test; root /data/project/service/web/; location / { access_log logs/service-access.log; error_log logs/service-error.log; index index.php index.html; try_files $uri $uri/ /index.php$is_args$args; } location ~ \\.php$ { fastcgi_pass 127.0.0.1:10071; fastcgi_index index.php; include fastcgi_params; fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name; fastcgi_param SERVER_NAME $http_host; fastcgi_ignore_client_abort on; } } NGINX 配置转发 location 进行的是模糊匹配。\n当结尾没有 / 时，location /abc/def 可以匹配 /abc/defghi 请求，也可以匹配 /abc/def/ghi 等。 当结尾有 / 时，location /abc/def/ 不能匹配 /abc/defghi 请求，只能匹配 /abc/def/anything 这样的请求。 下面四种情况分别用 http://192.168.1.4/proxy/test.html 进行访问：\n第一种：\nlocation /proxy/ { proxy_pass http://127.0.0.1:81/; } 会被代理到 http://127.0.0.1:81/test.html。\n第二种（相对于第一种，最后少一个 /）：\nlocation /proxy/ { proxy_pass http://127.0.0.1:81; } 会被代理到 http://127.0.0.1:81/proxy/test.html。\n第三种：\nlocation /proxy/ { proxy_pass http://127.0.0.1:81/ftlynx/; } 会被代理到 http://127.0.0.1:81/ftlynx/test.html。\n第四种（相对于第三种，最后少一个 /）：\nlocation /proxy/ { proxy_pass http://127.0.0.1:81/ftlynx; } 会被代理到 http://127.0.0.1:81/ftlynxtest.html。\n\u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2020/03/17/nginx-front-back-end-config/","summary":"\u003cp\u003e前后端分离的开发已是主流，本文主要是记录前后端分离项目的 NGINX 配置。\u003c/p\u003e\n\u003c!-- more --\u003e\n\u003cul\u003e\n\u003cli\u003e前端 Vue web 入口 \u003ccode\u003ehost.test\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e后端 PHP Yii service 入口 \u003ccode\u003ehost.test/api\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode class=\"language-conf\" data-lang=\"conf\"\u003eserver {\n  listen 80;\n  server_name host.test;\n  root /data/project/web/dist/;\n  index index.html index.php;\n\n  location ^~/api {\n    root           /data/project/service/web/;\n\n    access_log     logs/service-access.log;\n    error_log      logs/service-error.log;\n\n    fastcgi_pass   127.0.0.1:9000;\n    include        fastcgi.conf;\n    fastcgi_param  SCRIPT_FILENAME   /data/project/service/web/index.php;\n    fastcgi_param  SCRIPT_NAME       /api/index.php;\n  }\n\n  location /index.html {\n    add_header Cache-Control \u0026#34;no-cache, no-store\u0026#34;;\n  }\n\n  location ^~ / {\n    alias /data/project/web/dist/;\n    access_log logs/web-access.log;\n    error_log logs/web-error.log;\n  }\n}\n\u003c/code\u003e\u003c/pre\u003e\u003ch2 id=\"负载均衡场景\"\u003e负载均衡场景\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e前端 Vue web 入口 \u003ccode\u003ehost.test\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e后端 PHP Yii service 入口 \u003ccode\u003ehost.test/api\u003c/code\u003e 代理到 \u003ccode\u003eapi.host.test\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"web\"\u003eWEB\u003c/h3\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode class=\"language-conf\" data-lang=\"conf\"\u003eserver {\n  listen 80;\n  server_name host.test;\n  root /data/project/web/dist/;\n\n  access_log logs/web-access.log;\n  error_log logs/web-error.log;\n\n  location /index.html {\n    add_header Cache-Control \u0026#34;no-cache, no-store\u0026#34;;\n  }\n\n  location / {\n    index index.php index.html index.htm;\n    try_files $uri $uri/ /index.html;\n  }\n\n  location ^~/api/ {\n    proxy_set_header Host             api.host.test;\n    proxy_set_header X-Real-IP        $remote_addr;\n    proxy_set_header X-Forwarded-For  $proxy_add_x_forwarded_for;\n    proxy_set_header X-NginX-Proxy    true;\n    proxy_pass http://api.host.test/;\n  }\n}\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"service\"\u003eSERVICE\u003c/h3\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode class=\"language-conf\" data-lang=\"conf\"\u003eserver {\n  listen 80;\n  server_name api.host.test;\n  root /data/project/service/web/;\n\n  location / {\n    access_log logs/service-access.log;\n    error_log logs/service-error.log;\n\n    index index.php index.html;\n    try_files $uri $uri/ /index.php$is_args$args;\n  }\n\n  location ~ \\.php$ {\n    fastcgi_pass    127.0.0.1:10071;\n\n    fastcgi_index   index.php;\n    include         fastcgi_params;\n    fastcgi_param   SCRIPT_FILENAME   $document_root$fastcgi_script_name;\n    fastcgi_param   SERVER_NAME       $http_host;\n    fastcgi_ignore_client_abort       on;\n  }\n}\n\u003c/code\u003e\u003c/pre\u003e\u003ch2 id=\"nginx-配置转发\"\u003eNGINX 配置转发\u003c/h2\u003e\n\u003cp\u003elocation 进行的是模糊匹配。\u003c/p\u003e","title":"NGINX 前后端分离配置"},{"content":" u1s1 本教程质量一般，推荐看看 李兴兴 老师的教程。\n用视频记录生活越来越普及，年初旅行也拍了些素材，想着自己也当个 up 主。先来学学 PR。【PR】Premiere Pro CC 2019 全套入门教程 | bilibili 是我在 B 站看的第一套教学视频，坦白说内容不多，有不少重复的东西，但是这样适合完全零基础的同学。\n课代表来收我的课后作业：【交作业】PR CC 2019 全套入门教程 课后作业 | 菲菲与帆 。\n我的一条 VLOG：【VLOG】#01 新年之旅 成都 第一日 | 菲菲与帆 欢迎来一键三连。\n01-基础流程 1、窗口乱了后：【窗口-工作区-编辑\u0026amp;重置为保存的布局】alt + shift + 0 2、【文字工具】加字幕 3、修改字体：【窗口-基础图形】选择编辑 4、【剃刀】剪切多余素材 5、本素材图片来自 http://unsample.net/\n02-转场效果 1、选择素材点击左键拖拽到【左下窗口】 右下的文件夹可以快速新建文件夹，方便素材分类 2、时序新建时，选择 HDV 720 3、ctrl + d 添加转场效果 4、【左下窗口】（项目窗口）选择【效果】视频过渡，可以切换效果 5、点击时序上的过渡，【左上窗口】选择【效果控件】，可以编辑转场效果的持续时间、对齐等\n03\u0026amp;04-视频转场特效\u0026amp;音频特效 1、【左上窗口】选择【效果控件】，可以编辑视频效果、过渡效果 2、视频效果，可以点击秒表的图标添加关键帧 3、新建时查看、修改【暂存盘】位置 4、【编辑-首选项-时间轴】可以修改：静止图片默认持续时间等， 已经导入的素材无效 5、【时序窗口】计时器可以点击编辑，输入 500 会跳到第 5 秒的位置 6、音频过渡，结尾声音淡出\n05\u0026amp;06-视频剪辑\u0026amp;音画对应 1、【左上窗口】点击 i 标记入点，点击 o 标记出点 2、【左上窗口】窗口右下角的 + 是按钮编辑器 3、【左上窗口】标记完成后可以点击 插入 或者 覆盖 4、【节目窗口】点击 m 可以标记 5、【节目窗口】窗口右下角的 +，添加转到下一个标记 6、转到下一个标记配合在时序上的标，踩点视频\n07\u0026amp;08-简单动画\u0026amp;素材嵌套 1、【左上窗口】效果控件，可以修改素材位置、缩放 2、【左上窗口】效果控件，点击小秒表可以添加关键帧动画 3、导出素材前可以修改静止图片默认持续时间 4、创建多个时序，再创建一个 master 时序，作为主时序 5、时序拖入时序时，注意点击前面的 V1 A1，否则可能只有视频或音频 6、【时序窗口】时序取消链接，可以删除音频轨 7、按 alt 键拖拽可以快速复制\n09\u0026amp;10\u0026amp;11-自定义转场\u0026amp;视频效果\u0026amp;变形和扭曲 1、使用 PS 制作灰度图，新建 颜色模式 灰度，图片要和视频尺寸一致 2、在线图片编辑 https://www.uupoop.com/ 3、图片使用 tiff 格式，原因不懂 4、视频过渡 擦除 渐变擦除，然后可以选择自己制作的图片 5、从【效果】可以选择后向上拖入【效果控件】 6、fx 可以开启或关闭效果，还有 清除、复制、粘贴 7、【项目窗口】新建 调整图层，可以给视频加一个整体的效果 8、要善于使用标记定位 9、视频效果：变形、扭曲\n12-模板的下载和使用 1、.mogrt 模板 2、导入方法 1：【图形】安装动态图形模板 3、导入方法 2：【窗口】基础图形，游览，右下角加号 4、导入方法 3：将模板文件复制到 Mac：username/Library/Application Support/Adobe/Common/motion Graphics Template/ Win：root://Users/Username/AppData/Roaming/Adobe/Common/Motion Graphics Templates 5、【基础图形】编辑，可以修改模板内容 6、按 enter 键，可以渲染视频\n13-标准模板的使用 1、.prproj 模板 2、【视图】显示标尺、显示参考线，方便对齐\n14\u0026amp;15-倒计数器及色彩调节\u0026amp;传统与图形字幕 1、【项目窗口】新建 通用倒计时片头，就是到 2 就没了 2、【向前选择轨道工具】ctrl + a 3、视频效果 扭曲 球面化 4、视频效果 扭曲 偏移 5、视频效果 杂色与颗粒 杂色 6、【文件】新建 字幕 开放式字幕\n\u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2020/03/13/prcc2019-getting-started-notes/","summary":"\u003cblockquote\u003e\n\u003cp\u003eu1s1 本教程质量一般，推荐看看 李兴兴 老师的教程。\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003e用视频记录生活越来越普及，年初旅行也拍了些素材，想着自己也当个 up 主。先来学学 PR。\u003ca href=\"https://www.bilibili.com/video/av37550078\"\u003e【PR】Premiere Pro CC 2019 全套入门教程 | bilibili\u003c/a\u003e 是我在 B 站看的第一套教学视频，坦白说内容不多，有不少重复的东西，但是这样适合完全零基础的同学。\u003c/p\u003e\n\u003c!-- more --\u003e\n\u003cp\u003e课代表来收我的课后作业：\u003ca href=\"https://www.bilibili.com/video/bv17E41157Pz\"\u003e【交作业】PR CC 2019 全套入门教程 课后作业 | 菲菲与帆\u003c/a\u003e 。\u003c/p\u003e\n\u003cp\u003e我的一条 VLOG：\u003ca href=\"https://www.bilibili.com/video/BV1K7411o73B\"\u003e【VLOG】#01 新年之旅 成都 第一日 | 菲菲与帆\u003c/a\u003e 欢迎来一键三连。\u003c/p\u003e\n\u003ciframe src=\"//player.bilibili.com/player.html?aid=97184760\u0026bvid=BV1K7411o73B\u0026cid=166268624\u0026page=1\" scrolling=\"no\" border=\"0\" frameborder=\"no\" framespacing=\"0\" allowfullscreen=\"true\" width=\"480px\" height=\"270px\"\u003e \u003c/iframe\u003e\n\u003ch2 id=\"01-基础流程\"\u003e01-基础流程\u003c/h2\u003e\n\u003cp\u003e1、窗口乱了后：【窗口-工作区-编辑\u0026amp;重置为保存的布局】\u003ccode\u003ealt + shift + 0\u003c/code\u003e\n2、【文字工具】加字幕\n3、修改字体：【窗口-基础图形】选择编辑\n4、【剃刀】剪切多余素材\n5、本素材图片来自 \u003ca href=\"http://unsample.net/\"\u003ehttp://unsample.net/\u003c/a\u003e\u003c/p\u003e\n\u003ch2 id=\"02-转场效果\"\u003e02-转场效果\u003c/h2\u003e\n\u003cp\u003e1、选择素材点击左键拖拽到【左下窗口】 右下的文件夹可以快速新建文件夹，方便素材分类\n2、时序新建时，选择 HDV 720\n3、\u003ccode\u003ectrl + d\u003c/code\u003e 添加转场效果\n4、【左下窗口】（项目窗口）选择【效果】视频过渡，可以切换效果\n5、点击时序上的过渡，【左上窗口】选择【效果控件】，可以编辑转场效果的持续时间、对齐等\u003c/p\u003e\n\u003ch2 id=\"0304-视频转场特效音频特效\"\u003e03\u0026amp;04-视频转场特效\u0026amp;音频特效\u003c/h2\u003e\n\u003cp\u003e1、【左上窗口】选择【效果控件】，可以编辑视频效果、过渡效果\n2、视频效果，可以点击秒表的图标添加关键帧\n3、新建时查看、修改【暂存盘】位置\n4、【编辑-首选项-时间轴】可以修改：静止图片默认持续时间等，\n已经导入的素材无效\n5、【时序窗口】计时器可以点击编辑，输入 500 会跳到第 5 秒的位置\n6、音频过渡，结尾声音淡出\u003c/p\u003e","title":"【PRCC2019 全套入门教程】笔记"},{"content":"2020-04-23 后记：疑似是前置的负载均衡服务器有问题，改为直接使用真实 IP 后问题消失。\nPHP Warning: ftp_put(): php_connect_nonb() failed: Operation now in progress (115) in ... 环境 PHP 5.6.40。在开发过程中遇到了一个很诡异的情况，在使用 FTP 函数上传文件时，会间歇性无法上传文件。找了几圈有说是 PHP bug、有说是防火墙，都不解决问题。\n最后找到了一篇 Why is my PHP script intermittently unable to upload a file via FTP? | stackoverflow 解了大急。（当搜索结果没有找到答案时，可以考虑换几个相近的词再试试）\n解决方法：进行循环调用尝试。\n// 尝试 5 次 $uploaded = false; $tries = 0; while (!$uploaded \u0026amp;\u0026amp; $tries \u0026lt;= 5) { ++$tries; $conn = ftp_ssl_connect($host, $port, 10) or die(\u0026#39;FTP服务器连接失败\u0026#39;); //登陆（通过用户名或者匿名登陆） $result = ftp_login($conn, $user, $password); if (!$result) { ftp_close($conn); die(\u0026#39;ftp_login 失败\u0026#39;); } ftp_set_option($conn, FTP_USEPASVADDRESS, false); // turn passive mode on ftp_pasv($conn, true); $success = ftp_put($conn, $remoteFile, $localFile, FTP_BINARY); if ($success) { $uploaded = true; dump(\u0026#34;ftp upload: $success, $remoteFile, $localFile\u0026#34;); } else { dump(\u0026#34;ftp upload failed, tries: $tries\u0026#34;); } ftp_close($conn); } 循环 try 第二次就成功了，不知为啥。PHP の FTP(S)通信で php_connect_nonb() failed: Operation now in progress (115) | qiita 这篇文章有分析，读后还是不太清楚，望有缘人来指导。\nどうやら Operation now in progress (115)は EINPROGRESS から来ているらしい。常に非同期で connect するため最初の connect で EINPROGRESS が帰るのは正常だが、asynchronous=true の場合その後同期処理のために poll で接続完了を待つ。だが poll はエラーが起きても errno を更新しないため、接続に失敗したとき errno=EINPROGRESS の状態で返ってしまっているように見える。\n\u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2020/02/27/php-ftp-intermittently-unable-upload/","summary":"\u003cp\u003e2020-04-23 后记：疑似是前置的负载均衡服务器有问题，改为直接使用真实 IP 后问题消失。\u003c/p\u003e\n\u003chr\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ePHP Warning:  ftp_put\u003cspan class=\"o\"\u003e()\u003c/span\u003e: php_connect_nonb\u003cspan class=\"o\"\u003e()\u003c/span\u003e failed: Operation now in progress \u003cspan class=\"o\"\u003e(\u003c/span\u003e115\u003cspan class=\"o\"\u003e)\u003c/span\u003e in ...\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c!-- more --\u003e\n\u003cp\u003e环境 \u003ccode\u003ePHP 5.6.40\u003c/code\u003e。在开发过程中遇到了一个很诡异的情况，在使用 FTP 函数上传文件时，会间歇性无法上传文件。找了几圈有说是 PHP bug、有说是防火墙，都不解决问题。\u003c/p\u003e\n\u003cp\u003e最后找到了一篇 \u003ca href=\"https://stackoverflow.com/questions/42439316/why-is-my-php-script-intermittently-unable-to-upload-a-file-via-ftp\"\u003eWhy is my PHP script intermittently unable to upload a file via FTP? | stackoverflow\u003c/a\u003e 解了大急。（当搜索结果没有找到答案时，可以考虑换几个相近的词再试试）\u003c/p\u003e\n\u003cp\u003e解决方法：进行循环调用尝试。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"c1\"\u003e// 尝试 5 次\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e  \u003cspan class=\"nv\"\u003e$uploaded\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003efalse\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nv\"\u003e$tries\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"k\"\u003ewhile\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e!\u003c/span\u003e\u003cspan class=\"nv\"\u003e$uploaded\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan class=\"nv\"\u003e$tries\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;=\u003c/span\u003e \u003cspan class=\"mi\"\u003e5\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      \u003cspan class=\"o\"\u003e++\u003c/span\u003e\u003cspan class=\"nv\"\u003e$tries\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      \u003cspan class=\"nv\"\u003e$conn\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003eftp_ssl_connect\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$host\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$port\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e10\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003eor\u003c/span\u003e \u003cspan class=\"k\"\u003edie\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;FTP服务器连接失败\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      \u003cspan class=\"c1\"\u003e//登陆（通过用户名或者匿名登陆）\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e      \u003cspan class=\"nv\"\u003e$result\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003eftp_login\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$conn\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$user\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$password\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e!\u003c/span\u003e\u003cspan class=\"nv\"\u003e$result\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e          \u003cspan class=\"nx\"\u003eftp_close\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$conn\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e          \u003cspan class=\"k\"\u003edie\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;ftp_login 失败\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      \u003cspan class=\"nx\"\u003eftp_set_option\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$conn\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eFTP_USEPASVADDRESS\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003efalse\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      \u003cspan class=\"c1\"\u003e// turn passive mode on\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e      \u003cspan class=\"nx\"\u003eftp_pasv\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$conn\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      \u003cspan class=\"nv\"\u003e$success\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003eftp_put\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$conn\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$remoteFile\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$localFile\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eFTP_BINARY\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$success\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e          \u003cspan class=\"nv\"\u003e$uploaded\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e          \u003cspan class=\"nx\"\u003edump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;ftp upload: \u003c/span\u003e\u003cspan class=\"si\"\u003e$success\u003c/span\u003e\u003cspan class=\"s2\"\u003e, \u003c/span\u003e\u003cspan class=\"si\"\u003e$remoteFile\u003c/span\u003e\u003cspan class=\"s2\"\u003e, \u003c/span\u003e\u003cspan class=\"si\"\u003e$localFile\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      \u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"k\"\u003eelse\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e          \u003cspan class=\"nx\"\u003edump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;ftp upload failed, tries: \u003c/span\u003e\u003cspan class=\"si\"\u003e$tries\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      \u003cspan class=\"nx\"\u003eftp_close\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$conn\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e循环 try 第二次就成功了，不知为啥。\u003ca href=\"https://qiita.com/skawata/items/96895fe4eb5e6bbbf92c\"\u003ePHP の FTP(S)通信で php_connect_nonb() failed: Operation now in progress (115) | qiita\u003c/a\u003e 这篇文章有分析，读后还是不太清楚，望有缘人来指导。\u003c/p\u003e","title":"PHP FTP 间歇性无法上传文件"},{"content":"新裤子 · 夏日终曲\n2019 年的第一天从三亚开始，在 第一市场海鲜市场 买了海味，然后直接到旁边的 林姐香味海鲜 加工，迟到了超级好吃的香辣蟹。飞回北京就是滑雪团建，年后双双得到了最佳合作奖，感谢我们每周的火锅，让大家多了些感情。\n\u0026ndash; EOF \u0026ndash;\n年后买了烤箱烹饪技术再次升级，烤鸡翅、披萨、蛋挞甚至烤鱼，都已不在话下。受 shilei 推荐也喜欢玩德州扑克。看 B 站 UP 主自驾游，疯狂迷恋上了房车一段时间，还去看了一次房山的房车展（够远的），应该会结下不解之缘。\n3 月 29 日公司 7 周年，第一次庆祝公司周年，吃蛋糕前大家合了张影。这张照片我挺感动的，说不好具体的原因，可能是因为大家的笑容吧。清明小假在奥森玩了个露营，是真的有点冷。涛爷来北京面试，转头就成了科大博士，给劲儿。\n4 月中的一个双休日和爸妈南下，和比比定了亲 🎉🎉🎉。\n5 月乐队的夏天，是今年开过最好的综艺，刺猬、新裤子很棒。\n2019 年过去了，我很怀念它。\n","permalink":"https://zyf.im/2019/12/31/review-2019/","summary":"\u003cp\u003e\u003ca href=\"https://y.qq.com/n/ryqq/songDetail/235474091\"\u003e新裤子 · 夏日终曲\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e2019 年的第一天从三亚开始，在 \u003cem\u003e第一市场海鲜市场\u003c/em\u003e 买了海味，然后直接到旁边的 \u003cem\u003e林姐香味海鲜\u003c/em\u003e 加工，迟到了超级好吃的香辣蟹。飞回北京就是滑雪团建，年后双双得到了最佳合作奖，感谢我们每周的火锅，让大家多了些感情。\u003c/p\u003e\n\u003cp\u003e\u0026ndash; EOF \u0026ndash;\u003c/p\u003e\n\u003cp\u003e年后买了烤箱烹饪技术再次升级，烤鸡翅、披萨、蛋挞甚至烤鱼，都已不在话下。受 shilei 推荐也喜欢玩德州扑克。看 B 站 UP 主自驾游，疯狂迷恋上了房车一段时间，还去看了一次房山的房车展（够远的），应该会结下不解之缘。\u003c/p\u003e\n\u003cp\u003e3 月 29 日公司 7 周年，第一次庆祝公司周年，吃蛋糕前大家合了张影。这张照片我挺感动的，说不好具体的原因，可能是因为大家的笑容吧。清明小假在奥森玩了个露营，是真的有点冷。涛爷来北京面试，转头就成了科大博士，给劲儿。\u003c/p\u003e\n\u003cp\u003e4 月中的一个双休日和爸妈南下，和比比定了亲 🎉🎉🎉。\u003c/p\u003e\n\u003cp\u003e5 月乐队的夏天，是今年开过最好的综艺，刺猬、新裤子很棒。\u003c/p\u003e\n\u003cp\u003e2019 年过去了，我很怀念它。\u003c/p\u003e","title":"回顾 2019"},{"content":"项目代码：imzyf/lonicera | GitHub\n【PHP 核心技术与最佳实践】第二版 第 6 章 读书笔记\nLonicera Framework - Every French soldier carries a marshal’s baton in his knapsack.\nMVC MVC 模式的目的是实现一种动态的程序设计，使后续对程序的修改和扩展简化，并且使程序某一部分的重复利用成为可能。\nLonicera 0.1 bootstrap index.php 单一入口模式。\n启动 PHP 内置 Web 服务器：\nphp -S localhost:7070 路由器层 更偏向于使用 PATH_INFO 方式来访问。\n从传统 URL 参数模式的访问地址进行解析，提取里面的 group、controller、action、param 4 个参数，随后交给 bootstrap 进行 dispatch 处理。\n数据模型 用 PDO 来实现连接数据库。\nORM Object Relational Mapping 对象与数据库的映射叫作对象关系映射 PO Persistent Object 把一个数据库中的表的一行记录对应的对象称为持久对象 BO Business Object 业务对象 把业务逻辑封装为一个对象 VO Value Object 值对象 界面显示的数据对象 DTO Data Transfer Object 用在热呵呵需要数据传输的地方 DAO Data Access Object 指代 Active Record 模式中的数据对象 传统的 ORM 模式提倡数据对象和负责持久化的代码的分开，但是这并没有坚持数据操作的工作量。还有一种 ORM 模式叫作 Active Record。在 Active Record 中，模型层集成了 ORM 的功能，他们及代表实体，包含因为业务逻辑，又是数据对象，并负责把自己存储到数据库中。\nActive Record 模式中的数据对象不再是 PO 对象，而是 DAO。\n一系列的数据库操作组合起来，称之为 Service。Service 向下负责与数据库打交道，向上负责接收页面传递的参数以及数据的传输。理论上应该对 DAO 进项抽象到一个 Service 中。\n视图层 PHP MVC 中的显示层开始朝着轻量化、API 化发展了。\n增强一个类通常途径：\n使用 __call __set __get 等魔术方法 使用反射 使用 trait 使用继承和组合 初步改进 spl_autoload_register 统一加载文件。\nLonicera 0.2 引入异常机制 同时设置 set_error_handler 和 set_exception_handler。PHP 同时存在错误和异常两个互不包含的概念。\n拦截器与插件 dispatch 中处理。使用正则匹配、call_user_func。\nRequest 增强与安全防御 包装 $_REQUEST。\nLonicera 0.3 Composer 类加载机制 PSR-4。\nModel 增强 illuminata/database。\n控制反转与依赖注入 Inversion of Control IoC，Dependency Injection DI。\n谁控制谁？IoC 容器控制了对象。 控制什么？主要控制了外部资源获取（不只是对象创建，还包括比如文件等）。 传统应用程序是：由我们自己在对象中主动控制去直接获取依赖对象，而反转则是：由容器来帮忙创建及注入依赖对象。由于是容器帮我们查找及注入依赖对象，对象只是被动接受依赖对象，所以是反转。\n哪些方面反转了？依赖对象的获取被反转了。 在我们使用 UserOrder 对象的时候，不再需要手动去创建 User 对象和 Order 对象了，而是直接问 IoC 容器去要 UserOrder 对象，IoC 容器会负责查找 UserOrder 的依赖并替我们创建 User 对象和 Order 对象，并管理它们。也就是说和我们打交道的是 IoC 容器。\n依赖注入，是组件之间依赖关系由容器在运行期决定形象来说，即由容器动态地将某个依赖关系注入到组件之中。依赖注入的目的并非是为软件系统带来更多功能，而是为了提高组件重用的效率，并为系统搭建一个灵活、可扩展的平台。\n通过依赖注入机制，我们只需要通过简单的配置，而无需任何代码就可指定目标需要的资源，完成自身的业务逻辑，而不需要关心具体的资源来自何处，由谁实现。\n谁依赖于谁？当然是应用程序依赖于 IoC 容器。 为什么需要依赖？应用程序需要 IoC 容器来提供对象需要的外部资源。 谁注入谁？IoC 容器注入应用程序某个对象，应用程序依赖的对象。 注入了什么？注入某个对象所需要的外部资源(包括对象、资源、常量数据)。 IoC 和 DI 是两个相辅相成的概念，IoC 的实现是使用了 DI，而 DI 的目的是为了实现 IoC。实际上，它们是同一个概念的不同角度描述。\n为什么要这么做，这么做有什么意义呢？依赖注入帮我们降低了创建对象的成本，使得对象之间松耦合。\ncomposer 通过 composer.json 来管理第三方依赖，从这个角度讲，composer 就是一个 IoC 容器。\nPSR-11 Psr\\Contanier\\ContainerInterface。\nDB SQL SET NAMES utf8mb4; SET FOREIGN_KEY_CHECKS = 0; -- ---------------------------- -- Table structure for user -- ---------------------------- DROP TABLE IF EXISTS `user`; CREATE TABLE `user` ( `id` int(10) unsigned NOT NULL AUTO_INCREMENT, `name` varchar(255) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT \u0026#39;\u0026#39; COMMENT \u0026#39;名字\u0026#39;, `age` int(10) unsigned NOT NULL DEFAULT \u0026#39;0\u0026#39;, PRIMARY KEY (`id`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci; SET FOREIGN_KEY_CHECKS = 1; \u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2019/12/19/lonicera-framework/","summary":"\u003cp\u003e项目代码：\u003ca href=\"https://github.com/imzyf/lonicera\"\u003eimzyf/lonicera | GitHub\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e【PHP 核心技术与最佳实践】第二版 第 6 章 读书笔记\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003eLonicera Framework - Every French soldier carries a marshal’s baton in his knapsack.\u003c/p\u003e\n\u003ch2 id=\"mvc\"\u003eMVC\u003c/h2\u003e\n\u003cp\u003eMVC 模式的目的是实现一种动态的程序设计，使后续对程序的修改和扩展简化，并且使程序某一部分的重复利用成为可能。\u003c/p\u003e\n\u003ch2 id=\"lonicera-01\"\u003eLonicera 0.1\u003c/h2\u003e\n\u003ch3 id=\"bootstrap\"\u003ebootstrap\u003c/h3\u003e\n\u003cp\u003eindex.php 单一入口模式。\u003c/p\u003e\n\u003cp\u003e启动 PHP 内置 Web 服务器：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ephp -S localhost:7070\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"路由器层\"\u003e路由器层\u003c/h3\u003e\n\u003cp\u003e更偏向于使用 PATH_INFO 方式来访问。\u003c/p\u003e\n\u003cp\u003e从传统 URL 参数模式的访问地址进行解析，提取里面的 group、controller、action、param 4 个参数，随后交给 bootstrap 进行 dispatch 处理。\u003c/p\u003e\n\u003ch3 id=\"数据模型\"\u003e数据模型\u003c/h3\u003e\n\u003cp\u003e用 PDO 来实现连接数据库。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eORM Object Relational Mapping 对象与数据库的映射叫作对象关系映射\u003c/li\u003e\n\u003cli\u003ePO Persistent Object 把一个数据库中的表的一行记录对应的对象称为持久对象\u003c/li\u003e\n\u003cli\u003eBO Business Object 业务对象 把业务逻辑封装为一个对象\u003c/li\u003e\n\u003cli\u003eVO Value Object 值对象 界面显示的数据对象\u003c/li\u003e\n\u003cli\u003eDTO Data Transfer Object 用在热呵呵需要数据传输的地方\u003c/li\u003e\n\u003cli\u003eDAO Data Access Object 指代 Active Record 模式中的数据对象\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e传统的 ORM 模式提倡数据对象和负责持久化的代码的分开，但是这并没有坚持数据操作的工作量。还有一种 ORM 模式叫作 Active Record。在 Active Record 中，模型层集成了 ORM 的功能，他们及代表实体，包含因为业务逻辑，又是数据对象，并负责把自己存储到数据库中。\u003c/p\u003e","title":"Lonicera Framework"},{"content":"文本文件从 Windows 系统复制到 Mac 系统中文发生乱码，原因肯定是编码问题。\n解决办法 iconv | wikipedia 它的作用是在多种国际编码格式之间进行文本内码的转换。\niconv [OPTION...] [-f ENCODING] [-t ENCODING] [INPUTFILE...] iconv -f \u0026lt;原始编码\u0026gt; -t \u0026lt;目标编码\u0026gt; \u0026lt;输入文件\u0026gt; -o \u0026lt;输出文件\u0026gt; iconv -f GB18030 -t utf-8 \u0026lt;infile.txt\u0026gt; outfile.txt References 文本文件从 Windows 拷贝到 Mac 乱码 | super2bai \u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2019/12/09/windows-text-file-to-mac-chinese-messy-code/","summary":"\u003cp\u003e文本文件从 Windows 系统复制到 Mac 系统中文发生乱码，原因肯定是编码问题。\u003c/p\u003e\n\u003c!-- more --\u003e\n\u003ch2 id=\"解决办法\"\u003e解决办法\u003c/h2\u003e\n\u003cp\u003e\u003ca href=\"https://zh.wikipedia.org/wiki/Iconv\"\u003eiconv | wikipedia\u003c/a\u003e 它的作用是在多种国际编码格式之间进行文本内码的转换。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eiconv \u003cspan class=\"o\"\u003e[\u003c/span\u003eOPTION...\u003cspan class=\"o\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e[\u003c/span\u003e-f ENCODING\u003cspan class=\"o\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e[\u003c/span\u003e-t ENCODING\u003cspan class=\"o\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e[\u003c/span\u003eINPUTFILE...\u003cspan class=\"o\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eiconv -f \u0026lt;原始编码\u0026gt; -t \u0026lt;目标编码\u0026gt; \u0026lt;输入文件\u0026gt; -o \u0026lt;输出文件\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eiconv -f GB18030 -t utf-8 \u0026lt;infile.txt\u0026gt; outfile.txt\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"references\"\u003eReferences\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://super2bai.github.io/codec/w2m.html\"\u003e文本文件从 Windows 拷贝到 Mac 乱码 | super2bai\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u0026ndash; EOF \u0026ndash;\u003c/p\u003e","title":"Windows 文本文件到 Mac 中文乱码"},{"content":"统计个人增删行数 git config user.name git log --author=\u0026#34;zhaoyifan\u0026#34; --pretty=tformat: --numstat | awk \u0026#39;{ add += $1; subs += $2; loc += $1 - $2 } END { printf \u0026#34;added lines: %s, removed lines: %s, total lines: %s\\n\u0026#34;, add, subs, loc }\u0026#39; - added lines: 82813, removed lines: 53707, total lines: 29106 统计每个人增删行数 git log --shortstat | grep -E \u0026#34;(Author: )(\\s*(\\w+)){2}|fil(e|es) changed\u0026#34; | awk \u0026#39; { if($1 ~ /Author/) { author = $2\u0026#34; \u0026#34;$3 } else { files[author]+=$1 inserted[author]+=$4 deleted[author]+=$6 } } END { for (key in files) { print \u0026#34;Author: \u0026#34; key \u0026#34;\\n\\tfiles changed: \u0026#34;, files[key], \u0026#34;\\n\\tlines inserted: \u0026#34;, inserted[key], \u0026#34;\\n\\tlines deleted: \u0026#34;, deleted[key] } } \u0026#39; 统计每个人提交次数 git shortlog -sn --no-merges 忽略某些路径的更改 git log -- . \u0026#34;:(exclude)sub\u0026#34; git log -- . \u0026#34;:!sub\u0026#34; cloc AlDanial/cloc - cloc counts blank lines, comment lines, and physical lines of source code in many programming languages.\ncloc source/ 186 text files. 186 unique files. 3 files ignored. github.com/AlDanial/cloc v 1.84 T=0.16 s (1112.3 files/s, 138678.8 lines/s) ------------------------------------------------------------------------------- Language files blank comment code ------------------------------------------------------------------------------- Markdown 183 6028 0 16788 ------------------------------------------------------------------------------- SUM: 183 6028 0 16788 ------------------------------------------------------------------------------- Git Fame Git Fame - A command-line tool that helps you summarize and pretty-print git collaborators based on contributions\ngem install git_fame cd /path/to/gitdir \u0026amp;\u0026amp; git fame Total number of files: 2,053 Total number of lines: 63,132 Total number of commits: 4,330 +------------------------+--------+---------+-------+--------------------+ | name | loc | commits | files | percent | +------------------------+--------+---------+-------+--------------------+ | Johan Sørensen | 22,272 | 1,814 | 414 | 35.3 / 41.9 / 20.2 | | Marius Mathiesen | 10,387 | 502 | 229 | 16.5 / 11.6 / 11.2 | | Jesper Josefsson | 9,689 | 519 | 191 | 15.3 / 12.0 / 9.3 | | Ole Martin Kristiansen | 6,632 | 24 | 60 | 10.5 / 0.6 / 2.9 | | Linus Oleander | 5,769 | 705 | 277 | 9.1 / 16.3 / 13.5 | | Fabio Akita | 2,122 | 24 | 60 | 3.4 / 0.6 / 2.9 | | August Lilleaas | 1,572 | 123 | 63 | 2.5 / 2.8 / 3.1 | | David A. Cuadrado | 731 | 111 | 35 | 1.2 / 2.6 / 1.7 | | Jonas Ängeslevä | 705 | 148 | 51 | 1.1 / 3.4 / 2.5 | | Diego Algorta | 650 | 6 | 5 | 1.0 / 0.1 / 0.2 | | Arash Rouhani | 629 | 95 | 31 | 1.0 / 2.2 / 1.5 | | Sofia Larsson | 595 | 70 | 77 | 0.9 / 1.6 / 3.8 | | Tor Arne Vestbø | 527 | 51 | 97 | 0.8 / 1.2 / 4.7 | | spontus | 339 | 18 | 42 | 0.5 / 0.4 / 2.0 | | Pontus | 225 | 49 | 34 | 0.4 / 1.1 / 1.7 | +------------------------+--------+---------+-------+--------------------+ 让 git log 的输出漂亮简洁 git config --global alias.lg \u0026#34;log --color --graph --pretty=format:\u0026#39;%Cred%h%Creset -%C(yellow)%d%Creset %s %Cgreen(%cr) %C(bold blue)\u0026lt;%an %ae\u0026gt;%Creset\u0026#39; --abbrev-commit\u0026#34; https://gist.github.com/johanmeiring/3002458\n在 ~/.gitconfig 看到：\n[alias] lg = log --color --graph --pretty=format:\u0026#39;%Cred%h%Creset -%C(yellow)%d%Creset %s %Cgreen(%cr) %C(bold blue)\u0026lt;%an %ae\u0026gt;%Creset\u0026#39; --abbrev-commit 这其中的占位符的解释：\n%Cred：将颜色设置为红色 %Creset：重置颜色 %C(yellow)：将颜色设置为黄色 %h：缩略的提交哈希值 %d：ref names（不知道该怎么解释 😆） %s：提交时的 message %cr：相对的提交时间。可以换成%ci，展示的是年月日时分秒。 %an：提交人的 name %ae：提交人的邮箱 更多占位符，可以参考官方文档：https://git-scm.com/docs/pretty-formats\nReferences Git count lines by author | gist ezamelczyk Making \u0026lsquo;git log\u0026rsquo; ignore changes for certain paths | stackoverflow 让 git log 的输出漂亮简洁 | letianbiji \u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2019/12/03/analyze-git-log/","summary":"\u003ch2 id=\"统计个人增删行数\"\u003e统计个人增删行数\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit config user.name\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit log --author\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;zhaoyifan\u0026#34;\u003c/span\u003e --pretty\u003cspan class=\"o\"\u003e=\u003c/span\u003etformat: --numstat \u003cspan class=\"p\"\u003e|\u003c/span\u003e awk \u003cspan class=\"s1\"\u003e\u0026#39;{ add += $1; subs += $2; loc += $1 - $2 } END { printf \u0026#34;added lines: %s, removed lines: %s, total lines: %s\\n\u0026#34;, add, subs, loc }\u0026#39;\u003c/span\u003e -\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c!-- more --\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-txt\" data-lang=\"txt\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eadded lines: 82813, removed lines: 53707, total lines: 29106\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"统计每个人增删行数\"\u003e统计每个人增删行数\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit log --shortstat \u003cspan class=\"p\"\u003e|\u003c/span\u003e grep -E \u003cspan class=\"s2\"\u003e\u0026#34;(Author: )(\\s*(\\w+)){2}|fil(e|es) changed\u0026#34;\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e awk \u003cspan class=\"s1\"\u003e\u0026#39;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e{\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e if($1 ~ /Author/) {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e  author = $2\u0026#34; \u0026#34;$3\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e } else {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e  files[author]+=$1\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e  inserted[author]+=$4\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e  deleted[author]+=$6\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e }\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eEND { for (key in files) { print \u0026#34;Author: \u0026#34; key \u0026#34;\\n\\tfiles changed: \u0026#34;, files[key], \u0026#34;\\n\\tlines inserted: \u0026#34;, inserted[key], \u0026#34;\\n\\tlines deleted: \u0026#34;, deleted[key] } }\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"统计每个人提交次数\"\u003e统计每个人提交次数\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit shortlog -sn --no-merges\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"忽略某些路径的更改\"\u003e忽略某些路径的更改\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit log -- . \u003cspan class=\"s2\"\u003e\u0026#34;:(exclude)sub\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit log -- . \u003cspan class=\"s2\"\u003e\u0026#34;:!sub\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"cloc\"\u003ecloc\u003c/h2\u003e\n\u003cp\u003e\u003ca href=\"https://github.com/AlDanial/cloc\"\u003eAlDanial/cloc - cloc counts blank lines, comment lines, and physical lines of source code in many programming languages.\u003c/a\u003e\u003c/p\u003e","title":"Git log 统计分析"},{"content":"注意：此操作会修改 Git 历史记录，正式工作环境不允许。\n查询都有什么：\ngit log --format=\u0026#39;%aN %aE\u0026#39; | sort -u 注：一个特殊情况如果 email 没被设置过 OLD_EMAIL 可以填 user.name。\nOLD_EMAIL 原来的邮箱 CORRECT_NAME 更正的名字 CORRECT_EMAIL 更正的邮箱 git filter-branch -f --env-filter \u0026#39; OLD_EMAIL=\u0026#34;old@qq.com\u0026#34; CORRECT_NAME=\u0026#34;new_name\u0026#34; CORRECT_EMAIL=\u0026#34;new@gmail.com\u0026#34; if [ \u0026#34;$GIT_COMMITTER_EMAIL\u0026#34; = \u0026#34;$OLD_EMAIL\u0026#34; ] then export GIT_COMMITTER_NAME=\u0026#34;$CORRECT_NAME\u0026#34; export GIT_COMMITTER_EMAIL=\u0026#34;$CORRECT_EMAIL\u0026#34; fi if [ \u0026#34;$GIT_AUTHOR_EMAIL\u0026#34; = \u0026#34;$OLD_EMAIL\u0026#34; ] then export GIT_AUTHOR_NAME=\u0026#34;$CORRECT_NAME\u0026#34; export GIT_AUTHOR_EMAIL=\u0026#34;$CORRECT_EMAIL\u0026#34; fi if [ \u0026#34;$GIT_AUTHOR_NAME\u0026#34; != \u0026#34;$CORRECT_NAME\u0026#34; ] then export GIT_AUTHOR_NAME=\u0026#34;$CORRECT_NAME\u0026#34; export GIT_AUTHOR_EMAIL=\u0026#34;$CORRECT_EMAIL\u0026#34; fi \u0026#39; --tag-name-filter cat -- --branches --tags 因为修改了 Git 历史所有要使用强制推送：\ngit push --f --tags GitLab 有 master 分支保护的策略：\nremote: GitLab: You are not allowed to force push code to a protected branch on this project. 在 GitLab 中：Project(项目) -\u0026gt; Setting -\u0026gt; Repository 菜单下面的 Protected branches 把 master 的保护去掉就可以了。\nReferences Git 批量修改历史 commit 中的 user.name 和 user.email | segmentfault \u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2019/12/02/git-modify-history-commont-user-email/","summary":"\u003cp\u003e注意：\u003cstrong\u003e此操作会修改 Git 历史记录\u003c/strong\u003e，正式工作环境不允许。\u003c/p\u003e\n\u003cp\u003e查询都有什么：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit log --format\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;%aN %aE\u0026#39;\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e sort -u\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e注：一个特殊情况如果 email 没被设置过 OLD_EMAIL 可以填 \u003ccode\u003euser.name\u003c/code\u003e。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eOLD_EMAIL 原来的邮箱\u003c/li\u003e\n\u003cli\u003eCORRECT_NAME 更正的名字\u003c/li\u003e\n\u003cli\u003eCORRECT_EMAIL 更正的邮箱\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit filter-branch -f --env-filter \u003cspan class=\"s1\"\u003e\u0026#39;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eOLD_EMAIL=\u0026#34;old@qq.com\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eCORRECT_NAME=\u0026#34;new_name\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eCORRECT_EMAIL=\u0026#34;new@gmail.com\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eif [ \u0026#34;$GIT_COMMITTER_EMAIL\u0026#34; = \u0026#34;$OLD_EMAIL\u0026#34; ]\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003ethen\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e    export GIT_COMMITTER_NAME=\u0026#34;$CORRECT_NAME\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e    export GIT_COMMITTER_EMAIL=\u0026#34;$CORRECT_EMAIL\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003efi\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eif [ \u0026#34;$GIT_AUTHOR_EMAIL\u0026#34; = \u0026#34;$OLD_EMAIL\u0026#34; ]\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003ethen\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e    export GIT_AUTHOR_NAME=\u0026#34;$CORRECT_NAME\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e    export GIT_AUTHOR_EMAIL=\u0026#34;$CORRECT_EMAIL\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003efi\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eif [ \u0026#34;$GIT_AUTHOR_NAME\u0026#34; != \u0026#34;$CORRECT_NAME\u0026#34; ]\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003ethen\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e    export GIT_AUTHOR_NAME=\u0026#34;$CORRECT_NAME\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e    export GIT_AUTHOR_EMAIL=\u0026#34;$CORRECT_EMAIL\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003efi\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e\u0026#39;\u003c/span\u003e --tag-name-filter cat -- --branches --tags\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e因为修改了 Git 历史所有要使用强制推送：\u003c/p\u003e","title":"Git 批量修改历史 commit 中 user.email"},{"content":"先去官网看看 Download for Linux and Unix:\nRHEL and derivatives typically ship older versions of git. You can download a tarball and build from source, or use a 3rd-party repository such as the [IUS Community Project](https://ius.io/) to obtain a more recent version of git. RHEL 和衍生通常提供较老版本的 git。您可以下载 tarball 并从源代码构建，或者使用第三方存储库，如 IUS Community Project 来获得最新版本的 git。\n使用 IUS RHEL/CentOS 7\nyum install \\ https://repo.ius.io/ius-release-el7.rpm \\ https://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm 安装新版 git：\nius 通常会在高版本的软件名后面 + u\nyum list git 如果你已经装有低版本的 git，你需要先 remove（否则安装的时候会报错）\nyum remove git 安装 2.0 以上版本的 git\nyum install git2u WANdisco 另一个源：WANdisco Replication Binaries\nsudo vi /etc/yum.repos.d/wandisco-git.repo wandisco-git.repo\n[wandisco-git] name=Wandisco GIT Repository baseurl=http://opensource.wandisco.com/centos/7/git/$basearch/ enabled=1 gpgcheck=1 gpgkey=http://opensource.wandisco.com/RPM-GPG-KEY-WANdisco Import the repository GPG keys with:\nsudo rpm --import http://opensource.wandisco.com/RPM-GPG-KEY-WANdisco sudo yum remove git sudo yum install git git --version References How To Install Git on CentOS 7 | linuxize How to install latest version of git on CentOS 7.x/6.x | stackoverflow \u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2019/11/25/centos-upgrade-git-by-yum/","summary":"\u003cp\u003e先去官网看看 \u003ca href=\"https://git-scm.com/download/linux\"\u003eDownload for Linux and Unix\u003c/a\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-txt\" data-lang=\"txt\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eRHEL and derivatives typically ship older versions of git. You can download a tarball and build from source, or use a 3rd-party repository such as the [IUS Community Project](https://ius.io/) to obtain a more recent version of git.\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eRHEL 和衍生通常提供较老版本的 git。您可以下载 tarball 并从源代码构建，或者使用第三方存储库，如 \u003ca href=\"https://ius.io/\"\u003eIUS Community Project\u003c/a\u003e 来获得最新版本的 git。\u003c/p\u003e\n\u003ch2 id=\"使用-ius\"\u003e使用 IUS\u003c/h2\u003e\n\u003cp\u003eRHEL/CentOS 7\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eyum install \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003ehttps://repo.ius.io/ius-release-el7.rpm \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003ehttps://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e安装新版 git：\u003c/p\u003e\n\u003cp\u003eius 通常会在高版本的软件名后面 + u\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eyum list git\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e如果你已经装有低版本的 git，你需要先 remove（否则安装的时候会报错）\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eyum remove git\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e安装 2.0 以上版本的 git\u003c/p\u003e","title":"CentOS yum 升级 git 版本"},{"content":"git add . warning: CRLF will be replaced by LF in X. CRLF：windows 环境下的换行符 LF：linux 环境下的换行符 这个错误的意思，就是文件中存在两种环境的换行符，git 会自动替换 CRLF 为 LF ，所以提示警告。\n首先推荐扩展阅读：配置 Git 处理行结束符 | GitHub\n我项目中是配置了 .gitattributes 的：\n# Set the default behavior, in case people don\u0026#39;t have core.autocrlf set. * text=auto # Explicitly declare text files you want to always be normalized and converted # to native line endings on checkout. *.c text *.h text # Declare files that will always have CRLF line endings on checkout. *.sln text eol=crlf # Denote all files that are truly binary and should not be modified. *.png binary *.jpg binary .gitattributes 公式：要匹配的文件模式 属性1 属性2 ...。\n示例 1 * text=auto 对任何文件，设置 text=auto，表示文件的行尾自动转换。如果是文本文件，则在文件入 Git 库时，行尾自动转换为 LF。如果已经在入 Git 库中的文件的行尾为 CRLF，则该文件在入 Git 库时，不再转换为 LF。\n示例 2 *.txt text 对于 txt 文件，标记为文本文件，并进行行尾规范化。\n示例 3 *.jpg -text *.jpg binary 对于 jpg 文件，标记为非文本文件，不进行任何的行尾转换。*.jpg -text 可能是旧版本的写法。\n示例 4 *.vcproj text eol=crlf 对于 vcproj 文件，标记为文本文件，在文件入 Git 库时进行规范化，即行尾为 LF。但是在检出到工作目录时，行尾自动转换为 CRLF。\n示例 5 *.sh text eol=lf 对于 sh 文件，标记为文本文件，在文件入 Git 库时进行规范化，即行尾为 LF。在检出到工作目录时，行尾也不会转换为 CRLF（即保持 LF）。\n示例 6 *.py eol=lf 对于 py 文件，只针对工作目录中的文件，行尾为 LF。\n还是有问题 在项目中已经添加 .gitattributes 文件，但是还是出现了报错，这时要检查 git 的版本。（CentOS 自带的 git 版本较低）\n可以参考：CentOS yum 升级 git 版本\n后来还查到了一个方法，.gitattributes：\n* -crlf References Git 的 gitattributes 文件详解 | csdn gitattributes - Defining attributes per path | git-scm How to make Git ignore different line endings | rtuin \u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2019/11/22/crlf-will-be-replaced-by-lf/","summary":"\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit add .\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ewarning: CRLF will be replaced by LF in X.\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cul\u003e\n\u003cli\u003eCRLF：windows 环境下的换行符\u003c/li\u003e\n\u003cli\u003eLF：linux 环境下的换行符\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e这个错误的意思，就是文件中存在两种环境的换行符，git 会自动替换 CRLF 为 LF ，所以提示警告。\u003c/p\u003e\n\u003c!-- more --\u003e\n\u003cp\u003e首先推荐扩展阅读：\u003ca href=\"https://help.github.com/cn/github/using-git/configuring-git-to-handle-line-endings\"\u003e配置 Git 处理行结束符 | GitHub\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e我项目中是配置了 \u003ccode\u003e.gitattributes\u003c/code\u003e 的：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-txt\" data-lang=\"txt\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e# Set the default behavior, in case people don\u0026#39;t have core.autocrlf set.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e* text=auto\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e# Explicitly declare text files you want to always be normalized and converted\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e# to native line endings on checkout.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e*.c text\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e*.h text\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e# Declare files that will always have CRLF line endings on checkout.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e*.sln text eol=crlf\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e# Denote all files that are truly binary and should not be modified.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e*.png binary\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e*.jpg binary\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"gitattributes\"\u003e.gitattributes\u003c/h2\u003e\n\u003cp\u003e公式：\u003ccode\u003e要匹配的文件模式 属性1 属性2 ...\u003c/code\u003e。\u003c/p\u003e","title":"CRLF will be replaced by LF"},{"content":"重置 data 的数据为初始状态 this.$data = { ...this.$data, ...this.$options.data() }; // Object.assign(this.$data, this.$options.data()); Object.assign({}, this.$options.data().form, { type: 1 }); 修改 ElementUI 默认样式 vue 中令人头疼的 element-ui 组件默认 css 样式修改 | juejin\n\u0026lt;template\u0026gt; \u0026lt;div class=\u0026#34;my-class\u0026#34;\u0026gt; \u0026lt;el-table\u0026gt; \u0026lt;/el-table\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/template\u0026gt; \u0026lt;style lang=\u0026#34;scss\u0026#34; scoped\u0026gt; .my-class__expand-column .cell { display: none; } .my-class .el-table tbody tr:hover \u0026gt; td { cursor: pointer; } \u0026lt;/style\u0026gt; watch 对象的属性 data: { a: 100, msg: { channel: \u0026#34;音乐\u0026#34;, style: \u0026#34;活泼\u0026#34; } }, watch: { a(newval, oldVal) { console.log(\u0026#34;new: %s, old: %s\u0026#34;, newval, oldVal); } } watch: { msg: { handler(newValue, oldValue) { console.log(newValue) }, // 深度监听 deep: true } } 监听对象内的某一具体属性，可以通过 computed 做中间层来实现：\ncomputed: { channel() { return this.msg.channel } }, watch:{ channel(newValue, oldValue) { console.log(\u0026#39;new: %s, old: %s\u0026#39;, newValue, oldValue) } } 判断 data 中的对象是否为空 1、利用 jQuery 的 isEmptyObject：\n$.isEmptyObject(data.list); 实现源码：\nisEmptyObject: function(obj) { var name; for (name in obj) { return false; } return true; } 2、获取到对象中的属性名，存到一个数组中，通过判断数组的 length 来判断此对象是否为空：\nvar arr = Object.getOwnPropertyNames(data); alert(arr.length == 0); // true ES6：\nvar arr = Object.keys(data.list); alert(arr.length == 0); // true 3、转化为 json 字符串，再判断该字符串是否为 {}：\nvar b = JSON.stringify(data) == \u0026#34;{}\u0026#34;; alert(b); // true 关闭 webpack-dev-server 自动刷新 文件保存后页面刷新，刷的眼晕。\ndevServer: { ... hot: false, inline: false, liveReload: false } 注释掉 plugins 中的相关插件。\nplugins: [ // new webpack.HotModuleReplacementPlugin() ], 必须有 webpack.HotModuleReplacementPlugin 才能完全启用 HMR。如果 webpack 或 webpack-dev-server 是通过 \u0026ndash;hot 选项启动的，那么这个插件会被自动添加，所以你可能不需要把它添加到 webpack.config.js 中。\nnextTick 在 Vue 生命周期的 created() 钩子函数进行的 DOM 操作一定要放在 Vue.nextTick() 的回调函数中。\n在数据变化后要执行的某个操作，而这个操作需要使用随数据改变而改变的 DOM 结构的时候，这个操作都应该放进 Vue.nextTick() 的回调函数中。\nVue 异步执行 DOM 更新。只要观察到数据变化，Vue 将开启一个队列，并缓冲在同一事件循环中发生的所有数据改变。如果同一个 watcher 被多次触发，只会被推入到队列中一次。这种在缓冲时去除重复数据对于避免不必要的计算和 DOM 操作上非常重要。然后，在下一个的事件循环 \u0026ldquo;tick\u0026rdquo; 中，Vue 刷新队列并执行实际 (已去重的) 工作。Vue 在内部尝试对异步队列使用原生的 Promise.then 和 MessageChannel，如果执行环境不支持，会采用 setTimeout(fn, 0) 代替。\n键盘监听事件 按键修饰符 | vue\n\u0026lt;input type=\u0026#34;text\u0026#34; @keyup.esc=\u0026#34;KeyUpEsc\u0026#34; /\u0026gt; 将原生事件绑定到组件 | vue\n使用 element 组件库的 el-input 标签，绑定 delete 键：\n\u0026lt;el-input v-model=\u0026#34;input\u0026#34; placeholder=\u0026#34;请输入内容\u0026#34; @keyup.delete.native=\u0026#34;KeyUpDelete\u0026#34; \u0026gt;\u0026lt;/el-input\u0026gt; 为什么这次绑定事件多一个 .native 修饰符，这个可能是因为 element-ui 封装了个 div 在 input 标签外面，把原来的事件隐藏了，所以如果不加 .native 的话，按键不会生效。\n上面两种实现效果是当 input 标签获取到 焦点 的时候，才能监听到键盘，下面这种是全局监听 enter 键，是把监听事件绑定到 document 上（登录页面常用）：\ncreated: function() { var _this = this; document.onkeydown = function(e) { let key = e.keyCode; if (key == 13) { _this.submit(); } }; }, 键盘回车后页面被刷新 form 回车后执行查询方法，但是却重新刷新了页面，并且路由多了一个问号，http://localhost:3009/?#/admin。\n解决方案：el-from 加上 @submit.native.prevent：\n\u0026lt;el-form @submit.native.prevent\u0026gt; \u0026lt;el-form-item\u0026gt; \u0026lt;el-input @keyup.enter.native=\u0026#34;handleInputConfirm(obj)\u0026#34;\u0026gt; \u0026lt;/el-input\u0026gt; \u0026lt;/el-form-item\u0026gt; \u0026lt;/el-form\u0026gt; \u0026lt;script\u0026gt; export default { methods: { handleInputConfirm(obj) { // ... 提交内容 }, }, }; \u0026lt;/script\u0026gt; 原因：当一个 form 元素中只有一个输入框时，在该输入框中按下回车应提交该表单。如果希望阻止这一默认行为，可以在标签上添加 @submit.native.prevent。\nvue 键盘回车事件导致页面刷新的问题，路由多了一个问号 | cnblogs\n解决方案二：为表单元素增加属性 onSubmit=\u0026quot;return false\u0026quot;。\nVue element-ui 键盘回车事件表单自动提交造成页面刷新问题\n.sync 修饰符 .sync 修饰符 | vue\n\u0026lt;history-dialog :historys=\u0026#34;historyTable\u0026#34; :dialogVisible.sync=\u0026#34;dialogHistoryTableVisible\u0026#34; /\u0026gt; methods: { onClose() { this.$emit(\u0026#34;update:dialogVisible\u0026#34;, false); }, }, 【Vue】Vue 中的父子组件通讯以及使用 sync 同步父子组件数据 | penghuwan 优化图片加载失败 \u0026lt;div\u0026gt; \u0026lt;img :src=\u0026#34;item.picture\u0026#34; @error.once=\u0026#34;handleImgError($event)\u0026#34; /\u0026gt; \u0026lt;/div\u0026gt; handleImgError (e) { e.currentTarget.src = \u0026#34;http://www.ianbiangou.cn/index/ICON2.png\u0026#34; } 数据绑定 this.form = {}; // 不要用这种：this.form = \u0026#39;\u0026#39;; References jQuery.isEmptyObject() 函数详解 | csdn 简单理解 Vue 中的 nextTick | juejin Vue 中键盘监听事件（解决 element 监听键盘不生效）| jianshu 图片加载失败优化处理 | cnblogs How to disable webpack dev server auto reload? | stackoverflow ","permalink":"https://zyf.im/2019/08/08/vue-code-snippet/","summary":"\u003ch2 id=\"重置-data-的数据为初始状态\"\u003e重置 data 的数据为初始状态\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-js\" data-lang=\"js\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003e$data\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"p\"\u003e...\u003c/span\u003e\u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003e$data\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"p\"\u003e...\u003c/span\u003e\u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003e$options\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003edata\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e};\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Object.assign(this.$data, this.$options.data());\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nb\"\u003eObject\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eassign\u003c/span\u003e\u003cspan class=\"p\"\u003e({},\u003c/span\u003e \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003e$options\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003edata\u003c/span\u003e\u003cspan class=\"p\"\u003e().\u003c/span\u003e\u003cspan class=\"nx\"\u003eform\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"nx\"\u003etype\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e \u003cspan class=\"p\"\u003e});\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"修改-elementui-默认样式\"\u003e修改 ElementUI 默认样式\u003c/h2\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ca href=\"https://juejin.cn/post/7011016159545786376\"\u003evue 中令人头疼的 element-ui 组件默认 css 样式修改 | juejin\u003c/a\u003e\u003c/p\u003e\u003c/blockquote\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-html\" data-lang=\"html\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003etemplate\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003ediv\u003c/span\u003e \u003cspan class=\"na\"\u003eclass\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;my-class\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-table\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-table\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003ediv\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003etemplate\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003estyle\u003c/span\u003e \u003cspan class=\"na\"\u003elang\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;scss\u0026#34;\u003c/span\u003e \u003cspan class=\"na\"\u003escoped\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nc\"\u003emy-class__expand-column\u003c/span\u003e \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nc\"\u003ecell\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003edisplay\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"kc\"\u003enone\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nc\"\u003emy-class\u003c/span\u003e \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nc\"\u003eel-table\u003c/span\u003e \u003cspan class=\"nt\"\u003etbody\u003c/span\u003e \u003cspan class=\"nt\"\u003etr\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"nd\"\u003ehover\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"nt\"\u003etd\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003ecursor\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"kc\"\u003epointer\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003estyle\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"watch-对象的属性\"\u003ewatch 对象的属性\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-js\" data-lang=\"js\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003edata\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e   \u003cspan class=\"nx\"\u003ea\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"mi\"\u003e100\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e   \u003cspan class=\"nx\"\u003emsg\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      \u003cspan class=\"nx\"\u003echannel\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;音乐\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      \u003cspan class=\"nx\"\u003estyle\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;活泼\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e   \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e},\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003ewatch\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e   \u003cspan class=\"nx\"\u003ea\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003enewval\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eoldVal\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      \u003cspan class=\"nx\"\u003econsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003elog\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;new: %s, old: %s\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003enewval\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eoldVal\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e   \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-js\" data-lang=\"js\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003ewatch\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e   \u003cspan class=\"nx\"\u003emsg\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      \u003cspan class=\"nx\"\u003ehandler\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003enewValue\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eoldValue\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e         \u003cspan class=\"nx\"\u003econsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003elog\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003enewValue\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      \u003cspan class=\"p\"\u003e},\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      \u003cspan class=\"c1\"\u003e// 深度监听\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e      \u003cspan class=\"nx\"\u003edeep\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e   \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e监听对象内的某一具体属性，可以通过 \u003ccode\u003ecomputed\u003c/code\u003e 做中间层来实现：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-js\" data-lang=\"js\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003ecomputed\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e   \u003cspan class=\"nx\"\u003echannel\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003emsg\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003echannel\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e   \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e},\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003ewatch\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e   \u003cspan class=\"nx\"\u003echannel\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003enewValue\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eoldValue\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      \u003cspan class=\"nx\"\u003econsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003elog\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;new: %s, old: %s\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003enewValue\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eoldValue\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e   \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"判断-data-中的对象是否为空\"\u003e判断 data 中的对象是否为空\u003c/h2\u003e\n\u003cp\u003e1、利用 \u003ccode\u003ejQuery\u003c/code\u003e 的 \u003ccode\u003eisEmptyObject\u003c/code\u003e：\u003c/p\u003e","title":"Vue Code Snippet"},{"content":"编辑 settings.json command + , 右上角点击 打开设置。\n{ // 通过整体放大窗口比例 \u0026#34;window.zoomLevel\u0026#34;: 1.1, // 字体 \u0026#34;editor.fontSize\u0026#34;: 14, // 软换行 \u0026#34;editor.wordWrap\u0026#34;: \u0026#34;on\u0026#34;, } 显示空格和 tab 符号 Editor: Render Whitespace 控制编辑器在空白字符上显示符号的方式。 all Settings 同步 只需从左下角的设置齿轮启用内置同步。\n扩展推荐 Community Material Theme EditerConfig For VS Code ESLint Git History GitLens — Git supercharged markdownlint Material Icon Theme Material Theme Prettier - Code formatter Terminal Vetur \u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2019/06/11/vscode-using-experience/","summary":"\u003ch2 id=\"编辑-settingsjson\"\u003e编辑 settings.json\u003c/h2\u003e\n\u003cp\u003e\u003ccode\u003ecommand + ,\u003c/code\u003e 右上角点击 \u003ccode\u003e打开设置\u003c/code\u003e。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-json\" data-lang=\"json\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"c1\"\u003e// 通过整体放大窗口比例\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e  \u003cspan class=\"nt\"\u003e\u0026#34;window.zoomLevel\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"mf\"\u003e1.1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"c1\"\u003e// 字体\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e  \u003cspan class=\"nt\"\u003e\u0026#34;editor.fontSize\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"mi\"\u003e14\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"c1\"\u003e// 软换行\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e  \u003cspan class=\"nt\"\u003e\u0026#34;editor.wordWrap\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;on\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"显示空格和-tab-符号\"\u003e显示空格和 tab 符号\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-txt\" data-lang=\"txt\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eEditor: Render Whitespace\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e控制编辑器在空白字符上显示符号的方式。\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eall\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"settings-同步\"\u003eSettings 同步\u003c/h2\u003e\n\u003cp\u003e只需从左下角的设置齿轮启用内置同步。\u003c/p\u003e\n\u003ch2 id=\"扩展推荐\"\u003e扩展推荐\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eCommunity Material Theme\u003c/li\u003e\n\u003cli\u003eEditerConfig For VS Code\u003c/li\u003e\n\u003cli\u003eESLint\u003c/li\u003e\n\u003cli\u003eGit History\u003c/li\u003e\n\u003cli\u003eGitLens — Git supercharged\u003c/li\u003e\n\u003cli\u003emarkdownlint\u003c/li\u003e\n\u003cli\u003eMaterial Icon Theme\u003c/li\u003e\n\u003cli\u003eMaterial Theme\u003c/li\u003e\n\u003cli\u003ePrettier - Code formatter\u003c/li\u003e\n\u003cli\u003eTerminal\u003c/li\u003e\n\u003cli\u003eVetur\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u0026ndash; EOF \u0026ndash;\u003c/p\u003e","title":"VSCode 使用经验"},{"content":"commit message 应该清晰明了，说明本次提交的目的。基本公式：\n\u0026lt;type\u0026gt;(\u0026lt;scope\u0026gt;): \u0026lt;subject\u0026gt; 完整公式：\n\u0026lt;type\u0026gt;(\u0026lt;scope\u0026gt;): \u0026lt;subject\u0026gt; \u0026lt;BLANK LINE\u0026gt; \u0026lt;body\u0026gt; \u0026lt;BLANK LINE\u0026gt; \u0026lt;footer\u0026gt; type 用于说明 commit 的类别，只允许使用下面 7 个标识。\nfeat：新功能（feature） fix：修补 bug docs：文档（documentation） style：格式（不影响代码运行的变动） refactor：重构（即不是新增功能，也不是修改 bug 的代码变动） test：增加测试 chore：构建过程或辅助工具的变动 scope 用于说明 commit 影响的范围，比如数据层、控制层、视图层等等，视项目不同而不同。\nsubject 是 commit 目的的简短描述，不超过 50 个字符。\n以动词开头，使用第一人称现在时，比如 change，而不是 changed 或 changes 第一个字母小写 结尾不加句号 . cli 工具 commitizen cli commitizen/cz-cli 使用它提供的 git cz 命令替代我们的 git commit 命令，帮助我们生成符合规范的 commit message。\n除此之外，我们还需要为 commitizen 指定一个 Adapter 比如：commitizen/cz-conventional-changelog（一个符合 Angular 团队规范的 preset）使得 commitizen 按照我们指定的规范帮助我们生成 commit message。\n全局安装（首选）：\nnpm install -g commitizen cz-conventional-changelog echo \u0026#39;{ \u0026#34;path\u0026#34;: \u0026#34;cz-conventional-changelog\u0026#34; }\u0026#39; \u0026gt; ~/.czrc 项目级安装（首选）：\nnpm install -D commitizen cz-conventional-changelog package.json 中配置：\n\u0026#34;script\u0026#34;: { ..., \u0026#34;commit\u0026#34;: \u0026#34;git-cz\u0026#34;, }, \u0026#34;config\u0026#34;: { \u0026#34;commitizen\u0026#34;: { \u0026#34;path\u0026#34;: \u0026#34;node_modules/cz-conventional-changelog\u0026#34; } } 如果全局安装过 commitizen，那么在对应的项目中执行 git cz or npm run commit 都可以。\n自定义规范 也许 Angular 的那套规范我们不习惯，那么可以通过指定 Adapter leonardoanalista/cz-customizable 指定一套符合自己团队的规范。\n校验 message 可以通过 conventional-changelog/commitlint 校验 commit message。同时可以配合使用 typicode/husky 🐶 Git hooks made easy。\n生成 CHANGELOG conventional-changelog/standard-version 🏆 自动化版本和更新日志生成。\n还看到一个有意思的库 📦🚀 semantic-release 待研究。\nReferences 你可能会忽略的 Git 提交规范 - juejin 优雅的提交你的 Git Commit Message - juejin Commit message 和 Change log 编写指南 - ruanyifeng AngularJS Git Commit Message Conventions - google docs \u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2019/06/04/git-commit-message-style-guide/","summary":"\u003cp\u003ecommit message 应该清晰明了，说明本次提交的目的。基本公式：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-txt\" data-lang=\"txt\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u0026lt;type\u0026gt;(\u0026lt;scope\u0026gt;): \u0026lt;subject\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c!-- more --\u003e\n\u003cp\u003e完整公式：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-txt\" data-lang=\"txt\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u0026lt;type\u0026gt;(\u0026lt;scope\u0026gt;): \u0026lt;subject\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u0026lt;BLANK LINE\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u0026lt;body\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u0026lt;BLANK LINE\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u0026lt;footer\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"type\"\u003etype\u003c/h2\u003e\n\u003cp\u003e用于说明 commit 的类别，只允许使用下面 7 个标识。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003efeat：新功能（feature）\u003c/li\u003e\n\u003cli\u003efix：修补 bug\u003c/li\u003e\n\u003cli\u003edocs：文档（documentation）\u003c/li\u003e\n\u003cli\u003estyle：格式（不影响代码运行的变动）\u003c/li\u003e\n\u003cli\u003erefactor：重构（即不是新增功能，也不是修改 bug 的代码变动）\u003c/li\u003e\n\u003cli\u003etest：增加测试\u003c/li\u003e\n\u003cli\u003echore：构建过程或辅助工具的变动\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"scope\"\u003escope\u003c/h2\u003e\n\u003cp\u003e用于说明 commit 影响的范围，比如数据层、控制层、视图层等等，视项目不同而不同。\u003c/p\u003e\n\u003ch2 id=\"subject\"\u003esubject\u003c/h2\u003e\n\u003cp\u003e是 commit 目的的简短描述，不超过 50 个字符。\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e以动词开头，使用第一人称现在时，比如 change，而不是 changed 或 changes\u003c/li\u003e\n\u003cli\u003e第一个字母小写\u003c/li\u003e\n\u003cli\u003e结尾不加句号 \u003ccode\u003e.\u003c/code\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2 id=\"cli-工具\"\u003ecli 工具\u003c/h2\u003e\n\u003ch3 id=\"commitizen-cli\"\u003ecommitizen cli\u003c/h3\u003e\n\u003cp\u003e\u003ca href=\"https://github.com/commitizen/cz-cli\"\u003ecommitizen/cz-cli\u003c/a\u003e 使用它提供的 \u003ccode\u003egit cz\u003c/code\u003e 命令替代我们的 \u003ccode\u003egit commit\u003c/code\u003e 命令，帮助我们生成符合规范的 commit message。\u003c/p\u003e\n\u003cp\u003e除此之外，我们还需要为 \u003ccode\u003ecommitizen\u003c/code\u003e 指定一个 \u003ccode\u003eAdapter\u003c/code\u003e 比如：\u003ca href=\"https://github.com/commitizen/cz-conventional-changelog\"\u003ecommitizen/cz-conventional-changelog\u003c/a\u003e（一个符合 Angular 团队规范的 preset）使得 \u003ccode\u003ecommitizen\u003c/code\u003e 按照我们指定的规范帮助我们生成 commit message。\u003c/p\u003e","title":"Git 提交 message 规范"},{"content":"MySQL 中的索引可以以一定顺序引用多个列，这种索引叫做联合索引，一般的，一个联合索引是一个有序元组 \u0026lt;a1, a2, …, an\u0026gt;，其中各个元素均为数据表的一列。另外，单列索引可以看成联合索引元素数为 1 的特例。\n我们在 Employees Sample Database 中实验，MySQL 版本 5.7。\n以 employees.titles 为例，查看其索引：\nSHOW INDEX FROM employees.titles; +--------+------------+----------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+ | Table | Non_unique | Key_name | Seq_in_index | Column_name | Collation | Cardinality | Sub_part | Packed | Null | Index_type | Comment | Index_comment | +--------+------------+----------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+ | titles | 0 | PRIMARY | 1 | emp_no | A | 301292 | NULL | NULL | | BTREE | | | | titles | 0 | PRIMARY | 2 | title | A | 442605 | NULL | NULL | | BTREE | | | | titles | 0 | PRIMARY | 3 | from_date | A | 442605 | NULL | NULL | | BTREE | | | +--------+------------+----------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+ 全列匹配 EXPLAIN SELECT * FROM employees.titles WHERE emp_no = \u0026#39;10009\u0026#39; AND title = \u0026#39;Senior Engineer\u0026#39; AND from_date = \u0026#39;1995-02-18\u0026#39;; +----+-------------+--------+------------+-------+---------------+---------+---------+-------------------+------+----------+-------+ | id | select_type | table | partitions | type | possible_keys | key | key_len | ref | rows | filtered | Extra | +----+-------------+--------+------------+-------+---------------+---------+---------+-------------------+------+----------+-------+ | 1 | SIMPLE | titles | NULL | const | PRIMARY | PRIMARY | 159 | const,const,const | 1 | 100.00 | NULL | +----+-------------+--------+------------+-------+---------------+---------+---------+-------------------+------+----------+-------+ 当按照索引中所有列进行精确匹配（这里精确匹配指 = 或 IN 匹配）时，索引可以被用到。\n这里有一点需要注意，理论上索引对顺序是敏感的，但是由于 MySQL 的 查询优化器会自动调整 where 子句的条件顺序 以使用适合的索引，例如我们将 where 中的条件顺序颠倒：\nEXPLAIN SELECT * FROM employees.titles WHERE from_date = \u0026#39;1995-02-18\u0026#39; AND emp_no IN ( \u0026#39;10009\u0026#39; ) AND title = \u0026#39;Senior Engineer\u0026#39;; +----+-------------+--------+------------+-------+---------------+---------+---------+-------------------+------+----------+-------+ | id | select_type | table | partitions | type | possible_keys | key | key_len | ref | rows | filtered | Extra | +----+-------------+--------+------------+-------+---------------+---------+---------+-------------------+------+----------+-------+ | 1 | SIMPLE | titles | NULL | const | PRIMARY | PRIMARY | 159 | const,const,const | 1 | 100.00 | NULL | +----+-------------+--------+------------+-------+---------------+---------+---------+-------------------+------+----------+-------+ 和上面是一样的。\n最左前缀匹配 EXPLAIN SELECT * FROM employees.titles WHERE emp_no = \u0026#39;10009\u0026#39;; +----+-------------+--------+------------+------+---------------+---------+---------+-------+------+----------+-------+ | id | select_type | table | partitions | type | possible_keys | key | key_len | ref | rows | filtered | Extra | +----+-------------+--------+------------+------+---------------+---------+---------+-------+------+----------+-------+ | 1 | SIMPLE | titles | NULL | ref | PRIMARY | PRIMARY | 4 | const | 3 | 100.00 | NULL | +----+-------------+--------+------------+------+---------------+---------+---------+-------+------+----------+-------+ 当查询条件精确匹配索引的 左边连续一个或几个列 时，如 \u0026lt;emp_no\u0026gt; 或 \u0026lt;emp_no, title\u0026gt;，所以可以被用到，但是只能用到一部分，即条件所组成的最左前缀。\n上面的查询从分析结果看用到了 PRIMARY 索引，但是 key_len 为 4，说明只用到了索引的第一列前缀。\n中间某个条件未提供 查询条件用到了索引中列的精确匹配，但是中间某个条件未提供。\nEXPLAIN SELECT * FROM employees.titles WHERE emp_no=\u0026#39;10009\u0026#39; AND from_date=\u0026#39;1995-02-18\u0026#39;; +----+-------------+--------+------------+------+---------------+---------+---------+-------+------+----------+-------------+ | id | select_type | table | partitions | type | possible_keys | key | key_len | ref | rows | filtered | Extra | +----+-------------+--------+------------+------+---------------+---------+---------+-------+------+----------+-------------+ | 1 | SIMPLE | titles | NULL | ref | PRIMARY | PRIMARY | 4 | const | 1 | 10.00 | Using where | +----+-------------+--------+------------+------+---------------+---------+---------+-------+------+----------+-------------+ 此时索引使用情况和情况二相同，因为 title 未提供，所以查询只用到了索引的第一列，而后面的 from_date 虽然也在索引中，但是由于 title 不存在而无法和左前缀连接，因此需要对结果进行扫描过滤 from_date（这里由于 emp_no 唯一，所以不存在扫描）。\n如果想让 from_date 也使用索引而不是 where 过滤，可以增加一个 辅助索引 \u0026lt;emp_no, from_date\u0026gt;，此时上面的查询会使用这个索引。\n除此之外，还可以使用一种称之为 隔离列 的优化方法，将 emp_no 与 from_date 之间的 坑 填上。\n首先我们看下 title 有几种不同的值：\nSELECT DISTINCT(title) FROM employees.titles; 只有 7 种。在这种成为 坑 的列值比较少的情况下，可以考虑用 IN 来填补这个 坑 从而形成最左前缀：\nEXPLAIN SELECT * FROM employees.titles WHERE emp_no=\u0026#39;10009\u0026#39; AND title IN (\u0026#39;Senior Engineer\u0026#39;, \u0026#39;Staff\u0026#39;, \u0026#39;Engineer\u0026#39;, \u0026#39;Senior Staff\u0026#39;, \u0026#39;Assistant Engineer\u0026#39;, \u0026#39;Technique Leader\u0026#39;, \u0026#39;Manager\u0026#39;) AND from_date=\u0026#39;1995-02-18\u0026#39;; +----+-------------+--------+------------+-------+---------------+---------+---------+------+------+----------+-------------+ | id | select_type | table | partitions | type | possible_keys | key | key_len | ref | rows | filtered | Extra | +----+-------------+--------+------------+-------+---------------+---------+---------+------+------+----------+-------------+ | 1 | SIMPLE | titles | NULL | range | PRIMARY | PRIMARY | 159 | NULL | 7 | 100.00 | Using where | +----+-------------+--------+------------+-------+---------------+---------+---------+------+------+----------+-------------+ 这次 key_len 为 159，说明索引被用全了，但是从 type 和 rows 看出 IN 实际上执行了一个 range 查询，这里检查了 7 个 key。看下两种查询的性能比较：\nSET profiling = 1; SELECT * FROM... -- 1 SELECT * FROM... -- 2 SHOW PROFILES; | Query_ID | Duration | Query | +----------+------------+---------+ | 1 | 0.00083950 | SELECT * ..| | 2 | 0.00063700 | SELECT * ..| “填坑” 后性能提升了一点。如果经过 emp_no 筛选后余下很多数据，则后者性能优势会更加明显。当然，如果 title 的值很多，用填坑就不合适了，必须建立辅助索引。（笔者：多次测试后发现是有快有慢，可能是数据的原因，效果并不明显）\n查询条件没有指定索引第一列 EXPLAIN SELECT * FROM employees.titles WHERE from_date=\u0026#39;1995-02-18\u0026#39;; +----+-------------+--------+------------+------+---------------+------+---------+------+--------+----------+-------------+ | id | select_type | table | partitions | type | possible_keys | key | key_len | ref | rows | filtered | Extra | +----+-------------+--------+------------+------+---------------+------+---------+------+--------+----------+-------------+ | 1 | SIMPLE | titles | NULL | ALL | NULL | NULL | NULL | NULL | 442605 | 10.00 | Using where | +----+-------------+--------+------------+------+---------------+------+---------+------+--------+----------+-------------+ 由于不是最左前缀，索引这样的查询显然用不到索引。\n匹配某列的前缀字符串 EXPLAIN SELECT * FROM employees.titles WHERE emp_no=10009 AND title LIKE \u0026#39;Senior%\u0026#39;; +----+-------------+--------+------------+-------+---------------+---------+---------+------+------+----------+-------------+ | id | select_type | table | partitions | type | possible_keys | key | key_len | ref | rows | filtered | Extra | +----+-------------+--------+------------+-------+---------------+---------+---------+------+------+----------+-------------+ | 1 | SIMPLE | titles | NULL | range | PRIMARY | PRIMARY | 156 | NULL | 1 | 100.00 | Using where | +----+-------------+--------+------------+-------+---------------+---------+---------+------+------+----------+-------------+ 此时可以用到索引，如果通配符 % 不出现在开头，则可以用到索引，但根据具体情况不同可能只会用其中一个前缀。\n范围查询 EXPLAIN SELECT * FROM employees.titles WHERE emp_no \u0026lt; \u0026#39;10010\u0026#39; and title = \u0026#39;Senior Engineer\u0026#39;; +----+-------------+--------+------------+-------+---------------+---------+---------+------+------+----------+-------------+ | id | select_type | table | partitions | type | possible_keys | key | key_len | ref | rows | filtered | Extra | +----+-------------+--------+------------+-------+---------------+---------+---------+------+------+----------+-------------+ | 1 | SIMPLE | titles | NULL | range | PRIMARY | PRIMARY | 4 | NULL | 14 | 10.00 | Using where | +----+-------------+--------+------------+-------+---------------+---------+---------+------+------+----------+-------------+ 范围列可以用到索引（必须是最左前缀），但是范围列后面的列无法用到索引。同时，索引最多用于一个范围列，因此如果查询条件中有两个范围列则无法全用到索引。\nEXPLAIN SELECT * FROM employees.titles WHERE emp_no \u0026lt; \u0026#39;10010\u0026#39; AND title = \u0026#39;Senior Engineer\u0026#39; AND from_date BETWEEN \u0026#39;1986-01-01\u0026#39; AND \u0026#39;1986-12-31\u0026#39;; +----+-------------+--------+------------+-------+---------------+---------+---------+------+------+----------+-------------+ | id | select_type | table | partitions | type | possible_keys | key | key_len | ref | rows | filtered | Extra | +----+-------------+--------+------------+-------+---------------+---------+---------+------+------+----------+-------------+ | 1 | SIMPLE | titles | NULL | range | PRIMARY | PRIMARY | 4 | NULL | 14 | 1.11 | Using where | +----+-------------+--------+------------+-------+---------------+---------+---------+------+------+----------+-------------+ 可以看到索引对第二个范围索引无能为力。这里特别要说明 MySQL 一个有意思的地方，那就是仅用 explain 可能无法区分 范围索引 和 多值匹配，因为在 type 中这两者都显示为 range。\n同时，用了 between 并不意味着就是范围查询，例如下面的查询：\nEXPLAIN SELECT * FROM employees.titles WHERE emp_no BETWEEN \u0026#39;10001\u0026#39; AND \u0026#39;10010\u0026#39; AND title=\u0026#39;Senior Engineer\u0026#39; AND from_date BETWEEN \u0026#39;1986-01-01\u0026#39; AND \u0026#39;1986-12-31\u0026#39;; +----+-------------+--------+------------+-------+---------------+---------+---------+------+------+----------+-------------+ | id | select_type | table | partitions | type | possible_keys | key | key_len | ref | rows | filtered | Extra | +----+-------------+--------+------------+-------+---------------+---------+---------+------+------+----------+-------------+ | 1 | SIMPLE | titles | NULL | range | PRIMARY | PRIMARY | 159 | NULL | 15 | 1.11 | Using where | +----+-------------+--------+------------+-------+---------------+---------+---------+------+------+----------+-------------+ 看起来是用了两个范围查询，但作用于 emp_no 上的 BETWEEN 实际上相当于 IN，也就是说 emp_no 实际是多值精确匹配。可以看到这个查询用到了索引全部三个列。因此在 MySQL 中要谨慎地区分多值匹配和范围匹配，否则会对 MySQL 的行为产生困惑。\n还有个值得注意的事情：\nEXPLAIN SELECT * FROM employees.titles where emp_no \u0026gt; 10000 AND emp_no \u0026lt; 10011 AND title=\u0026#39;Senior Engineer\u0026#39; AND from_date BETWEEN \u0026#39;1986-01-01\u0026#39; AND \u0026#39;1986-12-31\u0026#39;; +----+-------------+--------+------------+-------+---------------+---------+---------+------+------+----------+-------------+ | id | select_type | table | partitions | type | possible_keys | key | key_len | ref | rows | filtered | Extra | +----+-------------+--------+------------+-------+---------------+---------+---------+------+------+----------+-------------+ | 1 | SIMPLE | titles | NULL | range | PRIMARY | PRIMARY | 4 | NULL | 15 | 1.11 | Using where | +----+-------------+--------+------------+-------+---------------+---------+---------+------+------+----------+-------------+ EXPLAIN SELECT * FROM employees.titles where emp_no \u0026gt;= 10001 and emp_no \u0026lt;= 10010 AND title=\u0026#39;Senior Engineer\u0026#39; AND from_date BETWEEN \u0026#39;1986-01-01\u0026#39; AND \u0026#39;1986-12-31\u0026#39;; +----+-------------+--------+------------+-------+---------------+---------+---------+------+------+----------+-------------+ | id | select_type | table | partitions | type | possible_keys | key | key_len | ref | rows | filtered | Extra | +----+-------------+--------+------------+-------+---------------+---------+---------+------+------+----------+-------------+ | 1 | SIMPLE | titles | NULL | range | PRIMARY | PRIMARY | 159 | NULL | 15 | 1.11 | Using where | +----+-------------+--------+------------+-------+---------------+---------+---------+------+------+----------+-------------+ 疑问：= 影响 范围索引 还是 多值匹配？\n查询条件中含有函数或表达式 很不幸，如果查询条件中含有函数或表达式，则 MySQL 不会为这列使用索引（虽然某些在数学意义上可以使用）。例如：\nEXPLAIN SELECT * FROM employees.titles WHERE emp_no=\u0026#39;10009\u0026#39; AND left(title, 6)=\u0026#39;Senior\u0026#39;; +----+-------------+--------+------------+------+---------------+---------+---------+-------+------+----------+-------------+ | id | select_type | table | partitions | type | possible_keys | key | key_len | ref | rows | filtered | Extra | +----+-------------+--------+------------+------+---------------+---------+---------+-------+------+----------+-------------+ | 1 | SIMPLE | titles | NULL | ref | PRIMARY | PRIMARY | 4 | const | 3 | 100.00 | Using where | +----+-------------+--------+------------+------+---------------+---------+---------+-------+------+----------+-------------+ 虽然这个查询和情况五中功能相同，但是由于使用了函数 left，则无法为 title 列应用索引，而情况五中用 LIKE 则可以。\nEXPLAIN SELECT * FROM employees.titles WHERE emp_no - 1 = 10000; +----+-------------+--------+------------+------+---------------+------+---------+------+--------+----------+-------------+ | id | select_type | table | partitions | type | possible_keys | key | key_len | ref | rows | filtered | Extra | +----+-------------+--------+------------+------+---------------+------+---------+------+--------+----------+-------------+ | 1 | SIMPLE | titles | NULL | ALL | NULL | NULL | NULL | NULL | 442605 | 100.00 | Using where | +----+-------------+--------+------------+------+---------------+------+---------+------+--------+----------+-------------+ 显然这个查询等价于查询 emp_no 为 10001 的函数，但是由于查询条件是一个表达式，MySQL 无法为其使用索引。看来 MySQL 还没有智能到自动优化常量表达式的程度，因此在写查询语句时尽量避免表达式出现在查询中，而是先手工私下代数运算，转换为无表达式的查询语句。\nReferences MySQL 索引背后的数据结构及算法原理 13.7.5.30 SHOW PROFILE Syntax \u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2019/05/25/the-left-prefix-index-rule/","summary":"\u003cp\u003eMySQL 中的索引可以以一定顺序引用多个列，这种索引叫做联合索引，一般的，一个联合索引是一个有序元组 \u003ccode\u003e\u0026lt;a1, a2, …, an\u0026gt;\u003c/code\u003e，其中各个元素均为数据表的一列。另外，单列索引可以看成联合索引元素数为 1 的特例。\u003c/p\u003e\n\u003cp\u003e我们在 \u003ca href=\"https://dev.mysql.com/doc/employee/en/employees-installation.html\"\u003eEmployees Sample Database\u003c/a\u003e 中实验，MySQL 版本 5.7。\u003c/p\u003e\n\u003c!-- more --\u003e\n\u003cp\u003e以 employees.titles 为例，查看其索引：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sql\" data-lang=\"sql\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eSHOW\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eINDEX\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eFROM\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eemployees\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003etitles\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"o\"\u003e+\u003c/span\u003e\u003cspan class=\"c1\"\u003e--------+------------+----------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eTable\u003c/span\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eNon_unique\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eKey_name\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eSeq_in_index\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eColumn_name\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eCollation\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eCardinality\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eSub_part\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ePacked\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eNull\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eIndex_type\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eComment\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eIndex_comment\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"o\"\u003e+\u003c/span\u003e\u003cspan class=\"c1\"\u003e--------+------------+----------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003etitles\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e          \u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003ePRIMARY\u003c/span\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e            \u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eemp_no\u003c/span\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eA\u003c/span\u003e\u003cspan class=\"w\"\u003e         \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"mi\"\u003e301292\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e     \u003c/span\u003e\u003cspan class=\"k\"\u003eNULL\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eNULL\u003c/span\u003e\u003cspan class=\"w\"\u003e   \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eBTREE\u003c/span\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e         \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e               \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003etitles\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e          \u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003ePRIMARY\u003c/span\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e            \u003c/span\u003e\u003cspan class=\"mi\"\u003e2\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003etitle\u003c/span\u003e\u003cspan class=\"w\"\u003e       \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eA\u003c/span\u003e\u003cspan class=\"w\"\u003e         \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"mi\"\u003e442605\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e     \u003c/span\u003e\u003cspan class=\"k\"\u003eNULL\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eNULL\u003c/span\u003e\u003cspan class=\"w\"\u003e   \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eBTREE\u003c/span\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e         \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e               \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003etitles\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e          \u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003ePRIMARY\u003c/span\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e            \u003c/span\u003e\u003cspan class=\"mi\"\u003e3\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003efrom_date\u003c/span\u003e\u003cspan class=\"w\"\u003e   \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eA\u003c/span\u003e\u003cspan class=\"w\"\u003e         \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"mi\"\u003e442605\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e     \u003c/span\u003e\u003cspan class=\"k\"\u003eNULL\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eNULL\u003c/span\u003e\u003cspan class=\"w\"\u003e   \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eBTREE\u003c/span\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e         \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e               \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"o\"\u003e+\u003c/span\u003e\u003cspan class=\"c1\"\u003e--------+------------+----------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"全列匹配\"\u003e全列匹配\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sql\" data-lang=\"sql\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eEXPLAIN\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eSELECT\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eFROM\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eemployees\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003etitles\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003eWHERE\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eemp_no\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;10009\u0026#39;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eAND\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003etitle\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;Senior Engineer\u0026#39;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eAND\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003efrom_date\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;1995-02-18\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"o\"\u003e+\u003c/span\u003e\u003cspan class=\"c1\"\u003e----+-------------+--------+------------+-------+---------------+---------+---------+-------------------+------+----------+-------+\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eid\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eselect_type\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003etable\u003c/span\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003epartitions\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003etype\u003c/span\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003epossible_keys\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003ekey\u003c/span\u003e\u003cspan class=\"w\"\u003e     \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ekey_len\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eref\u003c/span\u003e\u003cspan class=\"w\"\u003e               \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003erows\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003efiltered\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eExtra\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"o\"\u003e+\u003c/span\u003e\u003cspan class=\"c1\"\u003e----+-------------+--------+------------+-------+---------------+---------+---------+-------------------+------+----------+-------+\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eSIMPLE\u003c/span\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003etitles\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eNULL\u003c/span\u003e\u003cspan class=\"w\"\u003e       \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003econst\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003ePRIMARY\u003c/span\u003e\u003cspan class=\"w\"\u003e       \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003ePRIMARY\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e159\u003c/span\u003e\u003cspan class=\"w\"\u003e     \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003econst\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"n\"\u003econst\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"n\"\u003econst\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e   \u003c/span\u003e\u003cspan class=\"mi\"\u003e100\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"mi\"\u003e00\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eNULL\u003c/span\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"o\"\u003e+\u003c/span\u003e\u003cspan class=\"c1\"\u003e----+-------------+--------+------------+-------+---------------+---------+---------+-------------------+------+----------+-------+\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e当按照索引中所有列进行精确匹配（这里精确匹配指 \u003ccode\u003e=\u003c/code\u003e 或 \u003ccode\u003eIN\u003c/code\u003e 匹配）时，索引可以被用到。\u003c/p\u003e","title":"最左前缀原理与相关优化"},{"content":"归并排序（英语：Merge sort，或 mergesort），是创建在归并操作上的一种有效的排序算法，效率为 O(nlogn)。1945 年由约翰·冯·诺伊曼首次提出。该算法是采用分治法（Divide and Conquer）的一个非常典型的应用，且各层分治递归可以同时进行。\n采用分治法：\n分割：递归地把当前序列平均分割成两半。 集成：在保持元素顺序的同时将上一步得到的子序列集成到一起（归并）。 归并操作（merge），也叫归并算法，指的是将两个已经排序的序列合并成一个序列的操作。归并排序算法依赖归并操作。\n\u0026lt;?php function mergeSort($arr) { $len = count($arr); if ($len \u0026lt;= 1) { return $arr; } // 递归结束条件, 到达这步的时候, 数组就只剩下一个元素了, 也就是分离了数组 $mid = $len / 2; $left = array_slice($arr, 0, $mid); // 拆分数组0-mid这部分给左边left $right = array_slice($arr, $mid); // 拆分数组mid-末尾这部分给右边right $left = mergeSort($left); // 左边拆分完后开始递归合并往上走 $right = mergeSort($right); // 右边拆分完毕开始递归往上走 $arr = merge($left, $right); // 合并两个数组,继续递归 return $arr; } // merge函数将指定的两个有序数组(arrA, arr)合并并且排序 function merge($arrA, $arrB) { $arrC = array(); while (count($arrA) \u0026amp;\u0026amp; count($arrB)) { // 这里不断的判断哪个值小, 就将小的值给到arrC, 但是到最后肯定要剩下几个值, // 不是剩下arrA里面的就是剩下arrB里面的而且这几个有序的值, 肯定比arrC里面所有的值都大所以使用 $arrC[] = $arrA[0] \u0026lt; $arrB[0] ? array_shift($arrA) : array_shift($arrB); } return array_merge($arrC, $arrA, $arrB); } $startTime = microtime(1); $arr = range(1, 1000); shuffle($arr); echo \u0026#39;before sort: \u0026#39;, implode(\u0026#39;, \u0026#39;, $arr), \u0026#34;\\n\u0026#34;; $sortArr = mergeSort($arr); echo \u0026#39;after sort: \u0026#39;, implode(\u0026#39;, \u0026#39;, $sortArr), \u0026#34;\\n\u0026#34;; echo \u0026#39;use time: \u0026#39;, microtime(1) - $startTime, \u0026#34;s\\n\u0026#34;; 假设被排序的数列中有 N 个数。遍历一趟的时间复杂度是 O(N)，需要遍历多少次呢？\n归并排序的形式就是一棵二叉树，它需要遍历的次数就是二叉树的深度，而根据 完全二叉树 的可以得出它的时间复杂度是 O(N*lgN)。\nReferences PHP 算法 —— 归并排序 \u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2019/05/23/merge-sort/","summary":"\u003cp\u003e归并排序（英语：Merge sort，或 mergesort），是创建在归并操作上的一种有效的排序算法，效率为 \u003ccode\u003eO(nlogn)\u003c/code\u003e。1945 年由约翰·冯·诺伊曼首次提出。该算法是采用分治法（Divide and Conquer）的一个非常典型的应用，且各层分治递归可以同时进行。\u003c/p\u003e\n\u003c!-- more --\u003e\n\u003cp\u003e\u003cimg alt=\"merge-sort\" loading=\"lazy\" src=\"https://user-images.githubusercontent.com/9289792/58546744-9751a300-8238-11e9-84d1-0d33d5eaacee.gif\"\u003e\u003c/p\u003e\n\u003cp\u003e采用分治法：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e分割：递归地把当前序列平均分割成两半。\u003c/li\u003e\n\u003cli\u003e集成：在保持元素顺序的同时将上一步得到的子序列集成到一起（归并）。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e归并操作（merge），也叫归并算法，指的是将两个已经排序的序列合并成一个序列的操作。归并排序算法依赖归并操作。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e\u0026lt;?\u003c/span\u003e\u003cspan class=\"nx\"\u003ephp\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003efunction\u003c/span\u003e \u003cspan class=\"nf\"\u003emergeSort\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$arr\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nv\"\u003e$len\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003ecount\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$arr\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$len\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;=\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nv\"\u003e$arr\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"c1\"\u003e// 递归结束条件, 到达这步的时候, 数组就只剩下一个元素了, 也就是分离了数组\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nv\"\u003e$mid\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nv\"\u003e$len\u003c/span\u003e \u003cspan class=\"o\"\u003e/\u003c/span\u003e \u003cspan class=\"mi\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nv\"\u003e$left\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003earray_slice\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$arr\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$mid\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"c1\"\u003e// 拆分数组0-mid这部分给左边left\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e    \u003cspan class=\"nv\"\u003e$right\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003earray_slice\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$arr\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$mid\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"c1\"\u003e// 拆分数组mid-末尾这部分给右边right\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e    \u003cspan class=\"nv\"\u003e$left\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003emergeSort\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$left\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"c1\"\u003e// 左边拆分完后开始递归合并往上走\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e    \u003cspan class=\"nv\"\u003e$right\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003emergeSort\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$right\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"c1\"\u003e// 右边拆分完毕开始递归往上走\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nv\"\u003e$arr\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003emerge\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$left\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$right\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"c1\"\u003e// 合并两个数组,继续递归\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nv\"\u003e$arr\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// merge函数将指定的两个有序数组(arrA, arr)合并并且排序\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003efunction\u003c/span\u003e \u003cspan class=\"nf\"\u003emerge\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$arrA\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$arrB\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nv\"\u003e$arrC\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003earray\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003ewhile\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ecount\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$arrA\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan class=\"nx\"\u003ecount\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$arrB\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"c1\"\u003e// 这里不断的判断哪个值小, 就将小的值给到arrC, 但是到最后肯定要剩下几个值,\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e        \u003cspan class=\"c1\"\u003e// 不是剩下arrA里面的就是剩下arrB里面的而且这几个有序的值, 肯定比arrC里面所有的值都大所以使用\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e        \u003cspan class=\"nv\"\u003e$arrC\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nv\"\u003e$arrA\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"nv\"\u003e$arrB\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e?\u003c/span\u003e \u003cspan class=\"nx\"\u003earray_shift\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$arrA\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"nx\"\u003earray_shift\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$arrB\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nx\"\u003earray_merge\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$arrC\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$arrA\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$arrB\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$startTime\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003emicrotime\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$arr\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003erange\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e1000\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003eshuffle\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$arr\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eecho\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;before sort: \u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eimplode\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;, \u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$arr\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"se\"\u003e\\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$sortArr\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003emergeSort\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$arr\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eecho\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;after sort: \u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eimplode\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;, \u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$sortArr\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"se\"\u003e\\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eecho\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;use time: \u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003emicrotime\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e \u003cspan class=\"nv\"\u003e$startTime\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;s\u003c/span\u003e\u003cspan class=\"se\"\u003e\\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e假设被排序的数列中有 N 个数。遍历一趟的时间复杂度是 \u003ccode\u003eO(N)\u003c/code\u003e，需要遍历多少次呢？\u003c/p\u003e","title":"归并排序"},{"content":"个人 MacBook 食用说明。推荐自动化环境配置脚本项目 imzyf/dotfiles。\n软件下载 使用 brew cask 安装软件，非常方便。\n安装 brew：\n/bin/bash -c \u0026#34;$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)\u0026#34; # 查找软件 brew desc iterm2 brew search iterm2 brew info iterm2 # 安装软件 brew install --cask iterm2 软件清单 brew cask arc Chromium based browser chromium - Free and open-source web browser 🌐 dbeaver-community - Universal database tool and SQL client 🌐 docker - App to build and share containerised applications and microservices 🌐 office network can\u0026rsquo;t access https://desktop.docker.com/, have to manual install. drawio - Online diagram software 🌐 figma - Collaborative team software 💅🏼 firefox fork GIT client github - Desktop client for GitHub repositories 🌐 google-chrome - Web browser 💻 iina - Free and open-source media player 💻 imageoptim - Tool to optimise images to a smaller size 💻 iterm2 - Terminal emulator as alternative to Apple\u0026rsquo;s Terminal app 💻 itsycal - Menu bar calendar 💻 licecap - Animated screen capture application 💻 logitech-g-hub - Support for Logitech G gear 💻 mysqlworkbench notion - App to write, plan, collaborate, and get organised 💻 openinterminal orbstack Replacement for Docker Desktop phpstorm postman - Collaboration platform for API development 💻 qlstephen - Quick Look plugin for plaintext files without an extension 💻 raycast Control your tools with a few keystrokes sequel-ace slack snipaste - Snip or pin screenshots 💻 sourcetree - Graphical client for Git version control 💻 the-unarchiver - Unpacks archive files visual-studio-code warp - Rust-based terminal 💻 wetype - Text input app from WeChat team for Chinese users 💻 youdaodict - Youdao Dictionary 💻 zoom-for-it-admins brew cask archive adrive - Intelligent cloud storage platform 💻 another-redis-desktop-manager - Redis desktop manager 🌐 baidunetdisk - Cloud storage service 💻 blender - 3D creation suite 💅🏼 lens - Kubernetes IDE 🌐 mongodb-compass - Interactive tool for analyzing MongoDB data 🌐 fliqlo - Flip clock screensaver - 可以配合 触发角 使用 paper - Pap.er, 4K 5K HD Wallpaper Application 💻 wireshark - Network analyzer and capture tool - without graphical user interface 🌐 path-finder - 💰 dash - API documentation browser and code snippet manager - 💰 Medis 2 - 💰 redisinsight GUI for streamlined Redis application development craft Native document editor input-source-pro Tool for multi-language users cleanshot Screen capturing tool cleanmymac-zh - Tool to remove unnecessary files and folders from disk - 💰 # brew list # brew list --cask # # ==\u0026gt; Casks # # arc # chromium # dbeaver-community # drawio # eudic # figma # firefox # fork # github # google-chrome # iina # imageoptim # iterm2 # itsycal # licecap # logitech-g-hub # mysqlworkbench # notion # openinterminal # orbstack # phpstorm # postman # qlstephen # raycast # sequel-ace # slack # snipaste # sourcetree # the-unarchiver # visual-studio-code # warp # wetype # youdaodict # zoom-for-it-admins # # 💻 brew install --cask adrive alfred google-chrome visual-studio-code brew install --cask visual-studio-code wetype youdaodict # 🌐 brew install --cask itsycal # 💅🏼 brew install --cask blender brew mas Mac App Store command-line interface nvm curl jmeter - Load testing and performance measurement application wget yarn protobuf - Protocol buffers (Google\u0026rsquo;s data interchange format) ripgrep recursively searches directories for a regex pattern while respecting your gitignore fish Manual charles - Web debugging Proxy application - 💰 Navicat Premium - 💰 oh-my-zsh ClashX Pro axure-rp - Planning and prototyping tool for developers - 💰 Badgeify Add Any App to Your Mac Menu Bar one-key-hidpi 3182x1332 App Store  Xnip - Handy Screenshot App for Mac iHosts - /etc/hosts 编辑器 Xiaomi Home # brew install mas # mas search Xnip # mas upgrade # Xnip mas install 1221250572 # iHosts mas install 408981434 # WeChat mas install 836500024 # QQ音乐 mas install 595615424 # Xcode mas install 497799835 # MoneyThings 记账 mas install 1549694221 # Xiaomi Home, needed manual install mas install 957323480 AI BoltAI TypingMind LobeChat Ollama 快捷键 Mac 键盘快捷键 Chrome 键盘快捷键 个性化设置 触发角：系统偏好设置 -\u0026gt; 桌面与屏幕保护程序 -\u0026gt; 屏幕保护程序 -\u0026gt; 触发角 \u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2019/05/20/my-macbook/","summary":"\u003cp\u003e个人 MacBook 食用说明。推荐自动化环境配置脚本项目 \u003ca href=\"https://github.com/imzyf/dotfiles\"\u003eimzyf/dotfiles\u003c/a\u003e。\u003c/p\u003e\n\u003c!-- more --\u003e\n\u003ch2 id=\"软件下载\"\u003e软件下载\u003c/h2\u003e\n\u003cp\u003e使用 \u003ccode\u003ebrew cask\u003c/code\u003e 安装软件，非常方便。\u003c/p\u003e\n\u003cp\u003e安装 \u003ca href=\"https://brew.sh/\"\u003ebrew\u003c/a\u003e：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e/bin/bash -c \u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"k\"\u003e$(\u003c/span\u003ecurl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh\u003cspan class=\"k\"\u003e)\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# 查找软件\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ebrew desc iterm2\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ebrew search iterm2\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ebrew info iterm2\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# 安装软件\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ebrew install --cask iterm2\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"软件清单\"\u003e软件清单\u003c/h2\u003e\n\u003ch3 id=\"brew-cask\"\u003ebrew cask\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://formulae.brew.sh/cask/arc#default\"\u003earc\u003c/a\u003e Chromium based browser\u003c/li\u003e\n\u003cli\u003echromium - Free and open-source web browser 🌐\u003c/li\u003e\n\u003cli\u003edbeaver-community - Universal database tool and SQL client 🌐\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://formulae.brew.sh/cask/docker#default\"\u003edocker\u003c/a\u003e - App to build and share containerised applications and microservices 🌐 office network can\u0026rsquo;t access \u003ccode\u003ehttps://desktop.docker.com/\u003c/code\u003e, have to \u003ca href=\"https://www.docker.com/products/docker-desktop\"\u003emanual install\u003c/a\u003e.\u003c/li\u003e\n\u003cli\u003edrawio - Online diagram software 🌐\u003c/li\u003e\n\u003cli\u003efigma - Collaborative team software 💅🏼\u003c/li\u003e\n\u003cli\u003efirefox\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://formulae.brew.sh/cask/fork#default\"\u003efork\u003c/a\u003e GIT client\u003c/li\u003e\n\u003cli\u003egithub - Desktop client for GitHub repositories 🌐\u003c/li\u003e\n\u003cli\u003egoogle-chrome - Web browser 💻\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://formulae.brew.sh/cask/iina#default\"\u003eiina\u003c/a\u003e - Free and open-source media player 💻\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://formulae.brew.sh/cask/imageoptim#default\"\u003eimageoptim\u003c/a\u003e - Tool to optimise images to a smaller size 💻\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://formulae.brew.sh/cask/iterm2#default\"\u003eiterm2\u003c/a\u003e - Terminal emulator as alternative to Apple\u0026rsquo;s Terminal app 💻\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://formulae.brew.sh/cask/itsycal#default\"\u003eitsycal\u003c/a\u003e - Menu bar calendar 💻\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://formulae.brew.sh/cask/licecap#default\"\u003elicecap\u003c/a\u003e - Animated screen capture application 💻\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://formulae.brew.sh/cask/logitech-g-hub#default\"\u003elogitech-g-hub\u003c/a\u003e - Support for Logitech G gear 💻\u003c/li\u003e\n\u003cli\u003emysqlworkbench\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://formulae.brew.sh/cask/notion#default\"\u003enotion\u003c/a\u003e - App to write, plan, collaborate, and get organised 💻\u003c/li\u003e\n\u003cli\u003eopeninterminal\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://formulae.brew.sh/cask/orbstack#default\"\u003eorbstack\u003c/a\u003e Replacement for Docker Desktop\u003c/li\u003e\n\u003cli\u003ephpstorm\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://formulae.brew.sh/cask/postman#default\"\u003epostman\u003c/a\u003e - Collaboration platform for API development 💻\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://formulae.brew.sh/cask/qlstephen#default\"\u003eqlstephen\u003c/a\u003e - Quick Look plugin for plaintext files without an extension 💻\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://formulae.brew.sh/cask/raycast#default\"\u003eraycast\u003c/a\u003e Control your tools with a few keystrokes\u003c/li\u003e\n\u003cli\u003esequel-ace\u003c/li\u003e\n\u003cli\u003eslack\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://formulae.brew.sh/cask/snipaste#default\"\u003esnipaste\u003c/a\u003e - Snip or pin screenshots 💻\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.sourcetreeapp.com/\"\u003esourcetree\u003c/a\u003e - Graphical client for Git version control 💻\u003c/li\u003e\n\u003cli\u003ethe-unarchiver - Unpacks archive files\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://formulae.brew.sh/cask/visual-studio-code#default\"\u003evisual-studio-code\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://formulae.brew.sh/cask/warp#default\"\u003ewarp\u003c/a\u003e - Rust-based terminal 💻\u003c/li\u003e\n\u003cli\u003ewetype - Text input app from WeChat team for Chinese users 💻\u003c/li\u003e\n\u003cli\u003eyoudaodict - Youdao Dictionary 💻\u003c/li\u003e\n\u003cli\u003ezoom-for-it-admins\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"brew-cask-archive\"\u003ebrew cask archive\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://formulae.brew.sh/cask/adrive#default\"\u003eadrive\u003c/a\u003e - Intelligent cloud storage platform 💻\u003c/li\u003e\n\u003cli\u003eanother-redis-desktop-manager - Redis desktop manager 🌐\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://formulae.brew.sh/cask/baidunetdisk#default\"\u003ebaidunetdisk\u003c/a\u003e - Cloud storage service 💻\u003c/li\u003e\n\u003cli\u003eblender - 3D creation suite 💅🏼\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://formulae.brew.sh/cask/lens#default\"\u003elens\u003c/a\u003e - Kubernetes IDE 🌐\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://formulae.brew.sh/cask/mongodb-compass#default\"\u003emongodb-compass\u003c/a\u003e - Interactive tool for analyzing MongoDB data 🌐\u003c/li\u003e\n\u003cli\u003efliqlo - Flip clock screensaver - 可以配合 \u003ccode\u003e触发角\u003c/code\u003e 使用\u003c/li\u003e\n\u003cli\u003epaper - Pap.er, 4K 5K HD Wallpaper Application 💻\u003c/li\u003e\n\u003cli\u003ewireshark - Network analyzer and capture tool - without graphical user interface 🌐\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://formulae.brew.sh/cask/path-finder#default\"\u003epath-finder\u003c/a\u003e  - 💰\u003c/li\u003e\n\u003cli\u003edash - API documentation browser and code snippet manager  - 💰\u003c/li\u003e\n\u003cli\u003eMedis 2 - 💰\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://formulae.brew.sh/cask/redisinsight#default\"\u003eredisinsight\u003c/a\u003e GUI for streamlined Redis application development\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://formulae.brew.sh/cask/craft#default\"\u003ecraft\u003c/a\u003e Native document editor\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://formulae.brew.sh/cask/input-source-pro#default\"\u003einput-source-pro\u003c/a\u003e Tool for multi-language users\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://formulae.brew.sh/cask/cleanshot#default\"\u003ecleanshot\u003c/a\u003e Screen capturing tool\u003c/li\u003e\n\u003cli\u003ecleanmymac-zh - Tool to remove unnecessary files and folders from disk  - 💰\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# brew list\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# brew list --cask\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e#\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# ==\u0026gt; Casks\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e#\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# arc\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# chromium\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# dbeaver-community\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# drawio\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# eudic\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# figma\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# firefox\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# fork\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# github\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# google-chrome\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# iina\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# imageoptim\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# iterm2\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# itsycal\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# licecap\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# logitech-g-hub\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# mysqlworkbench\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# notion\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# openinterminal\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# orbstack\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# phpstorm\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# postman\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# qlstephen\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# raycast\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# sequel-ace\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# slack\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# snipaste\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# sourcetree\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# the-unarchiver\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# visual-studio-code\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# warp\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# wetype\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# youdaodict\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# zoom-for-it-admins\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e#\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# 💻\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ebrew install --cask adrive alfred google-chrome visual-studio-code\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ebrew install --cask visual-studio-code wetype youdaodict\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# 🌐\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ebrew install --cask itsycal\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# 💅🏼\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ebrew install --cask blender\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"brew\"\u003ebrew\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://formulae.brew.sh/formula/mas#default\"\u003emas\u003c/a\u003e Mac App Store command-line interface\u003c/li\u003e\n\u003cli\u003envm\u003c/li\u003e\n\u003cli\u003ecurl\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://formulae.brew.sh/formula/jmeter#default\"\u003ejmeter\u003c/a\u003e - Load testing and performance measurement application\u003c/li\u003e\n\u003cli\u003ewget\u003c/li\u003e\n\u003cli\u003eyarn\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://formulae.brew.sh/formula/protobuf#default\"\u003eprotobuf\u003c/a\u003e - Protocol buffers (Google\u0026rsquo;s data interchange format)\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/BurntSushi/ripgrep\"\u003eripgrep\u003c/a\u003e recursively searches directories for a regex pattern while respecting your gitignore\u003c/li\u003e\n\u003cli\u003e\u003cdel\u003efish\u003c/del\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"manual\"\u003eManual\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003echarles - Web debugging Proxy application - 💰\u003c/li\u003e\n\u003cli\u003eNavicat Premium  - 💰\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://ohmyz.sh/\"\u003eoh-my-zsh\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://install.appcenter.ms/users/clashx/apps/clashx-pro/distribution_groups/public\"\u003eClashX Pro\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003eaxure-rp - Planning and prototyping tool for developers - 💰\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://badgeify.app/\"\u003eBadgeify\u003c/a\u003e Add Any App to Your Mac Menu Bar\u003c/li\u003e\n\u003cli\u003e\u003cdel\u003e\u003ca href=\"https://github.com/xzhih/one-key-hidpi\"\u003eone-key-hidpi\u003c/a\u003e 3182x1332\u003c/del\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"app-store-\"\u003eApp Store \u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eXnip - Handy Screenshot App for Mac\u003c/li\u003e\n\u003cli\u003eiHosts - /etc/hosts 编辑器\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://apps.apple.com/cn/app/xiaomi-home/id957323480?l=en-GB\"\u003eXiaomi Home\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# brew install mas\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# mas search Xnip\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# mas upgrade\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Xnip\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003emas install \u003cspan class=\"m\"\u003e1221250572\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# iHosts\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003emas install \u003cspan class=\"m\"\u003e408981434\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# WeChat\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003emas install \u003cspan class=\"m\"\u003e836500024\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# QQ音乐\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003emas install \u003cspan class=\"m\"\u003e595615424\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Xcode\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003emas install \u003cspan class=\"m\"\u003e497799835\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# MoneyThings 记账\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003emas install \u003cspan class=\"m\"\u003e1549694221\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Xiaomi Home, needed manual install\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003emas install \u003cspan class=\"m\"\u003e957323480\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"ai\"\u003eAI\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eBoltAI\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.typingmind.com/\"\u003eTypingMind\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003eLobeChat\u003c/li\u003e\n\u003cli\u003eOllama\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"快捷键\"\u003e快捷键\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://support.apple.com/zh-cn/102650\"\u003eMac 键盘快捷键\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://support.google.com/chrome/answer/157179?hl=zh-Hans\"\u003eChrome 键盘快捷键\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"个性化设置\"\u003e个性化设置\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e触发角：\u003ccode\u003e系统偏好设置 -\u0026gt; 桌面与屏幕保护程序 -\u0026gt; 屏幕保护程序 -\u0026gt; 触发角\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u0026ndash; EOF \u0026ndash;\u003c/p\u003e","title":"My MacBook"},{"content":"启动 Laravel 5.8 文章以 Laravel 学习。入口文件 public/index.php：\n// Register The Auto Loader require __DIR__.\u0026#39;/../vendor/autoload.php\u0026#39;; autoload.php 不负责具体功能逻辑，只做了两件事：初始化自动加载类、注册自动加载类。\nautoload_real.php 中的类名为 ComposerAutoloaderInit... 这可能是为防止与用户自定义类名跟这个类重复冲突，加上了哈希值。\n其实还有一个做法我们更加熟悉，是定义一个命名空间。这里为什么不定义一个命名空间呢？一种理解：命名空间一般都是为了复用，而这个类只需要运行一次即可，以后也不会用得到，用哈希值更加合适。\nautoload_real.php autoload.php 主要调用了 getLoader()：\npublic static function getLoader() { // 单例模式，自动加载类只能有一个 1 if (null !== self::$loader) { return self::$loader; } // 获得自动加载核心类对象 2 spl_autoload_register(array(\u0026#39;ComposerAutoloaderInit76e88f0b305cd64c7c84b90b278c31db\u0026#39;, \u0026#39;loadClassLoader\u0026#39;), true, true); self::$loader = $loader = new \\Composer\\Autoload\\ClassLoader(); spl_autoload_unregister(array(\u0026#39;ComposerAutoloaderInit76e88f0b305cd64c7c84b90b278c31db\u0026#39;, \u0026#39;loadClassLoader\u0026#39;)); // 初始化自动加载核心类对象 3 $useStaticLoader = PHP_VERSION_ID \u0026gt;= 50600 \u0026amp;\u0026amp; !defined(\u0026#39;HHVM_VERSION\u0026#39;) \u0026amp;\u0026amp; (!function_exists(\u0026#39;zend_loader_file_encoded\u0026#39;) || !zend_loader_file_encoded()); if ($useStaticLoader) { require_once __DIR__ . \u0026#39;/autoload_static.php\u0026#39;; call_user_func(\\Composer\\Autoload\\ComposerStaticInit76e88f0b305cd64c7c84b90b278c31db::getInitializer($loader)); } else { $map = require __DIR__ . \u0026#39;/autoload_namespaces.php\u0026#39;; foreach ($map as $namespace =\u0026gt; $path) { $loader-\u0026gt;set($namespace, $path); } $map = require __DIR__ . \u0026#39;/autoload_psr4.php\u0026#39;; foreach ($map as $namespace =\u0026gt; $path) { $loader-\u0026gt;setPsr4($namespace, $path); } $classMap = require __DIR__ . \u0026#39;/autoload_classmap.php\u0026#39;; if ($classMap) { $loader-\u0026gt;addClassMap($classMap); } } // 注册自动加载核心类对象 4 $loader-\u0026gt;register(true); // 自动加载全局函数 5 if ($useStaticLoader) { $includeFiles = Composer\\Autoload\\ComposerStaticInit76e88f0b305cd64c7c84b90b278c31db::$files; } else { $includeFiles = require __DIR__ . \u0026#39;/autoload_files.php\u0026#39;; } foreach ($includeFiles as $fileIdentifier =\u0026gt; $file) { composerRequire76e88f0b305cd64c7c84b90b278c31db($fileIdentifier, $file); } return $loader; } 单例模式 1 if (null !== self::$loader) { return self::$loader; } 构造 ClassLoader 核心类 2 spl_autoload_register(array(\u0026#39;ComposerAutoloaderInit76e88f0b305cd64c7c84b90b278c31db\u0026#39;, \u0026#39;loadClassLoader\u0026#39;), true, true); self::$loader = $loader = new \\Composer\\Autoload\\ClassLoader(); spl_autoload_unregister(array(\u0026#39;ComposerAutoloaderInit76e88f0b305cd64c7c84b90b278c31db\u0026#39;, \u0026#39;loadClassLoader\u0026#39;)); public static function loadClassLoader($class) { if (\u0026#39;Composer\\Autoload\\ClassLoader\u0026#39; === $class) { require __DIR__ . \u0026#39;/ClassLoader.php\u0026#39;; } } composer 先向 PHP 自动加载机制注册了一个函数，这个函数 require 了 ClassLoader 文件。成功 new 出该文件中核心类 ClassLoader() 后，又销毁了该函数。\n为什么不直接 require？原因是：怕有的用户也定义了个 \\Composer\\Autoload\\ClassLoader 命名空间，导致自动加载错误文件。\n那为什么不跟引导类一样用个哈希值呢？原因是：这个类是可以复用的，框架允许用户使用这个类。\n初始化核心类对象 3 对自动加载类的初始化，主要是给自动加载核心类初始化顶级命名空间映射。初始化的方法有两种：\n使用 autoload_static 进行静态初始化 调用核心类接口初始化 autoload_static 静态初始化 静态初始化只支持 PHP 5.6 以上版本、不支持 HHVM 虚拟机、不存在 Zend-encoded file。\nautoload_static.php\n\u0026lt;?php // autoload_static.php @generated by Composer namespace Composer\\Autoload; // hash 防止冲突 class ComposerStaticInit76e88f0b305cd64c7c84b90b278c31db { public static $files = array (...); public static $prefixLengthsPsr4 = array (...); public static $prefixDirsPsr4 = array (...); public static $fallbackDirsPsr4 = array (...); public static $prefixesPsr0 = array (...); public static $classMap = array array (...); public static function getInitializer(ClassLoader $loader) { return \\Closure::bind(function () use ($loader) { $loader-\u0026gt;prefixLengthsPsr4 = ComposerStaticInit76e88f0b305cd64c7c84b90b278c31db::$prefixLengthsPsr4; $loader-\u0026gt;prefixDirsPsr4 = ComposerStaticInit76e88f0b305cd64c7c84b90b278c31db::$prefixDirsPsr4; $loader-\u0026gt;fallbackDirsPsr4 = ComposerStaticInit76e88f0b305cd64c7c84b90b278c31db::$fallbackDirsPsr4; $loader-\u0026gt;prefixesPsr0 = ComposerStaticInit76e88f0b305cd64c7c84b90b278c31db::$prefixesPsr0; $loader-\u0026gt;classMap = ComposerStaticInit76e88f0b305cd64c7c84b90b278c31db::$classMap; }, null, ClassLoader::class); } } 这个静态初始化类的核心就是 getInitializer() 函数，它将自己类中的顶级命名空间映射给了 ClassLoader 类。\n值得注意的是这个函数返回的是一个匿名函数，为什么呢？原因就是 ClassLoader 中的 prefixLengthsPsr4 、prefixDirsPsr4 等等方法都是 private 的。普通的函数没办法给类的 private 成员变量赋值。利用匿名函数的绑定功能就可以将把匿名函数转为 ClassLoader 类的成员函数。\n关于匿名函数的 绑定功能。\n接下来就是 顶级命名空间 初始化的关键了。\nclassMap public static $classMap = array ( \u0026#39;App\\\\Api\\\\Middleware\\\\DeviceRecord\u0026#39; =\u0026gt; __DIR__ . \u0026#39;/../..\u0026#39; . \u0026#39;/app/Api/Middleware/DeviceRecord.php\u0026#39;, \u0026#39;App\\\\Api\\\\Middleware\\\\HeaderCheck\u0026#39; =\u0026gt; __DIR__ . \u0026#39;/../..\u0026#39; . \u0026#39;/app/Api/Middleware/HeaderCheck.php\u0026#39;, ... ) 直接命名空间全名与目录的映射，没有顶级命名空间。简单粗暴，也导致这个数组相当的大。\nPSR0 顶级命名空间映射 public static $prefixesPsr0 = array ( \u0026#39;P\u0026#39; =\u0026gt; array ( \u0026#39;Prophecy\\\\\u0026#39; =\u0026gt; array ( 0 =\u0026gt; __DIR__ . \u0026#39;/..\u0026#39; . \u0026#39;/phpspec/prophecy/src\u0026#39;, ), \u0026#39;Parsedown\u0026#39; =\u0026gt; array ( 0 =\u0026gt; __DIR__ . \u0026#39;/..\u0026#39; . \u0026#39;/erusev/parsedown\u0026#39;, ), ), ... ); 为了快速找到顶级命名空间，这里使用命名空间第一个字母作为前缀索引。这个映射的用法比较明显，假如我们有 Parsedown/example 这样的命名空间，首先通过首字母 P，找到：\n\u0026#39;P\u0026#39; =\u0026gt; array (...) 这个数组，然后就会遍历这个数组来和 Parsedown/example 比较，发现第一个 Prophecy 不符合，第二个 Parsedown 符合，然后得到了映射目录（映射目录可能不止一个）：\n0 =\u0026gt; __DIR__ . \u0026#39;/..\u0026#39; . \u0026#39;/erusev/parsedown\u0026#39;, 接着遍历这个数组，尝试 __DIR__ . '/..' . '/erusev/parsedown/Parsedown/example.php' 是否存在，如果不存在接着遍历数组（这个例子数组只有一个元素），如果数组遍历完都没有，就会加载失败。\nPSR4 标准顶级命名空间映射 public static $prefixLengthsPsr4 = array ( \u0026#39;p\u0026#39; =\u0026gt; array ( \u0026#39;phpDocumentor\\\\Reflection\\\\\u0026#39; =\u0026gt; 25, ), \u0026#39;Z\u0026#39; =\u0026gt; array ( \u0026#39;Zend\\\\Diactoros\\\\\u0026#39; =\u0026gt; 15, ), ... ); public static $prefixDirsPsr4 = array ( \u0026#39;phpDocumentor\\\\Reflection\\\\\u0026#39; =\u0026gt; array ( 0 =\u0026gt; __DIR__ . \u0026#39;/..\u0026#39; . \u0026#39;/phpdocumentor/reflection-common/src\u0026#39;, 1 =\u0026gt; __DIR__ . \u0026#39;/..\u0026#39; . \u0026#39;/phpdocumentor/reflection-docblock/src\u0026#39;, 2 =\u0026gt; __DIR__ . \u0026#39;/..\u0026#39; . \u0026#39;/phpdocumentor/type-resolver/src\u0026#39;, ), \u0026#39;Zend\\\\Diactoros\\\\\u0026#39; =\u0026gt; array ( 0 =\u0026gt; __DIR__ . \u0026#39;/..\u0026#39; . \u0026#39;/zendframework/zend-diactoros/src\u0026#39;, ), ... ); PSR4 标准 顶级命名空间 映射用了两个数组，第一个和 PSR0 一样用命名空间第一个字母作为前缀索引，然后是 顶级命名空间，但是最终并不是文件路径，而是 顶级命名空间 的长度。为什么呢？因为 PSR4 的文件目录更加灵活，更加简洁。\nPSR0 中 顶级命名空间 目录 直接加 到命名空间前面就可以得到路径：\n↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓ Parsedown/example =\u0026gt; __DIR__ . \u0026#39;/..\u0026#39; . \u0026#39;/erusev/parsedown/Parsedown/example.php ↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑ 而 PSR4 却是用顶级命名空间目录 替换 顶级命名空间，所以获得顶级命名空间的 长度 很重要：\n↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓ Parsedown/example =\u0026gt; __DIR__ . \u0026#39;/..\u0026#39; . \u0026#39;/erusev/parsedown/example.php ↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑ 举例：假如我们找 Symfony\\\\Polyfill\\\\Mbstring\\\\example 这个类，和 PSR0 一样通过前缀索引和字符串匹配我们得到了:\n\u0026#39;Symfony\\\\Polyfill\\\\Mbstring\\\\\u0026#39; =\u0026gt; 26, 这条记录，键是顶级命名空间，值是命名空间的长度。拿到顶级命名空间后去 $prefixDirsPsr4 获取它的映射目录数组（注意映射目录可能不止一条）：\n\u0026#39;Symfony\\\\Polyfill\\\\Mbstring\\\\\u0026#39; =\u0026gt; array ( 0 =\u0026gt; __DIR__ . \u0026#39;/..\u0026#39; . \u0026#39;/symfony/polyfill-mbstring\u0026#39;, ), 将 Symfony\\\\Polyfill\\\\Mbstring\\\\example 前 26 个字母替换为 __DIR__ . '/..' . '/symfony/polyfill-mbstring 也就是：\n__DIR__ . \u0026#39;/..\u0026#39; . \u0026#39;/symfony/polyfill-mbstring/example.php 先验证磁盘上这个文件是否存在，如果不存在接着遍历。如果遍历后没有找到，则加载失败。\n自动加载核心类 ClassLoader 的静态初始化完成！\n其实还有 $fallbackDirsPsr4，暂未研究\n调用接口初始化 如果 PHP 版本低于 5.6 或者使用 HHVM 虚拟机环境或者存在 zend_loader_file_encoded，那么就要使用核心类的接口进行初始化。\n/* PSR0 取出命名空间的第一个字母作为索引，一个索引对应多个顶级命名空间，一个顶级命名空间对应多个目录路径，具体形式可以查看上面的 autoload_static 的 $prefixesPsr0。 如果没有顶级命名空间，就只存储一个路径名，以便在后面尝试加载。 */ $map = require __DIR__ . \u0026#39;/autoload_namespaces.php\u0026#39;; foreach ($map as $namespace =\u0026gt; $path) { $loader-\u0026gt;set($namespace, $path); } /* PSR4 如果没有顶级命名空间，就直接保存目录。 如果有命名空间的话，要保证顶级命名空间最后是 \\，然后分别保存 ( 前缀 -\u0026gt; 顶级命名空间，顶级命名空间 -\u0026gt; 顶级命名空间长度 ) ( 顶级命名空间 -\u0026gt; 目录 ) 这两个映射数组。具体形式可以查看上面我们讲的 autoload_static 的 prefixLengthsPsr4、$prefixDirsPsr4 。 */ $map = require __DIR__ . \u0026#39;/autoload_psr4.php\u0026#39;; foreach ($map as $namespace =\u0026gt; $path) { $loader-\u0026gt;setPsr4($namespace, $path); } /* 整个命名空间与目录之间的映射 */ $classMap = require __DIR__ . \u0026#39;/autoload_classmap.php\u0026#39;; if ($classMap) { $loader-\u0026gt;addClassMap($classMap); } 注册核心类对象 4 Composer 自动加载功能的启动与初始化，经过启动与初始化，自动加载核心类对象已经获得了顶级命名空间与相应目录的映射，换句话说，如果有命名空间 App\\Console\\Kernel，我们已经知道了 App\\ 对应的目录，接下来我们就要解决下面的就是 \\Console\\Kernel 这一段。\n/** * Registers this instance as an autoloader. * * @param bool $prepend Whether to prepend the autoloader or not */ public function register($prepend = false) { spl_autoload_register(array($this, \u0026#39;loadClass\u0026#39;), true, $prepend); } 一行代码实现自动加载。核心在 ClassLoader 的 loadClass() 函数上，这个函数负责按照 PSR 标准将顶层命名空间以下的内容转为对应的目录，也就是上面所说的将 App\\Console\\Kernel 中 Console\\Kernel 这一段转为目录。\n自动加载全局函数 5 Composer 不止可以自动加载命名空间，还可以加载全局函数。就是把全局函数写到特定的文件里面去，在程序运行前挨个 require 就行了。\nif ($useStaticLoader) { // 静态初始化 $includeFiles = Composer\\Autoload\\ComposerStaticInit76e88f0b305cd64c7c84b90b278c31db::$files; } else { // 普通初始化 $includeFiles = require __DIR__ . \u0026#39;/autoload_files.php\u0026#39;; } foreach ($includeFiles as $fileIdentifier =\u0026gt; $file) { composerRequire76e88f0b305cd64c7c84b90b278c31db($fileIdentifier, $file); } function composerRequire76e88f0b305cd64c7c84b90b278c31db($fileIdentifier, $file) { if (empty($GLOBALS[\u0026#39;__composer_autoload_files\u0026#39;][$fileIdentifier])) { require $file; $GLOBALS[\u0026#39;__composer_autoload_files\u0026#39;][$fileIdentifier] = true; } } 问题 1 为什么不直接 require $includeFiles 里面的每个文件名，而要用类外面的函数 composerRequire... ？\n避免和用户定义函数冲突 防止有人在全局函数所在的文件写 $this 或者 self 假如 $includeFiles 有个 app/helper.php 文件，这个 helper.php 文件的函数外有一行代码： $this-\u0026gt;foo()，如果引导类在 getLoader() 函数直接 require($file)，那么引导类就会运行这句代码，调用自己的 foo() 函数，这显然是错的。\n事实上 helper.php 就不应该出现 $this 或 self 这样的代码，这样写一般都是用户写错了的，一旦这样的事情发生：\n第一种情况：引导类恰好有 foo() 函数，那么就会莫名其妙执行了引导类的 foo()。 第二种情况：引导类没有 foo() 函数，但是却甩出来引导类没有 foo() 方法这样的错误提示，用户不知道自己哪里错了。把 require 语句放到 引导类的外面，遇到 $this 或者 self ，程序就会告诉用户根本没有类， $this 或 self 无效，错误信息更加明朗。 问题 2 为什么要用 hash 作为 $fileIdentifier？\n这个变量是用来控制全局函数只被 require 一次的，那为什么不用 require_once 呢？事实上 require_once 比 require 效率低很多，使用全局变量 $GLOBALS 这样控制加载会更快。猜测另一个原因应该是 require_once 对相对路径的支持并不理想，所以 composer 尽量少用 require_once。\n运行 ClassLoader 将 loadClass() 函数注册到 PHP SPL 中的 spl_autoload_register() 里面去。这样，每当 PHP 遇到一个不认识的命名空间的时候，PHP 会自动调用注册到 spl_autoload_register() 里面的函数堆栈，运行其中的每个函数，直到找到命名空间对应的文件。\n/** * Loads the given class or interface. * * @param string $class The name of the class * @return bool|null True if loaded, null otherwise */ public function loadClass($class) { if ($file = $this-\u0026gt;findFile($class)) { includeFile($file); // include $file; Prevents access to $this/self from included files. return true; } } /** * Finds the path to the file where the class is defined. * * @param string $class The name of the class * * @return string|false The path if found, false otherwise */ public function findFile($class) { // class map lookup if (isset($this-\u0026gt;classMap[$class])) { return $this-\u0026gt;classMap[$class]; } // classMapAuthoritative 关闭搜索未在类映射中注册的类的 prefix and fallback directories。- 不清楚干啥的 暂没研究 if ($this-\u0026gt;classMapAuthoritative || isset($this-\u0026gt;missingClasses[$class])) { return false; } // 如果启用扩展名，则使用 APCu 前缀来缓存已找到/未找到的类。 - 不清楚干啥的 暂没研究 if (null !== $this-\u0026gt;apcuPrefix) { $file = apcu_fetch($this-\u0026gt;apcuPrefix.$class, $hit); if ($hit) { return $file; } } $file = $this-\u0026gt;findFileWithExtension($class, \u0026#39;.php\u0026#39;); // Search for Hack files if we are running on HHVM if (false === $file \u0026amp;\u0026amp; defined(\u0026#39;HHVM_VERSION\u0026#39;)) { $file = $this-\u0026gt;findFileWithExtension($class, \u0026#39;.hh\u0026#39;); } if (null !== $this-\u0026gt;apcuPrefix) { apcu_add($this-\u0026gt;apcuPrefix.$class, $file); } if (false === $file) { // Remember that this class does not exist. $this-\u0026gt;missingClasses[$class] = true; } return $file; } loadClass() 主要调用 findFile() 函数。findFile() 在解析命名空间的时候主要分为两部分：\nclassMap 直接看命名空间是否在映射数组 findFileWithExtension() 包含了 PSR0、PSR4 如果我们在代码中写 'phpDocumentor\\Reflection\\example，PHP 会通过 SPL 调用 loadClass -\u0026gt; findFile -\u0026gt; findFileWithExtension。\n首先默认用 .php 后缀名调用 findFileWithExtension 函数里，利用 PSR4 标准尝试解析目录文件，如果文件不存在则继续用 PSR0 标准解析 如果解析出来的目录文件仍然不存在，但是环境是 HHVM 虚拟机，继续用后缀名 .hh 再次调用 findFileWithExtension 函数，如果不存在，说明此命名空间无法加载，放到 classMap 中设为 false，以便以后更快地加载 PSR4 对于 phpDocumentor\\Reflection\\example，当尝试利用 PSR4 标准映射目录时，步骤如下：\n// $class: phpDocumentor\\Reflection\\example // PSR-4 lookup $logicalPathPsr4 = strtr($class, \u0026#39;\\\\\u0026#39;, DIRECTORY_SEPARATOR) . $ext; // $logicalPathPsr4: phpDocumentor/Reflection/example.php(hh)` $first = $class[0]; // $first: p if (isset($this-\u0026gt;prefixLengthsPsr4[$first])) { /* \u0026#39;p\u0026#39; =\u0026gt; array ( \u0026#39;phpDocumentor\\\\Reflection\\\\\u0026#39; =\u0026gt; 25, ), */ $subPath = $class; // $subPath: phpDocumentor\\Reflection\\example while (false !== $lastPos = strrpos($subPath, \u0026#39;\\\\\u0026#39;)) { // $lastPos 13 $subPath = substr($subPath, 0, $lastPos); $search = $subPath.\u0026#39;\\\\\u0026#39;; if (isset($this-\u0026gt;prefixDirsPsr4[$search])) { // search phpDocumentor\\\\Reflection\\\\ // $lastPos 25 /* \u0026#39;phpDocumentor\\\\Reflection\\\\\u0026#39; =\u0026gt; array ( 0 =\u0026gt; __DIR__ . \u0026#39;/..\u0026#39; . \u0026#39;/phpdocumentor/reflection-common/src\u0026#39;, 1 =\u0026gt; __DIR__ . \u0026#39;/..\u0026#39; . \u0026#39;/phpdocumentor/reflection-docblock/src\u0026#39;, 2 =\u0026gt; __DIR__ . \u0026#39;/..\u0026#39; . \u0026#39;/phpdocumentor/type-resolver/src\u0026#39;, ), */ $pathEnd = DIRECTORY_SEPARATOR . substr($logicalPathPsr4, $lastPos + 1); // $pathEnd /example.php(hh) foreach ($this-\u0026gt;prefixDirsPsr4[$search] as $dir) { // 遍历 3 个 if (file_exists($file = $dir . $pathEnd)) { // $file __DIR__ . \u0026#39;/..\u0026#39; . /phpdocumentor/type-resolver/src/example.php(hh)` return $file; } } } } } PSR0 如果 PSR4 标准加载失败，则要进行 PSR0 标准加载。对于 phpDocumentor\\Reflection\\example，当尝试利用 PSR0 标准映射目录时，步骤如下：\n// $class: phpDocumentor\\Reflection\\example // PSR-0 lookup if (false !== $pos = strrpos($class, \u0026#39;\\\\\u0026#39;)) { // namespaced class name $logicalPathPsr0 = substr($logicalPathPsr4, 0, $pos + 1) . strtr(substr($logicalPathPsr4, $pos + 1), \u0026#39;_\u0026#39;, DIRECTORY_SEPARATOR); } else { // PEAR-like class name $logicalPathPsr0 = strtr($class, \u0026#39;_\u0026#39;, DIRECTORY_SEPARATOR) . $ext; } // $logicalPathPsr0: phpDocumentor/Reflection/example.php(hh)` if (isset($this-\u0026gt;prefixesPsr0[$first])) { foreach ($this-\u0026gt;prefixesPsr0[$first] as $prefix =\u0026gt; $dirs) { /* \u0026#39;P\u0026#39; =\u0026gt; array ( \u0026#39;Prophecy\\\\\u0026#39; =\u0026gt; array ( 0 =\u0026gt; __DIR__ . \u0026#39;/..\u0026#39; . \u0026#39;/phpspec/prophecy/src\u0026#39;, ), \u0026#39;Parsedown\u0026#39; =\u0026gt; array ( 0 =\u0026gt; __DIR__ . \u0026#39;/..\u0026#39; . \u0026#39;/erusev/parsedown\u0026#39;, ), ), */ if (0 === strpos($class, $prefix)) { foreach ($dirs as $dir) { if (file_exists($file = $dir . DIRECTORY_SEPARATOR . $logicalPathPsr0)) { // $file __DIR__ . \u0026#39;/..\u0026#39; . \u0026#39;/phpspec/prophecy/src\u0026#39; . phpDocumentor/Reflection/example.php(hh) return $file; } } } } } Q\u0026amp;A 个人一些疑问：\n防止用户自定义与 ClassLoader 命名空间冲突 spl_autoload_register(array(\u0026#39;ComposerAutoloaderInit76e88f0b305cd64c7c84b90b278c31db\u0026#39;, \u0026#39;loadClassLoader\u0026#39;), true, true); self::$loader = $loader = new \\Composer\\Autoload\\ClassLoader(); spl_autoload_unregister(array(\u0026#39;ComposerAutoloaderInit76e88f0b305cd64c7c84b90b278c31db\u0026#39;, \u0026#39;loadClassLoader\u0026#39;)); 为什么这样可以解决：与用户也定义了个 \\Composer\\Autoload\\ClassLoader 命名空间，导致自动加载错误文件。\n与第四个参数 $prepend true 有关吗？\ncomposer StaticLoader 有什么优势 composer 在加载类和加载全局方法时，都有两种方式。\n$useStaticLoader = PHP_VERSION_ID \u0026gt;= 50600 \u0026amp;\u0026amp; !defined(\u0026#39;HHVM_VERSION\u0026#39;) \u0026amp;\u0026amp; (!function_exists(\u0026#39;zend_loader_file_encoded\u0026#39;) || !zend_loader_file_encoded()); 以 $useStaticLoader 的值进行选择，为什么一定分两种，静态方法是有什么优势吗？\nReferences PHP Composer - 初始化源码分析 \u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2019/04/28/composer-autoload-in-laravel/","summary":"\u003ch2 id=\"启动\"\u003e启动\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eLaravel 5.8\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e文章以 Laravel 学习。入口文件 \u003ccode\u003epublic/index.php\u003c/code\u003e：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Register The Auto Loader\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003erequire\u003c/span\u003e \u003cspan class=\"no\"\u003e__DIR__\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;/../vendor/autoload.php\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003ccode\u003eautoload.php\u003c/code\u003e 不负责具体功能逻辑，只做了两件事：初始化自动加载类、注册自动加载类。\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003eautoload_real.php\u003c/code\u003e 中的类名为 \u003ccode\u003eComposerAutoloaderInit...\u003c/code\u003e 这可能是为防止与用户自定义类名跟这个类重复冲突，加上了哈希值。\u003c/p\u003e\n\u003cp\u003e其实还有一个做法我们更加熟悉，是定义一个命名空间。这里为什么不定义一个命名空间呢？一种理解：命名空间一般都是为了复用，而这个类只需要运行一次即可，以后也不会用得到，用哈希值更加合适。\u003c/p\u003e\n\u003c!-- more --\u003e\n\u003ch2 id=\"autoload_realphp\"\u003eautoload_real.php\u003c/h2\u003e\n\u003cp\u003e\u003ccode\u003eautoload.php\u003c/code\u003e 主要调用了 \u003ccode\u003egetLoader()\u003c/code\u003e：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"k\"\u003efunction\u003c/span\u003e \u003cspan class=\"nf\"\u003egetLoader\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e// 单例模式，自动加载类只能有一个 1\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003enull\u003c/span\u003e \u003cspan class=\"o\"\u003e!==\u003c/span\u003e \u003cspan class=\"nx\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"nv\"\u003e$loader\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nx\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"nv\"\u003e$loader\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e// 获得自动加载核心类对象 2\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e    \u003cspan class=\"nx\"\u003espl_autoload_register\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003earray\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;ComposerAutoloaderInit76e88f0b305cd64c7c84b90b278c31db\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;loadClassLoader\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"k\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"nv\"\u003e$loader\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nv\"\u003e$loader\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003e\\Composer\\Autoload\\ClassLoader\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003espl_autoload_unregister\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003earray\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;ComposerAutoloaderInit76e88f0b305cd64c7c84b90b278c31db\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;loadClassLoader\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e// 初始化自动加载核心类对象 3\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e    \u003cspan class=\"nv\"\u003e$useStaticLoader\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003ePHP_VERSION_ID\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026gt;=\u003c/span\u003e \u003cspan class=\"mi\"\u003e50600\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan class=\"o\"\u003e!\u003c/span\u003e\u003cspan class=\"nx\"\u003edefined\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;HHVM_VERSION\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e!\u003c/span\u003e\u003cspan class=\"nx\"\u003efunction_exists\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;zend_loader_file_encoded\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e||\u003c/span\u003e \u003cspan class=\"o\"\u003e!\u003c/span\u003e\u003cspan class=\"nx\"\u003ezend_loader_file_encoded\u003c/span\u003e\u003cspan class=\"p\"\u003e());\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$useStaticLoader\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003erequire_once\u003c/span\u003e \u003cspan class=\"no\"\u003e__DIR__\u003c/span\u003e \u003cspan class=\"o\"\u003e.\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;/autoload_static.php\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nx\"\u003ecall_user_func\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003e\\Composer\\Autoload\\ComposerStaticInit76e88f0b305cd64c7c84b90b278c31db\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"na\"\u003egetInitializer\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$loader\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"k\"\u003eelse\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nv\"\u003e$map\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003erequire\u003c/span\u003e \u003cspan class=\"no\"\u003e__DIR__\u003c/span\u003e \u003cspan class=\"o\"\u003e.\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;/autoload_namespaces.php\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003eforeach\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$map\u003c/span\u003e \u003cspan class=\"k\"\u003eas\u003c/span\u003e \u003cspan class=\"nv\"\u003e$namespace\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"nv\"\u003e$path\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"nv\"\u003e$loader\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"na\"\u003eset\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$namespace\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$path\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nv\"\u003e$map\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003erequire\u003c/span\u003e \u003cspan class=\"no\"\u003e__DIR__\u003c/span\u003e \u003cspan class=\"o\"\u003e.\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;/autoload_psr4.php\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003eforeach\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$map\u003c/span\u003e \u003cspan class=\"k\"\u003eas\u003c/span\u003e \u003cspan class=\"nv\"\u003e$namespace\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"nv\"\u003e$path\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"nv\"\u003e$loader\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"na\"\u003esetPsr4\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$namespace\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$path\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nv\"\u003e$classMap\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003erequire\u003c/span\u003e \u003cspan class=\"no\"\u003e__DIR__\u003c/span\u003e \u003cspan class=\"o\"\u003e.\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;/autoload_classmap.php\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$classMap\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"nv\"\u003e$loader\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"na\"\u003eaddClassMap\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$classMap\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e// 注册自动加载核心类对象 4\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e    \u003cspan class=\"nv\"\u003e$loader\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"na\"\u003eregister\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e// 自动加载全局函数 5\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$useStaticLoader\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nv\"\u003e$includeFiles\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003eComposer\\Autoload\\ComposerStaticInit76e88f0b305cd64c7c84b90b278c31db\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"nv\"\u003e$files\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"k\"\u003eelse\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nv\"\u003e$includeFiles\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003erequire\u003c/span\u003e \u003cspan class=\"no\"\u003e__DIR__\u003c/span\u003e \u003cspan class=\"o\"\u003e.\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;/autoload_files.php\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eforeach\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$includeFiles\u003c/span\u003e \u003cspan class=\"k\"\u003eas\u003c/span\u003e \u003cspan class=\"nv\"\u003e$fileIdentifier\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"nv\"\u003e$file\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nx\"\u003ecomposerRequire76e88f0b305cd64c7c84b90b278c31db\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$fileIdentifier\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$file\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nv\"\u003e$loader\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"单例模式-1\"\u003e单例模式 1\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003enull\u003c/span\u003e \u003cspan class=\"o\"\u003e!==\u003c/span\u003e \u003cspan class=\"nx\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"nv\"\u003e$loader\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nx\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"nv\"\u003e$loader\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"构造-classloader-核心类-2\"\u003e构造 ClassLoader 核心类 2\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003espl_autoload_register\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003earray\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;ComposerAutoloaderInit76e88f0b305cd64c7c84b90b278c31db\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;loadClassLoader\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"k\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"nv\"\u003e$loader\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nv\"\u003e$loader\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003e\\Composer\\Autoload\\ClassLoader\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003espl_autoload_unregister\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003earray\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;ComposerAutoloaderInit76e88f0b305cd64c7c84b90b278c31db\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;loadClassLoader\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"k\"\u003efunction\u003c/span\u003e \u003cspan class=\"nf\"\u003eloadClassLoader\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$class\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;Composer\\Autoload\\ClassLoader\u0026#39;\u003c/span\u003e \u003cspan class=\"o\"\u003e===\u003c/span\u003e \u003cspan class=\"nv\"\u003e$class\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003erequire\u003c/span\u003e \u003cspan class=\"no\"\u003e__DIR__\u003c/span\u003e \u003cspan class=\"o\"\u003e.\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;/ClassLoader.php\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003ccode\u003ecomposer\u003c/code\u003e 先向 \u003ccode\u003ePHP\u003c/code\u003e 自动加载机制注册了一个函数，这个函数 \u003ccode\u003erequire\u003c/code\u003e 了 \u003ccode\u003eClassLoader\u003c/code\u003e 文件。成功 \u003ccode\u003enew\u003c/code\u003e 出该文件中核心类 \u003ccode\u003eClassLoader()\u003c/code\u003e 后，又销毁了该函数。\u003c/p\u003e","title":"Laravel 中 composer 加载流程"},{"content":"又开始写世界上最后的语言 PHP 了（狗头保命）。一个很简单的字符串是否包含判断就掉坑了。\n方法签名：\nstrpos ( string $haystack , mixed $needle [, int $offset = 0 ] ) : int $mystring = \u0026#39;abc\u0026#39;; $findme = \u0026#39;a\u0026#39;; if (strpos($mystring, $findme)) { dump(\u0026#39;yes\u0026#39;); } 注意这时是不会输出 yes，因为 strpos($mystring, $findme) 返回的是 0。就想官方文档说的：\nWarning 此函数可能返回布尔值 FALSE，但也可能返回等同于 FALSE 的非布尔值。应使用 === 运算符来测试此函数的返回值。\n正解：\nif (strpos($mystring, $findme) !== false) { dump(\u0026#39;yes\u0026#39;); } 这次问题是网上一搜，找到 strpos 后看到 如果没找到 needle，将返回 FALSE 就没多想就用了。语言间的差异还有注意。\nReferences php.net - strpos \u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2019/04/10/php-strpos-warning/","summary":"\u003cp\u003e又开始写世界上最后的语言 PHP 了（狗头保命）。一个很简单的字符串是否包含判断就掉坑了。\u003c/p\u003e\n\u003cp\u003e方法签名：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003estrpos\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"nx\"\u003estring\u003c/span\u003e \u003cspan class=\"nv\"\u003e$haystack\u003c/span\u003e \u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003emixed\u003c/span\u003e \u003cspan class=\"nv\"\u003e$needle\u003c/span\u003e \u003cspan class=\"p\"\u003e[,\u003c/span\u003e \u003cspan class=\"nx\"\u003eint\u003c/span\u003e \u003cspan class=\"nv\"\u003e$offset\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e \u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"nx\"\u003eint\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$mystring\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;abc\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$findme\u003c/span\u003e   \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;a\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003estrpos\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$mystring\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$findme\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e   \u003cspan class=\"nx\"\u003edump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;yes\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e注意这时是不会输出 \u003ccode\u003eyes\u003c/code\u003e，因为 \u003ccode\u003estrpos($mystring, $findme)\u003c/code\u003e 返回的是 \u003ccode\u003e0\u003c/code\u003e。就想官方文档说的：\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eWarning 此函数可能返回布尔值 FALSE，但也可能返回等同于 FALSE 的非布尔值。应使用 === 运算符来测试此函数的返回值。\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003e正解：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003estrpos\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$mystring\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$findme\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e!==\u003c/span\u003e \u003cspan class=\"k\"\u003efalse\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e   \u003cspan class=\"nx\"\u003edump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;yes\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e这次问题是网上一搜，找到 \u003ccode\u003estrpos\u003c/code\u003e 后看到 \u003ccode\u003e如果没找到 needle，将返回 FALSE\u003c/code\u003e 就没多想就用了。语言间的差异还有注意。\u003c/p\u003e\n\u003ch2 id=\"references\"\u003eReferences\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.php.net/manual/zh/function.strpos.php\"\u003ephp.net - strpos\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u0026ndash; EOF \u0026ndash;\u003c/p\u003e","title":"PHP 请小心判断 strpos"},{"content":"在老项目中，我开始使用 laravel-mix 和 ES6 进行逐渐过渡。在这个过程中，发现了一个问题：当 jQuery 和 箭头函数 一起使用时，$(this) 的含义会发生变化。\n问题解释 这个问题主要是因为没有理解 箭头函数 的特性。箭头函数不会创建自己的 this 上下文，而是继承父作用域的 this。\n看下面的例子：\n// 问题代码 $(\u0026#39;.js-bottom-btn\u0026#39;).click(() =\u0026gt; { let flag = $(this).data(\u0026#39;flag\u0026#39;); // ... }); 在箭头函数中，this 不是指向被点击的元素，而是指向父作用域的 this（可能是 window 或 undefined）。\n解决方案 根据 jQuery click 文档，可以使用以下方法解决：\n方法 1: 使用传统函数 $(\u0026#39;.js-bottom-btn\u0026#39;).click(function() { let flag = $(this).data(\u0026#39;flag\u0026#39;); // ... }); 方法 2: 使用事件参数 $(\u0026#39;.js-bottom-btn\u0026#39;).click(event =\u0026gt; { let flag = $(event.currentTarget).data(\u0026#39;flag\u0026#39;); // ... }); 其他常见场景 jQuery 的 .each() 方法中也会遇到类似问题：\n// 问题代码 $(\u0026#34;jquery-selector\u0026#34;).each(() =\u0026gt; { $(this).click(); }); 需要修改为：\n$(\u0026#34;jquery-selector\u0026#34;).each((index, element) =\u0026gt; { $(element).click(); }); 箭头函数和 this 绑定 箭头函数的一个主要特点是词法绑定（lexical binding）。这意味着：\n箭头函数不创建自己的 this 上下文 箭头函数继承定义它的外部作用域的 this 值 这种行为与传统函数不同，传统函数中的 this 是根据调用方式决定的 参考资料 Using jQuery $(this) with ES6 Arrow Functions (lexical this binding) \u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2019/04/10/es6-jquery-this-arrow-function/","summary":"\u003cp\u003e在老项目中，我开始使用 \u003ccode\u003elaravel-mix\u003c/code\u003e 和 \u003ccode\u003eES6\u003c/code\u003e 进行逐渐过渡。在这个过程中，发现了一个问题：当 \u003ccode\u003ejQuery\u003c/code\u003e 和 \u003ccode\u003e箭头函数\u003c/code\u003e 一起使用时，\u003ccode\u003e$(this)\u003c/code\u003e 的含义会发生变化。\u003c/p\u003e\n\u003ch2 id=\"问题解释\"\u003e问题解释\u003c/h2\u003e\n\u003cp\u003e这个问题主要是因为没有理解 \u003ca href=\"https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Functions/Arrow_functions\"\u003e箭头函数\u003c/a\u003e 的特性。箭头函数不会创建自己的 \u003ccode\u003ethis\u003c/code\u003e 上下文，而是继承父作用域的 \u003ccode\u003ethis\u003c/code\u003e。\u003c/p\u003e\n\u003cp\u003e看下面的例子：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-js\" data-lang=\"js\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 问题代码\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nx\"\u003e$\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;.js-bottom-btn\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nx\"\u003eclick\u003c/span\u003e\u003cspan class=\"p\"\u003e(()\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kd\"\u003elet\u003c/span\u003e \u003cspan class=\"nx\"\u003eflag\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003e$\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nx\"\u003edata\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;flag\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e// ...\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e});\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e在箭头函数中，\u003ccode\u003ethis\u003c/code\u003e 不是指向被点击的元素，而是指向父作用域的 \u003ccode\u003ethis\u003c/code\u003e（可能是 \u003ccode\u003ewindow\u003c/code\u003e 或 \u003ccode\u003eundefined\u003c/code\u003e）。\u003c/p\u003e\n\u003ch2 id=\"解决方案\"\u003e解决方案\u003c/h2\u003e\n\u003cp\u003e根据 \u003ca href=\"https://api.jquery.com/click/\"\u003ejQuery click 文档\u003c/a\u003e，可以使用以下方法解决：\u003c/p\u003e\n\u003ch3 id=\"方法-1-使用传统函数\"\u003e方法 1: 使用传统函数\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-js\" data-lang=\"js\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003e$\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;.js-bottom-btn\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nx\"\u003eclick\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kd\"\u003efunction\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kd\"\u003elet\u003c/span\u003e \u003cspan class=\"nx\"\u003eflag\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003e$\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nx\"\u003edata\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;flag\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e// ...\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e});\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"方法-2-使用事件参数\"\u003e方法 2: 使用事件参数\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-js\" data-lang=\"js\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003e$\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;.js-bottom-btn\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nx\"\u003eclick\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eevent\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kd\"\u003elet\u003c/span\u003e \u003cspan class=\"nx\"\u003eflag\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003e$\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eevent\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ecurrentTarget\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nx\"\u003edata\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;flag\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e// ...\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e});\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"其他常见场景\"\u003e其他常见场景\u003c/h2\u003e\n\u003cp\u003ejQuery 的 \u003ccode\u003e.each()\u003c/code\u003e 方法中也会遇到类似问题：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-js\" data-lang=\"js\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 问题代码\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nx\"\u003e$\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;jquery-selector\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nx\"\u003eeach\u003c/span\u003e\u003cspan class=\"p\"\u003e(()\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nx\"\u003e$\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nx\"\u003eclick\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e});\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e需要修改为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-js\" data-lang=\"js\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003e$\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;jquery-selector\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nx\"\u003eeach\u003c/span\u003e\u003cspan class=\"p\"\u003e((\u003c/span\u003e\u003cspan class=\"nx\"\u003eindex\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eelement\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nx\"\u003e$\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eelement\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nx\"\u003eclick\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e});\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"箭头函数和-this-绑定\"\u003e箭头函数和 this 绑定\u003c/h2\u003e\n\u003cp\u003e箭头函数的一个主要特点是\u003cstrong\u003e词法绑定\u003c/strong\u003e（lexical binding）。这意味着：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e箭头函数不创建自己的 \u003ccode\u003ethis\u003c/code\u003e 上下文\u003c/li\u003e\n\u003cli\u003e箭头函数继承定义它的外部作用域的 \u003ccode\u003ethis\u003c/code\u003e 值\u003c/li\u003e\n\u003cli\u003e这种行为与传统函数不同，传统函数中的 \u003ccode\u003ethis\u003c/code\u003e 是根据调用方式决定的\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"参考资料\"\u003e参考资料\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://stackoverflow.com/questions/27670401/using-jquery-this-with-es6-arrow-functions-lexical-this-binding\"\u003eUsing jQuery $(this) with ES6 Arrow Functions (lexical this binding)\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u0026ndash; EOF \u0026ndash;\u003c/p\u003e","title":"ES6 中使用 jQuery $(this) 的问题"},{"content":"将 pivot 索引定义为：左边的数字之和等于索引右边的数字之和。\nInput: nums = [1, 7, 3, 6, 5, 6] Output: 3 Explanation: 1 + 7 + 3 = 5 + 6 Input: nums = [1, 2, 3] Output: -1 Explanation: There is no index that satisfies the conditions in the problem statement. Note:\nThe length of nums will be in the range [0, 10000]. Each element nums[i] will be an integer in the range [-1000, 1000]. 关键点 动态规划 数组的和 - 中轴数 = 中轴数左边数组的和 * 2 解答 func findPivot(_ array: [Int]) -\u0026gt; Int { // 数组和 let sum = array.reduce(0, +) // 左侧数组和 var leftSum = 0 for (key, value) in array.enumerated() { if sum - value == leftSum * 2 { return key } leftSum += value } return -1 } let array = [1, 7, 3, 6, 5, 6] search(array) // 3 References 找到数组中左右两边的和相等的 pivot 的下标 Find Pivot Index \u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2019/03/06/find-pivot-index/","summary":"\u003cp\u003e将 pivot 索引定义为：左边的数字之和等于索引右边的数字之和。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-swift\" data-lang=\"swift\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003eInput\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003enums\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e7\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e3\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e6\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e5\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e6\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003eOutput\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"mi\"\u003e3\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003eExplanation\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"mi\"\u003e7\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"mi\"\u003e3\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e5\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"mi\"\u003e6\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003eInput\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003enums\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e3\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003eOutput\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003eExplanation\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003eThere\u003c/span\u003e \u003cspan class=\"k\"\u003eis\u003c/span\u003e \u003cspan class=\"n\"\u003eno\u003c/span\u003e \u003cspan class=\"n\"\u003eindex\u003c/span\u003e \u003cspan class=\"n\"\u003ethat\u003c/span\u003e \u003cspan class=\"n\"\u003esatisfies\u003c/span\u003e \u003cspan class=\"n\"\u003ethe\u003c/span\u003e \u003cspan class=\"n\"\u003econditions\u003c/span\u003e \u003cspan class=\"k\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003ethe\u003c/span\u003e \u003cspan class=\"n\"\u003eproblem\u003c/span\u003e \u003cspan class=\"n\"\u003estatement\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c!-- more --\u003e\n\u003cp\u003eNote:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eThe length of \u003ccode\u003enums\u003c/code\u003e will be in the range \u003ccode\u003e[0, 10000]\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003eEach element \u003ccode\u003enums[i]\u003c/code\u003e will be an integer in the range \u003ccode\u003e[-1000, 1000]\u003c/code\u003e.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"关键点\"\u003e关键点\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e动态规划\u003c/li\u003e\n\u003cli\u003e数组的和 - 中轴数 = 中轴数左边数组的和 * 2\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"解答\"\u003e解答\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-swift\" data-lang=\"swift\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003efunc\u003c/span\u003e \u003cspan class=\"nf\"\u003efindPivot\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kc\"\u003e_\u003c/span\u003e \u003cspan class=\"n\"\u003earray\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"nb\"\u003eInt\u003c/span\u003e\u003cspan class=\"p\"\u003e])\u003c/span\u003e \u003cspan class=\"p\"\u003e-\u0026gt;\u003c/span\u003e \u003cspan class=\"nb\"\u003eInt\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e// 数组和\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kd\"\u003elet\u003c/span\u003e \u003cspan class=\"nv\"\u003esum\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003earray\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"bp\"\u003ereduce\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e// 左侧数组和\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nv\"\u003eleftSum\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ekey\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003evalue\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003earray\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eenumerated\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"n\"\u003esum\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e \u003cspan class=\"n\"\u003evalue\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"n\"\u003eleftSum\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"mi\"\u003e2\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003ekey\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"n\"\u003eleftSum\u003c/span\u003e \u003cspan class=\"o\"\u003e+=\u003c/span\u003e \u003cspan class=\"n\"\u003evalue\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003elet\u003c/span\u003e \u003cspan class=\"nv\"\u003earray\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e7\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e3\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e6\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e5\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e6\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003esearch\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003earray\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"c1\"\u003e// 3\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"references\"\u003eReferences\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://my.oschina.net/liyurong/blog/1608204\"\u003e找到数组中左右两边的和相等的 pivot 的下标 Find Pivot Index\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u0026ndash; EOF \u0026ndash;\u003c/p\u003e","title":"寻找数组中轴索引"},{"content":"思路 m 进制 -\u0026gt; 十进制 -\u0026gt; n 进制 利用柯里化生成函数（炫技 🐶） m 进制 -\u0026gt; 十进制 // carry 范围值: 2-36 // origin 范围值: 0-9 [ascii 48-58], A-Z [65-90], a-z [97-122] func carryToDecimalism(_ carry: Int) -\u0026gt; (_ origin: String) -\u0026gt; Int { return { origin in // 得到字符串对应的 ascii 码 let asciis = origin.uppercased().unicodeScalars.map { Int($0.value) } // 累加每一位 let result = asciis.reversed().enumerated().map { (index, ascii) -\u0026gt; Int in var standard: Int if 65 \u0026lt;= ascii \u0026amp;\u0026amp; ascii \u0026lt;= 90 { standard = ascii - 65 + 10 } else { standard = ascii - 48 } return standard * Int(pow(Double(carry), Double(index))) }.reduce(0, +) return result } } let 十六进制转十进制 = carryToDecimalism(16) print(十六进制转十进制(\u0026#34;1a\u0026#34;)) // 26 let 二进制转十进制 = carryToDecimalism(2) print(二进制转十进制(\u0026#34;110\u0026#34;)) // 6 十进制 -\u0026gt; n 进制 func decimalismToCarry(_ carry: Int) -\u0026gt; (_ origin: Int) -\u0026gt; String { return { origin in var result = [Int]() var remain = origin while remain \u0026gt; 0 { result.append(remain % carry) remain /= carry } if carry \u0026lt;= 10 { return result.reversed().map(String.init).joined() } else { return result.reversed().map { i -\u0026gt; String in return i \u0026lt; 10 ? String(i) : String(UnicodeScalar(i + 55)!) }.joined() } } } let 十进制转二进制 = decimalismToCarry(2) print(十进制转二进制(26)) // \u0026#34;11010\u0026#34; References ASCII 码对照表 \u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2019/03/02/convert-m-number-to-n-number/","summary":"\u003ch2 id=\"思路\"\u003e思路\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003em 进制 -\u0026gt; 十进制 -\u0026gt; n 进制\u003c/li\u003e\n\u003cli\u003e利用柯里化生成函数（炫技 🐶）\u003c/li\u003e\n\u003c/ul\u003e\n\u003c!-- more --\u003e\n\u003ch2 id=\"m-进制---十进制\"\u003em 进制 -\u0026gt; 十进制\u003c/h2\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e// carry 范围值: 2-36\n// origin 范围值: 0-9 [ascii 48-58], A-Z [65-90], a-z [97-122]\nfunc carryToDecimalism(_ carry: Int) -\u0026gt; (_ origin: String) -\u0026gt; Int {\n    return { origin in\n        // 得到字符串对应的 ascii 码\n        let asciis = origin.uppercased().unicodeScalars.map { Int($0.value) }\n        // 累加每一位\n        let result = asciis.reversed().enumerated().map { (index, ascii) -\u0026gt; Int in\n            var standard: Int\n            if 65 \u0026lt;= ascii \u0026amp;\u0026amp; ascii \u0026lt;= 90 {\n                standard = ascii - 65 + 10\n            } else {\n                standard = ascii - 48\n            }\n            return standard * Int(pow(Double(carry), Double(index)))\n        }.reduce(0, +)\n        return result\n    }\n}\n\nlet 十六进制转十进制 = carryToDecimalism(16)\nprint(十六进制转十进制(\u0026#34;1a\u0026#34;)) // 26\n\nlet 二进制转十进制 = carryToDecimalism(2)\nprint(二进制转十进制(\u0026#34;110\u0026#34;)) // 6\n\u003c/code\u003e\u003c/pre\u003e\u003ch2 id=\"十进制---n-进制\"\u003e十进制 -\u0026gt; n 进制\u003c/h2\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003efunc decimalismToCarry(_ carry: Int) -\u0026gt; (_ origin: Int) -\u0026gt; String {\n    return { origin in\n        var result = [Int]()\n        var remain = origin\n        while remain \u0026gt; 0 {\n            result.append(remain % carry)\n            remain /= carry\n        }\n        if carry \u0026lt;= 10 {\n            return result.reversed().map(String.init).joined()\n        } else {\n            return result.reversed().map { i -\u0026gt; String in\n                return i \u0026lt; 10 ? String(i) : String(UnicodeScalar(i + 55)!)\n            }.joined()\n        }\n    }\n}\n\nlet 十进制转二进制 = decimalismToCarry(2)\nprint(十进制转二进制(26)) // \u0026#34;11010\u0026#34;\n\u003c/code\u003e\u003c/pre\u003e\u003ch2 id=\"references\"\u003eReferences\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"http://ascii.911cha.com/\"\u003eASCII 码对照表\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u0026ndash; EOF \u0026ndash;\u003c/p\u003e","title":"m 进制转 n 进制"},{"content":"打印 n! 的结果（1 \u0026lt;= n \u0026lt;= 100）。注意：当 n \u0026gt; 20 时 64 位的 Int 将无法直接存储结果。\n思路 将大数字用 数组 形式表示。比如 987 使用 [9,8,7] 代替。 每一位乘以 n，再进行进位操作，得到新数组。 let nums = [9, 8, 7] let tmpNums = nums.map { $0 * 2 } // [18, 16, 14] // 遍历 tmpNums 每一个数字，进行进制操作 [18, 16, 14] -\u0026gt; [18, 17, 4] -\u0026gt; [19, 7, 4] -\u0026gt; [1, 9, 7, 4] print(tmpNums.map(String.init).joined()) // 1974 解答项目 func extraLongFactorials(n: Int) -\u0026gt; Void { guard n \u0026gt; 0 else { return } // 结果数组 var result: [Int] = [1] for index in 1...n { // 数组翻转 从低位开始每一位乘以本次的数字 let tmpNums = result.reversed().map { $0 * index } // 进位数 var carryNum = 0 // 重置结果 result = [] tmpNums.forEach { // 每一位加上上一位的进的数 let tmpNum = $0 + carryNum // 向下一位进制的数 carryNum = tmpNum / 10 // 本位实际剩下的数 插入结果 result.append(tmpNum % 10) } // 处理剩余进位数 进位数是可能大于 100 while carryNum \u0026gt; 0 { // 逐渐插入进制 result.append(carryNum % 10) carryNum /= 10 } // 翻转回数组 result = result.reversed() } // 连接字符串 print(result.map(String.init).joined()) } References Extra Long Factorials | HackerRank Swift 3 calculate factorial number. Result becomes too high? \u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2019/03/01/extra-long-factorials/","summary":"\u003cp\u003e打印 \u003ccode\u003en!\u003c/code\u003e 的结果（1 \u0026lt;= n \u0026lt;= 100）。注意：当 \u003ccode\u003en \u0026gt; 20\u003c/code\u003e 时 64 位的 \u003ccode\u003eInt\u003c/code\u003e 将无法直接存储结果。\u003c/p\u003e\n\u003ch2 id=\"思路\"\u003e思路\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e将大数字用 \u003cstrong\u003e数组\u003c/strong\u003e 形式表示。比如 987 使用 [9,8,7] 代替。\u003c/li\u003e\n\u003cli\u003e每一位乘以 n，再进行进位操作，得到新数组。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-swift\" data-lang=\"swift\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003elet\u003c/span\u003e \u003cspan class=\"nv\"\u003enums\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e9\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e8\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e7\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003elet\u003c/span\u003e \u003cspan class=\"nv\"\u003etmpNums\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003enums\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"bp\"\u003emap\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"nv\"\u003e$0\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"mi\"\u003e2\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"c1\"\u003e// [18, 16, 14]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 遍历 tmpNums 每一个数字，进行进制操作\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e18\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e16\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e14\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"p\"\u003e-\u0026gt;\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e18\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e17\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e4\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"p\"\u003e-\u0026gt;\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e19\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e7\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e4\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"p\"\u003e-\u0026gt;\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e9\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e7\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e4\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"bp\"\u003eprint\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etmpNums\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"bp\"\u003emap\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nb\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"kd\"\u003einit\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"n\"\u003ejoined\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e \u003cspan class=\"c1\"\u003e// 1974\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"解答项目\"\u003e解答项目\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-swift\" data-lang=\"swift\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003efunc\u003c/span\u003e \u003cspan class=\"nf\"\u003eextraLongFactorials\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003en\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nb\"\u003eInt\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e-\u0026gt;\u003c/span\u003e \u003cspan class=\"nb\"\u003eVoid\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eguard\u003c/span\u003e \u003cspan class=\"n\"\u003en\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e \u003cspan class=\"k\"\u003eelse\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e// 结果数组\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nv\"\u003eresult\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"nb\"\u003eInt\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"n\"\u003eindex\u003c/span\u003e \u003cspan class=\"k\"\u003ein\u003c/span\u003e \u003cspan class=\"mf\"\u003e1.\u003c/span\u003e\u003cspan class=\"p\"\u003e..\u003c/span\u003e\u003cspan class=\"n\"\u003en\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"c1\"\u003e// 数组翻转 从低位开始每一位乘以本次的数字\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"kd\"\u003elet\u003c/span\u003e \u003cspan class=\"nv\"\u003etmpNums\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eresult\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ereversed\u003c/span\u003e\u003cspan class=\"p\"\u003e().\u003c/span\u003e\u003cspan class=\"bp\"\u003emap\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"nv\"\u003e$0\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003eindex\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"c1\"\u003e// 进位数\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nv\"\u003ecarryNum\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"c1\"\u003e// 重置结果\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"n\"\u003eresult\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e[]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"n\"\u003etmpNums\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eforEach\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"c1\"\u003e// 每一位加上上一位的进的数\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"kd\"\u003elet\u003c/span\u003e \u003cspan class=\"nv\"\u003etmpNum\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nv\"\u003e$0\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003ecarryNum\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"c1\"\u003e// 向下一位进制的数\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"n\"\u003ecarryNum\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003etmpNum\u003c/span\u003e \u003cspan class=\"o\"\u003e/\u003c/span\u003e \u003cspan class=\"mi\"\u003e10\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"c1\"\u003e// 本位实际剩下的数 插入结果\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"n\"\u003eresult\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eappend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etmpNum\u003c/span\u003e \u003cspan class=\"o\"\u003e%\u003c/span\u003e \u003cspan class=\"mi\"\u003e10\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"c1\"\u003e// 处理剩余进位数 进位数是可能大于 100\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003ewhile\u003c/span\u003e \u003cspan class=\"n\"\u003ecarryNum\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"c1\"\u003e// 逐渐插入进制\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"n\"\u003eresult\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eappend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ecarryNum\u003c/span\u003e \u003cspan class=\"o\"\u003e%\u003c/span\u003e \u003cspan class=\"mi\"\u003e10\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"n\"\u003ecarryNum\u003c/span\u003e \u003cspan class=\"o\"\u003e/=\u003c/span\u003e \u003cspan class=\"mi\"\u003e10\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"c1\"\u003e// 翻转回数组\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"n\"\u003eresult\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eresult\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ereversed\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e// 连接字符串\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"bp\"\u003eprint\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eresult\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"bp\"\u003emap\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nb\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"kd\"\u003einit\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"n\"\u003ejoined\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"references\"\u003eReferences\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.hackerrank.com/challenges/extra-long-factorials/problem\"\u003eExtra Long Factorials | HackerRank\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://stackoverflow.com/questions/43830151/swift-3-calculate-factorial-number-result-becomes-too-high\"\u003eSwift 3 calculate factorial number. Result becomes too high?\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u0026ndash; EOF \u0026ndash;\u003c/p\u003e","title":"超长阶乘的计算"},{"content":"这次以 fastlane 为例，尝试项目中有什么事情可以被自动完成。\nfastlane 是 Ruby scripts 的集合，安装方法不多说了见 官网文档。\nfastlane 中有但不限于以下工具集：\nproduce 同时在 Apple Developer Portal 和 App Store Connect 中创建新的 iOS apps。 cert 自动创建和维护 iOS 签名证书。 sigh 创建，更新，下载和修复配置文件。 snapshot 自动在每台设备上获取 iOS 应用的本地化屏幕截图。 frameit 将您的屏幕截图放入正确的设备框架中。 gym 构建和打包您的 iOS apps。 deliver 将截图，元数据和您的应用上传到 App Store。 pem 自动生成并更新推送通知配置文件。 spaceship 一个 Ruby 库能够访问苹果开发者中心和应用商店连接 api。 pilot 自动化 TestFlight 部署并管理测试用户。 boarding 邀请 beta 测试人员。 match 使用 Git 同步整个团队的证书和配置文件。 scan 运行 app 测试。 实验环境：Xcode 10.1、Swift 4.2、fastlane 2.116.1、$99 开发者账户\n项目添加 fastlane 在项目根目录下：\nfastlane init 在出现 What would you like to use fastlane for? 是选择 4 Manual setup，在根据提示回车确认。\n之后项目文件中将新增：\nGemfile 这个文件包含了 fastlane gem 的依赖 fastlane 这个文件夹包含 Appfile 存储 app identifier，Apple ID 以及 fastlane 设置 app 所需的任何其他标识信息 Fastfile 管理 lanes 创建的可被调用的 actions 创建 App 打开 Fastfile 将里面所有内容替换为：\ndefault_platform(:ios) platform :ios do # 1 lane 的描述 desc \u0026#34;Create app on Apple Developer and App Store Connect sites\u0026#34; # 2 create_app 是这个 lane 的名字 lane :create_app do # 3 使用 produce action 将 app 添加到 Developer Portal 和 App Store Connect ​ produce end end 打开 Appfile 将 apple_id 前的 # 移除，将 [[APPLE_ID]] 替换为真实 Apple ID，这样 fastlane 将不会反复提示你输入。\n如果 App Store Connect 和 Apple Developer Portal 可以将 apple_id 替换为：\napple_dev_portal_id(\u0026#34;[[APPLE_DEVELOPER_ACCOUNT_USERNAME]]\u0026#34;) itunes_connect_id(\u0026#34;[[APP_STORE_CONNECT_ACCOUNT_USERNAME]]\u0026#34;) 打开命令行在项目目录输入：\nfastlane create_app 根据提示输入密码，之后将提示你输入 bundle ID，以反 host 格式创建 ID，之后是 App name 最长 30 个字符。\n完成后登陆 Apple Developer Center 和 App Store Connect，app 在二者已经都被创建了。\n再次打开 Appfile 将 app_identifier 填写刚才创建的 bundle ID。\n生成交付文件 bundle exec fastlane deliver 根据提醒暂不使用 Swift 代替 Ruby，因为 fastlane.swift 现在为 beta。\n完成后 fastlane 文件夹中新增：\nmetadata 这个文件夹存放了 app 大部分的 metadata 元数据 Deliverfile 保存这剩余小部分的元数据 screenshots 将保存 app 截图 metadata 文件夹中文件内容就是提交给 App Store Connect，多语言 app 可以手动创建对应的语言文件夹。\n更多 deliver 参数见 这里\n自动截图 多种设备和多语言 app 的截图是繁杂的。\nfastlane snapshot init fastlane 文件夹中新增：Snapfile，将里面的所有内容替换为一下：\n# 1 - 想截图的设备列表 devices([ \u0026#34;iPhone 8 Plus\u0026#34;, \u0026#34;iPhone SE\u0026#34; ]) # 2 - 支持的语言列表 languages([ \u0026#39;en-US\u0026#39;, \u0026#39;fr-FR\u0026#39; ]) # 3 - 包含 UI Tests 的 scheme 名字 scheme(\u0026#34;mZone Poker UITests\u0026#34;) # 4 - 截图存储位置 output_directory \u0026#34;./fastlane/screenshots\u0026#34; # 5 - 是否清理之前的截图 clear_previous_screenshots(true) 保存关闭，然后命令中执行：\nfastlane snapshot init 创建 Test Target 在 Xcode 选择 File -\u0026gt; New -\u0026gt; Target 选择 iOS UI Testing Bundle 点击 Next。\nProduct Name 输入上面 scheme 填写的名字 MZone Poker UITests 点击 Finish。\n之后将 fastlane 文件夹中的 SnapshotHelper.swift 拖到 mZone Poker UITests 中。\n之后将 mZone_Poker_UITests.swift 中的 setUp() 和 tearDown() 移除，替换 testExample()：\n// 1 设置截屏和启动 app let app = XCUIApplication() setupSnapshot(app) app.launch() // 2 点击 Chip Count 输入框（在 Storyboard 中的 accessibility identifier 设置 \u0026#34;chip count\u0026#34;）然后输入 10 let chipCountTextField = app.textFields[\u0026#34;chip count\u0026#34;] chipCountTextField.tap() chipCountTextField.typeText(\u0026#34;10\u0026#34;) // 3 点击 Big Blind 输入框 然后输入 100 let bigBlindTextField = app.textFields[\u0026#34;big blind\u0026#34;] bigBlindTextField.tap() bigBlindTextField.typeText(\u0026#34;100\u0026#34;) // 4 截图 snapshot(\u0026#34;01UserEntries\u0026#34;) // 5 点击 what should i do 再进行截图 app.buttons[\u0026#34;what should i do\u0026#34;].tap() snapshot(\u0026#34;02Suggestion\u0026#34;) 之后创建 mZone Poker UITests scheme，点击 run stop 右边的按钮选择 Manage Schemes...\n选择 Edit Schemes... 勾选 Test 和 Run\n打开 Fastfile 添加：\ndesc \u0026#34;Take screenshots\u0026#34; lane :screenshot do snapshot end 命令行执行：\nbundle exec fastlane screenshot 完成后将自动打开：\n创建 IPA 文件 首先要确保已经 target 设置 bundle identifier 和 signing identity。\n命令行执行：\nfastlane gym init 打开 Gymfile 替换为以下内容：\n# 1 指定 scheme scheme(\u0026#34;mZone Poker\u0026#34;) # 2 指定存放 .ipa 文件夹 output_directory(\u0026#34;./fastlane/builds\u0026#34;) # 3 从构建中排除 bitcode。Bitcode 允许 Apple 优化你的 app，但是现在排除它以提高构建速度。 include_bitcode(false) # 4 从构建中排除符号。包含符号允许 Apple 访问应用程序的调试信息，但是现在排除它以提高构建速度。 include_symbols(false) # 5 允许 Xcode 使用自动配置。 export_xcargs(\u0026#34;-allowProvisioningUpdates\u0026#34;) 打开 Fastfile 添加：\ndesc \u0026#34;Create ipa\u0026#34; lane :build do # 1 允许 Xcode 自动配置 enable_automatic_code_signing # 2 构建号自增（App Store Connect 要求构建号不能重复） increment_build_number # 3 创建签名的 .ipa 文件 gym end 保存后命令行执行：\nbundle exec fastlane build 上传到 App Store Connect 使用 deliver 将截图、元数据、.ipa 文件上传到 App Store Connect。\n替换 Deliverfile 内容：\n# 1 价格为 0 则是免费应用 price_tier(0) # 2 回答 Apple 在手动提交审核时会向您呈现的问题 submission_information({ export_compliance_encryption_updated: false, export_compliance_uses_encryption: false, content_rights_contains_third_party_content: false, add_id_info_uses_idfa: false }) # 3 提供应用评级配置位置 app_rating_config_path(\u0026#34;./fastlane/metadata/app_store_rating_config.json\u0026#34;) # 4 提供.ipa文件位置 ipa(\u0026#34;./fastlane/builds/mZone Poker.ipa”) # 5 将s ubmit_for_review 设置为 true 以自动提交应用以供审核 submit_for_review(true) # 6 必须在应用审核接受后手动发布应用 automatic_release(false) 在 Fastfile 中添加：\ndesc \u0026#34;Upload to App Store\u0026#34; lane :upload do deliver end 然后命令行执行：\nbundle exec fastlane upload 完成后，登录 App Store Connect。屏幕截图，元数据和构建应该在那里，等待审查。\n将命令放在一起 打开 Fastfile 添加：\ndesc \u0026#34;Create app, take screenshots, build and upload to App Store\u0026#34; lane :do_everything do create_app screenshot build upload end 在 Deliverfile 添加：\nforce(true) 执行：\nbundle exec fastlane do_everything References fastlane Tutorial: Getting Started \u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2019/02/28/fastlane-getting-started/","summary":"\u003cp\u003e这次以 \u003ca href=\"https://fastlane.tools/\"\u003efastlane\u003c/a\u003e 为例，尝试项目中有什么事情可以被自动完成。\u003c/p\u003e\n\u003cp\u003efastlane 是 Ruby scripts 的集合，安装方法不多说了见 \u003ca href=\"https://docs.fastlane.tools/\"\u003e官网文档\u003c/a\u003e。\u003c/p\u003e\n\u003cp\u003efastlane 中有但不限于以下工具集：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://docs.fastlane.tools/actions/produce/\"\u003eproduce\u003c/a\u003e 同时在 Apple Developer Portal 和 App Store Connect 中创建新的 iOS apps。\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://docs.fastlane.tools/actions/cert/\"\u003ecert\u003c/a\u003e 自动创建和维护 iOS 签名证书。\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://docs.fastlane.tools/actions/sigh/\"\u003esigh\u003c/a\u003e 创建，更新，下载和修复配置文件。\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://docs.fastlane.tools/actions/snapshot/\"\u003esnapshot\u003c/a\u003e 自动在每台设备上获取 iOS 应用的本地化屏幕截图。\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://docs.fastlane.tools/actions/frameit/\"\u003eframeit\u003c/a\u003e 将您的屏幕截图放入正确的设备框架中。\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://docs.fastlane.tools/actions/gym/\"\u003egym\u003c/a\u003e 构建和打包您的 iOS apps。\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://docs.fastlane.tools/actions/deliver/\"\u003edeliver\u003c/a\u003e 将截图，元数据和您的应用上传到 App Store。\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://docs.fastlane.tools/actions/pem/\"\u003epem\u003c/a\u003e 自动生成并更新推送通知配置文件。\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/fastlane/fastlane/tree/master/spaceship\"\u003espaceship\u003c/a\u003e 一个 Ruby 库能够访问苹果开发者中心和应用商店连接 api。\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://docs.fastlane.tools/actions/pilot/\"\u003epilot\u003c/a\u003e 自动化 TestFlight 部署并管理测试用户。\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/fastlane/boarding\"\u003eboarding\u003c/a\u003e 邀请 beta 测试人员。\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://docs.fastlane.tools/actions/match/\"\u003ematch\u003c/a\u003e 使用 Git 同步整个团队的证书和配置文件。\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://docs.fastlane.tools/actions/scan/\"\u003escan\u003c/a\u003e 运行 app 测试。\u003c/li\u003e\n\u003c/ul\u003e\n\u003c!-- more --\u003e\n\u003cblockquote\u003e\n\u003cp\u003e实验环境：Xcode 10.1、Swift 4.2、fastlane 2.116.1、$99 开发者账户\u003c/p\u003e","title":"fastlane 入门使用"},{"content":"再读王巍的【Swifter - Swift 开发者必备 Tips】，看看有什么新收获。\n柯里化（Currying） 柯里化 是把接受多个参数的函数变换成接受一个单一参数（最初函数的第一个参数）的函数，并且返回接受余下的参数而且返回结果的新函数的技术，这个词自己是第一次见到。\n自己的理解就是：把接受多个参数的函数变换为，先接受一个参数，然后返回一个函数，这个函数再接受其他参数。\n两个细节：\n只有一个参数，并且这个参数是该函数的第一个参数。必须按照参数的定义顺序来调用柯里化函数。 柯里化函数的函数体只会执行一次，只会在调用完最后一个参数的时候执行柯里化函数体。 /// 一个数加 x 的函数 func addTo(_ adder: Int) -\u0026gt; (Int) -\u0026gt; Int { return { adder + $0 } } // +2 let addTwo = addTo(2) let result = addTwo(6) // 8 // +10 let addTen = addTo(10) addTen(6) // 16 柯里化是一种量产相似方法的好办法，可以通过柯里化一个方法模板来避免写出很多重复代码，也方便了今后维护。\n书中还提到了一个封装 Selector 的例子，但是没懂，欢迎指教。\nReference:\nSwift 函数柯里化介绍及使用场景 将 protocol 的方法声明为 mutating protocol 不仅可以被 class 类型实现，也适用于 struct 和 enum。因为这个原因就要考虑定义的方法是否应该使用 mutating 来修饰。在 protocl 中使用 mutating 修饰的方法，对于 class 的实现是完全透明的。\n多元组（Tuple） python 中有见过类似。\n/// 交互数据 func swapMe\u0026lt;T\u0026gt;(_ a: inout T, _ b: inout T) { (a, b) = (b, a) } var a = 10 var b = 20 swapMe(\u0026amp;a, \u0026amp;b) // a: 20 b: 10 /// 可读的返回值 let rect = CGRect(x: 0, y: 0, width: 100, height: 100) let (slice, remainder) = rect.divided(atDistance: 20, from: .minYEdge) // slice {x 0 y 0 w 100 h 20} // remainder {x 0 y 20 w 100 h 80} @autoclosure 和 ?? @autoclosure 做的事情就是把一句表达式自动的封装成一个闭包（closure）。这样有时候在语法上看起来就会非常漂亮。\nfunc logIfTrue(_ predicate: @autoclosure () -\u0026gt; Bool) { if predicate() { print(\u0026#34;True\u0026#34;) } } logIfTrue(2 \u0026gt; 1) // 而不是 logIfTrue { 2 \u0026gt; 1 } Swift 把 2 \u0026gt; 1 这个表达式自动转换为 () -\u0026gt; Bool。\nSwift 中 ?? 定义为：\nfunc ??\u0026lt;T\u0026gt;(optional: T?, defaultValue: @autoclosure () -\u0026gt; T?) -\u0026gt; T? func ??\u0026lt;T\u0026gt;(optional: T?, defaultValue: @autoclosure () -\u0026gt; T) -\u0026gt; T /// 猜测 ?? 的实现 func ??\u0026lt;T\u0026gt;(optional: T?, defaultValue: @autoclosure() -\u0026gt; T) -\u0026gt; T { switch optional { case .some(let value): return value default: return defaultValue() } } 使用 @autoclosure 来修饰默认值看起来有些画蛇添足，但是如果默认值是通过一系列复杂计算得到话，在 optional 不为 nil 的情况下就会造成浪费。@autoclosure 将计算推迟到 optional 为 nil。\n@escaping func doWork(block: () -\u0026gt; Void) { block() } doWork { print(\u0026#34;work\u0026#34;) } 这里默认了一个隐藏假设：参数中 block 的内容会在 doWork 发会之前就完成了，也就是说，对于 block 的调用是同步行为。\nfunc doWorkAsync(block: @escaping () -\u0026gt; ()) { DispatchQueue.main.async { block() } } @escaping 表明这个闭包是会 逃逸 出该方法。\nclass S { var foo = \u0026#34;foo\u0026#34; func method1() { doWork { print(foo) } foo = \u0026#34;method1\u0026#34; } func method2() { doWorkAsync { print(self.foo) } foo = \u0026#34;method2\u0026#34; } func method3() { foo = \u0026#34;method4\u0026#34; doWorkAsync { [weak self] in print(self?.foo ?? \u0026#34;nil\u0026#34;) } foo = \u0026#34;method3\u0026#34; } } S().method1() // foo - 同步 S().method2() // method2 - 强引用造成？ S().method3() // nil - 已经释放 Optional Chaining let playClosure = { (child: Child) -\u0026gt; Void in child.pet?.toy?.play() } 这里 Void 是不合理的，因为真正的结果是一个 Optional 的结果，所有应该为 Void?。\nlet playClosure = { (child: Child) -\u0026gt; Void? in child.pet?.toy?.play() } // 判断方法是否调用成功： if let result = playClosure { print(\u0026#34;happy\u0026#34;) } else { print(\u0026#34;can\u0026#39;t play\u0026#34;) } ","permalink":"https://zyf.im/2019/02/15/swifter-tips-reading-notes/","summary":"\u003cp\u003e再读王巍的【Swifter - Swift 开发者必备 Tips】，看看有什么新收获。\u003c/p\u003e\n\u003ch2 id=\"柯里化currying\"\u003e柯里化（Currying）\u003c/h2\u003e\n\u003cp\u003e\u003ca href=\"https://zh.wikipedia.org/wiki/%E6%9F%AF%E9%87%8C%E5%8C%96%5D\"\u003e柯里化\u003c/a\u003e 是把接受多个参数的函数变换成接受一个单一参数（最初函数的第一个参数）的函数，并且返回接受余下的参数而且返回结果的新函数的技术，这个词自己是第一次见到。\u003c/p\u003e\n\u003cp\u003e自己的理解就是：把接受多个参数的函数变换为，先接受一个参数，然后返回一个函数，这个函数再接受其他参数。\u003c/p\u003e\n\u003cp\u003e两个细节：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e只有一个参数，并且这个参数是该函数的第一个参数。必须按照参数的定义顺序来调用柯里化函数。\u003c/li\u003e\n\u003cli\u003e柯里化函数的函数体只会执行一次，只会在调用完最后一个参数的时候执行柯里化函数体。\u003c/li\u003e\n\u003c/ul\u003e\n\u003c!-- more --\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-swift\" data-lang=\"swift\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e/// 一个数加 x 的函数\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003efunc\u003c/span\u003e \u003cspan class=\"nf\"\u003eaddTo\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kc\"\u003e_\u003c/span\u003e \u003cspan class=\"n\"\u003eadder\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nb\"\u003eInt\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e-\u0026gt;\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nb\"\u003eInt\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e-\u0026gt;\u003c/span\u003e \u003cspan class=\"nb\"\u003eInt\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"n\"\u003eadder\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"nv\"\u003e$0\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// +2\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003elet\u003c/span\u003e \u003cspan class=\"nv\"\u003eaddTwo\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eaddTo\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003elet\u003c/span\u003e \u003cspan class=\"nv\"\u003eresult\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eaddTwo\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e6\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"c1\"\u003e// 8\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// +10\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003elet\u003c/span\u003e \u003cspan class=\"nv\"\u003eaddTen\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eaddTo\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e10\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003eaddTen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e6\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"c1\"\u003e// 16\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e柯里化是一种量产相似方法的好办法，可以通过柯里化一个方法模板来避免写出很多重复代码，也方便了今后维护。\u003c/p\u003e\n\u003cp\u003e书中还提到了一个封装 \u003ca href=\"https://oleb.net/blog/2014/07/swift-instance-methods-curried-functions/?utm_campaign=iOS_Dev_Weekly_Issue_157\u0026amp;utm_medium=email\u0026amp;utm_source=iOS%252BDev%252BWeekly\"\u003eSelector\u003c/a\u003e 的例子，但是没懂，欢迎指教。\u003c/p\u003e\n\u003cp\u003eReference:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.jianshu.com/p/5b27fec8c616\"\u003eSwift 函数柯里化介绍及使用场景\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"将-protocol-的方法声明为-mutating\"\u003e将 protocol 的方法声明为 mutating\u003c/h2\u003e\n\u003cp\u003e\u003ccode\u003eprotocol\u003c/code\u003e 不仅可以被 \u003ccode\u003eclass\u003c/code\u003e 类型实现，也适用于 \u003ccode\u003estruct\u003c/code\u003e 和 \u003ccode\u003eenum\u003c/code\u003e。因为这个原因就要考虑定义的方法是否应该使用 \u003ccode\u003emutating\u003c/code\u003e 来修饰。在 \u003ccode\u003eprotocl\u003c/code\u003e 中使用 \u003ccode\u003emutating\u003c/code\u003e 修饰的方法，对于 \u003ccode\u003eclass\u003c/code\u003e 的实现是完全透明的。\u003c/p\u003e\n\u003ch2 id=\"多元组tuple\"\u003e多元组（Tuple）\u003c/h2\u003e\n\u003cp\u003epython 中有见过类似。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-swift\" data-lang=\"swift\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e/// 交互数据\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003efunc\u003c/span\u003e \u003cspan class=\"nf\"\u003eswapMe\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;(\u003c/span\u003e\u003cspan class=\"kc\"\u003e_\u003c/span\u003e \u003cspan class=\"n\"\u003ea\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"kr\"\u003einout\u003c/span\u003e \u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003e_\u003c/span\u003e \u003cspan class=\"n\"\u003eb\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"kr\"\u003einout\u003c/span\u003e \u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ea\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eb\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eb\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ea\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nv\"\u003ea\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e10\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nv\"\u003eb\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e20\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003eswapMe\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u0026amp;\u003c/span\u003e\u003cspan class=\"n\"\u003ea\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"n\"\u003eb\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"c1\"\u003e// a: 20  b: 10\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-swift\" data-lang=\"swift\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e/// 可读的返回值\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003elet\u003c/span\u003e \u003cspan class=\"nv\"\u003erect\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eCGRect\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ey\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ewidth\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"mi\"\u003e100\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eheight\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"mi\"\u003e100\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003elet\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eslice\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eremainder\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003erect\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003edivided\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eatDistance\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"mi\"\u003e20\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003efrom\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eminYEdge\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// slice {x 0 y 0 w 100 h 20}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// remainder {x 0 y 20 w 100 h 80}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"autoclosure-和-\"\u003e\u003ccode\u003e@autoclosure\u003c/code\u003e 和 \u003ccode\u003e??\u003c/code\u003e\u003c/h2\u003e\n\u003cp\u003e\u003ccode\u003e@autoclosure\u003c/code\u003e 做的事情就是把一句表达式自动的封装成一个闭包（closure）。这样有时候在语法上看起来就会非常漂亮。\u003c/p\u003e","title":"【Swifter - Swift 开发者必备 Tips】笔记"},{"content":"在 GitHub Trending 中总是看到 mxcl/PromiseKit 它是主要解决的是 “回调地狱” 的问题，决定尝试用一下。\n环境：Swift 4.2、PromiseKit 6\nthen and done 下面是一个典型的 promise 链式（chain）调用：\nfirstly { login() }.then { creds in fetch(avatar: creds.user) }.done { image in self.imageView = image } 如果这段代码使用完成回调（completion handler）实现，他将是：\nlogin { creds, error in if let creds = creds { fetch(avatar: creds.user) { image, error in if let image = image { self.imageView = image } } } } then 是完成回调的另一种方式，但是它更丰富。在处级阶段的理解，它更具有可读性。上面的 promise chain 更容易阅读和理解：一个异步操作接着另一个，一行接一行。它与程序代码非常接近，因为我们很容易得到 Swift 的当前状态。\ndone 与 then 基本是一样的，但是它将不再返回 promise。它是典型的在末尾 “success” 部分的 chain。在上面的例子 done 中，我们接收到了最终的图片并使用它设置了 UI。\n让我们对比一下两个 login 的方法签名：\n// Promise: func login() -\u0026gt; Promise\u0026lt;Creds\u0026gt; // Compared with: func login(completion: (Creds?, Error?) -\u0026gt; Void) // 可选型，两者都是可选 区别在于 promise，方法返回 promises 而不是的接受和运行回调。每一个处理器（handler）都会返回一个 promise。Promise 对象们定义 then 方法，该方法在继续链式调用之前等待 promise 的完成。chains 在程序上解决，一次一个 promise。\nPromise 代表未来异步方法的输入值。它有一个表示它包装的对象类型的类型。例如，在上面的例子里，login 的返回 Promise 值代表一个 Creds 的一个实例。\n可以注意到这与 completion pattern 的不同，promises chain 似乎忽略错误。并不是这样，实际上：promise chain 使错误处理更容易访问（accessible），并使错误更难被忽略。\ncatch 有了 promises，错误在 promise chain 上级联（cascade along），确保你的应用的健壮（robust）和清晰的代码。\nfirstly { login() }.then { creds in fetch(avatar: creds.user) }.done { image in self.imageView = image }.catch { // 整个 chain 上的错误都到了这里 } 如果你忘记了 catch 这个 chain，Swift 会发出警告\n每个 promise 都是一个表示单个（individual）异步任务的对象。如果任务失败，它的 promise 将成为 rejected。产生 rejected promises 将跳过后面所有的 then，而是将执行 catch。（严格上说是执行后续所有的 catch 处理）\n这与 completion handler 对比：\nfunc handle(error: Error) { //... } login { creds, error in guard let creds = creds else { return handle(error: error!) } fetch(avatar: creds.user) { image, error in guard let image = image else { return handle(error: error!) } self.imageView.image = image } } 使用 guard 和合并错误对处理有所保证，但是 promise chain 更具有可读性。\nensure firstly { UIApplication.shared.isNetworkActivityIndicatorVisible = true return login() }.then { fetch(avatar: $0.user) }.done { self.imageView = $0 }.ensure { UIApplication.shared.isNetworkActivityIndicatorVisible = false }.catch { // ... } 无论在 chain 哪里结束，成功或者失败，ensure 终将被执行。也可以使用 finally 来完成相同的事情，区别是没有返回值。\nspinner(visible: true) firstly { foo() }.done { // ... }.catch { // ... }.finally { self.spinner(visible: false) } when 多个异步操作同时处理时可能又难又慢。例如当 操作1 和 操作2 都完成时再返回结果：\n// 串行操作 operation1 { result1 in operation2 { result2 in finish(result1, result2) } } // 并行操作 var result1: ...! var result2: ...! let group = DispatchGroup() group.enter() group.enter() operation1 { result1 = $0 group.leave() } operation2 { result2 = $0 group.leave() } group.notify(queue: .main) { finish(result1, result2) } 使人 Promises 将变得容易很多：\nfirstly { when(fulfilled: operation1(), operation2()) }.done { result1, result2 in // ... } when 等待所有的完成再返回 promises 结果。\nPromiseKit 扩展 PromiseKit 提过了一些 Apple API 的扩展，例如：\nfirstly { CLLocationManager.promise() }.then { location in CLGeocoder.reverseGeocode(location) }.done { placemarks in self.placemark.text = \u0026#34;\\(placemarks.first)\u0026#34; } 同时需要指定 subspaces：\npod \u0026#34;PromiseKit\u0026#34; pod \u0026#34;PromiseKit/CoreLocation\u0026#34; pod \u0026#34;PromiseKit/MapKit\u0026#34; 更多的扩展可以查询 PromiseKit organization，甚至扩展了 Alamofire 这样的公共库。\n制作 Promises 有时你的 chains 仍然需要以自己开始，或许你使用的三方库没有提供 promises 或者自己写了异步系统，没关系，他们非常容易添加 promises。如果你查看了 PromiseKit 的标准扩展，可以看到使用了下面相同的描述：\n已有代码：\nfunc fetch(completion: (String?, Error?) -\u0026gt; Void) 转换：\nfunc fetch() -\u0026gt; Promise\u0026lt;String\u0026gt; { return Promise { fetch(completion: $0.resolve) } } 更具有可读性的：\nfunc fetch() -\u0026gt; Promise\u0026lt;String\u0026gt; { return Promise { seal in fetch { result, error in seal.resolve(result, error) } } } Promise 初始化程序提供的 seal 对象定义了很多处理 garden-variety 完成回调的方法。\nPromiseKit 设置尝试以 Promise(fetch) 进行处理，但是完成通过编译器的消歧义。\nGuarantee 从 PromiseKit 5 开始，提供了 Guarantee 以做补充，目的是完善 Swift 强的的异常处理。\nGuarantee 永远不会失败，所以不能被 rejected。\nfirstly { after(seconds: 0.1) }.done { // 这里不要加 catch } Guarantee 的语法相较更简单：\nfunc fetch() -\u0026gt; Promise\u0026lt;String\u0026gt; { return Guarantee { seal in fetch { result in seal(result) } } } // 减少为 func fetch() -\u0026gt; Promise\u0026lt;String\u0026gt; { return Guarantee(resolver: fetch) } map compactMap 等 then 要求返回另一个 promise map 要求返回一个 object 或 value 类型 compactMap 要求返回一个 可选型，如过返回 nil，chain 将失败并报错 PMKError.compactMap firstly { URLSession.shared.dataTask(.promise, with: rq) }.compactMap { try JSONSerialization.jsonObject($0.data) as? [String] }.done { arrayOfStrings in // ... }.catch { error in // Foundation.JSONError if JSON was badly formed // PMKError.compactMap if JSON was of different type } 除此之外还有：thenMap compactMapValues firstValue etc\nget get 会得到 done 中相同值。\nfirstly { foo() }.get { foo in // ... }.done { foo in // same foo! } tap 为 debug 提供 tap，与 get 类似但是可以得到 Result\u0026lt;T\u0026gt; 这样就可以检查 chain 上的值：\nfirstly { foo() }.tap { print($0) }.done { // ... }.catch { // ... } 补充 firstly 上面例子中的 firstly 是语法糖，非必须但是可以让 chains 更有可读性。\nfirstly { login() }.then { creds in // ... } // 也可以 login().then { creds in // ... } 知识点：login() 返回了一个 Promise，同时所有的 Promise 有一个 then 方法。firstly 返回一个 Promise，同样 then 也返回一个 Promise。\nwhen 变种 when(fulfilled:) 在所有异步操作执行完后才执行回调，一个失败 chain 将 rejects。It\u0026rsquo;s important to note that all promises in the when continue. Promises have no control over the tasks they represent. Promises are just wrappers around tasks. when(resolved:) 使一个或多个组件承诺失败也会等待。此变体 when 生成的值是 Result\u0026lt;T\u0026gt; 的数组，所有要保证相同的泛型。 race 只要有一个异步操作执行完毕，就立刻执行 then 回调。其它没有执行完毕的异步操作仍然会继续执行，而不是停止。 Swift 闭包接口 Swift 有自动推断返回值和单行返回。\nfoo.then { bar($0) } // is the same as: foo.then { baz -\u0026gt; Promise\u0026lt;String\u0026gt; in return bar(baz) } 这样有好有坏，具体可以查询 Troubleshooting\n更多阅读 强力建议阅读 API Reference 在 Xcode 使用 optinon-click 阅读 PromiseKit 代码 在网上有一些 PMK \u0026lt; 5 的文章，里面的 API 有些不同要注意 References Getting Started Swift - 异步编程库 PromiseKit 使用详解 1（安装配置、基本用法） \u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2019/01/19/promisekit-getting-started/","summary":"\u003cp\u003e在 GitHub Trending 中总是看到 \u003ca href=\"https://github.com/mxcl/PromiseKit\"\u003emxcl/PromiseKit\u003c/a\u003e 它是主要解决的是 “回调地狱” 的问题，决定尝试用一下。\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e环境：Swift 4.2、PromiseKit 6\u003c/p\u003e\u003c/blockquote\u003e\n\u003ch2 id=\"then-and-done\"\u003ethen and done\u003c/h2\u003e\n\u003cp\u003e下面是一个典型的 promise 链式（chain）调用：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003efirstly {\n    login()\n}.then { creds in\n    fetch(avatar: creds.user)\n}.done { image in\n    self.imageView = image\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c!-- more --\u003e\n\u003cp\u003e如果这段代码使用完成回调（\u003ccode\u003ecompletion handler\u003c/code\u003e）实现，他将是：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003elogin { creds, error in\n    if let creds = creds {\n        fetch(avatar: creds.user) { image, error in\n            if let image = image {\n                self.imageView = image\n            }\n        }\n    }\n}\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e\u003ccode\u003ethen\u003c/code\u003e 是完成回调的另一种方式，但是它更丰富。在处级阶段的理解，它更具有可读性。上面的 promise chain 更容易阅读和理解：一个异步操作接着另一个，一行接一行。它与程序代码非常接近，因为我们很容易得到 Swift 的当前状态。\u003c/p\u003e","title":"PromiseKit 入门使用"},{"content":" 重新翻阅的自己工作邮件的发件箱，回顾一年工作。新年伊始自己还是在开发 P 项目的 iOS App，开始写 Q\u0026amp;A 功能。一些不算太难的 tableView 布局的需求，对我来说，都是头大的问题。\n这段时期招聘时的面试，竟成为我学习 App 开发的一扇小窗。\n年前收到了奖金还是挺开心的。leader 新年寄语：\n要发声，要当主力 当有好的想法时，要学会说服别人 要有耐心，Yifan 需要时间的沉淀 前两点意思差不多，这段时间思想上困扰我的是：自己对自己的定位是一个初级工程师，认为会的东西、经验不多，见识少，我尊重比我年长的工程师的想法与观点，也相信他们是经过长远思考过的。这个思维设定，我觉得没有什么问题。但是也许有人忽略了 责任，对方案负责，对项目负责。开发方案一再重建性修改，接口结构没有规范。\n2017 的总结说胜利属于伏地魔，本想苟着发育，这时发现：苟是苟不住的，这个世界 需要英雄 carry。\n后来我感觉应该将公司看做一个舞台，舞台上有灯光、音效就要利用，展示自己、锻炼自己，即使是出糗，那就整理整理再来一次，who care? 成长是最重要的。\nCourse 模块是前工程师用 Objective-C 写的，离职后一直没有再维护，过年期间自己重构了所有 Objective-C 的代码，项目完全转为了一个纯 Swift 项目。使用 Realm 作为数据本地化方案，选择的原因也很朴素，GitHub 哪个星多我就优先选用什么。\n后来参考 Jack Feng - 6ag 的几个 Swift 开源项目，新创建了 P 项目的工具 App，也对主项目结构做了重新的整理，在这里再次特别感谢。\n西安运营部的成立，加多了 C 项目的后台需求，难以都顾及项目两头。使用 laravel-admin 搭建新后台，也开始使用 Docker 部署项目，感觉从此离不开 Docker 了，像极了遇到 Git 时的感觉。\nC 项目主站的前端是在服务端渲染，非常传统的模式，多个工程师转手也是十分混乱。参考了 白俊遥 工程的博客、laravel 项目，修改了项目结构，添加了 gulp 工具制定了工作流，虽然没有实现前后端的完全分离，但终究是向现代化前端走出了一步。\n转眼就到了年中调薪，公司不含糊，薪水涨到了我满意的值。这对我很关键，调整的不单单是我的薪水，也调整了我的心态。因为当时我认为没有强的工程师、甚至归我负责，却拿着比我还高的薪水。现在总算是有了一个平衡。\n不断向 C 项目投入更多的资源，项目 指标 的要求越来越多。比如：优化了项目、优化了查询，到底优化了多少，怎么量化？这些在之前一直不被重视，改好了就都算叫优化了。项目中出现的问题错误，都要查找真实具体的原因，而不是说一个可能的什么原因，就当解答的了。我一开始也很难适应这些，但心里是认同的。\nC 项目数据源重新整理，终于摸到了一次算法的边。“你觉的算法没用，是因为你不会。” 数据标记、正确率、召回率、特征词提取、文本相似度、词条打分、背包算法…… 一段最让人回忆的开发经历，与业务开发完全不同的模式。\nC 项目衍生出新项目 G，我一个人做，一次实践 Laravel 框架的机会。\n再次和 Z 哥合作了一个 App 项目，私活做的真是的太累了，极不推荐。其实这段时期工作上并没有在做 iOS，因为这个项目没让自己 iOS 的技能凉下来，为后面回归 iOS 项目保持了状态。\n参加了年度的 Swift 大会，在群里简单了很多大佬、看过博客的工程师，没想到他们都很乐意加微信。也发现他们相互都认识，这就是圈子吧。\n2018 是世界杯年，我不懂球就是看个热闹，最开心的是公司有活动基金，我拉着不少新同事们吃喝了不少。冬季后发展成了和同事的每周的火锅，真挺快乐的。\n买了心心念的 Switch 叫的闪送，上午下单一会后，就像收外卖一样收了机子。荒野之息是好玩，呃… 男主竟然叫林克不是塞尔达，你敢想？\n因为 MSI 的胜利开始关注 RNG LPL。这年 LPL 后面的比赛我基本都看了，中午还会看 dys 的直播实况。洲际赛 RW 救世主真是精彩，“当没人相信你的时候，你自己相信了自己，并且赢得了胜利，这便是成为英雄的道路。” 登峰造極 2018 我们是冠军。\n永利*暴雷崩盘，损失不少，派出所报案。家里，多年的期房要发钥匙了，感恩父母。一次团建向比比求婚成功。\n这年最后一天是在三亚，吃到了棒棒的早晨，去了蜈支洲岛，感受了乘风破浪，遇到了一个有趣的东北司机，参加了酒店的晚会，看了喝酒赢到的电影。\n2018 Happy Ending.\n做了一个梦 我们 iG 拿冠军了 啊哈哈哈… 我说是不是假的 确实是个梦吧， 但是就是当时虽然在做 但是特别开心。 所以我们尽量就是自己努力一下， 然后每个人发挥好一点的话， 我觉得真的有可能 也可以拿冠军的。\n\u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2018/12/31/review-2018/","summary":"\u003ciframe frameborder=\"no\" border=\"0\" marginwidth=\"0\" marginheight=\"0\" width=298 height=52 src=\"//music.163.com/outchain/player?type=2\u0026id=476618833\u0026auto=0\u0026height=32\"\u003e\u003c/iframe\u003e\n\u003cp\u003e重新翻阅的自己工作邮件的发件箱，回顾一年工作。新年伊始自己还是在开发 P 项目的 iOS App，开始写 Q\u0026amp;A 功能。一些不算太难的 tableView 布局的需求，对我来说，都是头大的问题。\u003c/p\u003e\n\u003cp\u003e这段时期招聘时的面试，竟成为我学习 App 开发的一扇小窗。\u003c/p\u003e\n\u003cp\u003e年前收到了奖金还是挺开心的。leader 新年寄语：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e要发声，要当主力\u003c/li\u003e\n\u003cli\u003e当有好的想法时，要学会说服别人\u003c/li\u003e\n\u003cli\u003e要有耐心，Yifan 需要时间的沉淀\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e前两点意思差不多，这段时间思想上困扰我的是：自己对自己的定位是一个初级工程师，认为会的东西、经验不多，见识少，我尊重比我年长的工程师的想法与观点，也相信他们是经过长远思考过的。这个思维设定，我觉得没有什么问题。但是也许有人忽略了 \u003cstrong\u003e责任\u003c/strong\u003e，对方案负责，对项目负责。开发方案一再重建性修改，接口结构没有规范。\u003c/p\u003e\n\u003cp\u003e2017 的总结说胜利属于伏地魔，本想苟着发育，这时发现：苟是苟不住的，这个世界 \u003cstrong\u003e需要英雄\u003c/strong\u003e carry。\u003c/p\u003e\n\u003cp\u003e后来我感觉应该将公司看做一个舞台，舞台上有灯光、音效就要利用，展示自己、锻炼自己，即使是出糗，那就整理整理再来一次，who care? 成长是最重要的。\u003c/p\u003e\n\u003cp\u003eCourse 模块是前工程师用 Objective-C 写的，离职后一直没有再维护，过年期间自己重构了所有 Objective-C 的代码，项目完全转为了一个纯 Swift 项目。使用 Realm 作为数据本地化方案，选择的原因也很朴素，GitHub 哪个星多我就优先选用什么。\u003c/p\u003e\n\u003cp\u003e后来参考 \u003ca href=\"https://github.com/6ag\"\u003eJack Feng - 6ag\u003c/a\u003e 的几个 Swift 开源项目，新创建了 P 项目的工具 App，也对主项目结构做了重新的整理，在这里再次特别感谢。\u003c/p\u003e\n\u003cp\u003e西安运营部的成立，加多了 C 项目的后台需求，难以都顾及项目两头。使用 laravel-admin 搭建新后台，也开始使用 Docker 部署项目，感觉从此离不开 Docker 了，像极了遇到 Git 时的感觉。\u003c/p\u003e\n\u003cp\u003eC 项目主站的前端是在服务端渲染，非常传统的模式，多个工程师转手也是十分混乱。参考了 \u003ca href=\"https://baijunyao.com/\"\u003e白俊遥\u003c/a\u003e 工程的博客、laravel 项目，修改了项目结构，添加了 gulp 工具制定了工作流，虽然没有实现前后端的完全分离，但终究是向现代化前端走出了一步。\u003c/p\u003e\n\u003cp\u003e转眼就到了年中调薪，公司不含糊，薪水涨到了我满意的值。这对我很关键，调整的不单单是我的薪水，也调整了我的心态。因为当时我认为没有强的工程师、甚至归我负责，却拿着比我还高的薪水。现在总算是有了一个平衡。\u003c/p\u003e\n\u003cp\u003e不断向 C 项目投入更多的资源，项目 \u003cstrong\u003e指标\u003c/strong\u003e 的要求越来越多。比如：优化了项目、优化了查询，到底优化了多少，怎么量化？这些在之前一直不被重视，改好了就都算叫优化了。项目中出现的问题错误，都要查找真实具体的原因，而不是说一个可能的什么原因，就当解答的了。我一开始也很难适应这些，但心里是认同的。\u003c/p\u003e","title":"回顾 2018"},{"content":"快速从一个数组中查找一个元素。\nLinear Search 线性查找 func linearSearch\u0026lt;T: Equatable\u0026gt;(_ a: [T], _ key: T) -\u0026gt; Int? { for i in 0 ..\u0026lt; a.count { if a[i] == key { return i } } return nil } 线性查找在最坏情况：遍历了整个数组，但没有找到合适的元素。平均要遍历一半的元素性能为 O(n)，而二分查找的效率为 O(log n)，也就是说一个有 1,000,000 元素的数组只需要 20 步就可以找到想要的元素 log_2(1,000,000) = 19.9。\n但是二分查找要求数组必须是排好序。\n二分查找步骤：\n将数组分为两半。 判断想要找的元素是在左边数组还是右边，这也是数组需要排好顺序的原因。 如果要的元素在左边，就将左边的数组分成更小的两部分，并判断要的元素在哪部分。 重复步骤直到找到想要的元素。如果数组不能进一步查分，就说明要找的元素不在数组中。 divide-and-conquer\nThe code func binarySearch\u0026lt;T: Comparable\u0026gt;(_ a: [T], key: T, range: Range\u0026lt;Int\u0026gt;) -\u0026gt; Int? { if range.lowerBound \u0026gt;= range.upperBound { // If we get here, then the search key is not present in the array. return nil } else { // Calculate where to split the array. let midIndex = range.lowerBound + (range.upperBound - range.lowerBound) / 2 // Is the search key in the left half? if a[midIndex] \u0026gt; key { return binarySearch(a, key: key, range: range.lowerBound ..\u0026lt; midIndex) // Is the search key in the right half? // 这里 + 1 的原因是排除 midIndex 中间值 } else if a[midIndex] \u0026lt; key { return binarySearch(a, key: key, range: midIndex + 1 ..\u0026lt; range.upperBound) // If we get here, then we\u0026#39;ve found the search key! } else { return midIndex } } } // 19 numbers let numbers = [2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37, 41, 43, 47, 53, 59, 61, 67] // 0 ..\u0026lt; numbers.count 覆盖所有范围 binarySearch(numbers, key: 43, range: 0 ..\u0026lt; numbers.count) // gives 13 二分查找是将数组分为两个，但是我们不需要正真的创建两个新数组。取而代之，我们使用 Swift Range 对象跟踪这些拆分。左闭右开。upperBound 总是比最后一个元素的索引多一。\nmidIndex = (lowerBound + upperBound) / 2 如果这样写将存在一个 bug，就是当这两值非常大时，将存在一个越界的问题。\nIterative vs recursive 迭代 vs 递归 二分查找本质是递归。\n使用迭代的方式实现：\nfunc binarySearch(_ a: [Int], key: Int) -\u0026gt; Int? { var lowerBound = 0 var upperBound = a.count while lowerBound \u0026lt; upperBound { // 这行僵硬了 没有必要的 var range = lowerBound ..\u0026lt; upperBound let midIndex = range.lowerBound + (range.upperBound - range.lowerBound) / 2 let midValue = a[midIndex] if key \u0026lt; midValue { upperBound = midIndex } else if key \u0026gt; midValue { lowerBound = midIndex + 1 } else { return midIndex } } return nil } The end 查找前数组一定要先排序吗？这取决于排序花费的时间，有时候：数组排序加二分查找比线性搜索还要慢。二分查找的优势在于一次排序后多次查找。\n文章代码：GitHub - imzyf/data-structure-and-algorithm/004-Binary Search/。\nReferences raywenderlich/swift-algorithm-club/Binary Search ","permalink":"https://zyf.im/2018/12/10/binary-search/","summary":"\u003cp\u003e快速从一个数组中查找一个元素。\u003c/p\u003e\n\u003ch2 id=\"linear-search-线性查找\"\u003eLinear Search 线性查找\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-swift\" data-lang=\"swift\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003efunc\u003c/span\u003e \u003cspan class=\"nf\"\u003elinearSearch\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nb\"\u003eEquatable\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;(\u003c/span\u003e\u003cspan class=\"kc\"\u003e_\u003c/span\u003e \u003cspan class=\"n\"\u003ea\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e \u003cspan class=\"kc\"\u003e_\u003c/span\u003e \u003cspan class=\"n\"\u003ekey\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e-\u0026gt;\u003c/span\u003e \u003cspan class=\"nb\"\u003eInt\u003c/span\u003e\u003cspan class=\"p\"\u003e?\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e \u003cspan class=\"k\"\u003ein\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e \u003cspan class=\"p\"\u003e..\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"n\"\u003ea\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"bp\"\u003ecount\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"n\"\u003ea\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"n\"\u003ekey\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"kc\"\u003enil\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e线性查找在最坏情况：遍历了整个数组，但没有找到合适的元素。平均要遍历一半的元素性能为 \u003ccode\u003eO(n)\u003c/code\u003e，而二分查找的效率为 \u003ccode\u003eO(log n)\u003c/code\u003e，也就是说一个有 \u003ccode\u003e1,000,000\u003c/code\u003e 元素的数组只需要 \u003ccode\u003e20\u003c/code\u003e 步就可以找到想要的元素 \u003ccode\u003elog_2(1,000,000) = 19.9\u003c/code\u003e。\u003c/p\u003e\n\u003cp\u003e但是二分查找要求数组必须是排好序。\u003c/p\u003e\n\u003cp\u003e二分查找步骤：\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e将数组分为两半。\u003c/li\u003e\n\u003cli\u003e判断想要找的元素是在左边数组还是右边，这也是数组需要排好顺序的原因。\u003c/li\u003e\n\u003cli\u003e如果要的元素在左边，就将左边的数组分成更小的两部分，并判断要的元素在哪部分。\u003c/li\u003e\n\u003cli\u003e重复步骤直到找到想要的元素。如果数组不能进一步查分，就说明要找的元素不在数组中。\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003edivide-and-conquer\u003c/p\u003e\n\u003ch2 id=\"the-code\"\u003eThe code\u003c/h2\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003efunc binarySearch\u0026lt;T: Comparable\u0026gt;(_ a: [T], key: T, range: Range\u0026lt;Int\u0026gt;) -\u0026gt; Int? {\n    if range.lowerBound \u0026gt;= range.upperBound {\n        // If we get here, then the search key is not present in the array.\n        return nil\n\n    } else {\n        // Calculate where to split the array.\n        let midIndex = range.lowerBound + (range.upperBound - range.lowerBound) / 2\n\n        // Is the search key in the left half?\n        if a[midIndex] \u0026gt; key {\n            return binarySearch(a, key: key, range: range.lowerBound ..\u0026lt; midIndex)\n\n        // Is the search key in the right half?\n        // 这里 + 1 的原因是排除 midIndex 中间值\n        } else if a[midIndex] \u0026lt; key {\n            return binarySearch(a, key: key, range: midIndex + 1 ..\u0026lt; range.upperBound)\n\n        // If we get here, then we\u0026#39;ve found the search key!\n        } else {\n            return midIndex\n        }\n    }\n}\n\u003c/code\u003e\u003c/pre\u003e\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e// 19 numbers\nlet numbers = [2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37, 41, 43, 47, 53, 59, 61, 67]\n\n// 0 ..\u0026lt; numbers.count 覆盖所有范围\nbinarySearch(numbers, key: 43, range: 0 ..\u0026lt; numbers.count)  // gives 13\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e二分查找是将数组分为两个，但是我们不需要正真的创建两个新数组。取而代之，我们使用 Swift \u003ccode\u003eRange\u003c/code\u003e 对象跟踪这些拆分。左闭右开。upperBound 总是比最后一个元素的索引多一。\u003c/p\u003e","title":"二分查找 Binary Search"},{"content":"将一个数组从高到低或者从低到高排序。\n插入排序算法的工作原理：\n将若干数字放在一个数组里，数组是乱序的。 从数组中挑选一个数字，它是哪个并不重要，但是为了方便我们挑选数组头部的这个。 将这个数字插入到一个新的数组里。 从乱序数组里挑选下一个数字也将它放到新数组里。这个数字要么在第一个数字前或者后，所以这个两个数字是被排序的。 再次重从乱序数组里挑选下一个数字也将它放到新数组里，并将数字放在正确的位置。 一直如此进行直到乱序数组中没有数字。这时也将等到一个排序好的新数组。 自己的一个实现：\nlet array = [2, 1, 3, 8, 3, 5, 4] var newArray = [Int]() for (k, v) in array.enumerated() { for (nK, nV) in newArray.enumerated() { // 本次的数 小于 存在的数的第一个(nv) if v \u0026lt; nV { newArray.insert(v, at: nK) break } } // 没有插入成功 放在末尾 if newArray.count \u0026lt; k + 1 { newArray.append(v) } } In-place sort 上面的排序需要两个数组，一个原始的，一个排好顺序的。但是我们也可以 就地排序 无需创建一个额外的数组。我们只需要跟踪记录原始数组中哪里部分排好顺序了，哪一部分还没有排序。\n举例：[ 8, 3, 5, 4, 6 ] 使用 | 分割是否排好顺序的部分。\n// 开始时 | 在最前 [| 8, 3, 5, 4, 6 ] // 开始向左移动，左侧只有个 8 无论什么顺序都是正确的，右侧是未排序的部分 [ 8 | 3, 5, 4, 6 ] // 依次进行 将未排序的头部元素放在已排部分的正确位置 [ 3, 8 | 5, 4, 6 ] [ 3, 5, 8 | 4, 6 ] [ 3, 4, 5, 8 | 6 ] [ 3, 4, 5, 6, 8 |] 每次 | 移动，都对左侧进行排序，未排序的部分逐渐减少，排序部分增加。直到未排序部分为零。\nHow to insert 将未排序的头部元素放在已排部分的正确位置，如何这到这点的？\n// 从此状态开始。下个说的 4，我们需要将 4 插入到 [ 3, 5, 8 ] 这个已经排好的数组里 [ 3, 5, 8 | 4, 6 ] // 移动 |，这时我们注意 8 这个元素 [ 3, 5, 8, 4 | 6 ] ^ // 8 大于 4，所有 8 应该在 4 的右边，8 与 4 进行位置调换 [ 3, 5, 4, 8 | 6 ] \u0026lt;--\u0026gt; swapped // 将 4 与现在的前面的元素 5 进行比较，5 大于 4，所以 5 与 4 进行位置调换 [ 3, 4, 5, 8 | 6 ] \u0026lt;--\u0026gt; swapped // 3 小于 4 这个数，所以我们完成了对 4 的排序，这时从头到 |，是排好顺序的 [ 3, 4, 5, 8 | 6 ] 这就是对插入排序算法的内循环的描述。\nThe code func insertionSort(_ array: [Int]) -\u0026gt; [Int] { // 1 var a = array // 2 for x in 1..\u0026lt;a.count { var y = x // 3 while y \u0026gt; 0 \u0026amp;\u0026amp; a[y] \u0026lt; a[y - 1] { a.swapAt(y - 1, y) y -= 1 } } return a } 将 array 复制一个副本。因为我们无法直接修改参数中的 array，就想 Swift 自身的 sort()，insertionSort() 将返回一个排序顺序的副本数组。 两个循环在方法中。外层循环遍历轮到排序的元素，也就是从待排数组中挑选出头部的元素。x 索引为排好顺序的结尾索引同时也是待排数组的开头。记住，如何时间从开头到 x 永远都是排好顺序的，从 x 到最后的元素都是未排序的。 内层循环查询 x 索引位置的元素。这个元素可能小于之前排序顺序数组中的每一个元素。内层循环从后倒序遍历每一个已排序的元素，每次发现这个元素之前的元素比它大，则交互位置。当内层循环完成时，数组从开头到 x 将又是已排序的。 tip：外层循环从索引 1 开始，而不是 0。将第一个元素从堆移动到排序部分实际上并没有改变任何东西，所以我们不妨跳过它。\nNo more swaps 上面的插入排序可以正常的工作了。我们还可以通过移除调用 swap() 让程序更快一些。\n我们可以将所有需要换位置的元素向右移动一个位置，然后将新数字复制到正确的位置。\n[ 3, 5, 8, 4 | 6 ] remember 4 * [ 3, 5, 8, 8 | 6 ] shift 8 to the right ---\u0026gt; [ 3, 5, 5, 8 | 6 ] shift 5 to the right ---\u0026gt; [ 3, 4, 5, 8 | 6 ] copy 4 into place * func insertionSort(_ array: [Int]) -\u0026gt; [Int] { var a = array for x in 1..\u0026lt;a.count { var y = x let temp = a[y] // tip while y \u0026gt; 0 \u0026amp;\u0026amp; temp \u0026lt; a[y - 1] { // 1 a[y] = a[y - 1] y -= 1 } // 2 a[y] = temp } return a } 原本需要换位置的元素右移一个位置。 当内层结束时，y 的索引位置就是新元素的排序后的位置，将元素放在此。 tip：这里我自己写成了 while y \u0026gt; 0 \u0026amp;\u0026amp; a[y] \u0026lt; a[y - 1] 这是不对的，因为我要找的是 原本 的 a[y] 的位置，但是循环一次后 a[y] 将发生变化。\nMaking it generic func insertionSort\u0026lt;T\u0026gt;(_ array: [T], _ isOrderedBefore: (T, T) -\u0026gt; Bool) -\u0026gt; [T] { var a = array for x in 1..\u0026lt;a.count { var y = x let temp = a[y] while y \u0026gt; 0, isOrderedBefore(temp, a[y - 1]) { a[y] = a[y - 1] y -= 1 } a[y] = temp } return a } 通过闭包来执行大小比较。\nlet numbers = [ 10, -1, 3, 9, 2, 27, 8, 5, 1, 3, 0, 26 ] insertionSort(numbers, \u0026lt;) let objects = [ obj1, obj2, obj3, ... ] insertionSort(objects) { $0.priority \u0026lt; $1.priority } 插入排序是一种稳定 stable 的排序。当排序后具有相同排序键的元素保持相同的相对顺序时，排序是稳定的。这对于诸如数字或字符串之类的简单值并不重要，但在排序更复杂的对象时这很重要。在上面的示例中，如果两个对象具有相同的优先级，则无论其他属性的值如何，这两个对象都不会被交换。\nPerformance 最差的插入排序是 O(n^2) 因为俩个相近的循环嵌套。其他排序算法（如快速排序和合并排序）具有 O(n log n) 性能，在大输入时速度更快。\n插入排序实际上对于排序小数组非常快。某些标准库具有排序功能，当分区大小为 10 或更小时，可以从快速排序切换到插入排序。\n将 insertSort() 与 Swift 的内置 sort() 进行比较。在大约 100 元素左右的阵列上，速度差异很小。但是，随着输入变大，O(n^2) 快速开始执行比 O(n log n) 差很多，并且插入排序无法跟上。\n文章代码：GitHub - imzyf/data-structure-and-algorithm/003-Insertion Sort/。\nReferences raywenderlich/swift-algorithm-club/Insertion Sort ","permalink":"https://zyf.im/2018/11/24/insertion-sort/","summary":"\u003cp\u003e将一个数组从高到低或者从低到高排序。\u003c/p\u003e\n\u003cp\u003e插入排序算法的工作原理：\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e将若干数字放在一个数组里，数组是乱序的。\u003c/li\u003e\n\u003cli\u003e从数组中挑选一个数字，它是哪个并不重要，但是为了方便我们挑选数组头部的这个。\u003c/li\u003e\n\u003cli\u003e将这个数字插入到一个新的数组里。\u003c/li\u003e\n\u003cli\u003e从乱序数组里挑选下一个数字也将它放到新数组里。这个数字要么在第一个数字前或者后，所以这个两个数字是被排序的。\u003c/li\u003e\n\u003cli\u003e再次重从乱序数组里挑选下一个数字也将它放到新数组里，并将数字放在正确的位置。\u003c/li\u003e\n\u003cli\u003e一直如此进行直到乱序数组中没有数字。这时也将等到一个排序好的新数组。\u003c/li\u003e\n\u003c/ol\u003e\n\u003c!-- more --\u003e\n\u003cp\u003e自己的一个实现：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003elet array = [2, 1, 3, 8, 3, 5, 4]\n\nvar newArray = [Int]()\nfor (k, v) in array.enumerated() {\n    for (nK, nV) in newArray.enumerated() {\n        // 本次的数 小于 存在的数的第一个(nv)\n        if v \u0026lt; nV {\n            newArray.insert(v, at: nK)\n            break\n        }\n    }\n    // 没有插入成功 放在末尾\n    if newArray.count \u0026lt; k + 1 {\n        newArray.append(v)\n    }\n}\n\u003c/code\u003e\u003c/pre\u003e\u003ch2 id=\"in-place-sort\"\u003eIn-place sort\u003c/h2\u003e\n\u003cp\u003e上面的排序需要两个数组，一个原始的，一个排好顺序的。但是我们也可以 \u003cem\u003e就地排序\u003c/em\u003e 无需创建一个额外的数组。我们只需要跟踪记录原始数组中哪里部分排好顺序了，哪一部分还没有排序。\u003c/p\u003e","title":"插入排序 Insertion Sort"},{"content":"实现一个 队列，包括 enqueue、dequeue、peek。\nQueue 队列 核心也是 array，A queue gives you a FIFO or first-in, first-out order. 队列是：先进先出的。\npublic struct Queue\u0026lt;T\u0026gt; { fileprivate var array = [T]() } enqueue 进队，在数组尾部追加元素。\npublic mutating func enqueue(_ element: T) { array.append(element) } dequeue 出队，将首位的元素移除。因为首位元素移除后，其他元素依次向前移动，所以是 O(n)。\npublic var isEmpty: Bool { // 使用数组自身的方法，而不是 array.count \u0026gt; 0 return array.isEmpty } public mutating func dequeue() -\u0026gt; T? { // 使用定义的变量 if isEmpty { return nil } else { return array.removeLast() } } peek 查看队首元素。\n/// peek() 改为更有语义话的只读变量 public var front: T? { return array.first } 优化出队 在出队后不移动元素而是移动 起始索引，就像动的收银台而不是排队的人。\n/// 优化 队列 的出队 public struct OptimizedQueue\u0026lt;T\u0026gt; { /// 这里改为了可选型，为了可以清理无效的元素 fileprivate var array = [T?]() /// 起始索引 fileprivate var head = 0 public var count: Int { // 减去 起始索引 前面的数量 return array.count - head } public var isEmpty: Bool { // 根据实际数量判断 return count == 0 } // 保持不变 public mutating func enqueue(_ element: T) { array.append(element) } public mutating func dequeue() -\u0026gt; T? { guard head \u0026lt; array.count, let element = array[head] else { return nil } // 置空当前位置元素 array[head] = nil // 前移起始索引 head += 1 // 空索引的占用比例 let percentage = Double(head)/Double(array.count) // 50 0.25 都是魔法数字，主要是为了控制数组修剪的频率，可以自行调整 if array.count \u0026gt; 50 \u0026amp;\u0026amp; percentage \u0026gt; 0.25 { // 将起始空元素删除 array.removeFirst(head) // 重置 起始索引 head = 0 } return element } public var front: T? { if isEmpty { return nil } else { // 根据 起始索引进行 返回 return array[head] } } } 文章代码：GitHub - imzyf/data-structure-and-algorithm/002-Queue/。\nReferences raywenderlich/swift-algorithm-club/Queue ","permalink":"https://zyf.im/2018/11/22/queue-data-structure/","summary":"\u003cp\u003e实现一个 \u003ccode\u003e队列\u003c/code\u003e，包括 \u003ccode\u003eenqueue\u003c/code\u003e、\u003ccode\u003edequeue\u003c/code\u003e、\u003ccode\u003epeek\u003c/code\u003e。\u003c/p\u003e\n\u003ch2 id=\"queue\"\u003eQueue\u003c/h2\u003e\n\u003cp\u003e\u003ccode\u003e队列\u003c/code\u003e 核心也是 array，A queue gives you a FIFO or first-in, first-out order. 队列是：先进先出的。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-swift\" data-lang=\"swift\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003epublic\u003c/span\u003e \u003cspan class=\"kd\"\u003estruct\u003c/span\u003e \u003cspan class=\"nc\"\u003eQueue\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003efileprivate\u003c/span\u003e \u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nv\"\u003earray\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e]()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c!-- more --\u003e\n\u003ch2 id=\"enqueue\"\u003eenqueue\u003c/h2\u003e\n\u003cp\u003e进队，在数组尾部追加元素。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-swift\" data-lang=\"swift\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003epublic\u003c/span\u003e \u003cspan class=\"kr\"\u003emutating\u003c/span\u003e \u003cspan class=\"kd\"\u003efunc\u003c/span\u003e \u003cspan class=\"nf\"\u003eenqueue\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kc\"\u003e_\u003c/span\u003e \u003cspan class=\"n\"\u003eelement\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003earray\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eappend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eelement\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"dequeue\"\u003edequeue\u003c/h2\u003e\n\u003cp\u003e出队，将首位的元素移除。因为首位元素移除后，其他元素依次向前移动，所以是 O(n)。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-swift\" data-lang=\"swift\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003epublic\u003c/span\u003e \u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nv\"\u003eisEmpty\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nb\"\u003eBool\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e// 使用数组自身的方法，而不是 array.count \u0026gt; 0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003earray\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"bp\"\u003eisEmpty\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003epublic\u003c/span\u003e \u003cspan class=\"kr\"\u003emutating\u003c/span\u003e \u003cspan class=\"kd\"\u003efunc\u003c/span\u003e \u003cspan class=\"nf\"\u003edequeue\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e-\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e?\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e// 使用定义的变量\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"bp\"\u003eisEmpty\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"kc\"\u003enil\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"k\"\u003eelse\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003earray\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"bp\"\u003eremoveLast\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"peek\"\u003epeek\u003c/h2\u003e\n\u003cp\u003e查看队首元素。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-swift\" data-lang=\"swift\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e/// peek() 改为更有语义话的只读变量\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003epublic\u003c/span\u003e \u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nv\"\u003efront\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e?\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003earray\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"bp\"\u003efirst\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"优化出队\"\u003e优化出队\u003c/h2\u003e\n\u003cp\u003e在出队后不移动元素而是移动 \u003ccode\u003e起始索引\u003c/code\u003e，就像动的收银台而不是排队的人。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-swift\" data-lang=\"swift\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e/// 优化 队列 的出队\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003epublic\u003c/span\u003e \u003cspan class=\"kd\"\u003estruct\u003c/span\u003e \u003cspan class=\"nc\"\u003eOptimizedQueue\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e/// 这里改为了可选型，为了可以清理无效的元素\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003efileprivate\u003c/span\u003e \u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nv\"\u003earray\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e?]()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e/// 起始索引\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003efileprivate\u003c/span\u003e \u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nv\"\u003ehead\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kd\"\u003epublic\u003c/span\u003e \u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nv\"\u003ecount\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nb\"\u003eInt\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"c1\"\u003e// 减去 起始索引 前面的数量\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003earray\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"bp\"\u003ecount\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e \u003cspan class=\"n\"\u003ehead\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kd\"\u003epublic\u003c/span\u003e \u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nv\"\u003eisEmpty\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nb\"\u003eBool\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"c1\"\u003e// 根据实际数量判断\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"bp\"\u003ecount\u003c/span\u003e \u003cspan class=\"p\"\u003e==\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e// 保持不变\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kd\"\u003epublic\u003c/span\u003e \u003cspan class=\"kr\"\u003emutating\u003c/span\u003e \u003cspan class=\"kd\"\u003efunc\u003c/span\u003e \u003cspan class=\"nf\"\u003eenqueue\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kc\"\u003e_\u003c/span\u003e \u003cspan class=\"n\"\u003eelement\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"n\"\u003earray\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eappend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eelement\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kd\"\u003epublic\u003c/span\u003e \u003cspan class=\"kr\"\u003emutating\u003c/span\u003e \u003cspan class=\"kd\"\u003efunc\u003c/span\u003e \u003cspan class=\"nf\"\u003edequeue\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e-\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e?\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003eguard\u003c/span\u003e \u003cspan class=\"n\"\u003ehead\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"n\"\u003earray\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"bp\"\u003ecount\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"kd\"\u003elet\u003c/span\u003e \u003cspan class=\"nv\"\u003eelement\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003earray\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003ehead\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"k\"\u003eelse\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"kc\"\u003enil\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"c1\"\u003e// 置空当前位置元素\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"n\"\u003earray\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003ehead\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"kc\"\u003enil\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"c1\"\u003e// 前移起始索引\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"n\"\u003ehead\u003c/span\u003e \u003cspan class=\"o\"\u003e+=\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"c1\"\u003e// 空索引的占用比例\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"kd\"\u003elet\u003c/span\u003e \u003cspan class=\"nv\"\u003epercentage\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nb\"\u003eDouble\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ehead\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"nb\"\u003eDouble\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003earray\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"bp\"\u003ecount\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"c1\"\u003e// 50 0.25 都是魔法数字，主要是为了控制数组修剪的频率，可以自行调整\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"n\"\u003earray\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"bp\"\u003ecount\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"mi\"\u003e50\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan class=\"n\"\u003epercentage\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"mf\"\u003e0.25\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"c1\"\u003e// 将起始空元素删除\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"n\"\u003earray\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eremoveFirst\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ehead\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"c1\"\u003e// 重置 起始索引\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"n\"\u003ehead\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003eelement\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kd\"\u003epublic\u003c/span\u003e \u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nv\"\u003efront\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e?\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"bp\"\u003eisEmpty\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"kc\"\u003enil\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"k\"\u003eelse\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"c1\"\u003e// 根据 起始索引进行 返回\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003earray\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003ehead\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e文章代码：\u003ca href=\"https://github.com/imzyf/data-structure-and-algorithm/tree/master/002-Queue\"\u003eGitHub - imzyf/data-structure-and-algorithm/002-Queue/\u003c/a\u003e。\u003c/p\u003e","title":"队列 Queue Data Structure"},{"content":"加入 Swift Algorithm Club /\u0026lsquo;ælgə\u0026rsquo;rɪðəm/，回炉重新学习数据结构与算法。\n自己创建的项目：GitHub - imzyf/data-structure-and-algorithm。\n实现一个 栈 /stæk/，包含 push peek pop 与 Generics 泛型。\nstack 栈 非常像一个数组，它包括少量的方法。\npush 添加一个新元素到栈顶 pop 从栈顶移除一个元素 peek 查看栈顶的一个元素但是不 pop A stack gives you a LIFO or last-in first-out order. 栈是后进先出，队列是先进先出。\npublic struct Stack\u0026lt;Element\u0026gt; { fileprivate var array: [Element] = [] } push push 是在数组的尾部添加元素是以 O(1)，如果是在数组最前添加是 O(n) 这是昂贵的。\npublic mutating func push(_ element: Element) { array.append(element) } 因为使用的 struct，修改属性值的方法要加 mutating。\npop 想从一个空栈中弹出最后一个元素将返回 nil。\npublic mutating func pop(_ element: Element) { return array.popLast() } peek 与 pop 有点像，但是并没有移除栈顶的元素。\n/// peek 改为更加语义化的 top 只读变量 public var top: T? { return array.last } other 两个其他的常用属性，栈是否为空，栈中元素的个数。\npublic var isEmpty: Bool { return array.isEmpty } public var count: Int { return array.count } References Swift Algorithm Club: Swift Stack Data Structure \u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2018/11/22/stack-data-structure/","summary":"\u003cp\u003e加入 \u003ca href=\"https://github.com/raywenderlich/swift-algorithm-club\"\u003eSwift Algorithm Club\u003c/a\u003e /\u0026lsquo;ælgə\u0026rsquo;rɪðəm/，回炉重新学习数据结构与算法。\u003c/p\u003e\n\u003cp\u003e自己创建的项目：\u003ca href=\"https://github.com/imzyf/data-structure-and-algorithm\"\u003eGitHub - imzyf/data-structure-and-algorithm\u003c/a\u003e。\u003c/p\u003e\n\u003cp\u003e实现一个 \u003ccode\u003e栈\u003c/code\u003e /stæk/，包含 \u003ccode\u003epush\u003c/code\u003e \u003ccode\u003epeek\u003c/code\u003e \u003ccode\u003epop\u003c/code\u003e 与 \u003ccode\u003eGenerics\u003c/code\u003e 泛型。\u003c/p\u003e\n\u003c!-- more --\u003e\n\u003ch2 id=\"stack\"\u003estack\u003c/h2\u003e\n\u003cp\u003e\u003ccode\u003e栈\u003c/code\u003e 非常像一个数组，它包括少量的方法。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003epush 添加一个新元素到栈顶\u003c/li\u003e\n\u003cli\u003epop 从栈顶移除一个元素\u003c/li\u003e\n\u003cli\u003epeek 查看栈顶的一个元素但是不 pop\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eA stack gives you a LIFO or last-in first-out order. 栈是后进先出，队列是先进先出。\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003epublic struct Stack\u0026lt;Element\u0026gt; {\n    fileprivate var array: [Element] = []\n}\n\u003c/code\u003e\u003c/pre\u003e\u003ch2 id=\"push\"\u003epush\u003c/h2\u003e\n\u003cp\u003e\u003ccode\u003epush\u003c/code\u003e 是在数组的尾部添加元素是以 \u003ccode\u003eO(1)\u003c/code\u003e，如果是在数组最前添加是 \u003ccode\u003eO(n)\u003c/code\u003e 这是昂贵的。\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003epublic mutating func push(_ element: Element) {\n  array.append(element)\n}\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e因为使用的 \u003ccode\u003estruct\u003c/code\u003e，修改属性值的方法要加 \u003ccode\u003emutating\u003c/code\u003e。\u003c/p\u003e\n\u003ch2 id=\"pop\"\u003epop\u003c/h2\u003e\n\u003cp\u003e想从一个空栈中弹出最后一个元素将返回 \u003ccode\u003enil\u003c/code\u003e。\u003c/p\u003e","title":"栈 Stack Data Structure"},{"content":"在上传 App 到 App Store 后收到邮件，有 issues Too many symbol files。在之前看到 Your delivery was successful，此 issues 不影响发布，所以一直搁置了。\n今天决定彻底处理下。\n背景 先说 *.symbols 这文件是干嘛的，我现在（2018-10）对此的理解：\nsymbols 为符号表文件 符号表是内存地址与函数名、文件名、行号的映射表 \u0026lt;起始地址\u0026gt; \u0026lt;结束地址\u0026gt; \u0026lt;函数\u0026gt; [\u0026lt;文件名:行号\u0026gt;] 为什么要配置符号表？\n为了能快速并准确地定位用户 App 发生 Crash 的代码位置，使用符号表对 App 发生 Crash 的程序 堆栈 进行 解析 和 还原。\n项目情况 再说下项目情况，因为数字都是用了的是 Int，为防止 32 位设备发生越界情况（理由好像有点扯），所以项目端设置了设备限制 arm64，也就是 5s 之前的设备不可以安装。\n因为使用了三方库，但是三方库是支持 32 位设备的，所以生成了冗余的 symbols 文件。\n查询 symbols 文件的生成情况：Xcode Window -\u0026gt; Organizer 选择有问题的 archive，右击选择 Show in finder，命令行进入 *.app 中的 dSYMs 文件夹，执行 dwarfdump --uuid * 可以查询到是否生成了多余的文件。\n解决 在 Podfile 中：\npost_install do |installer| installer.pods_project.targets.each do |target| target.build_configurations.each do |config| config.build_settings[\u0026#39;ENABLE_BITCODE\u0026#39;] = \u0026#39;NO\u0026#39; config.build_settings[\u0026#39;ARCHS\u0026#39;] = \u0026#39;arm64\u0026#39; end end end 检查 在 info.plist 中：\n\u0026lt;key\u0026gt;UIRequiredDeviceCapabilities\u0026lt;/key\u0026gt; \u0026lt;array\u0026gt; \u0026lt;string\u0026gt;arm64\u0026lt;/string\u0026gt; \u0026lt;/array\u0026gt; 在 build Settings 搜索 valid architecture 中，填写 arm64\nReferences “Too many symbol files” after successfully submitting my apps “Too many symbol files” warnning when submitting app App 提交 iTunes Connect,\u0026ldquo;二进制无效\u0026quot;问题解决方案。 Bugly iOS 符号表配置 \u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2018/10/30/correct-too-many-symbol-files-issues/","summary":"\u003cp\u003e在上传 App 到 App Store 后收到邮件，有 issues \u003cstrong\u003eToo many symbol files\u003c/strong\u003e。在之前看到 \u003cem\u003eYour delivery was successful\u003c/em\u003e，此 issues 不影响发布，所以一直搁置了。\u003c/p\u003e\n\u003cp\u003e今天决定彻底处理下。\u003c/p\u003e\n\u003c!-- more --\u003e\n\u003ch2 id=\"背景\"\u003e背景\u003c/h2\u003e\n\u003cp\u003e先说 \u003ccode\u003e*.symbols\u003c/code\u003e 这文件是干嘛的，我现在（2018-10）对此的理解：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003esymbols 为符号表文件\u003c/li\u003e\n\u003cli\u003e符号表是内存地址与函数名、文件名、行号的映射表 \u003ccode\u003e\u0026lt;起始地址\u0026gt; \u0026lt;结束地址\u0026gt; \u0026lt;函数\u0026gt; [\u0026lt;文件名:行号\u0026gt;]\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e为什么要配置符号表？\u003c/p\u003e\n\u003cp\u003e为了能快速并准确地定位用户 App 发生 \u003cstrong\u003eCrash 的代码位置\u003c/strong\u003e，使用符号表对 App 发生 Crash 的程序 \u003cem\u003e堆栈\u003c/em\u003e 进行 \u003cem\u003e解析\u003c/em\u003e 和 \u003cem\u003e还原\u003c/em\u003e。\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"006tNbRwly1fwq98vcjeoj30i00383yh\" loading=\"lazy\" src=\"https://user-images.githubusercontent.com/9289792/80204521-9ea54a80-865b-11ea-9420-7d8a2d32e910.jpg\"\u003e\u003c/p\u003e\n\u003ch2 id=\"项目情况\"\u003e项目情况\u003c/h2\u003e\n\u003cp\u003e再说下项目情况，因为数字都是用了的是 Int，为防止 32 位设备发生越界情况（理由好像有点扯），所以项目端设置了设备限制 \u003ccode\u003earm64\u003c/code\u003e，也就是 5s 之前的设备不可以安装。\u003c/p\u003e\n\u003cp\u003e因为使用了三方库，但是三方库是支持 32 位设备的，所以生成了冗余的 symbols 文件。\u003c/p\u003e\n\u003cp\u003e查询 symbols 文件的生成情况：Xcode Window -\u0026gt; Organizer 选择有问题的 archive，右击选择 Show in finder，命令行进入 *.app 中的 dSYMs 文件夹，执行 \u003ccode\u003edwarfdump --uuid *\u003c/code\u003e 可以查询到是否生成了多余的文件。\u003c/p\u003e","title":"解决 Too many symbol files"},{"content":"如何在 MySQL 中选择合适的日期类型困扰了很久，varchar、int、timestamp、datetime 都有尝试过，近来有所感悟，做此总结。\n注：此总结考虑了 PHP 和 Laravel 框架的特点。\n使用 varchar varchar 存储日期时间的格式完全可以自己控制，月/日/年 还是 年-月-日 需求怎么说就怎么存，读取后展示是也不用在格式化。同时伏笔也就此埋下：日期时间格式没强制约束，总有一天字段里出现了与众不同的格式；要是日期时间会 变化 或作为 查询条件 或要进行 排序 时就又是一坑，还是要格式化标准格式再处理。可以说 varchar 应该是最差的选择了。\n使用 int 与 timestamp PHP time() 可以直接获取当前时间戳秒数，数据库字段要也是 int 一存就完事了，不会有格式问题，谁用什么样转什么样。但是在数据库工具中查看此字段时显示不够直观，范围时会不方便，这些在使用 timestamp 是会得到解决。\ntimestamp 是我一直迷惑的一个类型。我写了几个例子做测试：\n将 Laravel 项目设置为 CST 中国标准时间，MySQL 时区设置为 UTC，使用 now() 获取当前日期时间，比如：2018-5-25 11:00:00 存入 timestamp 类型的字段中，使用数据库工具查看字段结果为仍然为 2018-5-25 11:00:00。 继续上面的操作，项目中使用查询语句查询刚才的记录，结果显示为 2018-5-25 11:00:00，将项目时区从 CST 改为 UTC 后再次查询的结果仍然为 2018-5-25 11:00:00 没有变化。 继续上面的操作，将数据库的时区改为 +8:00，数据库工具、项目查询后的结果为 2018-5-25 19:00:00 发生了变化，修改项目为 CST 查询结果是 2018-5-25 19:00:00 和刚才一样也变化了。 这个测试说明了：\n项目的时区影响的是 PHP 的时区，影响的是 now() 产生的日期时间。 一个日期时间从项目存入数据库时，这个日期时间的时区是数据库设置的时区，和项目无关了。传入什么样子数据库存什么样子，更换了参照系，但是没有转换日期时间。 从数据库中读一个时间戳日期时间，这个是时间戳日期时间受到数据库的时区影响，和项目的时区无关。 我现在认识的结论：\n因为数据库时区不可能轻易改变，所以依靠数据库转换时区不可能。 没看出来时间戳对于处理时区对 datatime 有什么过人之处，若有就是时间戳将时间标准设置在了 UTC，占 4 字节更小些。 数据库时区和项目时区不一致可能会坑，如果一直不一致同时各个项目也一直错下去，没不会有察觉。 对应国际化项目，是不是应该将数据库和项目还有服务器都设置为 UTC？谁使用谁根据用户的时区进行处理。 使用 timestamp 与 datetime datetime 字段类型存储的时间不会随时间库时区发生变化，占 8 个字节，可存储 1000-01-01 00:00:00 到 9999-12-31 23:59:59。而时间戳只能存储 1970 年到 2038 年多，2038 还有 20 年怎么感觉马上就到了。\ndatetime 个人推荐的存储时间的格式。\n时区处理常见问题 北京用户在北京时间 2018-05-27 10:00:00 发布一个文章。\n如果在前端发布日期时间为 2018-05-27 10:00:00，在北京用户看来是没问题的，但是在美国的用户看来是奇怪的，因为美国没有到 2018-05-27 10:00:00 他们甚至还在 26 日。\n这时 1 min ago 这种展示形式就解决了这个问题，ago 是一种绝对的方式，在一个月之后再显示完整的日期时间，此时世界各地肯定已经度过了这个要展示日期时间，无论在哪国用户显示 2018-05-27 10:00:00 都不会奇怪了。\n同时也要注意，我们将各个时区都设置为 UTC 后，ago 的时间很好计算，但是在一个月之后日前时间完全显示，美国用户看北京用户的发布日期时间也应该是在中国看来的 2018-05-27 10:00:00，此发布日期不应该以美国用户为标准。这个问题的解决方法还在考虑，日期时间是存储多个字段来区分用于显示或比较，还是自行转换处理，需要实践测试。\nMySQL 查看、修改时区 查看时区 \u0026gt; select now(); # 或 select curtime(); \u0026gt; show variables like \u0026#34;%time_zone%\u0026#34;; # SELECT @@global.time_zone, @@session.time_zone; +------------------+--------+ | Variable_name | Value | +------------------+--------+ | system_time_zone | CST | | time_zone | SYSTEM | +------------------+--------+ # time_zone 说明 mysql 使用 system 的时区，system_time_zone 说明 system 使用 CST 时区 修改时区 \u0026gt; set global time_zone = \u0026#39;+8:00\u0026#39;; # 修改 mysql 全局时区为北京时间，即我们所在的东8区 \u0026gt; set time_zone = \u0026#39;+8:00\u0026#39;; # 修改当前会话时区 SET time_zone = \u0026#39;Asia/Shanghai\u0026#39; \u0026gt; flush privileges; # 立即生效 通过修改 my.cnf 配置文件来修改时区\n# vim /etc/my.cnf # 在[mysqld]区域中加上 default-time-zone=\u0026#39;+8:00\u0026#39; # /etc/init.d/mysqld restart # 重启 mysql 使新时区生效 最后的总结 全球化的项目应当考虑：\n项目、数据库、服务器都建议设置为 UTC 要考虑时分秒的字段用 datetime 类型，不用考虑时分秒的字段用 date created_at 和 updated_at 字段，考虑 Laravel 框架的特点使用 timestamp References mysql 修改时区的几种方法 \u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2018/05/25/select-the-appropriate-date-type-in-mysql/","summary":"\u003cp\u003e如何在 MySQL 中选择合适的日期类型困扰了很久，\u003ccode\u003evarchar\u003c/code\u003e、\u003ccode\u003eint\u003c/code\u003e、\u003ccode\u003etimestamp\u003c/code\u003e、\u003ccode\u003edatetime\u003c/code\u003e 都有尝试过，近来有所感悟，做此总结。\u003c/p\u003e\n\u003cp\u003e注：此总结考虑了 PHP 和 Laravel 框架的特点。\u003c/p\u003e\n\u003ch2 id=\"使用-varchar\"\u003e使用 varchar\u003c/h2\u003e\n\u003cp\u003e\u003ccode\u003evarchar\u003c/code\u003e 存储日期时间的格式完全可以自己控制，\u003ccode\u003e月/日/年\u003c/code\u003e 还是 \u003ccode\u003e年-月-日\u003c/code\u003e 需求怎么说就怎么存，读取后展示是也不用在格式化。同时伏笔也就此埋下：日期时间格式没强制约束，总有一天字段里出现了与众不同的格式；要是日期时间会 \u003cem\u003e变化\u003c/em\u003e 或作为 \u003cem\u003e查询条件\u003c/em\u003e 或要进行 \u003cem\u003e排序\u003c/em\u003e 时就又是一坑，还是要格式化标准格式再处理。可以说 \u003ccode\u003evarchar\u003c/code\u003e 应该是最差的选择了。\u003c/p\u003e\n\u003c!-- more --\u003e\n\u003ch2 id=\"使用-int-与-timestamp\"\u003e使用 int 与 timestamp\u003c/h2\u003e\n\u003cp\u003ePHP \u003ccode\u003etime()\u003c/code\u003e 可以直接获取当前时间戳秒数，数据库字段要也是 \u003ccode\u003eint\u003c/code\u003e 一存就完事了，不会有格式问题，谁用什么样转什么样。但是在数据库工具中查看此字段时显示不够直观，范围时会不方便，这些在使用 \u003ccode\u003etimestamp\u003c/code\u003e 是会得到解决。\u003c/p\u003e\n\u003cp\u003etimestamp 是我一直迷惑的一个类型。我写了几个例子做测试：\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e将 Laravel 项目设置为 \u003ccode\u003eCST\u003c/code\u003e 中国标准时间，MySQL 时区设置为 \u003ccode\u003eUTC\u003c/code\u003e，使用 \u003ccode\u003enow()\u003c/code\u003e 获取当前日期时间，比如：\u003ccode\u003e2018-5-25 11:00:00\u003c/code\u003e 存入 \u003ccode\u003etimestamp\u003c/code\u003e 类型的字段中，使用数据库工具查看字段结果为仍然为 \u003ccode\u003e2018-5-25 11:00:00\u003c/code\u003e。\u003c/li\u003e\n\u003cli\u003e继续上面的操作，项目中使用查询语句查询刚才的记录，结果显示为 \u003ccode\u003e2018-5-25 11:00:00\u003c/code\u003e，将项目时区从 \u003ccode\u003eCST\u003c/code\u003e 改为 \u003ccode\u003eUTC\u003c/code\u003e 后再次查询的结果仍然为 \u003ccode\u003e2018-5-25 11:00:00\u003c/code\u003e 没有变化。\u003c/li\u003e\n\u003cli\u003e继续上面的操作，将数据库的时区改为 \u003ccode\u003e+8:00\u003c/code\u003e，数据库工具、项目查询后的结果为 \u003ccode\u003e2018-5-25 19:00:00\u003c/code\u003e 发生了变化，修改项目为 \u003ccode\u003eCST\u003c/code\u003e 查询结果是 \u003ccode\u003e2018-5-25 19:00:00\u003c/code\u003e 和刚才一样也变化了。\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e这个测试说明了：\u003c/p\u003e","title":"在 MySQL 中选择合适的日期类型"},{"content":"禁止 IP 访问，其他域名跳转到 www.xxx.com：\nserver { listen 80; server_name 55.66.77.88; deny all; } server { listen 80; server_name www.xxx.com xxx.com; return 301 https://www.xxx.com$request_uri; } server { listen 443 ssl http2; #... if ($host = 55.66.77.88) { return 403; } if ($host != \u0026#39;www.xxx.com\u0026#39;){ rewrite ^/(.*)$ https://www.xxx.com/$1 permanent; } #... } \u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2018/05/20/nginx-ip-forbidden/","summary":"\u003cp\u003e禁止 IP 访问，其他域名跳转到 \u003ccode\u003ewww.xxx.com\u003c/code\u003e：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode class=\"language-conf\" data-lang=\"conf\"\u003eserver {\n    listen 80;\n    server_name 55.66.77.88;\n    deny all;\n}\n\nserver {\n    listen 80;\n    server_name www.xxx.com xxx.com;\n\n    return 301 https://www.xxx.com$request_uri;\n}\n\nserver {\n    listen 443 ssl http2;\n\n    #...\n\n    if ($host = 55.66.77.88) {\n        return 403;\n    }\n    if ($host != \u0026#39;www.xxx.com\u0026#39;){\n        rewrite ^/(.*)$ https://www.xxx.com/$1 permanent;\n    }\n\n    #...\n}\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e\u0026ndash; EOF \u0026ndash;\u003c/p\u003e","title":"NGINX 禁止 IP 访问"},{"content":" Laravel 教程 - Web 开发实战入门\n基础信息 Laravel 与 PHP Ruby on Rails 有以下原则：\n强调与注重敏捷开发； 约定高于配置（Convention over configuration）； DRY（Don\u0026rsquo;t repeat yourself）不要重复自己，提倡代码重用； 重视「编码愉悦性」。 如何正确阅读本书 随后你会有很多机会来学习它们。现在最重要的是保持『训练』的连贯性。\n编程是技能，不是知识，技能只有在不断刻意练习下才会有进步。\n开发环境布置 第一个应用 composer create-project laravel/laravel Laravel --prefer-dist \u0026#34;5.5.*\u0026#34; Git 与 GitHub 设置 push 的默认模式为 simple\ngit config --global push.default simple 部署上线 注册 Heroku 后：\nheroku login # 添加 SSH Key 到 Heroku 上 heroku keys:add # 创建配置文件来告诉 Heroku 应当使用什么命令来启动 Web 服务器 echo web: vendor/bin/heroku-php-apache2 public/ \u0026gt; Procfile git add -A git commit -m \u0026#34;Procfile for Heroku\u0026#34; # 创建一个新应用 heroku create # 对应用名称进行更改，保证未被其它人占用 heroku rename imzyf-laravel-essential # 声明应用是用 PHP 写的 heroku buildpacks:set heroku/php # 设置 APP key php artisan key:generate heroku config:set APP_KEY=base64:wuWj8Kicza6I9YxgWczviNVcueVN2RroqiUILreyNmA= # 部署上线 git push heroku master # 快速打开线上应用 heroku open # 输出生产环境上的日志 heroku logs 构建页面 静态页面 生成静态页面控制器：\nphp artisan make:controller StaticPagesController 页面优化 样式美化 # 升级 yarn brew upgrade yarn yarn install --no-bin-links yarn add cross-env 每次检测到 .scss 文件发生更改时，自动将其编译为 .css 文件：\nnpm run watch-poll Laravel 前端工作流 Laravel Mix 一款前端任务自动化管理工具。Mix 提供了简洁流畅的 API，让你能够为你的 Laravel 应用定义 Webpack 编译任务。\n_header.blade.php 为局部视图增加前缀下划线是『约定俗成』的做法。\n布局中的链接 \u0026lt;li\u0026gt;\u0026lt;a href=\u0026#34;/help\u0026#34;\u0026gt;帮助\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt; // 可以改写为 \u0026lt;li\u0026gt;\u0026lt;a href=\u0026#34;{{ route(\u0026#39;help\u0026#39;) }}\u0026#34;\u0026gt;帮助\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt; 路由中修改：\nRoute::get(\u0026#39;/help\u0026#39;, \u0026#39;StaticPagesController@help\u0026#39;)-\u0026gt;name(\u0026#39;help\u0026#39;); route('help') 将被渲染为 http://sample.test/help。\n用户模型 数据库迁移 当我们运行迁移时，up 方法会被调用 当我们回滚迁移时，down 方法会被调用 查看数据库表 php artisan migrate # 回滚 php artisan migrate:rollback 模型文件 创建模型命令指定命名空间，同时顺便创建数据库迁移使用 --migration 或 -m 选项\nphp artisan make:model Models/Article -m 『约定优于配置』（convention over configuration），也称作按约定编程，这是一种软件设计范式，旨在减少软件开发人员需做决定的数量，获得简单的好处，而又不失灵活性。如果所用工具的约定与你的期待相符，便可省去配置；反之，你可以配置来达到你所期待的方式。\n创建用户对象 php artisan tinker \u0026gt;\u0026gt;\u0026gt; App\\Models\\User::create([\u0026#39;name\u0026#39;=\u0026gt; \u0026#39;Aufree\u0026#39;, \u0026#39;email\u0026#39;=\u0026gt;\u0026#39;aufree@yousails.com\u0026#39;,\u0026#39;password\u0026#39;=\u0026gt;bcrypt(\u0026#39;password\u0026#39;)]) 用户注册 显示用户的信息 Laravel 遵从 RESTful 架构的设计原则，将数据看做一个资源，由 URI 来指定资源。\nRoute::resource(\u0026#39;users\u0026#39;, \u0026#39;UsersController\u0026#39;); 上面代码将等同于： Route::get(\u0026#39;/users\u0026#39;, \u0026#39;UsersController@index\u0026#39;)-\u0026gt;name(\u0026#39;users.index\u0026#39;); Route::get(\u0026#39;/users/{user}\u0026#39;, \u0026#39;UsersController@show\u0026#39;)-\u0026gt;name(\u0026#39;users.show\u0026#39;); Route::get(\u0026#39;/users/create\u0026#39;, \u0026#39;UsersController@create\u0026#39;)-\u0026gt;name(\u0026#39;users.create\u0026#39;); Route::post(\u0026#39;/users\u0026#39;, \u0026#39;UsersController@store\u0026#39;)-\u0026gt;name(\u0026#39;users.store\u0026#39;); Route::get(\u0026#39;/users/{user}/edit\u0026#39;, \u0026#39;UsersController@edit\u0026#39;)-\u0026gt;name(\u0026#39;users.edit\u0026#39;); Route::patch(\u0026#39;/users/{user}\u0026#39;, \u0026#39;UsersController@update\u0026#39;)-\u0026gt;name(\u0026#39;users.update\u0026#39;); Route::delete(\u0026#39;/users/{user}\u0026#39;, \u0026#39;UsersController@destroy\u0026#39;)-\u0026gt;name(\u0026#39;users.destroy\u0026#39;); 注册表单 全局辅助函数 old 来帮助我们在 Blade 模板中显示旧输入数据\n{{ old(\u0026#39;name\u0026#39;) }} 用户数据验证 为了安全考虑，会让我们提供一个 token（令牌）来防止我们的应用受到 CSRF（跨站请求伪造）的攻击。\n{{ csrf_field() }} 会被转换为：\n\u0026lt;input type=\u0026#34;hidden\u0026#34; name=\u0026#34;_token\u0026#34; value=\u0026#34;fhcxqT67dNowMoWsAHGGPJOAWJn8x5R5ctSwZrAq\u0026#34;\u0026gt; 注册失败错误消息 composer require \u0026#34;overtrue/laravel-lang:~3.0\u0026#34; config/app.php 修改：\n\u0026#39;locale\u0026#39; =\u0026gt; \u0026#39;zh-CN\u0026#39;, 注册成功 临时保存用户数据的方法 - 会话（Session），并附带支持多种会话后端驱动，可通过统一的 API 进行使用。\nsession()-\u0026gt;flash(\u0026#39;success\u0026#39;, \u0026#39;欢迎，您将在这里开启一段新的旅程~\u0026#39;); session()-\u0026gt;get(\u0026#39;success\u0026#39;) 会话管理 用户登录 Auth::check() 方法用于判断当前用户是否已登录，已登录返回 true，未登录返回 false。\n记住我 Auth::attempt() 方法可接收两个参数，第一个参数为需要进行用户身份认证的数组，第二个参数为是否为用户开启『记住我』功能的布尔值。\n用户 CRUD 更新用户 \u0026lt;form method=\u0026#34;POST\u0026#34; action=\u0026#34;{{ route(\u0026#39;users.update\u0026#39;, $user-\u0026gt;id )}}\u0026#34;\u0026gt; // 将转为： \u0026lt;form method=\u0026#34;POST\u0026#34; action=\u0026#34;http://sample.test/users/1\u0026#34;\u0026gt; 权限系统 在 Laravel 中可以使用 授权策略 (Policy) 来对用户的操作权限进行验证，在用户未经授权进行操作时将返回 403 禁止访问的异常。\nredirect() 实例提供了一个 intended 方法，该方法可将页面重定向到上一次请求尝试访问的页面上，并接收一个默认跳转地址参数，当上一次请求记录为空时，跳转到默认地址上。\nreturn redirect()-\u0026gt;intended(route(\u0026#39;users.show\u0026#39;, [Auth::user()])); 列出所有用户 假数据的生成分为两个阶段：\n对要生成假数据的模型指定字段进行赋值 - 『模型工厂』 批量生成假数据模型 - 『数据填充』 数据库的重置和填充操作：\nphp artisan migrate:refresh --seed 邮件发送 账户激活 用户注册成功后，自动生成激活令牌 将激活令牌以链接的形式附带在注册邮件里面，并将邮件发送到用户的注册邮箱上 用户点击注册链接跳到指定路由，路由收到激活令牌参数后映射给相关控制器动作处理 控制器拿到激活令牌并进行验证，验证通过后对该用户进行激活，并将其激活状态设置为已激活 用户激活成功，自动登录 使用 log 邮件驱动的方式来调试邮件发送功能，这么做的好处是邮件并不会真正被发送出去，而是会出现在 storage/logs/laravel.log 文件中：\nMAIL_DRIVER=log 在生产环境中发送邮件 QQ 邮箱的账号设置里开启 POP3 和 SMTP 服务。\nMAIL_DRIVER=smtp MAIL_HOST=smtp.qq.com MAIL_PORT=25 MAIL_USERNAME=xxxxxxxxxxxxxx@qq.com MAIL_PASSWORD=xxxxxxxxx // 密码是我们第一步拿到的授权码 MAIL_ENCRYPTION=tls MAIL_FROM_ADDRESS=xxxxxxxxxxxxxx@qq.com MAIL_FROM_NAME=SampleApp 微博 CRUD 显示微博 diffForHumans() 该方法的作用是将日期进行友好化处理：\n\u0026gt;\u0026gt;\u0026gt; $created_at-\u0026gt;diffForHumans() =\u0026gt; \u0026#34;17 years ago\u0026#34; ","permalink":"https://zyf.im/2018/05/09/laravel-essential-training-reading-notes/","summary":"\u003cblockquote\u003e\n\u003cp\u003e\u003ca href=\"https://laravel-china.org/courses?rf=10678\"\u003eLaravel 教程 - Web 开发实战入门\u003c/a\u003e\u003c/p\u003e\u003c/blockquote\u003e\n\u003ch2 id=\"基础信息\"\u003e基础信息\u003c/h2\u003e\n\u003ch3 id=\"laravel-与-php\"\u003eLaravel 与 PHP\u003c/h3\u003e\n\u003cp\u003e\u003ccode\u003eRuby on Rails\u003c/code\u003e 有以下原则：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e强调与注重敏捷开发；\u003c/li\u003e\n\u003cli\u003e约定高于配置（Convention over configuration）；\u003c/li\u003e\n\u003cli\u003eDRY（Don\u0026rsquo;t repeat yourself）不要重复自己，提倡代码重用；\u003c/li\u003e\n\u003cli\u003e重视「编码愉悦性」。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"如何正确阅读本书\"\u003e如何正确阅读本书\u003c/h3\u003e\n\u003cp\u003e随后你会有很多机会来学习它们。现在最重要的是保持『训练』的连贯性。\u003c/p\u003e\n\u003cp\u003e编程是技能，不是知识，技能只有在不断刻意练习下才会有进步。\u003c/p\u003e\n\u003ch2 id=\"开发环境布置\"\u003e开发环境布置\u003c/h2\u003e\n\u003ch3 id=\"第一个应用\"\u003e第一个应用\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ecomposer create-project laravel/laravel Laravel --prefer-dist \u003cspan class=\"s2\"\u003e\u0026#34;5.5.*\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"git-与-github\"\u003eGit 与 GitHub\u003c/h3\u003e\n\u003cp\u003e设置 push 的默认模式为 simple\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit config --global push.default simple\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"部署上线\"\u003e部署上线\u003c/h3\u003e\n\u003cp\u003e注册 Heroku 后：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eheroku login\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# 添加 SSH Key 到 Heroku 上\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eheroku keys:add\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# 创建配置文件来告诉 Heroku 应当使用什么命令来启动 Web 服务器\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eecho\u003c/span\u003e web: vendor/bin/heroku-php-apache2 public/ \u0026gt; Procfile\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit add -A\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit commit -m \u003cspan class=\"s2\"\u003e\u0026#34;Procfile for Heroku\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# 创建一个新应用\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eheroku create\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# 对应用名称进行更改，保证未被其它人占用\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eheroku rename imzyf-laravel-essential\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# 声明应用是用 PHP 写的\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eheroku buildpacks:set heroku/php\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# 设置 APP key\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ephp artisan key:generate\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eheroku config:set \u003cspan class=\"nv\"\u003eAPP_KEY\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003ebase64:wuWj8Kicza6I9YxgWczviNVcueVN2RroqiUILreyNmA\u003cspan class=\"o\"\u003e=\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# 部署上线\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit push heroku master\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# 快速打开线上应用\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eheroku open\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# 输出生产环境上的日志\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eheroku logs\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"构建页面\"\u003e构建页面\u003c/h2\u003e\n\u003ch3 id=\"静态页面\"\u003e静态页面\u003c/h3\u003e\n\u003cp\u003e生成静态页面控制器：\u003c/p\u003e","title":"L01 Web 开发实战入门"},{"content":"又回到 PHP Web 开发，使用 Laravel 框架，重读《Modern PHP》。\nPHP 正在重生。\n特性 命名空间 声明命名空间：\n\u0026lt;?php namespace Oreilly\\ModernPHP; 导入和别名：\n\u0026lt;?php use Symfony\\Component\\HttpFoundation\\Response as Res; $r = new Res(\u0026#39;Oops\u0026#39;, 400); $r-\u0026gt;send(); PHP 5.6 开始可以导入函数和常量：\n\u0026lt;?php use func Namespace\\functionName; use constant Namespace\\CONST_NAME; functionName(); echo CONST_NAME; 使用接口 接口是两个 PHP 对象之间的契约，其目的不是让一个对象依赖另一个对象的身份，而是依赖另一个对象的能力。\n使用接口编写更加灵活，能委托别人实现细节。\n性状 trait 性状是类的部分实现，可以混入一个或者多个现有的 PHP 类中。性状有两个作用：表明类可以做什么（像是接口）；提供模块化实现（像是类）。\n如果想让两个无关的 PHP 类具有类似的行为，应该怎么呢？性状就是为了解决这种问题而诞生的。性状能把模块化的实现方式注入多个无关的类中。而且性状还能促进代码的重用。\n这与创建一个接口，两个无关的类实现这个接口的优势在于：不用写相同的实现代码，符合 DRY 原则。\nPHP 解释器在编译时会把性状复制粘贴到类的定义体中，但是不会处理这个操作引入的不兼容问题。如果性状假定类中有特定的属性和方法（在性状中没有定义），要确保相应的类中有对应的属性和方法。\n生成器 Generator 是 PHP 5.5.0 引入的功能。生成器是简单的迭代器，仅此而已。\nPHP 生成器不要求类实现 Iterator 接口，从而减轻了类的负担。生成器会根据需求计算并产生要迭代的值。这对应该的性能有重大影响。假如标准的 PHP 迭代器经常在内存中执行迭代操作，这要预先计算出数据集，性能低；此时我们可以使用生成器，即时计算并产出后续值，不占用宝贵的内存资源。\nPHP 生成器不能满足所有迭代操作的需求，因为如果不查询，生成器永远不知道下一个要迭代的值是什么，在生成器中无法后退和快进。生成器还是一次性，无法多次迭代同一个生成器。不过，如果需要，可以重建或克隆生成器。\nPHP 生成器是 PHP 函数，只不过要在函数中一次或者多次使用 yield 关键字。生成器从不返回值，值产出值。\nfunction myGenerator() { yield \u0026#39;value1\u0026#39;; yield \u0026#39;value2\u0026#39;; yield \u0026#39;value3\u0026#39;; } foreach (myGenerator() as $yieldedValue) { echo $yieldedValue, PHP_EOL; } value1 value2 value3 使用生成器处理 CSV：\nfunction getRows($file) { $handle = fopen($file, \u0026#39;rb\u0026#39;); if ($handle === false) { throw new Exception(); } while (feof($handle) === false) { yield fgetcsv($handle); } fclose($handle); } foreach (getRows(\u0026#39;data.csv\u0026#39;) as $row) { print_r($row); } 闭包 理论上讲，闭包和匿名函数是不同的概念。不过，PHP 将其视作相同的概念。\n$closure = function ($name) { return sprintf(\u0026#39;Hello %s\u0026#39;, $name); } echo $closure(\u0026#34;Josh\u0026#34;); 我们之所以能调用 $closure 变量，是因为这个变量的值是一个闭包，而且闭包对象实现了 __invoke() 魔术方法。只要变量名后有()，PHP 就会查找并调用 __invoke() 方法。\nPHP 闭包常被当做函数和方法的回调使用。\n$numbersPlusOne = array_map(function ($number) { return $number + 1; }, [1,2,3]); print_r($numbersPlusOne); // [2,3,4] 在有闭包之前，只能单独创建具名函数，然后使用名称引用那个函数：\n$numbersPlusOne = array_map(\u0026#39;incrementNumber\u0026#39;, [1,2,3]); // 如果只需要使用一次回调，没必要单独定义。把闭包当成回调使用，写出的代码更整洁、更清晰。 使用 use 关键字附加闭包状态：\nfunction enclosePerson($name) { return function ($doCommand) use ($name) { return sprintf(\u0026#39;%s, %s\u0026#39;, $name, $doCommand); } } // 把字符串 Clay 封装到闭包里 $clay = enclosePerson(\u0026#39;Clay\u0026#39;); // 传入参数，调用闭包 echo $clay(\u0026#39;get me sweet tea!\u0026#39;); // \u0026#34;Clay, get me sweet tea!\u0026#34; 具名函数 enclosePerson() 有个名为 $name 的参数，这个函数返回一个闭包对象，而且这个闭包封装了 $name 参数。即便返回的闭包对象跳出了 enclosePerson() 函数的作用域，它也会记住 $name 参数的值，因为 $name 变量仍在闭包中。\nPHP 闭包是对象。闭包对象的默认状态没什么用，不过有一个 __invoke() 魔术方法和 bindTo() 方法。\nZend OPcache 字节码缓存能存储预先编译好的 PHP 字节码。这意味着，请求 PHP 脚本时，PHP 解释器不用每次都读取、解析和编译 PHP 代码。\n内置的 HTTP 服务器 启动这个服务器：\nphp -S localhost:4000 // 让 PHP Web 服务器监听所有接口 php -S 0.0.0.0:4000 标准 PSR 是什么 PHP Standards Recommendation.\nPSR-1 基本的代码风格 PSR-2 严格的代码风格 PSR-3 日志记录器接口 PSR-4 自动加载 组件 查找组件 Awesome PHP Packagist 良好实践 流 流式数据的种类各异，每种类型需要独特的协议，以便读写数据。称这些协议为流封装协议。\n开始通信 读取数据 写入数据 结束通信 指定协议和目标的方法是使用流标识符：\n\u0026lt;scheme\u0026gt;://\u0026lt;target\u0026gt;\n使用 HTTP 流封装协议创建了一个与 Flickr API 通信的 PHP 流：\n\u0026lt;?php $json = file_get_contents( \u0026#39;http://api.flickr.com/services/feeds/photos_public.gne?format=json\u0026#39; ); 不要误以为这是普通的网页 URL，file_get_contents() 函数的字符串参数其实是一个流标识符。http 协议会让 PHP 使用 HTTP 流封装协议。在这个参数中，http 之后是流的目标。很多 PHP 开发者不知道普通的 URL 其实是 PHP 流封装协议标识的伪装。\n我们使用 file_get_contents() fopen() fwrite() 和 fclose() 函数读写文件系统。因为 PHP 默认使用的流封装协议是 file://，使用我们很少认为这些函数使用的是 PHP 流。\n隐式使用 file:// 流封装协议：\n$handle = fopen(\u0026#39;/etc/hosts\u0026#39;, \u0026#39;rb\u0026#39;); while (feof($handle) !== ture) { echo fgets($handle); } fclose($handle); 显示使用 file:// 流封装协议：\n... $handle = fopen(\u0026#39;file://etc/hosts\u0026#39;, \u0026#39;rb\u0026#39;); ... 我们通常会省略 file:// 封装协议，这是 PHP 使用的默认值。\n编写命令行脚本的 PHP 开发者会感激 php:// 流封装协议。这个流封装协议的作用是与 PHP 脚本的标准输入、标准输出和标准错误文件描描述符通信。\nphp://stdin 只读 PHP 流，其中的数据来自标准输入。例如，接收命令行传入脚本的信息。\nphp://stdout 把数据写入当前的缓冲区。这个流只能写，无法读或寻址。\nphp://memory 从系统内存中读取数据，或者把数据写入系统内存。缺点是，可用内存是有限的。使用 php://temp 流更安全。\nphp://temp 和 php://memory 类似，不过没有可以内存时，PHP 会把数据写入临时文件。\n错误和异常 提到了 Monolog 记录日志。\n调优 内存 一共能分配给 PHP 多少内存？\nLinode 2GB 的 sever 留 512MB 给 PHP。\n单个 PHP 进程平均消耗多少内存？\n使用 top 命令查看。一般 PHP 进程消耗 5 ~ 20MB 内存。\n能负担的起多少个 PHP-FPM 进程？\n假设 PHP 分配了 512MB 内存，每个 PHP 平均消耗 15MB 内存，从而确定能负担的起 34 个进程。\n压力测试工具：\nab - Apache HTTP server benchmarking tool Siege Zend OPcache opcache.memory_consumption = 64 # 为操作码缓存分配的内存量（单位 MB）。 opcache.interned_strings_buffer = 16 # 用来存储驻留字符串的内存量（单位 MB，默认 4MB）。 opcache.max_accelerated_file = 4000 # 操作码缓存中最多能存储多少个 PHP 脚本。这个值一定比 PHP 应用中的文件数量大。 opcache.validate_timestamps = 1 # 为 1 时，一段时间后 PHP 会检查 PHP 脚本的内容是否变化。检查的时间间隔由 revalidate_freq 指定。 # 开发环境设为 1，在生成环境中为 0。 opcache.revalidate_freq = 0 # 设置多久检查一次 PHP 脚本的内容是否有变化。 opcache.fast_shutdown = 1 # 这么设置能让操作码使用更快的停机步骤，把对象析构和内存释放交给 Zend Engine 的内存管理器完成。 文件上传 file_uploads = 1 upload_max_filesize = 10M max_file_uploads = 3 如果需要上传非常大的文件，还要调整 nginx 虚拟主机配置中的 client_max_body_size 设置。\n会话处理 session.save_handler = \u0026#39;memcached\u0026#39; session.save_path = \u0026#39;127.0.0.2:11211\u0026#39; 缓冲输出 output_buffering = 4096 implicit_flush = false 确保使用的值是 4（32 位系统）或者 8（64 位系统）的倍数。\n真实路径缓存 realpath cache，PHP 会缓存应用使用的文件路径，这样每次包含或者导入文件时就无需不断搜索包含路径了。\nrealpath_cache_size = 64k 部署 提到了 Capistrano 待研究。\n测试 PHPUnit Xdebug 使用 Travis CI 持续测试 分析 XHProf 较新的 PHP 应用分析器 XHGUI New Relic Blackfire HHVM 和 Hack Hip-Hop Virtual Machine.\nHack 是一门建立在 PHP 之上的编程语音，引入了静态类型，新的数据结构和额外的接口，同时还能向后兼容现有的动态类型 PHP 代码。\n动态类型和静态类型，二者之间的区别在于何时检查 PHP 类型。动态类型在运行时检查类型，而静态类型在编译时检查类型。\n\u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2018/05/08/modern-php-reading-notes/","summary":"\u003cp\u003e又回到 PHP Web 开发，使用 Laravel 框架，重读《Modern PHP》。\u003c/p\u003e\n\u003c!-- more --\u003e\n\u003cblockquote\u003e\n\u003cp\u003ePHP 正在重生。\u003c/p\u003e\u003c/blockquote\u003e\n\u003ch2 id=\"特性\"\u003e特性\u003c/h2\u003e\n\u003ch3 id=\"命名空间\"\u003e命名空间\u003c/h3\u003e\n\u003cp\u003e声明命名空间：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e\u0026lt;?\u003c/span\u003e\u003cspan class=\"nx\"\u003ephp\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003enamespace\u003c/span\u003e \u003cspan class=\"nx\"\u003eOreilly\\ModernPHP\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e导入和别名：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e\u0026lt;?\u003c/span\u003e\u003cspan class=\"nx\"\u003ephp\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003euse\u003c/span\u003e \u003cspan class=\"nx\"\u003eSymfony\\Component\\HttpFoundation\\Response\u003c/span\u003e \u003cspan class=\"k\"\u003eas\u003c/span\u003e \u003cspan class=\"nx\"\u003eRes\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$r\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003eRes\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;Oops\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e400\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$r\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"na\"\u003esend\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003ePHP 5.6 开始可以导入函数和常量：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e\u0026lt;?\u003c/span\u003e\u003cspan class=\"nx\"\u003ephp\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003euse\u003c/span\u003e \u003cspan class=\"nx\"\u003efunc\u003c/span\u003e \u003cspan class=\"k\"\u003eNamespace\u003c/span\u003e\u003cspan class=\"nx\"\u003e\\functionName\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003euse\u003c/span\u003e \u003cspan class=\"nx\"\u003econstant\u003c/span\u003e \u003cspan class=\"k\"\u003eNamespace\u003c/span\u003e\u003cspan class=\"nx\"\u003e\\CONST_NAME\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003efunctionName\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eecho\u003c/span\u003e \u003cspan class=\"nx\"\u003eCONST_NAME\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"使用接口\"\u003e使用接口\u003c/h3\u003e\n\u003cp\u003e接口是两个 PHP 对象之间的契约，其目的不是让一个对象依赖另一个对象的身份，而是依赖另一个对象的能力。\u003c/p\u003e\n\u003cp\u003e使用接口编写更加灵活，能委托别人实现细节。\u003c/p\u003e\n\u003ch3 id=\"性状-trait\"\u003e性状 trait\u003c/h3\u003e\n\u003cp\u003e性状是类的部分实现，可以混入一个或者多个现有的 PHP 类中。性状有两个作用：表明类可以做什么（像是接口）；提供模块化实现（像是类）。\u003c/p\u003e\n\u003cp\u003e如果想让两个无关的 PHP 类具有类似的行为，应该怎么呢？性状就是为了解决这种问题而诞生的。性状能把模块化的实现方式注入多个无关的类中。而且性状还能促进代码的重用。\u003c/p\u003e\n\u003cp\u003e这与创建一个接口，两个无关的类实现这个接口的优势在于：不用写相同的实现代码，符合 DRY 原则。\u003c/p\u003e\n\u003cp\u003ePHP 解释器在编译时会把性状复制粘贴到类的定义体中，但是不会处理这个操作引入的不兼容问题。如果性状假定类中有特定的属性和方法（在性状中没有定义），要确保相应的类中有对应的属性和方法。\u003c/p\u003e\n\u003ch3 id=\"生成器\"\u003e生成器\u003c/h3\u003e\n\u003cp\u003eGenerator 是 PHP 5.5.0 引入的功能。生成器是简单的迭代器，仅此而已。\u003c/p\u003e\n\u003cp\u003ePHP 生成器不要求类实现 Iterator 接口，从而减轻了类的负担。生成器会根据需求计算并产生要迭代的值。这对应该的性能有重大影响。假如标准的 PHP 迭代器经常在内存中执行迭代操作，这要预先计算出数据集，性能低；此时我们可以使用生成器，即时计算并产出后续值，不占用宝贵的内存资源。\u003c/p\u003e\n\u003cp\u003ePHP 生成器不能满足所有迭代操作的需求，因为如果不查询，生成器永远不知道下一个要迭代的值是什么，在生成器中无法后退和快进。生成器还是一次性，无法多次迭代同一个生成器。不过，如果需要，可以重建或克隆生成器。\u003c/p\u003e\n\u003cp\u003ePHP 生成器是 PHP 函数，只不过要在函数中一次或者多次使用 yield 关键字。生成器从不返回值，值产出值。\u003c/p\u003e","title":"【Modern PHP】笔记"},{"content":"Getting Started Two shortcuts to get started\nShift+Shift(⇧+⇧) helps you find anything within your project. Alt+Enter(Option+Enter) provides instant access to contextual actions and quick fixes relevant to the selected code. Getting started with PHP in PhpStorm\n还有个 One Dark theme 但是 Material Theme UI 已经包含这个主题。\n配置：\nPreferences \u0026gt; Appearance \u0026amp; Behavior \u0026gt; Appearance 下，右侧配置：Theme: Darcula，勾选 User custom font: .AppleSystemUIFont Size: 18。\nPreferences \u0026gt; Editor \u0026gt; Font 下，右侧配置：Font: Menlo Size: 18 Line spacing: 1.2。\nPreferences \u0026gt; Editor \u0026gt; Color Scheme 下，右侧配置：Seheme: Atom One Dark(Material) 点击右侧的三个点 Duplicate 复制一份。\nPreferences \u0026gt; Editor \u0026gt; Color Scheme \u0026gt; General 下，右侧配置：\nEditor \u0026gt; Gutter background，右侧 Background: 292929（设置行号背景色） Editor \u0026gt; Vertical Scrollar \u0026gt; Thumb 与 Thumb while scrolling，右侧 Background: 305599C0（设置垂直滑块色） Editor \u0026gt; Text \u0026gt; Default text，右侧 Background: 292929（设置面板背景色） 快捷键 command + , 打开设置 command + shift + t 在代码和对应单元测试间用快速切换 command + e 查看最近编辑文件列表 shift + shift 搜索文件/类/操作/设置 command + option + t 快速包裹 if/foreach/while 等控制结构 command + option + +/- 快速展开/折叠 option + F12 呼出内置终端 command + shift + a \u0026ldquo;Quick Lists\u0026rdquo; 创建高频操作集合 Refactor control + t 重构代码优化 command + n 代码生成 option + return 语法修复、代码优化等建议 option + 鼠标选择 同时修改多处相同内容 Git command + k Commit Changes command + shift + k Push Changes control + v 查看版本操作菜单 Debug command + F8 # 添加断点 control + d # 启动调试 F8 # Step Over F7 # Step Into shift + F8 # Step Out 技巧 围绕选择输入 设置选择了一个词后，再按单引号或双引号，将选中的单词用引号括起来。\nPreferences 中搜索 Surround Selection on typing quote or brace 将其勾选（Editor \u0026gt; General \u0026gt; Smart Keys 下）。\n关闭文档提示 鼠标放在方法上会出现文档提示，想关闭。\nPreferences 中搜索 Show quick documentation on mouse move 取消勾选（Editor \u0026gt; Code Editing 下）。\n使用 PHP-CS-Fixer The PHP Coding Standards Fixer (PHP CS Fixer) tool fixes your code to follow standards.\n工作环境：MacBook。\n打开 PhpStorm Preferences \u0026gt; Tools \u0026gt; External Tools 添加：\nProgram: /usr/local/bin/php-cs-fixer Arguments: --verbose fix \u0026quot;$FileDir$/$FileName$\u0026quot; --dry-run --rules=@PSR1,@PSR2,@Symfony（Note that previous verions of PHP-CS-Fixer used \u0026ndash;levels instead of \u0026ndash;rules. 未找到） Working directory: $ProjectFileDir$ 我取消勾选了 Open console for tool output，可以不输出日志信息 为了方便使用，保存文件时就可以格式化，设置快捷键 Preferences \u0026gt; Keymap \u0026gt; Macros：\n设置 php-cs-fix 单独的快捷键 Preferences \u0026gt; Keymap \u0026gt; External Tools：\n关闭不常用的插件 Preferences \u0026gt; Plugins \u0026gt; Installed 向下滚动，Bundled 中有不少预装但不常用的可以禁掉。\n遇到过的一些问题 文件类型错误 一个文件被新建后，明明扩展名没有错，但是却没有语法高亮，删除文件后也不解决问题。\n解决办法：Editor \u0026gt; File Types 找 Text 将里面涉及的文件删除掉。\nphpstorm 文件类型错误 Undefined function XXX 出现 PHP 的原生方法未定义的警告。\n解决方法：File \u0026gt; Invalidate Caches / Restart\nTypo: In word XXX 提示单词拼写错误，但是其中没有问题，比如全拼的名字。\n解决方法：option + enter -\u0026gt; Save to dictionary\nSpellchecking | jetbrains warning: Multiple definitions exists for class I resolved this by going to Preferences-\u0026gt; Languages \u0026amp; Frameworks-\u0026gt; PHP; and then under Include path, remove the conflicting path. (In my case a package reference in the vendor directory to a package I was developing inside my Laravel project)\nReferences 打造漂亮的 PhpStorm 界面 大牛们的 PHPstorm 使用技巧和建议 Use PHP-CS-Fixer in PHPStorm ","permalink":"https://zyf.im/2018/05/05/phpstorm-using-experience/","summary":"\u003ch2 id=\"getting-started\"\u003eGetting Started\u003c/h2\u003e\n\u003cp\u003e\u003ca href=\"https://www.jetbrains.com/phpstorm/getting-started/episode-1/\"\u003eTwo shortcuts to get started\u003c/a\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003eShift+Shift(⇧+⇧)\u003c/code\u003e helps you find anything within your project.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eAlt+Enter(Option+Enter)\u003c/code\u003e provides instant access to contextual actions and quick fixes relevant to the selected code.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eGetting started with PHP in PhpStorm\u003c/p\u003e\n\u003cp\u003e还有个 \u003ccode\u003eOne Dark theme\u003c/code\u003e 但是 \u003ccode\u003eMaterial Theme UI\u003c/code\u003e 已经包含这个主题。\u003c/p\u003e\n\u003cp\u003e配置：\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003ePreferences \u0026gt; Appearance \u0026amp; Behavior \u0026gt; Appearance\u003c/code\u003e 下，右侧配置：\u003ccode\u003eTheme: Darcula\u003c/code\u003e，勾选 \u003ccode\u003eUser custom font: .AppleSystemUIFont\u003c/code\u003e \u003ccode\u003eSize: 18\u003c/code\u003e。\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003ePreferences \u0026gt; Editor \u0026gt; Font\u003c/code\u003e 下，右侧配置：\u003ccode\u003eFont: Menlo\u003c/code\u003e \u003ccode\u003eSize: 18\u003c/code\u003e \u003ccode\u003eLine spacing: 1.2\u003c/code\u003e。\u003c/p\u003e","title":"PhpStorm 使用经验"},{"content":"一直在使用 Let\u0026rsquo;s Encrypt 的免费 SSL 证书，但是一直没做笔记。今天看到 Let\u0026rsquo;s Encrypt 支持了通配符证书（Wildcard Certificates），也就是说二级子域名和主域名可以共用一个证书。\n申请证书 # 下载证书申请客户端 cd /opt git clone https://github.com/certbot/certbot cd /opt/certbot # 注意通配符并不包含主域名，所以要配置两个 ./certbot-auto certonly -d *.zyf.im -d zyf.im --manual --preferred-challenges dns --server \u0026#34;https://acme-v02.api.letsencrypt.org/directory\u0026#34; -preferred-challenges dns 使用 DNS 方式校验域名所有权，所以会遇到：\n------------------------------------------------------------------------------- Please deploy a DNS TXT record under the name _acme-challenge.zyf.im with the following value: YZ2unEViXH8nYZ2unEViIbW52LhIEViIbW52Lh Before continuing, verify the record is deployed. ------------------------------------------------------------------------------- Press Enter to Continue 要在域名服务商那里将 _acme-challenge.zyf.im 配置 DNS TXT 记录，从而校验域名所有权。\n使用 host -t txt _acme-challenge.zyf.im 验证记录是否已经生效，如果看到对应的值，按 Enter 继续。\n... - Congratulations! ... 生成的证书会放置在 /etc/letsencrypt/live/，可以使用 openssl 验证一下：\nopenssl x509 -in /etc/letsencrypt/live/zyf.im/cert.pem -noout -text | grep zyf.im Subject: CN=zyf.im DNS:*.zyf.im DNS:zyf.im 配置证书 server { listen 80; server_name zyf.im design.zyf.im; return 301 https://$host$request_uri; } server { listen 443 ssl http2; listen [::]:443 ssl http2; server_name design.zyf.im; root /project/imzyf; index index.html index.htm; ssl_certificate /etc/letsencrypt/live/zyf.im/fullchain.pem; ssl_certificate_key /etc/letsencrypt/live/zyf.im/privkey.pem; ssl_session_timeout 1d; # Diffie-Hellman parameter for DHE ciphersuites, recommended 2048 bits ssl_dhparam /etc/nginx/ssl/dhparam.pem;:q! # intermediate configuration. tweak to your needs. ssl_protocols TLSv1 TLSv1.1 TLSv1.2; ssl_ciphers \u0026#39;...\u0026#39;; ssl_prefer_server_ciphers on; # HSTS (ngx_http_headers_module is required) (15768000 seconds = 6 months) add_header Strict-Transport-Security max-age=15768000; # OCSP Stapling --- # fetch OCSP records from URL in ssl_certificate and cache them ssl_stapling on; ssl_stapling_verify on; } 证书续期 证书的有效期只有三个月，所以要利用 crontab 定时续期：\n30 2 * * 1 /opt/certbot/certbot-auto renew \u0026gt;\u0026gt; /var/log/le-renew.log 2\u0026gt;\u0026amp;1 35 2 * * 1 /etc/init.d/nginx reload References 配置使用免费的通配符证书 | laisky 我是如何将网站全站启用 Https 的？| freehao123 \u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2018/04/26/lets-encrypt-wildcard-certificates/","summary":"\u003cp\u003e一直在使用 \u003ca href=\"https://letsencrypt.org/\"\u003eLet\u0026rsquo;s Encrypt\u003c/a\u003e 的免费 SSL 证书，但是一直没做笔记。今天看到 Let\u0026rsquo;s Encrypt 支持了通配符证书（Wildcard Certificates），也就是说二级子域名和主域名可以共用一个证书。\u003c/p\u003e\n\u003c!-- more --\u003e\n\u003ch2 id=\"申请证书\"\u003e申请证书\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# 下载证书申请客户端\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003ecd\u003c/span\u003e /opt\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit clone https://github.com/certbot/certbot\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003ecd\u003c/span\u003e /opt/certbot\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# 注意通配符并不包含主域名，所以要配置两个\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e./certbot-auto certonly -d *.zyf.im -d zyf.im --manual --preferred-challenges dns --server \u003cspan class=\"s2\"\u003e\u0026#34;https://acme-v02.api.letsencrypt.org/directory\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003ccode\u003e-preferred-challenges dns\u003c/code\u003e 使用 DNS 方式校验域名所有权，所以会遇到：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e-------------------------------------------------------------------------------\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ePlease deploy a DNS TXT record under the name\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e_acme-challenge.zyf.im with the following value:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eYZ2unEViXH8nYZ2unEViIbW52LhIEViIbW52Lh\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eBefore continuing, verify the record is deployed.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e-------------------------------------------------------------------------------\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ePress Enter to Continue\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e要在域名服务商那里将 \u003ccode\u003e_acme-challenge.zyf.im\u003c/code\u003e 配置 DNS TXT 记录，从而校验域名所有权。\u003c/p\u003e","title":"使用 Let's Encrypt 通配符证书"},{"content":"今日遇到 Docker 中的项目绕过了宿主机 UFW 的配置，可以被任意 IP 访问，甚是奇怪。查找资料发现：\n如果你在 Linux 使用 Docker，很可能你的系统防火墙降级为 Uncomplicated Firewall (UFW)。如果是这样的话，你有一点可能不知道，Docker 和 UFW 的组合带来了一些安全问题。为什么呢？因为 Docker 实际上绕过了 UFW 并直接修改了 iptables，所以一个容器可以绑定一个端口。这就意味着，所有你设置的 UFW 规则都将在 Docker 容器中失效。\n如何修复：\nsudo vi /etc/default/docker # add the following line: DOCKER_OPTS=\u0026#34;--iptables=false\u0026#34; Restart the docker daemon:\nsudo systemctl restart docker # or docker/etc/init.d/docker restart When a problem arises, it only takes a bit of digging to discover the solution was already there, waiting for you to make it so. Don\u0026rsquo;t let this issue with Docker stop you from using this incredible technology.\n相关阅读：\nUbuntu 下使用 UFW 管理防火墙服务 | Yifans_Z docker and ufw serious problems | moby 无视系统防火墙的 docker | binss References How to fix the Docker and UFW security flaw | techrepublic \u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2018/04/24/docker-ufw-not-work/","summary":"\u003cp\u003e今日遇到 Docker 中的项目绕过了宿主机 UFW 的配置，可以被任意 IP 访问，甚是奇怪。查找资料发现：\u003c/p\u003e\n\u003cp\u003e如果你在 Linux 使用 Docker，很可能你的系统防火墙降级为 Uncomplicated Firewall (UFW)。如果是这样的话，你有一点可能不知道，Docker 和 UFW 的组合带来了一些安全问题。为什么呢？因为 Docker 实际上绕过了 UFW 并直接修改了 iptables，所以一个容器可以绑定一个端口。这就意味着，所有你设置的 UFW 规则都将在 Docker 容器中失效。\u003c/p\u003e\n\u003cp\u003e如何修复：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo vi /etc/default/docker\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# add the following line:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003eDOCKER_OPTS\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;--iptables=false\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eRestart the docker daemon:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo systemctl restart docker\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# or\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edocker/etc/init.d/docker restart\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cblockquote\u003e\n\u003cp\u003eWhen a problem arises, it only takes a bit of digging to discover the solution was already there, waiting for you to make it so. Don\u0026rsquo;t let this issue with Docker stop you from using this incredible technology.\u003c/p\u003e","title":"Docker UFW 失效"},{"content":"因为自己是直接从 Swift 进入的 iOS 开发，Swift 与 Objective-C 初始化的对比就不多提了。感觉上 Swift 初始化的方式像 Java，自己也只这样套着 Java 去理解，但也发现了不相同的地方。\n初始化顺序 class Blog: NSObject { let param: String override init() { } } 这里有条错误 error: property 'self.param' not initialized at implicitly generated super.init call 说明：param 参数没有在隐式生成 super.init 调用之前完成初始化。\nSwift 中并不是不调用 super.init 而是为了方便开发者由编译器完成了这一步，但是要求调用 super.init 之前要完成成员变量的初始化。\nclass Blog: NSObject { let param: String override init() { param = \u0026#34;swift init\u0026#34; } } 对于需要修改父类中成员变量值，我们需要在调用 super.init 之后再进行修改：\nclass Cat { var name: String init() { name = \u0026#34;cat\u0026#34; } } class Tiger: Cat { let power: Int override init() { power = 10 super.init() name = \u0026#34;tiger\u0026#34; } } Swift 中类的初始化顺序：\n初始化自己的成员变量，必须 调用父类初始化方法，如无需第三步，则这一步也可省略 修改父类成员变量，可选 补充说明：\nlet 声明的常量是可以在初始化方法中进行赋值，Swift 中的 init 方法只会被调用一次，这与 Objective-C 不同 即使成员变量是可选类型，如：let power: Int? 仍然是需要进行初始化的，var power: Int? 则可以不用 关键字 例子 1：\nclass CustomView: UIView { let param: Int override init() { // error 1 self.param = 1 super.init() // error 2 } } // error 3 将父类从 NSObject 修改为 UIView，竟然收到 3 条错误：\ninitializer does not override a designated initializer from its superclass must call a designated initializer of the superclass \u0026lsquo;UIView\u0026rsquo; \u0026lsquo;required\u0026rsquo; initializer \u0026lsquo;init(coder:)\u0026rsquo; must be provided by subclass of \u0026lsquo;UIView\u0026rsquo; 例子 2：\nclass CustomView: UIView { convenience init(param: Int, frame: CGRect) { super.init(frame: frame) // error } required init?(coder aDecoder: NSCoder) { fatalError(\u0026#34;init(coder:) has not been implemented\u0026#34;) } } error：\nconvenience initializer for \u0026lsquo;CustomView\u0026rsquo; must delegate (with \u0026lsquo;self.init\u0026rsquo;) rather than chaining to a superclass 上面俩个例子出现了 3 个关键字：designated、convenience 和 required。\ndesignated Swift 定义了两种类初始化器类型，用来保证所有成员属性能够获得一个初始化值。即 designated initializers [i\u0026rsquo;niʃəlaizə] 和 convenience initializers。\nDesignated initializers are the primary initializers for a class. A designated initializer fully initializes all properties introduced by that class and calls an appropriate superclass initializer to continue the initialization process up the superclass chain.\nprimary initializers：designated initializers 是一个类的主初始化器，理论上来说是一个类初始化的必经之路。（不同的初始化路径可能调用不同的 designated initializers） fully initializes all properties：必须在 designated initializers 中完成所有成员属性的初始化 calls an appropriate superclass initializer：需要调用合适的父类初始化器完成初始化，不能随意调用 在 Swift 中 designated initializers 的写法和一般的初始化方法无异，Sample 1 中，我们试图去 override init，可以理解为我们就是在 override 一个 designated initializers，然后我们收到了错误 Initializer does not override a designated initializer from its superclass，可见我们并没有找到合适的 designated initializers，我们进入父类 UIView，可以看到下面两个初始化方法：\npublic init(frame: CGRect) public init?(coder aDecoder: NSCoder) 原来，这两个类才是父类的 designated initializers，那我们改改试试：\nclass CustomView: UIView { let param: Int override init(frame: CGRect) { // error 1 fixed self.param = 1 super.init(frame: frame) // error 2 fixed } } // error 3 error 1 fixed 由此可见：我们去 override 一个不是 designated initializers 的初始化器时，是不满足定义中所说的 primary initializers，这就可能导致这个初始化器不被执行，成员变量没有初始化，这样创建的“半成品”实例可能存在一些不安全的情况。\n第二条 fully initializes all properties，这点我们并没有犯错，因为我们已经初始化了 CustomView 类中引入的 param 变量。\n第三条 calls an appropriate superclass initializer 很明显就对应了 error 2，我们 override init(frame:)，那我们就必须调用对应的父类初始化方法。\nerror 3 提示我们 init(coder:) 是一个 \u0026lsquo;required\u0026rsquo; initializer，子类必须提供\nrequired Write the required modifier before the definition of a class initializer to indicate that every subclass of the class must implement that initializer.\n通过添加 required 关键字强制子类对某个初始化方法进行重写。\nclass CustomView: UIView { let param: Int override init(frame: CGRect) { // error 1 fixed self.param = 1 super.init(frame: frame) // error 2 fixed } required init?(coder aDecoder: NSCoder) { fatalError(\u0026#34;init(coder:) has not been implemented\u0026#34;) } } // error 3 fixed error 3 fixed 插入的这个方法很奇怪，方法体里直接写 fatalError(\u0026quot;init(coder:) has not been implemented\u0026quot;)，那岂不是走到这里就 crash 了？\ndesignated initializers 是一个类的主初始化器，理论上来说是一个类初始化的必经之路（不同的初始化路径可能调用不同的 designated initializers），其实，这个 init(coder:) 与 init(frame: frame) 就是不同的初始化路径，当我们使用 xib 方式初始化一个 view 时，就会走到 init(coder:)。此时，如果我们没有真正实现这个方法，就会出现 fatal crash。\n完整初始方案：\nclass CustomView: UIView { let param: Int override init(frame: CGRect) { self.param = 1 super.init(frame: frame) } required init?(coder aDecoder: NSCoder) { self.param = 1 super.init(coder: aDecoder) } } convenience Convenience initializers are secondary, supporting initializers for a class. You can define a convenience initializer to call a designated initializer from the same class as the convenience initializer with some of the designated initializer’s parameters set to default values. You can also define a convenience initializer to create an instance of that class for a specific use case or input value type.\nconvenience initializers 是对类初始化方法的补充，用于为类提供一些快捷的初始化方法，可以不创建这类方法，但如果创建了，就需要遵循原则：call a designated initializer from the same class，也就是说要调用该类自己的 designated initializer，那么我们应该 override init(frame:) ，然后修改为：\nclass CustomView: UIView { convenience init(param: Int, frame: CGRect) { self.init(frame: frame) // error fixed } override init(frame: CGRect) { super.init(frame: frame) } required init?(coder aDecoder: NSCoder) { fatalError(\u0026#34;init(coder:) has not been implemented\u0026#34;) } } 然后对成员变量 param 赋值：\nclass CustomView: UIView { var param: Int convenience init(param: Int, frame: CGRect) { self.param = param // error self.init(frame: frame) } override init(frame: CGRect) { super.init(frame: frame) // error } required init?(coder aDecoder: NSCoder) { fatalError(\u0026#34;init(coder:) has not been implemented\u0026#34;) } } 来个两个错误：\nUse of \u0026lsquo;self\u0026rsquo; in property access \u0026lsquo;param\u0026rsquo; before self.init initializes self Property \u0026lsquo;self.param\u0026rsquo; not initialized at super.init call 第二个错误我们清楚，是需要在调用 super.init 之前初始化本类成员属性。\n第一个错误其实，这是 Swift 编译器提供的安全检查，文档原文如下：\nA convenience initializer must delegate to another initializer before assigning a value to any property (including properties defined by the same class). If it doesn’t, the new value the convenience initializer assigns will be overwritten by its own class’s designated initializer.\n原来 Swift 防止 convenience initializers 中赋值之后又被该类自己的 designated initializer 覆盖而做了检查。因此，正确的方式应该是调用该类的其他初始化方法之后再修改属性值，最终修改如下：\nclass CustomView: UIView { var param: Int convenience init(param: Int, frame: CGRect) { self.init(frame: frame) self.param = param // error fixed } override init(frame: CGRect) { self.param = 0 // error fixed super.init(frame: frame) } required init?(coder aDecoder: NSCoder) { self.param = 0 super.init(coder: aDecoder) } } 小结 子类中初始化方法必须覆盖全部初始化路径，以保证对象完全初始化 子类中 designated initializer 必须调用父类中对应的 designated initializer，以保证父类也能完成初始化 子类中如果重写父类中 convenience initializer 所需要的全部 init 方法，就可以在子类中使用父类的 convenience initializer 了 子类如果没有定义任何 designated initializer，则默认继承所有父类的 designated initializer 及 convenience initializer 子类中必须实现的 designated initializer，可以通过添加 required 关键字强制子类重写其实现，以保证依赖该方法的 convenience initializer 始终可以使用 convenience initializer 必须调用自身类中的其他初始化方法，并在最终必须调用一个 designated initializer 在构造器完成初始化之前, 不能调用任何实例方法，或读取任何实例属性的值，self 本身也不能被引用 可失败初始化器 可失败初始化器 Failable Initializers ，即可能返回 nil 的初始化方法。\nA failable initializer creates an optional value of the type it initializes. You write return nil within a failable initializer to indicate a point at which initialization failure can be triggered.\n就是将初始化返回值变成 optional value，并在不满足初始化条件的地方 return nil。通过调用处判断是否有值即可知道是否初始化成功。\nclass Product { let name: String init?(name: String) { if name.isEmpty { return nil } self.name = name } } class CartItem: Product { let quantity: Int init?(name: String, quantity: Int) { if quantity \u0026lt; 1 { return nil } self.quantity = quantity super.init(name: name) } } CartItem 类的初始化方法先对传入参数 quantity 的值进行判断，小于 1 则为无效参数，然后 return nil（初始化失败），大于或等于 1 则继续调用父类 Product 的初始化方法，再次判断传入参数 name，为空则 return nil（初始化失败），否则继续初始化。\n总的来说，可失败初始化器的设定，是在保证安全性的基础上提供了逻辑上更清晰的初始化方式。Failable Initializers 所有的结果都将是 T? 类型，通过 Optional Binding 方式，我们就能知道初始化是否成功，并安全地使用它们了。\nReferences 从 Swift 初始化说起 The Swift Programming Language (Swift 4.1) Initialization Swift 类构造器的使用 \u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2018/03/31/swift-init/","summary":"\u003cp\u003e因为自己是直接从 Swift 进入的 iOS 开发，Swift 与 Objective-C 初始化的对比就不多提了。感觉上 Swift 初始化的方式像 Java，自己也只这样套着 Java 去理解，但也发现了不相同的地方。\u003c/p\u003e\n\u003ch2 id=\"初始化顺序\"\u003e初始化顺序\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-swift\" data-lang=\"swift\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eBlog\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eNSObject\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kd\"\u003elet\u003c/span\u003e \u003cspan class=\"nv\"\u003eparam\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nb\"\u003eString\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kr\"\u003eoverride\u003c/span\u003e \u003cspan class=\"kd\"\u003einit\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e这里有条错误 \u003ccode\u003eerror: property 'self.param' not initialized at implicitly generated super.init call\u003c/code\u003e 说明：\u003ccode\u003eparam\u003c/code\u003e 参数没有在隐式生成 \u003ccode\u003esuper.init\u003c/code\u003e 调用之前完成初始化。\u003c/p\u003e\n\u003cp\u003eSwift 中并不是不调用 \u003ccode\u003esuper.init\u003c/code\u003e 而是为了方便开发者由编译器完成了这一步，但是要求调用 \u003ccode\u003esuper.init\u003c/code\u003e 之前要完成成员变量的初始化。\u003c/p\u003e\n\u003c!-- more --\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-swift\" data-lang=\"swift\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eBlog\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eNSObject\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kd\"\u003elet\u003c/span\u003e \u003cspan class=\"nv\"\u003eparam\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nb\"\u003eString\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kr\"\u003eoverride\u003c/span\u003e \u003cspan class=\"kd\"\u003einit\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"n\"\u003eparam\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;swift init\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e对于需要修改父类中成员变量值，我们需要在调用 \u003ccode\u003esuper.init\u003c/code\u003e 之后再进行修改：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-swift\" data-lang=\"swift\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eCat\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nv\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nb\"\u003eString\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kd\"\u003einit\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"n\"\u003ename\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;cat\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eTiger\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eCat\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kd\"\u003elet\u003c/span\u003e \u003cspan class=\"nv\"\u003epower\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nb\"\u003eInt\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kr\"\u003eoverride\u003c/span\u003e \u003cspan class=\"kd\"\u003einit\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"n\"\u003epower\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e10\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"kc\"\u003esuper\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"kd\"\u003einit\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"n\"\u003ename\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;tiger\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eSwift 中类的初始化顺序：\u003c/p\u003e","title":"Swift 初始化"},{"content":"在 iOS 7 Apple 在 UIViewController 中引入了 topLayoutGuide 和 bottomLayoutGuide 属性来描述没有被覆盖(status bar, navigation bar, toolbar, tab bar, etc.)屏幕的区域。在 iOS 11 中，Apple 已经弃用了这些属性，并引入了 safe area。Apple 建议我们不要在 safe area 操作，在 iOS 11 中，当在 iOS App 中定位视图时，你必须使用新的 safe area API。\nUIView 在 iOS 11 UIViewController topLayoutGuide 和 bottomLayoutGuide 属性已经被替换成了新的 UIView 中的 safe area：\n@available(iOS 11.0, *) open var safeAreaInsets: UIEdgeInsets { get } @available(iOS 11.0, *) open var safeAreaLayoutGuide: UILayoutGuide { get } safeAreaInsets 属性意味着屏幕可以覆盖从四个方向，而不仅仅是顶部和底部。当被 iPhone X 呈现时，我们就明白了为什么我们需要左右 insets。\niPhone 8 vs iPhone X safe area (portrait orientation)\niPhone 8 vs iPhone X safe area (landscape orientation)\niPhone X 在 portrait orientation 有 top 和 bottom 的 safe area，在 landscape orientation 有 left right 和 bottom。\n让我们来看一个例子。在 ViewController 的 View 的顶部和底部添加了两个带有文本标签和固定高度的 custom subviews，并附加 attached 到视图的边缘 edges。\nSubviews are attached to the view\u0026rsquo;s edges\n正如所看到的，subviews 内容与顶部的 notch 和底部的 home indicator 指示器重叠 overlapped。为了正确地定位 subviews，我们可以使用手动布局将它们附加到 safe area：\ntopSubview.frame.origin.x = view.safeAreaInsets.left topSubview.frame.origin.y = view.safeAreaInsets.top topSubview.frame.size.width = view.bounds.width - view.safeAreaInsets.left - view.safeAreaInsets.right topSubview.frame.size.height = 300 或者使用 Auto Layout：\nbottomSubview.leftAnchor.constraint(equalTo: view.safeAreaLayoutGuide.leftAnchor).isActive = true bottomSubview.rightAnchor.constraint(equalTo: view.safeAreaLayoutGuide.rightAnchor).isActive = true bottomSubview.bottomAnchor.constraint(equalTo: view.safeAreaLayoutGuide.bottomAnchor).isActive = true bottomSubview.heightAnchor.constraint(equalToConstant: 300).isActive = true Subviews are attached to the superview safe area\n上面看起来好很多。此外可以在 subview subclass 添加 subviews content 到 safe area。\n// 方法一： label.translatesAutoresizingMaskIntoConstraints = false label.leftAnchor.constraint(equalTo: superview.safeAreaLayoutGuide.leftAnchor).isActive = true label.topAnchor.constraint(equalTo: superview.safeAreaLayoutGuide.topAnchor).isActive = true label.bottomAnchor.constraint(equalTo: superview.safeAreaLayoutGuide.bottomAnchor).isActive = true label.rightAnchor.constraint(equalTo: superview.safeAreaLayoutGuide.rightAnchor).isActive = true // 或者方法二： override func layoutSubviews() { super.layoutSubviews() var labelFrame = bounds labelFrame.origin.x += safeAreaInsets.left labelFrame.origin.y += safeAreaInsets.top labelFrame.size.width -= safeAreaInsets.left + safeAreaInsets.right labelFrame.size.height -= safeAreaInsets.top + safeAreaInsets.bottom label.frame = labelFrame } Subviews are attached to the view\u0026rsquo;s edges. Labels are attached to the superview safe area.\n在 subviews 层次结构 hierarchy 的任何地方都可以将 view 添加到 safe area。\nUIViewController 在 iOS 11 UIViewController 有了一个新属性：\n@available(iOS 11.0, *) open var additionalSafeAreaInsets: UIEdgeInsets 当 view controller subviews 覆盖嵌入的 child view controller views 时，将使用它。例如，Apple 在 UINavigationController 和 UITabBarController 中使用额外的 additional safe area insets，当这些条是半透明的。\nadditionalSafeAreaInsets 是对现有 safearea 的扩展附加。\n当你改变 additional safe area insets 或者 safe area insets 被系统改变，UIView 和 UIViewController 中的方法将被调用：\n// UIView @available(iOS 11.0, *) open func safeAreaInsetsDidChange() //UIViewController @available(iOS 11.0, *) open func viewSafeAreaInsetsDidChange() 需要注意的是，当状态栏隐藏时，可能会出现一个奇怪的问题：所有的 safe area insets 计算都是正确的，但导航栏会移动到顶部的 notch 下方。这是一个 bug，目前没有很好的修复方法，只能使用一些变通方法。\nSimulate iPhone X safe area Additional safe area insets 也可以用来测试你的 app 是如何支持 iPhone X，如果你不能在模拟器上测试你的 app，而且没有 iPhone X，那就很有用了。\n//portrait orientation, status bar is shown additionalSafeAreaInsets.top = 24.0 additionalSafeAreaInsets.bottom = 34.0 //portrait orientation, status bar is hidden additionalSafeAreaInsets.top = 44.0 additionalSafeAreaInsets.bottom = 34.0 //landscape orientation additionalSafeAreaInsets.left = 44.0 additionalSafeAreaInsets.bottom = 21.0 additionalSafeAreaInsets.right = 44.0 UIScrollView 在 iOS 11 中，UIScrollView 的 insets 调整行为有了重大变化。让我们添加一个带有文本标签的 scroll view 到 view controller 并将其附加到视图的边缘。\n你会发现 scroll view 的 insets 在顶部和底部会自动调整。在 iOS 7 及更高版本中，scroll view content insets 调整行为可以通过 UIViewController 的 automaticallyAdjustsScrollViewInsets 属性管理，但在 iOS 11 中，它被弃用并由新的 UIScrollView 的 contentInsetAdjustmentBehavior 属性替代：\n@available(iOS 11.0, *) public enum ContentInsetAdjustmentBehavior : Int { case automatic case scrollableAxes case never case always } @available(iOS 11.0, *) open var contentInsetAdjustmentBehavior: UIScrollView.ContentInsetAdjustmentBehavior Content Insets Adjustment Behavior never — scroll view content insets 永远不会被调整，很简单。\nscrollableAxes — 只为可滚动的轴调整 content insets。例如，当 scroll view content size height 大于 frame size height 或 alwaysBounceVertical 属性启用时，垂直轴是可滚动的。同样，当 content size width 大于 frame size width 或 alwaysBounceHorizontal 属性启用时，水平轴是可滚动的。\n例如，在横屏方向，如果水平轴不可滚动，只有底部 content inset 会被调整，左右 content insets 不会被调整。\nalways — 对所有可滚动和不可滚动的轴调整 scroll view content insets。\nautomatic — 默认值，也是最有趣的值。当以下条件为真时，它与 always 相同：\nscroll view 水平轴可滚动，垂直轴不可滚动 scroll view 是 view controller 视图的第一个子视图 view controller 是导航控制器或标签栏控制器的子视图 automaticallyAdjustsScrollViewInsets 启用 在所有其他情况下，automatic 与 scrollableAxes 相同。\nautomatic 行为是默认的，因为它具有向后兼容性 — 具有水平可滚动轴的 scroll views 在 iOS 10 和 iOS 11 中将具有相同的顶部和底部 insets。\nAdjusted Content Insets 在 iOS 11 中，UIScrollView 有了新的 adjustedContentInset 属性：\n@available(iOS 11.0, *) open var adjustedContentInset: UIEdgeInsets { get } contentInset 和 adjustedContentInset 有什么区别？让我们打印当 scroll view 被顶部的导航栏和底部的标签栏覆盖时的两个值：\n// iOS 10 print(\u0026#34;contentInset: \\(scrollView.contentInset)\u0026#34;) // output: contentInset: UIEdgeInsets(top: 64.0, left: 0.0, bottom: 49.0, right: 0.0) // iOS 11 print(\u0026#34;contentInset: \\(scrollView.contentInset)\u0026#34;) print(\u0026#34;adjustedContentInset: \\(scrollView.adjustedContentInset)\u0026#34;) // output: contentInset: UIEdgeInsets(top: 0.0, left: 0.0, bottom: 0.0, right: 0.0) // output: adjustedContentInset: UIEdgeInsets(top: 88.0, left: 0.0, bottom: 83.0, right: 0.0) 如果我们从四面添加 10 点到 contentInset 并再次打印两个值：\nscrollView.contentInset = UIEdgeInsets(top: 10, left: 10, bottom: 10, right: 10) // iOS 10 print(\u0026#34;contentInset: \\(scrollView.contentInset)\u0026#34;) // output: contentInset: UIEdgeInsets(top: 10.0, left: 10.0, bottom: 10.0, right: 10.0) // iOS 11 print(\u0026#34;contentInset: \\(scrollView.contentInset)\u0026#34;) print(\u0026#34;adjustedContentInset: \\(scrollView.adjustedContentInset)\u0026#34;) // output: contentInset: UIEdgeInsets(top: 10.0, left: 10.0, bottom: 10.0, right: 10.0) // output: adjustedContentInset: UIEdgeInsets(top: 98.0, left: 10.0, bottom: 93.0, right: 10.0) 我们会看到在 iOS 11 中，实际的 scroll view content insets 可以从 adjustedContentInset 属性读取，而不是从 contentInset 属性读取。这意味着当你的应用同时支持 iOS 10 和 iOS 11 时，应该为调整 content insets 创建不同的逻辑。\n如果你更改 contentInset 或者 content insets 被系统调整，UIScrollView 和 UIScrollViewDelegate 中的适当方法将被调用：\n// UIScrollView @available(iOS 11.0, *) open func adjustedContentInsetDidChange() // UIScrollViewDelegate @available(iOS 11.0, *) optional func scrollViewDidChangeAdjustedContentInset(_ scrollView: UIScrollView) UITableView UITableView 在 iOS 11 中也有新的 safe area 相关功能。让我们添加一个具有自定义 header 和自定义 cells 的 table view 到 view controller，并将其附加到视图的边缘。\n你可以看到 header 和 cell 的 content view frame 在横屏方向下会改变。同时，cell 和 separator frames 不会改变。这是默认行为，可以通过新的 UITableView 的 insetsContentViewsToSafeArea 属性管理：\n@available(iOS 11.0, *) open var insetsContentViewsToSafeArea: Bool 如果你禁用 content view insets：\ntableView.insetsContentViewsToSafeArea = false 你会看到现在 header/footer/cell content views frame 等于 header/footer/cell frame。\n这意味着在 iOS 11 中，如果 header/footer/cell subviews 添加到 content view，你不需要更改它们的位置，UITableView 会为你完成这项工作。\nUICollectionView 和 UITableView 类似，UICollectionView 也有处理 safe area 的方法。当使用 UICollectionViewFlowLayout 时，iOS 11 中新增了 sectionInsetReference 属性：\n@available(iOS 11.0, *) public enum SectionInsetReference : Int { case fromContentInset case fromSafeArea case fromLayoutMargins } @available(iOS 11.0, *) open var sectionInsetReference: UICollectionViewFlowLayout.SectionInsetReference 这个属性用于确定 section insets 的参考点，有三个值：\nfromContentInset — 默认值，section insets 不会受到 safe area 的影响。 fromSafeArea — section insets 会添加 safe area insets。在这种情况下，实际的 section content insets 将等于 section content insets 加上 safe area insets。 fromLayoutMargins — section insets 会添加 layout margins。 当在 iPhone X 的横屏模式下使用 grid 布局时，cells 可能会被 notch 覆盖。为了修复这个问题，可以设置 sectionInsetReference 为 .fromSafeArea，这样就不需要手动添加 safe area insets 到 section content insets。\n总结 在 iOS 11 中，Apple 添加了许多有用的工具来处理 safe area。这些工具在以下类中都有体现：\nUIView: 提供 safeAreaInsets 和 safeAreaLayoutGuide 属性，允许在视图层次结构的任何地方访问 safe area。 UIViewController: 添加 additionalSafeAreaInsets 属性，可以扩展 safe area，对测试非常有用。 UIScrollView: 引入 contentInsetAdjustmentBehavior 和 adjustedContentInset 属性，完全改变了 scroll view insets 的调整方式。 UITableView: 增加 insetsContentViewsToSafeArea 属性，自动调整 content views 以适应 safe area。 UICollectionView: 通过 UICollectionViewFlowLayout 的 sectionInsetReference 属性，提供对 section insets 如何响应 safe area 的控制。 所有这些新 API 都使得为 iPhone X 和未来的设备适配应用程序变得更加简单和统一。当开发新的 iOS 11+ 应用时，应该充分利用这些 API，以确保应用在所有屏幕尺寸和形状上看起来都很好。\nRefereneces iOS Safe Area Updating Your App for iOS 11 Building Apps for iPhone X ","permalink":"https://zyf.im/2018/03/29/ios-safe-area/","summary":"\u003cp\u003e在 iOS 7 Apple 在 UIViewController 中引入了 \u003ccode\u003etopLayoutGuide\u003c/code\u003e 和 \u003ccode\u003ebottomLayoutGuide\u003c/code\u003e 属性来描述没有被覆盖(status bar, navigation bar, toolbar, tab bar, etc.)屏幕的区域。在 iOS 11 中，Apple 已经弃用了这些属性，并引入了 safe area。Apple 建议我们不要在 safe area 操作，在 iOS 11 中，当在 iOS App 中定位视图时，你必须使用新的 safe area API。\u003c/p\u003e\n\u003ch2 id=\"uiview\"\u003eUIView\u003c/h2\u003e\n\u003cp\u003e在 iOS 11 UIViewController \u003ccode\u003etopLayoutGuide\u003c/code\u003e 和 \u003ccode\u003ebottomLayoutGuide\u003c/code\u003e 属性已经被替换成了新的 UIView 中的 safe area：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-swift\" data-lang=\"swift\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e@\u003c/span\u003e\u003cspan class=\"n\"\u003eavailable\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eiOS\u003c/span\u003e \u003cspan class=\"mf\"\u003e11.0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003eopen\u003c/span\u003e \u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nv\"\u003esafeAreaInsets\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eUIEdgeInsets\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"kr\"\u003eget\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e@\u003c/span\u003e\u003cspan class=\"n\"\u003eavailable\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eiOS\u003c/span\u003e \u003cspan class=\"mf\"\u003e11.0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003eopen\u003c/span\u003e \u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nv\"\u003esafeAreaLayoutGuide\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eUILayoutGuide\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"kr\"\u003eget\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003ccode\u003esafeAreaInsets\u003c/code\u003e 属性意味着屏幕可以覆盖从四个方向，而不仅仅是顶部和底部。当被 iPhone X 呈现时，我们就明白了为什么我们需要左右 insets。\u003c/p\u003e\n\u003cimg src=\"https://tva1.sinaimg.cn/large/006tNbRwly1fptmugww5wj30zs0x0jw8.jpg\" alt=\"ios-safe-area\" width=\"400\" /\u003e\n\u003cp\u003e\u003cem\u003eiPhone 8 vs iPhone X safe area (portrait orientation)\u003c/em\u003e\u003c/p\u003e","title":"iOS Safe Area 我所知道的全部"},{"content":"使用 Auto Layout 让 UITableViewCell 自适应 UITextView 高度，效果演示：\n99-projects-of-swift/029-tableviewcell-self-adaption\n预备步骤 给 textView 上下左右建立相对于 cell 的约束 取消 textView 的 Scrolling Enabled 设置 tableView 估算高度 tableView.estimatedRowHeight = 70 设置 textView.delegate = self 关键点 如果在 textViewDidChange(textView:) 调用 tableView.reloadData() 会造成 textView 失去焦点，键盘隐藏。\n解决方法：\nfunc textViewDidChange(textView: UITextView) { tableView.beginUpdates() tableView.endUpdates() } 这里带来了一个问题，当 textView 长度超过一屏或者过长时，在输入时 tableView 会跳动滚动 jumping and stuttering。\n更好的解决方法：\nfunc textViewDidChange(textView: UITextView) { let currentOffset = tableView.contentOffset UIView.setAnimationsEnabled(false) tableView.beginUpdates() tableView.endUpdates() UIView.setAnimationsEnabled(true) tableView.setContentOffset(currentOffset, animated: false) } 禁用动画和重建表视图的内容偏移修正抖动。\nReferences Self-sizing UITextView in a UITableView using Auto Layout - like Reminders.app \u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2018/03/27/self-sizing-uitextview-in-a-uitableviewcell/","summary":"\u003cp\u003e使用 Auto Layout 让 UITableViewCell 自适应 UITextView 高度，效果演示：\u003c/p\u003e\n\u003cimg src=\"https://user-images.githubusercontent.com/9289792/37953137-931860e0-31d4-11e8-8809-c871b09f9519.gif\" alt=\"Self-sizing UITextView in cell\" width=\"200\" /\u003e\n\u003cp\u003e\u003ca href=\"https://github.com/imzyf/99-projects-of-swift/tree/master/029-tableviewcell-self-adaption\"\u003e99-projects-of-swift/029-tableviewcell-self-adaption\u003c/a\u003e\u003c/p\u003e\n\u003c!-- more --\u003e\n\u003ch2 id=\"预备步骤\"\u003e预备步骤\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003e给 textView 上下左右建立相对于 cell 的约束\u003c/li\u003e\n\u003cli\u003e取消 textView 的 \u003ccode\u003eScrolling Enabled\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e设置 tableView 估算高度 \u003ccode\u003etableView.estimatedRowHeight = 70\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e设置 \u003ccode\u003etextView.delegate = self\u003c/code\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2 id=\"关键点\"\u003e关键点\u003c/h2\u003e\n\u003cp\u003e如果在 \u003ccode\u003etextViewDidChange(textView:)\u003c/code\u003e 调用 \u003ccode\u003etableView.reloadData()\u003c/code\u003e 会造成 textView 失去焦点，键盘隐藏。\u003c/p\u003e\n\u003cp\u003e解决方法：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003efunc textViewDidChange(textView: UITextView) {\n    tableView.beginUpdates()\n    tableView.endUpdates()\n}\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e这里带来了一个问题，当 textView 长度超过一屏或者过长时，在输入时 tableView 会跳动滚动 jumping and stuttering。\u003c/p\u003e\n\u003cp\u003e更好的解决方法：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003efunc textViewDidChange(textView: UITextView) {\n    let currentOffset = tableView.contentOffset\n    UIView.setAnimationsEnabled(false)\n    tableView.beginUpdates()\n    tableView.endUpdates()\n    UIView.setAnimationsEnabled(true)\n    tableView.setContentOffset(currentOffset, animated: false)\n}\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e禁用动画和重建表视图的内容偏移修正抖动。\u003c/p\u003e","title":"UITableViewCell 自适应 UITextView 高度"},{"content":" iOS Unit Testing and UI Testing Tutorial\n编写测试并不迷人 (glamorous)，但是既然测试能让你闪闪发光 (sparkling) 的应用程序避免变成 (from turning into) 一堆乱七八糟的垃圾，那么说明测试是必要的。如果你正在阅读这篇教程，那么你已经知道你 应该 为代码和 UI 编写测试，但是你可能不知道如何做。\n也许你已经有一个 \u0026ldquo;可以运行\u0026rdquo; 的应用，但想测试你正在进行的扩展应用的更改。也许你已经编写了一些测试，但不确定它们是否是 正确 的测试。或者，你已经开始开发一个新应用，想要边开发边测试。\n这篇教程将告诉你如何:\n使用 Xcode 的测试导航器来测试应用的模型和异步方法 通过使用存根 (stubs) 和模拟对象 (mocks) 模拟与库或系统对象的交互 测试 UI 和性能 使用代码覆盖率工具 在此过程中，你将学到一些测试高手常用的专业术语。\n开始 首先，下载教程素材。它包含一个基于 UIKit Apprentice 中的示例应用的 BullsEye 项目。这是一个简单的运气和机会游戏。游戏逻辑在 BullsEyeGame 类中，你将在本教程中对其进行测试。\n测试什么 在编写任何测试之前，重要的是了解基础知识。你需要测试什么？\n如果你的目标是扩展现有应用，你应该首先为计划更改的任何组件编写测试。\n一般来说，测试应该覆盖：\n核心功能：模型类和方法及其与控制器的交互 最常见的 UI 工作流 边界条件 Bug 修复 测试的最佳实践 首字母缩写 FIRST 描述了有效单元测试的一套简明标准。这些标准是：\nFast：测试应该快速运行。 Independent/Isolated：测试之间不应共享状态。 Repeatable：每次运行测试时，都应获得相同的结果。外部数据提供者或并发问题可能导致间歇性失败。 Self-validating：测试应完全自动化。输出应该是\u0026quot;通过\u0026quot;或\u0026quot;失败\u0026quot;，而不是依赖程序员对日志文件的解释。 Timely：理想情况下，你应该在编写生产代码之前编写测试它们的测试。这被称为测试驱动开发。 遵循 FIRST 原则将使你的测试保持清晰有用，而不会成为应用开发的障碍。\nXcode 中的单元测试 测试导航器 提供了使用测试的最简单方法。你将使用它来创建测试目标并对你的应用运行测试。\n创建单元测试目标 打开 BullsEye 项目并按下 Command-6 打开测试导航器。\n点击左下角的 +，然后从菜单中选择 New Unit Test Target…：\n接受默认名称 BullsEyeTests，并输入 com.raywenderlich 作为 Organization Identifier。当测试包出现在测试导航器中时，通过点击展开三角形展开它，然后点击 BullsEyeTests 在编辑器中打开它。\n默认模板导入测试框架 XCTest，并定义了 BullsEyeTests 子类，其中包含 setUpWithError()、tearDownWithError() 和示例测试方法。\n你可以通过三种方式运行测试：\nProduct ▸ Test 或 Command-U。这两种方式都会运行 所有 测试类。 点击测试导航器中的箭头按钮。 点击边栏中的菱形按钮。 你也可以通过点击测试导航器或边栏中的菱形来运行单个测试方法。\n当所有测试成功时，菱形将变为绿色并显示勾号。点击 testPerformanceExample() 末尾的灰色菱形打开性能结果：\n你不需要 testPerformanceExample() 或 testExample()，所以删除它们。\n使用 XCTAssert 测试模型 首先，你将使用 XCTAssert 函数测试 BullsEye 模型的核心功能：BullsEyeGame 是否正确计算一轮的分数？\n在 BullsEyeTests.swift 中，在 import XCTest 下面添加这一行：\n@testable import BullsEye 这使单元测试可以访问 BullsEye 中的 internal 类型和函数。\n在 BullsEyeTests 顶部添加这个属性：\nvar sut: BullsEyeGame! 这为 BullsEyeGame 创建一个占位符，它是 System Under Test (SUT)，或者说是这个测试用例类关注测试的对象。\n接下来，用以下内容替换 setUpWithError() 的内容：\ntry super.setUpWithError() sut = BullsEyeGame() 这在类级别创建 BullsEyeGame，以便该测试类中的所有测试都可以访问 SUT 对象的属性和方法。\n在你忘记之前，在 tearDownWithError() 中 释放 你的 SUT 对象。用以下内容替换它的内容：\nsut = nil try super.tearDownWithError() 注意：在 setUpWithError() 中创建 SUT 并在 tearDownWithError() 中释放它是一种很好的做法，以确保每个测试都从干净的状态开始。\n编写你的第一个测试 现在你已经准备好编写你的第一个测试了！\n在 BullsEyeTests 末尾添加以下代码，测试当猜测值高于目标值时是否计算了预期的分数：\nfunc testScoreIsComputedWhenGuessIsHigherThanTarget() { // given let guess = sut.targetValue + 5 // when sut.check(guess: guess) // then XCTAssertEqual(sut.scoreRound, 95, \u0026#34;Score computed from guess is wrong\u0026#34;) } 测试方法的名称总是以 test 开头，后跟对其测试内容的描述。\n将测试格式化为 given、when 和 then 部分是一种良好的做法：\nGiven：在这里，你设置所需的任何值。在这个例子中，你创建一个 guess 值，以便可以指定它与 targetValue 相差多少。 When：在这一部分，你将执行被测试的代码：调用 check(guess:)。 Then：这是你断言你期望的结果的部分，如果测试 失败，会打印一条消息。在这种情况下，sut.scoreRound 应该等于 95，因为它是 100 − 5。 通过点击边栏或测试导航器中的菱形图标运行测试。这将构建并运行应用，菱形图标将变成绿色勾号！你还会看到一个短暂显示在 Xcode 上方的弹出窗口，也表示成功：\n注意：要查看 XCTestAssertions 的完整列表，请访问 Apple 的按类别列出的断言页面。\n调试测试 让我们添加另一个测试来检查当猜测值低于目标值时的得分计算。添加以下测试方法：\nfunc testScoreIsComputedWhenGuessIsLowerThanTarget() { // given let guess = sut.targetValue - 5 // when sut.check(guess: guess) // then XCTAssertEqual(sut.scoreRound, 95, \u0026#34;Score computed from guess is wrong\u0026#34;) } 在这个测试中，猜测值比目标值小 5，所以分数应该仍然是 95。运行这个测试看看会发生什么。\n如果这个测试失败了，那么你可能在 BullsEyeGame 中发现了一个 bug！在断点导航器中添加测试失败断点，这将在断言失败时停止测试运行。\n运行你的测试：当测试失败时，它将在 XCTAssertEqual 行停止。在调试控制台中检查 sut 和 guess。\n猜测值是目标值减 5，但 scoreRound 是 105 而不是 95！\n要进一步调查，使用常规调试过程：在 when 语句处设置断点，并在 BullsEyeGame.swift 的 check(_:) 方法中设置另一个断点。然后再次运行测试，分步执行 let difference 行，检查 difference 值：\n问题是 difference 是负数，所以得分是 100 - (-5)。要修复这个问题，应该使用 difference 的绝对值。\n修改 BullsEyeGame.swift 中的 check 方法，将：\nlet difference = guess - targetValue 改为：\nlet difference = abs(guess - targetValue) 移除两个断点并再次运行测试以确认它现在通过了。\n使用 XCTestExpectation 测试异步操作 许多 iOS 应用程序与网络、数据库或文件系统进行异步交互。这些异步操作需要特殊的测试处理，确保测试能够等待操作完成后再进行断言。\n要测试异步操作，可以使用 XCTestExpectation。它允许你创建一个期望（expectation），告诉测试等待满足这个期望，然后才能结束测试。\n下面是测试异步操作的基本模式：\nfunc testAsynchronousOperation() { // 1. 创建期望 let expectation = expectation(description: \u0026#34;描述你期望发生的事\u0026#34;) // 2. 执行异步操作 performAsyncOperation { // 3. 异步操作完成时，满足期望 expectation.fulfill() } // 4. 等待期望被满足，设置超时时间 wait(for: [expectation], timeout: 5.0) // 5. 在异步操作完成后进行断言 } 这个模式可以帮助你测试各种异步操作，如网络请求、动画或定时器。\n快速失败 有时，测试失败是如此明显，以至于没有理由继续执行测试的剩余部分。在这种情况下，你可以使用 XCTFail(_:file:line:) 强制测试立即失败：\nfunc testWithCondition() { guard someConditionIsMet else { XCTFail(\u0026#34;重要条件未满足\u0026#34;) return } // 继续测试 } 有条件地失败 你可能希望根据特定条件跳过某些测试。例如，某些测试可能只在特定的设备或操作系统版本上运行。在这些情况下，你可以使用 XCTSkip 来有条件地跳过测试：\nfunc testFeatureOnlyAvailableIniOS14() throws { if #available(iOS 14.0, *) { // 测试 iOS 14 特性 } else { throw XCTSkip(\u0026#34;此测试需要 iOS 14\u0026#34;) } } 模拟对象和交互 当你测试一个与其他对象交互的对象时，可能不希望测试涉及真实的依赖项。例如，如果测试需要网络请求，则测试将变得缓慢和不可靠。\n这就是为什么我们使用存根（Stubs）和模拟对象（Mocks）来代替真实对象：\n存根（Stub）：提供测试所需的固定响应，不关心如何被调用 模拟对象（Mock）：记录它们如何被调用，允许你验证交互方式 使用存根模拟输入 创建一个存根非常简单，你只需创建一个实现相同协议的对象，并提供固定的测试数据：\nprotocol DataProvider { func fetchData(completion: @escaping (Data?, Error?) -\u0026gt; Void) } class StubDataProvider: DataProvider { var stubData: Data? var stubError: Error? func fetchData(completion: @escaping (Data?, Error?) -\u0026gt; Void) { completion(stubData, stubError) } } 现在你可以使用这个存根来测试你的代码如何处理不同的数据情况：\nfunc testHandleDataFetchSuccess() { // 创建存根并设置测试数据 let stub = StubDataProvider() stub.stubData = \u0026#34;测试数据\u0026#34;.data(using: .utf8) // 将存根注入被测试系统 sut = SystemUnderTest(dataProvider: stub) // 执行测试 sut.loadData() // 断言 XCTAssertEqual(sut.loadedData, stub.stubData) } 使用模拟对象验证交互 模拟对象除了返回数据外，还跟踪它如何被调用：\nclass MockDataProvider: DataProvider { var fetchDataCallCount = 0 var stubbedData: Data? func fetchData(completion: @escaping (Data?, Error?) -\u0026gt; Void) { fetchDataCallCount += 1 completion(stubbedData, nil) } } 然后可以验证模拟对象是否按预期被调用：\nfunc testDataProviderIsCalledOnRefresh() { // 创建模拟对象 let mock = MockDataProvider() // 注入模拟对象 sut = SystemUnderTest(dataProvider: mock) // 在刷新时应该调用数据提供者 sut.refresh() // 验证交互 XCTAssertEqual(mock.fetchDataCallCount, 1, \u0026#34;刷新应该调用一次数据提供者\u0026#34;) } Xcode 中的 UI 测试 UI 测试模拟用户与应用程序界面的交互。这些测试非常有价值，因为它们验证整个应用程序从用户角度的工作方式。\n创建 UI 测试目标 与单元测试类似，你可以从测试导航器创建 UI 测试目标，选择 \u0026ldquo;New UI Test Target\u0026hellip;\u0026quot;。\nUI 测试使用 XCUIApplication 类启动你的应用程序，并通过 XCUIElement 查询与 UI 元素交互：\nfunc testExample() throws { // 启动应用 let app = XCUIApplication() app.launch() // 与 UI 交互 app.buttons[\u0026#34;增加\u0026#34;].tap() // 验证 UI 状态 XCTAssertEqual(app.staticTexts[\u0026#34;计数器\u0026#34;].label, \u0026#34;1\u0026#34;) } 记录 UI 测试 Xcode 提供了一个记录功能，可以自动生成 UI 测试代码。在编辑器中放置光标，然后点击记录按钮，与应用交互。Xcode 将生成相应的测试代码。\n测试性能 除了测试功能正确性，Xcode 还支持性能测试，用于确保你的代码保持高效：\nfunc testPerformanceExample() throws { measure { // 放置要测量性能的代码 for _ in 1...1000 { _ = complexAlgorithm() } } } 当你运行这个测试时，Xcode 会多次执行 measure 块内的代码，并报告平均执行时间。如果执行时间明显变慢，测试将失败。\n启用代码覆盖率 代码覆盖率是衡量测试质量的指标，它显示了你的测试覆盖了多少代码。\n启用代码覆盖率步骤：\n编辑方案 (Edit Scheme) 选择 \u0026ldquo;Test\u0026rdquo; 操作 选择 \u0026ldquo;Options\u0026rdquo; 选项卡 勾选 \u0026ldquo;Code Coverage\u0026rdquo; 选项 运行测试后，可以在报告导航器中查看覆盖率报告。\n追求 100% 覆盖率？ 虽然高代码覆盖率是好事，但盲目追求 100% 的覆盖率可能适得其反。测试的目标是确保代码的正确性，而不仅仅是提高覆盖率数字。\n关注测试以下方面：\n容易出错的复杂逻辑 经常变化的代码 核心业务功能 已修复的 bug 总结 本教程介绍了如何在 Xcode 中进行单元测试和 UI 测试。掌握这些测试技术将帮助你创建更可靠、更健壮的 iOS 应用。\n关键要点：\n使用 XCTAssert 函数测试模型层 使用 XCTestExpectation 测试异步操作 使用存根和模拟对象隔离测试 创建 UI 测试验证用户交互 测量代码性能并监控变化 监控代码覆盖率，但关注测试质量而非数量 最重要的是，养成编写测试的习惯。随着时间的推移，这将为你的应用程序构建一个安全网，让你能够自信地进行更改并添加新功能。\n参考资料 Apple 官方文档：XCTest Apple 按类别列出的断言 WWDC 视频：测试与 Xcode ","permalink":"https://zyf.im/2018/03/15/ios-unit-testing-and-ui-testing-tutorial/","summary":"\u003cblockquote\u003e\n\u003cp\u003e\u003ca href=\"https://www.kodeco.com/21020457-ios-unit-testing-and-ui-testing-tutorial\"\u003eiOS Unit Testing and UI Testing Tutorial\u003c/a\u003e\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003e编写测试并不迷人 (glamorous)，但是既然测试能让你闪闪发光 (sparkling) 的应用程序避免变成 (from turning into) 一堆乱七八糟的垃圾，那么说明测试是必要的。如果你正在阅读这篇教程，那么你已经知道你 \u003cem\u003e应该\u003c/em\u003e 为代码和 UI 编写测试，但是你可能不知道如何做。\u003c/p\u003e\n\u003cp\u003e也许你已经有一个 \u0026ldquo;可以运行\u0026rdquo; 的应用，但想测试你正在进行的扩展应用的更改。也许你已经编写了一些测试，但不确定它们是否是 \u003cem\u003e正确\u003c/em\u003e 的测试。或者，你已经开始开发一个新应用，想要边开发边测试。\u003c/p\u003e\n\u003cp\u003e这篇教程将告诉你如何:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e使用 Xcode 的测试导航器来测试应用的模型和异步方法\u003c/li\u003e\n\u003cli\u003e通过使用存根 (stubs) 和模拟对象 (mocks) 模拟与库或系统对象的交互\u003c/li\u003e\n\u003cli\u003e测试 UI 和性能\u003c/li\u003e\n\u003cli\u003e使用代码覆盖率工具\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e在此过程中，你将学到一些测试高手常用的专业术语。\u003c/p\u003e\n\u003ch2 id=\"开始\"\u003e开始\u003c/h2\u003e\n\u003cp\u003e首先，下载教程素材。它包含一个基于 UIKit Apprentice 中的示例应用的 BullsEye 项目。这是一个简单的运气和机会游戏。游戏逻辑在 \u003ccode\u003eBullsEyeGame\u003c/code\u003e 类中，你将在本教程中对其进行测试。\u003c/p\u003e\n\u003ch2 id=\"测试什么\"\u003e测试什么\u003c/h2\u003e\n\u003cp\u003e在编写任何测试之前，重要的是了解基础知识。你需要测试什么？\u003c/p\u003e\n\u003cp\u003e如果你的目标是扩展现有应用，你应该首先为计划更改的任何组件编写测试。\u003c/p\u003e\n\u003cp\u003e一般来说，测试应该覆盖：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e核心功能：模型类和方法及其与控制器的交互\u003c/li\u003e\n\u003cli\u003e最常见的 UI 工作流\u003c/li\u003e\n\u003cli\u003e边界条件\u003c/li\u003e\n\u003cli\u003eBug 修复\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"测试的最佳实践\"\u003e测试的最佳实践\u003c/h3\u003e\n\u003cp\u003e首字母缩写 \u003cem\u003eFIRST\u003c/em\u003e 描述了有效单元测试的一套简明标准。这些标准是：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cem\u003eFast\u003c/em\u003e：测试应该快速运行。\u003c/li\u003e\n\u003cli\u003e\u003cem\u003eIndependent/Isolated\u003c/em\u003e：测试之间不应共享状态。\u003c/li\u003e\n\u003cli\u003e\u003cem\u003eRepeatable\u003c/em\u003e：每次运行测试时，都应获得相同的结果。外部数据提供者或并发问题可能导致间歇性失败。\u003c/li\u003e\n\u003cli\u003e\u003cem\u003eSelf-validating\u003c/em\u003e：测试应完全自动化。输出应该是\u0026quot;通过\u0026quot;或\u0026quot;失败\u0026quot;，而不是依赖程序员对日志文件的解释。\u003c/li\u003e\n\u003cli\u003e\u003cem\u003eTimely\u003c/em\u003e：理想情况下，你应该在编写生产代码之前编写测试它们的测试。这被称为测试驱动开发。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e遵循 FIRST 原则将使你的测试保持清晰有用，而不会成为应用开发的障碍。\u003c/p\u003e","title":"【译】iOS 单元测试和 UI 测试入门教程"},{"content":"主要内容：【Git 协同模型】\n经典 Git 协同模型 集中式协同模型 可以像集中式版本控制系统那样使用 Git，在一个大家都可以访问到的服务器上架设 Git 服务器，每个人从该服务器克隆代码，本地提交推送到服务器上。\n金字塔式协同模型 虽然理论上每个开发者的版本库都是平等的，但是会有一个公认的权威的版本库，这个版本库由一个或者多个核心开发者负责维护（具有推送的权限）。\n开源社区逐渐发展出金字塔模型，而这也是必然之选。\nTopgit 协同模型 笔者注：Topgit 是否已经过时？\n卖主分支 Vendor Branch 是在版本库中专门创建一个和上游同步的分支，一旦有上游代码发布就捡入到卖主分支中。\n子模组协同模型 创建子模组 git submodule add /path/to/repos/libA.git lib/lib_a .gitmodules 的内容：\ncat .gitmodules [submodule \u0026#34;lib/lib_a\u0026#34;] path = lib/lib_a url = /path/to/repos/libA.git 克隆带子模组的版本库 git clone /path/to/repos/super.git /path/to/my/workspace/super-clone 子模组的版本库并不会默认克隆，如果需要克隆出子模组型式引用的外部库，需要执行：\ngit submodule init git submodule update 在子模组中修改和子模组的更新 修改更新的方式和普通仓库一样。如果修改了子模块，要先推送子模块的修改，再推送主仓库，以防止其他人克隆 super 版本库、更新模组时因为找不到该子模组版本库相应的提交而导致出错。\n查看子模组状态：\ngit submodule status 子树合并 引入外部版本库 # 注册外部版本库 git remote add util /path/to/repos/util.git git fetch util # 查看所有分支 git branch -a # 从 util/master 远程分支创建一个本地分支 util-branch git checkout -b util-branch util/master 子目录方式合并外部版本库 # 在主分支，将分支 util-branch 读取到当前分支的一个子目录下 git read-tree --prefix=lib util-branch # 将 lib 目录下的文件更新出来 git checkout -- lib 现在还不能忙着提交，因为如果现在进行提交就体现不出来两个分支的合并关系。需要使用 Git 底层的命令进行数据提交。\n# 将暂存区的目录树保存下来 git write-tree 要手工创建一个合并提交，即新的提交要有两个父提交。这两个父提交分别是 master 分支和 util-branch 分支的最新提交。\necho \u0026#34;subtree merge\u0026#34; | \\ git commit-tree 2153518409d218609af40babededec6e8ef51616 \\ -p 911b1af2e0c95a2fc1306b8dea707064d5386c2e \\ -p 12408a149bfa78a4c2d4011f884aa2adb04f0934 62ae6cc3f9280418bdb0fcf6c1e678905b1fe690 需要把当前的 master 分支重置到此提交 ID：\ngit reset 62ae6cc3f9280418bdb0fcf6c1e678905b1fe690 操作繁琐，可使用下面 subtree 命令进行代替。\n利用子树合并跟踪上游改动 git checkout util-branch git pull git checkout master git merge -Xsubtree=lib util-branch Git Subtree 管理子项目 假设 P1 项目、P2 项目 共用 S 项目\n关联 S 项目 git subtree add --prefix=\u0026lt;S项目的相对路径\u0026gt; \u0026lt;S项目git地址\u0026gt; \u0026lt;分支\u0026gt; --squash --squash 意思是把 subtree 的改动合并成一次 commit，这样就不用拉取子项目完整的历史记录。--prefix 之后的 = 等号也可以用空格。\n更新代码 P1、P2 项目里各种提交 commit，其中有些 commit 会涉及到 S 目录 的更改，但是没关系。\n提交更改到子项目 git subtree push --prefix=\u0026lt;S项目的相对路径\u0026gt; \u0026lt;S项目git地址\u0026gt; \u0026lt;分支\u0026gt; Git 会遍历 步骤 2 中所有的 commit，从中找出针对 S 目录 的更改，然后把这些更改记录提交到 S 项目 的 Git 服务器上，并保留 步骤 2 中的相关 S 的提交 记录到 S仓库 中。\n更新子目录 git subtree pull --prefix=\u0026lt;S项目的相对路径\u0026gt; \u0026lt;S 项目 git 地址\u0026gt; \u0026lt;分支\u0026gt; --squash 拆分已有项目 需要从现有项目中抽取公共模块单独进行 Git 管理，假设已有 项目 P 抽取 项目 S。\n提交日志分离 git subtree split -P \u0026lt;S项目的相对路径\u0026gt; -b \u0026lt;临时branch\u0026gt; Git 会遍历所有的 commit，分离出与 S 项目的相对路径相关的 commit，并存入临时 branch 中。\n创建子 repo mkdir \u0026lt;S项目新路径\u0026gt; cd S项目新路径 git init git pull \u0026lt;P项目的路径\u0026gt; \u0026lt;临时branch\u0026gt; git remote add origin \u0026lt;S项目的git仓库\u0026gt; git push origin -u master 清理数据 cd P项目的路径 git rm -rf \u0026lt;S项目的相对路径\u0026gt; git commit -m \u0026#39;移除相应模块\u0026#39; # 提交删除申请 git branch -D \u0026lt;临时branch\u0026gt; # 删除临时分支 添加 subtree git subtree add --prefix=\u0026lt;S项目的相对路径\u0026gt; \u0026lt;S项目git地址\u0026gt; \u0026lt;分支\u0026gt; --squash git push origin master 执行完第 2 步时，对应的目录已经剥离出来形成独立的项目了。第 3，4 步主要是把当前项目的对应的文件给删除，重新在 P 项目建立 Subtree。\ntip: 推送到 GitHub Page：\ngit subtree push --prefix=dist origin gh-pages References 4. 协同模型 — GotGit Git Subtree 的使用 \u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2018/01/19/got-git-reading-notes-model/","summary":"\u003cp\u003e主要内容：【Git 协同模型】\u003c/p\u003e\n\u003ch2 id=\"经典-git-协同模型\"\u003e经典 Git 协同模型\u003c/h2\u003e\n\u003ch3 id=\"集中式协同模型\"\u003e集中式协同模型\u003c/h3\u003e\n\u003cp\u003e可以像集中式版本控制系统那样使用 Git，在一个大家都可以访问到的服务器上架设 Git 服务器，每个人从该服务器克隆代码，本地提交推送到服务器上。\u003c/p\u003e\n\u003ch2 id=\"金字塔式协同模型\"\u003e金字塔式协同模型\u003c/h2\u003e\n\u003cp\u003e虽然理论上每个开发者的版本库都是平等的，但是会有一个公认的权威的版本库，这个版本库由一个或者多个核心开发者负责维护（具有推送的权限）。\u003c/p\u003e\n\u003cp\u003e开源社区逐渐发展出金字塔模型，而这也是必然之选。\u003c/p\u003e\n\u003c!-- more --\u003e\n\u003ch2 id=\"topgit-协同模型\"\u003eTopgit 协同模型\u003c/h2\u003e\n\u003cblockquote\u003e\n\u003cp\u003e笔者注：Topgit 是否已经过时？\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003e\u003ccode\u003e卖主分支 Vendor Branch\u003c/code\u003e 是在版本库中专门创建一个和上游同步的分支，一旦有上游代码发布就捡入到卖主分支中。\u003c/p\u003e\n\u003ch2 id=\"子模组协同模型\"\u003e子模组协同模型\u003c/h2\u003e\n\u003ch3 id=\"创建子模组\"\u003e创建子模组\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit submodule add /path/to/repos/libA.git lib/lib_a\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003ccode\u003e.gitmodules\u003c/code\u003e 的内容：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ecat .gitmodules\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003esubmodule \u003cspan class=\"s2\"\u003e\u0026#34;lib/lib_a\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nv\"\u003epath\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e lib/lib_a\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nv\"\u003eurl\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e /path/to/repos/libA.git\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"克隆带子模组的版本库\"\u003e克隆带子模组的版本库\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit clone /path/to/repos/super.git /path/to/my/workspace/super-clone\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e子模组的版本库并不会默认克隆，如果需要克隆出子模组型式引用的外部库，需要执行：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit submodule init\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit submodule update\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"在子模组中修改和子模组的更新\"\u003e在子模组中修改和子模组的更新\u003c/h3\u003e\n\u003cp\u003e修改更新的方式和普通仓库一样。如果修改了子模块，要先推送子模块的修改，再推送主仓库，以防止其他人克隆 super 版本库、更新模组时因为找不到该子模组版本库相应的提交而导致出错。\u003c/p\u003e\n\u003cp\u003e查看子模组状态：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit submodule status\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"子树合并\"\u003e子树合并\u003c/h2\u003e\n\u003ch3 id=\"引入外部版本库\"\u003e引入外部版本库\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# 注册外部版本库\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit remote add util /path/to/repos/util.git\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit fetch util\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# 查看所有分支\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit branch -a\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# 从 util/master 远程分支创建一个本地分支 util-branch\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit checkout -b util-branch util/master\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"子目录方式合并外部版本库\"\u003e子目录方式合并外部版本库\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# 在主分支，将分支 util-branch 读取到当前分支的一个子目录下\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit read-tree --prefix\u003cspan class=\"o\"\u003e=\u003c/span\u003elib util-branch\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# 将 lib 目录下的文件更新出来\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit checkout -- lib\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e现在还不能忙着提交，因为如果现在进行提交就体现不出来两个分支的合并关系。需要使用 Git 底层的命令进行数据提交。\u003c/p\u003e","title":"【Git 权威指南】读书笔记 - 协同模型"},{"content":"主要内容：【Git 协议与工作协同】、【冲突解决】、【Git 里程碑】、【Git 分支】、【远程版本库】、【补丁文件交互】\nGit 协议与工作协同 Git 支持的协议 SSH、GIT、HTTP、HTTPS、FTP、FTPS、RSYNC 及前面已经看到的本地协议。\nSSH 协议：\nssh://[user@]example.com[:port]/path/to/repo.git/ [user@]example.com:path/to/repo.git/ GIT 协议，最常用的只读协议：\ngit://example.com[:port]/path/to/repo.git/ HTTP[S] 协议：\nhttp[s]://example.com[:port]/path/to/repo.git/ 强制非快进式推送 git push -f 强制推送，会强制刷新服务器中的版本。\n禁止非快进式推送 git --git-dir=/path/to/repos/shared.git config receive.denyNonFastForwards true 冲突解决 拉回操作中的合并 git pull = git fetch + git merge 合并策略 Merge Strategis\nGit 合并操作支持很多合并策略，默认会选择最适合的合并策略。例如，和一个分支进行合并时会选择 recursive 合并策略，当和两个或两个以上的其他分支进行合并时采用 octopus 合并策略。\ngit merge [-s \u0026lt;strategy\u0026gt;] [-X \u0026lt;strategy-option\u0026gt;] [\u0026lt;commit\u0026gt;...] This option forces conflicting hunks to be auto-resolved cleanly by favoring our version.\ngit merge -s recursive -X ours [\u0026lt;commit\u0026gt;...] Merge branch obsolete into the current branch, using ours merge strategy:\ngit merge -s ours obsolete Git 里程碑 显示里程碑 git tag 显示说明。-n\u0026lt;num\u0026gt; 显示最多 \u0026lt;num\u0026gt; 行里程碑的说明：\ngit tag -n1 使用统配：\ngit tag -l v1.* 查看提交对应的里程碑及其他引用：\ngit log --oneline --decorate 创建里程碑 当创建了里程碑 mytag 后，会在版本库的 .git/refs/tags 目录下创建一个新文件。实际上指向的是一个提交：\ngit tag mytag git cat-file -t mytag commit 带说明的 tag 指向的不再是一个提交，而是一个 tag 对象：\ngit tag -m \u0026#34;My first annotated tag.\u0026#34; mytag2 git cat-file -t mytag2 tag 为里程碑对象添加 GnuPG 签名：\ngit tag -s -m \u0026#34;My first GPG-signed tag.\u0026#34; mytag3 删除里程碑 git tag -d mytag Deleted tag \u0026#39;mytag\u0026#39; (was 60a2f4f) 共享里程碑 创建的里程碑，默认只在本地版本库中可见，不会因为对分支执行推送而将里程碑也推送到远程版本库。\n将 mytag 里程碑共享到上游版本库：\ngit push origin mytag 所有里程碑全部推送到远程版本库：\ngit push origin refs/tags/* 里程碑共享，必须显式的推送。 执行获取或拉回操作，自动从远程版本库获取新里程碑，并在本地版本库中创建。 如果本地已有同名的里程碑，默认不会从上游同步里程碑，即使两者里程碑的指向是不同的。 删除远程版本库的里程碑 git push origin :mytag2 里程碑命名规范 语义化版本 2.0.0\n版本格式：主版本号.次版本号.修订号，版本号递增规则如下：\n主版本号：当你做了不兼容的 API 修改， 次版本号：当你做了向下兼容的功能性新增， 修订号：当你做了向下兼容的问题修正。 先行版本号及版本编译信息可以加到 主版本号.次版本号.修订号 的后面，作为延伸。\nGit 分支 分支是代码管理的利器。如果没有有效的分支管理，代码管理就适应不了复杂的开发过程和项目的需要。\n分支命令概述 # 显示 1. git branch # 创建 2. git branch \u0026lt;branchname\u0026gt; 3. git branch \u0026lt;branchname\u0026gt; \u0026lt;start-point\u0026gt; # 删除，-d 在删除分支 \u0026lt;branchname\u0026gt; 时会检查所要删除的分支是否已经合并到其他分支中，否则拒绝删除。 4. git branch -d \u0026lt;branchname\u0026gt; 5. git branch -D \u0026lt;branchname\u0026gt; # 重命名，-m 如果版本库中已经存在名为 \u0026lt;newbranch\u0026gt; 的分支，拒绝执行重命名，而 7 会强制执行。 6. git branch -m \u0026lt;oldbranch\u0026gt; \u0026lt;newbranch\u0026gt; 7. git branch -M \u0026lt;oldbranch\u0026gt; \u0026lt;newbranch\u0026gt; 创建并切换到新分支：\ngit checkout -b \u0026lt;new_branch\u0026gt; [\u0026lt;start_point\u0026gt;] 分支变基 master dev（开发完成，领先 master） # 先切换到 dev git checkout dev # 变基操作 git rebase master # 遇到冲突，解决冲突 # 添加到暂存区 git add -u # 继续变基 git rebase --continue # 直接将 dev 推送到远程 master git push origin dev:master # 切换到 master git checkout master # 拉取最新代码 git pull # 删除 dev 分支 git branch -d dev 远程版本库 远程分支 查看远程分支：\ngit branch -r 在向远程版本库执行获取操作时，不是把远程版本库的分支原封不动地复制到本地版本库的分支中，而是复制到另外的命名空间。\n远程分支不是真正意义上的分支，是类似于里程碑一样的引用。如果针对远程分支执行检出命令，会看到大段的错误警告。\n远程分支类似于里程碑，如果检出就会使得头指针 HEAD 处于分离头指针状态。实际上除了以 refs/heads 为前缀的引用之外，如果检出任何其他引用，都将使工作区处于分离头指针状态。如果对远程分支进行修改就需要创建新的本地分支。\n分支追踪 为了能够在远程分支 origin/hello-1.x 上进行工作，需要基于该远程分支创建本地分支：\ngit checkout hello-1.x 从远程分支创建本地分支，自动建立了分支间的跟踪，而从一个本地分支创建另外一个本地分支则没有。\n从 hello-1.x 分支中创建新的本地分支 hello-jx，并与远程建立联系。\ngit checkout -b hello-jx hello-1.x cat .git/config 远程版本库 # 设置 git remote add new-remote file:///path/to/repos/hello-user1.git # 修改 url git remote set-url new-remote file:///path/to/repos/hello-user2.git # 单独修改 push 地址 git remote set-url --push new-remote /path/to/repos/hello-user2.git # 修改 版本库名称 git remote rename new-remote user2 # 当注册了多个远程版本库并希望获取所有远程版本库的更新 git remote update # 如果某个远程版本库不想在执行 git remote update 时获得更新 git config remote.user2.skipDefaultUpdate true # 删除 git remote rm PUSH 和 PULL 操作与远程版本库 在执行 git pull 操作的时候可以通过参数 --rebase 设置使用变基而非合并操作，将本地分支的改动变基到跟踪分支上。为了避免因为忘记使用 --rebase 参数导致分支的合并，可进行设置：\ngit config branch.\u0026lt;branchname\u0026gt;.rebase true 这样在遇到冲突（本地和远程分支出现偏离）的情况下，会采用变基操作，而不是默认的合并操作。\n如果为本地版本库设置参数 branch.autosetuprebase ，值为 true，则在基于远程分支建立本地追踪分支时，会自动配置 branch.\u0026lt;branchname\u0026gt;.rebase 参数。\n分支和里程碑的安全性 用 reflog 记录对分支的操作历史。默认创建的带工作区的版本库都会包含 core.logallrefupdates 为 true 的配置，这样在版本库中建立的每个分支都会创建对应的 reflog。但是创建的裸版本库默认不包含这个设置，也就不会为每个分支设置 reflog。可能因为分支误操作导致数据丢失，可以考虑为裸版本库添加此配置。\n关闭非快进式提交。配置 receive.denyNonFastForwards 设置为 true，则禁止一切非快进式推送。更好的方法是通过架设基于 SSH 协议的 Git 服务器，配置强制提交的用户权限。\n关闭分支删除功能。配置 receive.denyDeletes 设置为 true，则禁止删除分支。更好的方法是：配置分支删除的用户权限。\n补丁文件交互 将最近三个提交转换为补丁文件：\ngit format-patch -s HEAD~3..HEAD -s 会在导出的补丁文件中添加当前用户的签名。\n应用补丁：\ngit am user1-mail-archive git apply 可以应用一般格式的补丁文件，但是不能执行提交，也不能保持补丁中的作者信息。\nReferences 3. Git 和声 — GotGit ","permalink":"https://zyf.im/2018/01/17/got-git-reading-notes-harmony/","summary":"\u003cp\u003e主要内容：【Git 协议与工作协同】、【冲突解决】、【Git 里程碑】、【Git 分支】、【远程版本库】、【补丁文件交互】\u003c/p\u003e\n\u003ch2 id=\"git-协议与工作协同\"\u003eGit 协议与工作协同\u003c/h2\u003e\n\u003ch3 id=\"git-支持的协议\"\u003eGit 支持的协议\u003c/h3\u003e\n\u003cp\u003eSSH、GIT、HTTP、HTTPS、FTP、FTPS、RSYNC 及前面已经看到的本地协议。\u003c/p\u003e\n\u003cp\u003eSSH 协议：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003essh://[user@]example.com[:port]/path/to/repo.git/\n\n[user@]example.com:path/to/repo.git/\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eGIT 协议，最常用的只读协议：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003egit://example.com[:port]/path/to/repo.git/\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eHTTP[S] 协议：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003ehttp[s]://example.com[:port]/path/to/repo.git/\n\u003c/code\u003e\u003c/pre\u003e\u003c!-- more --\u003e\n\u003ch3 id=\"强制非快进式推送\"\u003e强制非快进式推送\u003c/h3\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003egit push -f\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e强制推送，会强制刷新服务器中的版本。\u003c/p\u003e\n\u003ch3 id=\"禁止非快进式推送\"\u003e禁止非快进式推送\u003c/h3\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003egit --git-dir=/path/to/repos/shared.git config receive.denyNonFastForwards true\n\u003c/code\u003e\u003c/pre\u003e\u003ch2 id=\"冲突解决\"\u003e冲突解决\u003c/h2\u003e\n\u003ch3 id=\"拉回操作中的合并\"\u003e拉回操作中的合并\u003c/h3\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003egit pull = git fetch + git merge\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"合并策略\"\u003e合并策略\u003c/h3\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ca href=\"https://git-scm.com/docs/git-merge#_merge_strategies\"\u003eMerge Strategis\u003c/a\u003e\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003eGit 合并操作支持很多合并策略，默认会选择最适合的合并策略。例如，和一个分支进行合并时会选择 recursive 合并策略，当和两个或两个以上的其他分支进行合并时采用 octopus 合并策略。\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003egit merge [-s \u0026lt;strategy\u0026gt;] [-X \u0026lt;strategy-option\u0026gt;] [\u0026lt;commit\u0026gt;...]\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eThis option forces conflicting hunks to be auto-resolved cleanly by favoring our version.\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003egit merge -s recursive -X ours [\u0026lt;commit\u0026gt;...]\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eMerge branch obsolete into the current branch, using ours merge strategy:\u003c/p\u003e","title":"【Git 权威指南】读书笔记 - 和声"},{"content":"R.swift 获取强类型、自动编译的图片、字体、segues 等资源。\n以避免无法编译时检查 字符串 的形式引用资源所导致的错误。\nlet icon = UIImage(named: \u0026#34;settings-icon\u0026#34;) let font = UIFont(name: \u0026#34;San Francisco\u0026#34;, size: 42) let color = UIColor(named: \u0026#34;indictator highlight\u0026#34;) let viewController = CustomViewController(nibName: \u0026#34;CustomView\u0026#34;, bundle: nil) let string = String(format: NSLocalizedString(\u0026#34;welcome.withName\u0026#34;, comment: \u0026#34;\u0026#34;), locale: NSLocale.current, \u0026#34;Arthur Dent\u0026#34;) With R.swift\nlet icon = R.image.settingsIcon() let font = R.font.sanFrancisco(size: 42) let color = R.color.indicatorHighlight() let viewController = CustomViewController(nib: R.nib.customView.name) let string = R.string.localizable.welcomeWithName(\u0026#34;Arthur Dent\u0026#34;) 配置 其中 GitHub 上有的就不再累述了，主要注意：\n添加 R.generated.swift 不要勾选 Copy items if needed，软引用就好。 要在 .gitignore 添加 *.generated.swift 以避免不必要的冲突。 添加新的资源文件后需要 command + b 编译下，才可以使用。\n.clr 颜色文件的创建和使用 使用 Xcode 创建 .clr 文件：\n之后可以在其中添加颜色，选择颜色回车可以对颜色从新命名。\n生成的 .clr 文件保存在 ~/library/Colors 下，可以导入到项目后再通过 R.color 使用。\nTips 打开、关闭隐藏文件：\ncommand + shift + . References XCode Tip: Color Palette ","permalink":"https://zyf.im/2018/01/17/r-swift-getting-started/","summary":"\u003cp\u003e\u003ca href=\"https://github.com/mac-cain13/R.swift\"\u003eR.swift\u003c/a\u003e 获取强类型、自动编译的图片、字体、segues 等资源。\u003c/p\u003e\n\u003cp\u003e以避免无法编译时检查 \u003ccode\u003e字符串\u003c/code\u003e 的形式引用资源所导致的错误。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-swift\" data-lang=\"swift\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003elet\u003c/span\u003e \u003cspan class=\"nv\"\u003eicon\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eUIImage\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003enamed\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;settings-icon\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003elet\u003c/span\u003e \u003cspan class=\"nv\"\u003efont\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eUIFont\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;San Francisco\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003esize\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"mi\"\u003e42\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003elet\u003c/span\u003e \u003cspan class=\"nv\"\u003ecolor\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eUIColor\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003enamed\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;indictator highlight\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003elet\u003c/span\u003e \u003cspan class=\"nv\"\u003eviewController\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eCustomViewController\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003enibName\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;CustomView\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ebundle\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"kc\"\u003enil\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003elet\u003c/span\u003e \u003cspan class=\"nv\"\u003estring\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nb\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eformat\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eNSLocalizedString\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;welcome.withName\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ecomment\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"n\"\u003elocale\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eNSLocale\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecurrent\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;Arthur Dent\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eWith R.swift\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-swift\" data-lang=\"swift\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003elet\u003c/span\u003e \u003cspan class=\"nv\"\u003eicon\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eR\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eimage\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esettingsIcon\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003elet\u003c/span\u003e \u003cspan class=\"nv\"\u003efont\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eR\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003efont\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esanFrancisco\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esize\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"mi\"\u003e42\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003elet\u003c/span\u003e \u003cspan class=\"nv\"\u003ecolor\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eR\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecolor\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eindicatorHighlight\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003elet\u003c/span\u003e \u003cspan class=\"nv\"\u003eviewController\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eCustomViewController\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003enib\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eR\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003enib\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecustomView\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003elet\u003c/span\u003e \u003cspan class=\"nv\"\u003estring\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eR\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003elocalizable\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ewelcomeWithName\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;Arthur Dent\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c!-- more --\u003e\n\u003ch2 id=\"配置\"\u003e配置\u003c/h2\u003e\n\u003cp\u003e其中 GitHub 上有的就不再累述了，主要注意：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e添加 \u003ccode\u003eR.generated.swift\u003c/code\u003e 不要勾选 \u003ccode\u003eCopy items if needed\u003c/code\u003e，软引用就好。\u003c/li\u003e\n\u003cli\u003e要在 \u003ccode\u003e.gitignore\u003c/code\u003e 添加 \u003ccode\u003e*.generated.swift\u003c/code\u003e 以避免不必要的冲突。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e添加新的资源文件后需要 \u003ccode\u003ecommand + b\u003c/code\u003e 编译下，才可以使用。\u003c/p\u003e\n\u003ch2 id=\"clr-颜色文件的创建和使用\"\u003e.clr 颜色文件的创建和使用\u003c/h2\u003e\n\u003cp\u003e使用 Xcode 创建 .clr 文件：\u003c/p\u003e\n\u003cimg src=\"https://user-images.githubusercontent.com/9289792/80204310-36566900-865b-11ea-864b-89a8e5cc8e75.jpg\" alt=\"Create a Color Palette\" width=\"300px\" /\u003e\n\u003cp\u003e之后可以在其中添加颜色，选择颜色回车可以对颜色从新命名。\u003c/p\u003e\n\u003cp\u003e生成的 \u003ccode\u003e.clr\u003c/code\u003e 文件保存在 \u003ccode\u003e~/library/Colors\u003c/code\u003e 下，可以导入到项目后再通过 \u003ccode\u003eR.color\u003c/code\u003e 使用。\u003c/p\u003e\n\u003cp\u003eTips 打开、关闭隐藏文件：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003ecommand\u003c/span\u003e + \u003cspan class=\"nb\"\u003eshift\u003c/span\u003e + .\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"references\"\u003eReferences\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.natashatherobot.com/xcode-color-palette/\"\u003eXCode Tip: Color Palette\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e","title":"R.swift 强类型引用资源文件"},{"content":"状态栏 Help Search 框可以很方便的检索到相关的设置项。\nNavigator ⌘ 1 .. ⌘ 7 可以切换窗口。\nShow the Symbol navigator 在类不多时，可以方便看所有类的结构，类多时时使用下面的 filter 功能。\nShow the Breakpoint navigator 点击右下角 + 选择 Exception Breakpoint..，可以在添加更明确的报错点，可以选择语言是 obj-c 还是 Swfit。\nUtilities ⌘ ⌥ 1 .. ⌘ ⌥ 7 可以切换窗口。\nShow the Code Snippet Library 代码片段模板，也可以将自己的写好的片段拖入。\nShow the Media Library 可以直接从中拖拽图片成 UIImageView 放入 xib 中。\nxib 快捷键 按住 option 拖拽可以快速复制组件。\n快捷键 option ⌥ 按住 ⌥ 并点击代码或方法时，可查看行内文档帮助。 按住 ⌥ 点击文件可以辅助编辑窗模式打开文件（多栏显示，可以用于 xib 与 code 绑定数据）。好用 按住 ⌥ ⇧ 点击文件可以选择文件打开的窗口位置。 显示和隐藏栏 ⌘ ⇧ y 显示/隐藏调试区域。 ⌘ ⌥ ⏎ 显示辅助编辑栏，Open the assistant editor ⌘ ⏎ 隐藏辅助编辑器栏。 组合键 ^ 为 control，⌥ 为 option\n⌘ ⌥ { ⌘ ⌥ } 整行上下移动代码。 将光标放在方法名上任一位置，点开 Eidt，点击 ⌃ ⇧ 将看到 Copy Qualified Symbol Name，点击 ⌃ ⇧ ⌥ 将看到 Copy Symbol Name，eg [UIColor colorWithRed:255/255.0f green:127/255.0f blue:80/255.0f alpha:1] 将会被拷贝为 +[UIColor colorWithRed:green:blue:alpha:]。 自动缩进代码 ^ i 或者全选 ⌘ a 后 ^ i。 ⌘ ⇧ o Open Quickly 查找文件，或者使用 ⌘ space。 command line Security find-identity -v 显示出已经安装的有效身份。 References [译]每个 iOS 开发者都该知道的 17 个 Xcode 小技巧 ","permalink":"https://zyf.im/2018/01/12/xcode-tips/","summary":"\u003ch2 id=\"状态栏\"\u003e状态栏\u003c/h2\u003e\n\u003ch3 id=\"help\"\u003eHelp\u003c/h3\u003e\n\u003cp\u003e\u003ccode\u003eSearch\u003c/code\u003e 框可以很方便的检索到相关的设置项。\u003c/p\u003e\n\u003cimg src=\"https://user-images.githubusercontent.com/9289792/80204076-c811a680-865a-11ea-8c0b-5e3b70ae22bd.jpg\" alt=\"xcode-unknown-tips-Search\" width=\"960px\" /\u003e\n\u003c!-- more --\u003e\n\u003ch2 id=\"navigator\"\u003eNavigator\u003c/h2\u003e\n\u003cp\u003e\u003ccode\u003e⌘ 1\u003c/code\u003e .. \u003ccode\u003e⌘ 7\u003c/code\u003e 可以切换窗口。\u003c/p\u003e\n\u003ch3 id=\"show-the-symbol-navigator\"\u003eShow the Symbol navigator\u003c/h3\u003e\n\u003cp\u003e在类不多时，可以方便看所有类的结构，类多时时使用下面的 filter 功能。\u003c/p\u003e\n\u003cimg src=\"https://user-images.githubusercontent.com/9289792/80204084-ca740080-865a-11ea-8fb0-e102827a3123.jpg\" alt=\"xcode-unknown-tips-Show the Symbol navigator\" width=\"260px\" /\u003e\n\u003ch3 id=\"show-the-breakpoint-navigator\"\u003eShow the Breakpoint navigator\u003c/h3\u003e\n\u003cp\u003e点击右下角 \u003ccode\u003e+\u003c/code\u003e 选择 \u003ccode\u003eException Breakpoint..\u003c/code\u003e，可以在添加更明确的报错点，可以选择语言是 obj-c 还是 Swfit。\u003c/p\u003e\n\u003cimg src=\"https://user-images.githubusercontent.com/9289792/80204086-cb0c9700-865a-11ea-93b5-7fc0edd67daf.jpg\" alt=\"xcode-unknown-tips-Show the Breakpoint navigator\" width=\"260px\" /\u003e\n\u003ch2 id=\"utilities\"\u003eUtilities\u003c/h2\u003e\n\u003cp\u003e\u003ccode\u003e⌘ ⌥ 1\u003c/code\u003e .. \u003ccode\u003e⌘ ⌥ 7\u003c/code\u003e 可以切换窗口。\u003c/p\u003e\n\u003ch3 id=\"show-the-code-snippet-library\"\u003eShow the Code Snippet Library\u003c/h3\u003e\n\u003cp\u003e代码片段模板，也可以将自己的写好的片段拖入。\u003c/p\u003e\n\u003cimg src=\"https://user-images.githubusercontent.com/9289792/80204090-cba52d80-865a-11ea-9d1f-d6f772fc7e1c.jpg\" alt=\"xcode-unknown-tips-Show the Code Snippet Labrary\" width=\"260px\" /\u003e\n\u003ch3 id=\"show-the-media-library\"\u003eShow the Media Library\u003c/h3\u003e\n\u003cp\u003e可以直接从中拖拽图片成 UIImageView 放入 xib 中。\u003c/p\u003e","title":"Xcode 不知名的实用技巧"},{"content":"2017 关键词：Birds、离职、狼人杀、白洋淀、iOS、自如。\nBirds Birds 是自己编写时间最长的一个 Web 项目。项目接手、改版、重构、迭代、盈利，上半年每天工作都是面对它。\nBirds 良好的表现与需求互相推动，这点很重要，假如有需求而项目没有成长，或项目成长没了需求，对工程来说都只能是纸上谈兵、无事可做。项目中的规范的重要性，无论是代码还是数据库，只要项目不是夭折终将显现，对于规范性我绝不会开倒车，做任何妥协，种种经历只说明：这里欠的东西总会还。如何应对需求的千变万化，小结几点：模块化、组件化思想，功能多可配置，功能可拔插，功能方法粒度要小；不要对程序肆意进行打补丁式的修改，减少对流程入侵；当某一处的逻辑增加时要及时重新修改、定义流程；对需求目的的正确理解更是能高效开发。\n对前端重新认识的一年。现在的前端和大学时刚刚接触时，已经大不一样了。前端能做的事情越来越多，很多业务逻辑都在前端处理，服务端只需要提供接口，分工合作更容易。浅尝 React Vue Webpack 后，也许前端才是自己的归宿。\n离职 离职的不是我。老人走，新人来，新人走。离职一词在我身边跟了一年都没有停下来。同事离职的原因很多，离开北京、公司发展、自我发展\u0026hellip; 马云说离职的原因就两个：1. 钱没给够。2. 受了委屈。我起初是认同这一说法的，但是后来觉得 “人” 或者说 “人的思想” 或者说 “人性” 在其中影响作用非常的大。相同的事情不同的角度看，结果相去甚远，如果基本的理念不同，那事情基本是无法调和的。\n对做的事情的认同感，对自我的定位与认识，对现实情况的冷静思考，这几点需要反复咀嚼。\n分享一篇文章：公司没大牛带，需要离职么？。对于刚入门的我们，这是一个很有代表性的问题。太多时候我们期待别人，忘了自己。公司有大牛，能跟着学是幸运，没有是常态。先接受了这个设定，会更容易找提高自己的方法。有没有大牛并不重要，我们是为了那个更好的自己。\n狼人杀 2017 火的游戏很多：狼人杀、守望先锋、王者荣耀、吃鸡。狼人杀这一杀，好像杀到了毕业前和同学舍友在一起臭 high 的日子。可说骚话、互相 diss、互相吹捧，真真假假其乐无穷。最赤鸡的是鱼炸出了个女盆友，各路同学亲上加亲，无法克说。\n白洋淀 我想 你说 你不要在孤单 让我做你的伴\n白洋淀去过四次，那里的温泉过去两次，年中 Team Building 再喜加一，而这一次让这里有了美丽故事。喷泉、沙发，出现了对的人。\niOS React Native 的一波尝试后，走上了移动开发的道。Swift 让上 iOS 车的门槛降低不少，Swift API 趋向稳定，可以说这是最好的时候。GitHub 应该是再也放不下了，外文的书籍、文档确实靠谱啊，推荐一个教程网站 iOS Tutorials - Ray Wenderlich 真的零基础入门。\n我相信：一个人语言的界限，就是他世界的边界。\n自如 一场大火让无数人无家可归，年末换房也受牵连。被自如圈粉，其他中介的房子真的太 low 了。自如订房子居然也要抢，一波三折、失而复得。在没抢到房子时，真的想走，想离开这里了，很凄凉。最终是在公司对面住下了，过上了在家吃中饭晚饭的日子。\n2018 Happy New Year 2017 自己是幸运的，2018 猥琐发育，不要浪，胜利属于伏地魔。\n\u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2017/12/31/review-2017/","summary":"\u003cp\u003e2017 关键词：Birds、离职、狼人杀、白洋淀、iOS、自如。\u003c/p\u003e\n\u003ciframe frameborder=\"no\" border=\"0\" marginwidth=\"0\" marginheight=\"0\" width=298 height=52 src=\"//music.163.com/outchain/player?type=2\u0026id=423314746\u0026auto=0\u0026height=32\"\u003e\u003c/iframe\u003e\n\u003ch2 id=\"birds\"\u003eBirds\u003c/h2\u003e\n\u003cp\u003eBirds 是自己编写时间最长的一个 Web 项目。项目接手、改版、重构、迭代、盈利，上半年每天工作都是面对它。\u003c/p\u003e\n\u003c!-- more --\u003e\n\u003cp\u003eBirds 良好的表现与需求互相推动，这点很重要，假如有需求而项目没有成长，或项目成长没了需求，对工程来说都只能是纸上谈兵、无事可做。项目中的规范的重要性，无论是代码还是数据库，只要项目不是夭折终将显现，对于规范性我绝不会开倒车，做任何妥协，种种经历只说明：这里欠的东西总会还。如何应对需求的千变万化，小结几点：模块化、组件化思想，功能多可配置，功能可拔插，功能方法粒度要小；不要对程序肆意进行打补丁式的修改，减少对流程入侵；当某一处的逻辑增加时要及时重新修改、定义流程；对需求目的的正确理解更是能高效开发。\u003c/p\u003e\n\u003cp\u003e对前端重新认识的一年。现在的前端和大学时刚刚接触时，已经大不一样了。前端能做的事情越来越多，很多业务逻辑都在前端处理，服务端只需要提供接口，分工合作更容易。浅尝 React Vue Webpack 后，也许前端才是自己的归宿。\u003c/p\u003e\n\u003ch2 id=\"离职\"\u003e离职\u003c/h2\u003e\n\u003cp\u003e离职的不是我。老人走，新人来，新人走。离职一词在我身边跟了一年都没有停下来。同事离职的原因很多，离开北京、公司发展、自我发展\u0026hellip; 马云说离职的原因就两个：1. 钱没给够。2. 受了委屈。我起初是认同这一说法的，但是后来觉得 “人” 或者说 “人的思想” 或者说 “人性” 在其中影响作用非常的大。相同的事情不同的角度看，结果相去甚远，如果基本的理念不同，那事情基本是无法调和的。\u003c/p\u003e\n\u003cp\u003e对做的事情的认同感，对自我的定位与认识，对现实情况的冷静思考，这几点需要反复咀嚼。\u003c/p\u003e\n\u003cp\u003e分享一篇文章：\u003ca href=\"http://stormzhang.com/2017/06/26/leave-if-no-experts/\"\u003e公司没大牛带，需要离职么？\u003c/a\u003e。对于刚入门的我们，这是一个很有代表性的问题。太多时候我们期待别人，忘了自己。公司有大牛，能跟着学是幸运，没有是常态。先接受了这个设定，会更容易找提高自己的方法。有没有大牛并不重要，我们是为了那个更好的自己。\u003c/p\u003e\n\u003ch2 id=\"狼人杀\"\u003e狼人杀\u003c/h2\u003e\n\u003cp\u003e2017 火的游戏很多：狼人杀、守望先锋、王者荣耀、吃鸡。狼人杀这一杀，好像杀到了毕业前和同学舍友在一起臭 high 的日子。可说骚话、互相 diss、互相吹捧，真真假假其乐无穷。最赤鸡的是鱼炸出了个女盆友，各路同学亲上加亲，无法克说。\u003c/p\u003e\n\u003ch2 id=\"白洋淀\"\u003e白洋淀\u003c/h2\u003e\n\u003cblockquote\u003e\n\u003cp\u003e我想 你说\n你不要在孤单 让我做你的伴\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003e白洋淀去过四次，那里的温泉过去两次，年中 Team Building 再喜加一，而这一次让这里有了美丽故事。喷泉、沙发，出现了对的人。\u003c/p\u003e\n\u003ch2 id=\"ios\"\u003eiOS\u003c/h2\u003e\n\u003cp\u003eReact Native 的一波尝试后，走上了移动开发的道。Swift 让上 iOS 车的门槛降低不少，Swift API 趋向稳定，可以说这是最好的时候。GitHub 应该是再也放不下了，外文的书籍、文档确实靠谱啊，推荐一个教程网站 \u003ca href=\"https://www.raywenderlich.com/category/ios\"\u003eiOS Tutorials - Ray Wenderlich\u003c/a\u003e 真的零基础入门。\u003c/p\u003e\n\u003cp\u003e我相信：一个人语言的界限，就是他世界的边界。\u003c/p\u003e\n\u003ch2 id=\"自如\"\u003e自如\u003c/h2\u003e\n\u003cp\u003e一场大火让无数人无家可归，年末换房也受牵连。被自如圈粉，其他中介的房子真的太 low 了。自如订房子居然也要抢，一波三折、失而复得。在没抢到房子时，真的想走，想离开这里了，很凄凉。最终是在公司对面住下了，过上了在家吃中饭晚饭的日子。\u003c/p\u003e\n\u003ch2 id=\"2018-happy-new-year\"\u003e2018 Happy New Year\u003c/h2\u003e\n\u003cp\u003e2017 自己是幸运的，2018 猥琐发育，不要浪，胜利属于伏地魔。\u003c/p\u003e","title":"回顾 2017"},{"content":"主要内容：【历史穿梭】、【改变历史】、【Git 克隆】\n历史穿梭 查看条件个数：\ngit rev-list HEAD | wc -l 版本表示法：git rev-parse git rev-parse pick out and massage parameters for other git commands.\n--git-dir 可以显示 Git 版本库的位置 --show-cdup 当前工作区目录的深度 --parseopt 可以用于被 Git 无关应用用于解析命令行参数 # 显示分支，tag git rev-parse --symbolic --branches git rev-parse --symbolic --branches # 显示定义的所有引用 git rev-parse --symbolic --glob=refs/* # 显示多个表达式的 SHA1 哈希值： git rev-parse master refs/heads/master 6652a0dce6a5067732c00ef0a220810a7230655e 6652a0dce6a5067732c00ef0a220810a7230655e ^后面的数字代表该提交的第几个父提交，~\u0026lt;n\u0026gt;就相当于连续\u0026lt;n\u0026gt;个符号^ git rev-parse A~3 A^^^ e80aa7481beda65ae00e35afc4bc4b171f9b0ebf e80aa7481beda65ae00e35afc4bc4b171f9b0ebf # 暂存区里的文件和HEAD中的文件相同 git rev-parse :gitg.png HEAD:gitg.png fc58966ccc1e5af24c2c9746196550241bc01c50 fc58966ccc1e5af24c2c9746196550241bc01c50 # 在提交日志中查找字串的方式显示提交 git rev-parse :/\u0026#34;Commit A\u0026#34; 81993234fc12a325d303eccea20f6fd629412712 版本范围表示法：git rev-list git rev-list 可以帮助研究 Git 的各种版本范围语法。\n# 从开始到 tag：A 的所有历史提交 git rev-list --oneline A # 每个 tag 历史提交的并集 git rev-list --oneline D F # ^ 排除这个版本及其历史版本 git rev-list --oneline ^G D # ^G D 等价于 G..D git rev-list --oneline G..D # 含 ^ 的参数顺序不重要，.. # ^B C 相当于 B..C # C ^B 相当于 B..C # C..B 相当于 ^C B 浏览日志：git --graph 参数调用 git log 可以显示字符界面的提交关系图。\ngit config --global alias.glog \u0026#34;log --graph\u0026#34; --oneline 单行显示 -\u0026lt;n\u0026gt; 显示最近的 条日志 -p 显示变动 --stat 显示变动摘要 查看、分析某一个提交：\ngit show D --stat tag D ... git cat-file -p D^0 差异比较：git diff 比较里程碑 B 和里程碑 A，用命令：git diff B A 比较工作区和里程碑 A，用命令：git diff A 比较暂存区和里程碑 A，用命令：git diff -cached A 比较工作区和暂存区，用命令：git diff 比较暂存区和 HEAD，用命令：git diff -cached 比较工作区和 HEAD，用命令：git diff HEAD 显示不同版本下的文件差异：\ngit diff \u0026lt;commit1\u0026gt; \u0026lt;commit2\u0026gt; -- \u0026lt;paths\u0026gt; 非 Git 目录/文件的差异比较，可在版本库之外使用：\ngit diff \u0026lt;path1\u0026gt; \u0026lt;path2\u0026gt; --word-diff 差异逐 词 比较，而非缺省的逐 行 比较 文件追溯：git blame 逐行显示文件，在每一行的行首显示此行最早是在什么版本引入的，由谁引入。\n只想查看某几行，使用 -L n,m 参数：\ngit blame -L 6,+5 README 二分查找：git bisect 定位问题代码。\n改变历史 作为分布式版本控制系统，一旦版本库被多人共享，改变历史就可能是无法完成的任务。\n悔棋 git commit –amend 单步悔棋，修补式提交。\n检出文件到前一版：\ngit checkout HEAD^ -- src/hello.h 多步悔棋 git reset --soft HEAD^^ 回到未来 拣选指令 git cherry-pick 从众多的提交中挑选出一个提交应用在当前的工作分支中。\n该命令需要提供一个提交 ID 作为参数，操作过程相当于将该提交导出为补丁文件，然后在当前 HEAD 上重放形成无论内容还是提交说明都一致的提交。\n操作例子：A B C D E F 6 次提交。\n例子 1.1：出掉 D：\n# 将 HEAD 指针切换到 C git checkout C # 拣选将 E 提交在当前 HEAD 上 git cherry-pick E # 拣选操作将 F 提交在当前 HEAD 上 git cherry-pick master # 将 master 分支指向新的提交 ID（f677821）上 git checkout master git reset --hard HEAD@{1} 例子 1.2：D 融入 C：\ngit checkout D # 将 C 和 D 融合 git reset --soft HEAD^^ # 提交说明重用C提交的提交说明 git commit -C C git cherry-pick E git cherry-pick F git rebase 对提交执行变基操作，即可以实现将指定范围的提交“嫁接”到另外一个提交之上。\ngit rebase --onto \u0026lt;newbase\u0026gt; \u0026lt;since\u0026gt; \u0026lt;till\u0026gt; 变基操作的过程：\n首先执行 git checkout ，如果 till 不是一个分支，则变基操作是在 detached HEAD 分离头指针 状态的，当变基结束后，对 master 分支执行重置以实现把变基结果记录在分支中。 将..所标识的提交范围写到一个临时文件中。（..是指包括的所有历史提交排除以及的历史提交后形成的版本范围） 当前分支强制重置（git reset \u0026ndash;hard）到。 从保存在临时文件中的提交列表中，一个一个将提交按照顺序重新提交到重置之后的分支上。 如果遇到提交已经在分支中包含，跳过该提交。 如果在提交过程遇到冲突，变基过程暂停。用户解决冲突后，执行 git rebase –continue 继续变基操作。或者执行 git rebase –skip 跳过此提交。或者执行 git rebase –abort 就此终止变基操作切换到变基前的分支上。 例子 2.1：出掉 D：\ngit rebase --onto C D F # or git rebase --onto C E^ F 例子 2.2：D 融入 C：\ngit checkout D # C和D融合 git reset --soft HEAD^^ git add . # 复用 C 的提交信息 git commit -C C # 记住这个提交 ID，可以用 tag 的方法 git tag newbase git rebase --onto newbase E^ master -i 交互式变基方法。\n例子 3.1：出掉 D：\ngit rebase -i D^ # d, drop = remove commit # 提交 D 标示修改为 d 例子 3.2：D 融入 C：\ngit rebase -i C^ # 提交 D 标示修改为 s 丢弃历史 重点内容第一次 Get\n历史有的时候会成为负担。只保留最近的 100 次提交，抛弃之前的历史提交。那么应该如何操作呢？\n例：清除 tag A 之前的提交历史：\n# 查看里程碑A指向的目录树 git cat-file -p A^{tree} # 使用git commit-tree命令直接从该目录树创建提交 echo \u0026#34;Commit from tree of tag A.\u0026#34; | git commit-tree A^{tree} 8f7f94ba6a9d94ecc1c223aa4b311670599e1f86 # 命令git commit-tree的输出是一个提交的SHA1哈希值。 # 会发现这个提交没有历史提交，可以称之为孤儿提交。 git log 8f7f94ba6a9d94ecc1c223aa4b311670599e1f86 # 将master分支从里程碑到最新的提交全部迁移到刚刚生成的孤儿提交上。 git rebase --onto 8f7f94ba6a9d94ecc1c223aa4b311670599e1f86 A master 反转提交 git revert HEAD Git 克隆 鸡蛋不装在一个篮子里 1. git clone \u0026lt;repository\u0026gt; \u0026lt;directory\u0026gt; 2. git clone --bare \u0026lt;repository\u0026gt; \u0026lt;directory.git\u0026gt; 3. git clone --mirror \u0026lt;repository\u0026gt; \u0026lt;directory.git\u0026gt; 一般约定俗成裸版本库的目录名以 .git 为后缀。\n用法 3 区别于用法 2 之处在于用法 3 克隆出来的裸版本对上游版本库进行了注册，这样可以在裸版本库中使用 git fetch 命令和上游版本库进行持续同步。\n克隆生成裸版本库 git clone --bare /path/to/my/workspace/demo /path/to/repos/demo.git demo.git 目录就是版本库目录，不含工作区。\ngit --git-dir=/path/to/repos/demo.git config core.bare true # 向其 push git push /path/to/repos/demo.git 创建生成裸版本库 git init --bare /path/to/repos/demo-init.git References 2. Git 独奏 — GotGit ","permalink":"https://zyf.im/2017/12/25/got-git-reading-notes-solo-part4/","summary":"\u003cp\u003e主要内容：【历史穿梭】、【改变历史】、【Git 克隆】\u003c/p\u003e\n\u003ch2 id=\"历史穿梭\"\u003e历史穿梭\u003c/h2\u003e\n\u003cp\u003e查看条件个数：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003egit rev-list HEAD | wc -l\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"版本表示法git-rev-parse\"\u003e版本表示法：git rev-parse\u003c/h3\u003e\n\u003cp\u003e\u003ccode\u003egit rev-parse\u003c/code\u003e pick out and massage parameters for other git commands.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003e--git-dir\u003c/code\u003e 可以显示 Git 版本库的位置\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e--show-cdup\u003c/code\u003e 当前工作区目录的深度\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e--parseopt\u003c/code\u003e 可以用于被 Git 无关应用用于解析命令行参数\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e# 显示分支，tag\ngit rev-parse --symbolic --branches\n\ngit rev-parse --symbolic --branches\n\n# 显示定义的所有引用\ngit rev-parse --symbolic --glob=refs/*\n\u003c/code\u003e\u003c/pre\u003e\u003c!-- more --\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e# 显示多个表达式的 SHA1 哈希值：\n\ngit rev-parse  master  refs/heads/master\n6652a0dce6a5067732c00ef0a220810a7230655e\n6652a0dce6a5067732c00ef0a220810a7230655e\n\n^后面的数字代表该提交的第几个父提交，~\u0026lt;n\u0026gt;就相当于连续\u0026lt;n\u0026gt;个符号^\n\ngit rev-parse  A~3  A^^^\ne80aa7481beda65ae00e35afc4bc4b171f9b0ebf\ne80aa7481beda65ae00e35afc4bc4b171f9b0ebf\n\n# 暂存区里的文件和HEAD中的文件相同\n\ngit rev-parse  :gitg.png  HEAD:gitg.png\nfc58966ccc1e5af24c2c9746196550241bc01c50\nfc58966ccc1e5af24c2c9746196550241bc01c50\n\n# 在提交日志中查找字串的方式显示提交\ngit rev-parse :/\u0026#34;Commit A\u0026#34;\n81993234fc12a325d303eccea20f6fd629412712\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"版本范围表示法git-rev-list\"\u003e版本范围表示法：git rev-list\u003c/h3\u003e\n\u003cp\u003e\u003ccode\u003egit rev-list\u003c/code\u003e 可以帮助研究 Git 的各种版本范围语法。\u003c/p\u003e","title":"【Git 权威指南】读书笔记 - 独奏 - Part 4"},{"content":"自己也做了一次面试官。简历看到了很多，内容总结如下：\n一些感受 一些基本的技能感觉不用写，不会吸引什么注意力。所以要精懂一些特别的技能，技术点。 一些 “与产品沟通” “安排工作”，我觉的也不用写，也没什么吸引力。 简历要体出自己擅长的地方，特别的地方，其他的一笔带过就可以。 简历上的字词的细节我比较在意，iOS \u0026amp; IOS，Xcode \u0026amp; XCode。 有 GitHub Blog 绝对的好评，但要有内容。 基础知识、业务能力、性格、气场。 技能 基础 Objective-C Swift 内存管理机制，MRC \u0026amp; ARC 代理、通知、Block 回调机制 闭包 KVC，KVO 机制 CoreData FMBD 归档存储 SQLite NSUserDefaults runtime 运行机制，runloop 运行机制 GCD NSOperation NSThread 多线程编程 Socket 通信 单例 观察者 MVVM RESTful 业务 瀑布流 抽屉 断点续传 媒体流 瀑布流 SSO 单点登陆 Framework Cocoapods 支付宝 高德 二维码扫描 友盟 极光推送 短信验证 微信 微博登陆 支付 in-app purchase SDWebImage AFNetworking Alamofire SnapKit MBProgressHUD IM 环信 Spring 动画 ICSDrawer 侧滑菜单 AVOS Cloud SDK ZXing ZBar 二维码 XMPP 其他 Axure 良好英文文档阅读能力 职责 模块封装 上架 迭代 沟通 整体框架 KVO 监听实现自定义下拉刷新 针对不同的网络状态 设置不同的缓存策略 各种 SDK 集成 HTML5 Native 相互调用 奇巧淫技 自己对 iOS 的理解还并不深，如何面试更有经验的人？\n答：准备的问题可以自己并不太懂，只要问题靠谱，要做的就是多听。多听面试者的回答的状态，是含糊？是自信？是心虚？而且多听几位后也就大概其知道答案了。\n奇事 因为有机试题所以不止一位怀疑这是个圈套，面试是为了做功能。 References 招聘一个靠谱的 iOS 卓同学的 Swift 面试题 ","permalink":"https://zyf.im/2017/11/25/ios-recruitment-summary/","summary":"\u003cp\u003e自己也做了一次面试官。简历看到了很多，内容总结如下：\u003c/p\u003e\n\u003ch2 id=\"一些感受\"\u003e一些感受\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e一些基本的技能感觉不用写，不会吸引什么注意力。所以要精懂一些特别的技能，技术点。\u003c/li\u003e\n\u003cli\u003e一些 “与产品沟通” “安排工作”，我觉的也不用写，也没什么吸引力。\u003c/li\u003e\n\u003cli\u003e简历要体出自己擅长的地方，特别的地方，其他的一笔带过就可以。\u003c/li\u003e\n\u003cli\u003e简历上的字词的细节我比较在意，iOS \u0026amp; IOS，Xcode \u0026amp; XCode。\u003c/li\u003e\n\u003cli\u003e有 GitHub Blog 绝对的好评，但要有内容。\u003c/li\u003e\n\u003cli\u003e基础知识、业务能力、性格、气场。\u003c/li\u003e\n\u003c/ul\u003e\n\u003c!-- more --\u003e\n\u003ch2 id=\"技能\"\u003e技能\u003c/h2\u003e\n\u003ch3 id=\"基础\"\u003e基础\u003c/h3\u003e\n\u003col\u003e\n\u003cli\u003eObjective-C Swift\u003c/li\u003e\n\u003cli\u003e内存管理机制，MRC \u0026amp; ARC\u003c/li\u003e\n\u003cli\u003e代理、通知、Block 回调机制 闭包\u003c/li\u003e\n\u003cli\u003eKVC，KVO 机制\u003c/li\u003e\n\u003cli\u003eCoreData FMBD 归档存储 SQLite NSUserDefaults\u003c/li\u003e\n\u003cli\u003eruntime 运行机制，runloop 运行机制\u003c/li\u003e\n\u003cli\u003eGCD NSOperation NSThread 多线程编程\u003c/li\u003e\n\u003cli\u003eSocket 通信\u003c/li\u003e\n\u003cli\u003e单例 观察者\u003c/li\u003e\n\u003cli\u003eMVVM\u003c/li\u003e\n\u003cli\u003eRESTful\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch3 id=\"业务\"\u003e业务\u003c/h3\u003e\n\u003col\u003e\n\u003cli\u003e瀑布流 抽屉\u003c/li\u003e\n\u003cli\u003e断点续传 媒体流 瀑布流\u003c/li\u003e\n\u003cli\u003eSSO 单点登陆\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch3 id=\"framework\"\u003eFramework\u003c/h3\u003e\n\u003col\u003e\n\u003cli\u003eCocoapods\u003c/li\u003e\n\u003cli\u003e支付宝 高德 二维码扫描 友盟 极光推送 短信验证\u003c/li\u003e\n\u003cli\u003e微信 微博登陆 支付 in-app purchase\u003c/li\u003e\n\u003cli\u003eSDWebImage AFNetworking Alamofire SnapKit MBProgressHUD\u003c/li\u003e\n\u003cli\u003eIM 环信\u003c/li\u003e\n\u003cli\u003eSpring 动画\u003c/li\u003e\n\u003cli\u003eICSDrawer 侧滑菜单\u003c/li\u003e\n\u003cli\u003eAVOS Cloud SDK\u003c/li\u003e\n\u003cli\u003eZXing ZBar 二维码\u003c/li\u003e\n\u003cli\u003eXMPP\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch3 id=\"其他\"\u003e其他\u003c/h3\u003e\n\u003col\u003e\n\u003cli\u003eAxure\u003c/li\u003e\n\u003cli\u003e良好英文文档阅读能力\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2 id=\"职责\"\u003e职责\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003e模块封装\u003c/li\u003e\n\u003cli\u003e上架\u003c/li\u003e\n\u003cli\u003e迭代\u003c/li\u003e\n\u003cli\u003e沟通\u003c/li\u003e\n\u003cli\u003e整体框架\u003c/li\u003e\n\u003cli\u003eKVO 监听实现自定义下拉刷新\u003c/li\u003e\n\u003cli\u003e针对不同的网络状态 设置不同的缓存策略\u003c/li\u003e\n\u003cli\u003e各种 SDK 集成\u003c/li\u003e\n\u003cli\u003eHTML5 Native 相互调用\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2 id=\"奇巧淫技\"\u003e奇巧淫技\u003c/h2\u003e\n\u003cp\u003e自己对 iOS 的理解还并不深，如何面试更有经验的人？\u003c/p\u003e","title":"iOS 招聘总结"},{"content":"录制 GIF 推荐使用 LICEcap 小巧好用。\nGIF 查看方法 在 Mac 上双击 GIF 将是按帧查看一幅一幅的图片，按住 空格 可以动起来。也可以选择 GIF 图片直接点击空格预览。\nGIF 编辑 预览 在 Mac 中可以直接使用 预览 对 GIF 进行删除帧的操作。但是发现再次保存的 GIF 只播放一次，不会循环播放。\nPhotoshop 使用 Photoshop 打开 GIF，点击 窗口 -\u0026gt; 时间轴，可在时间轴中对图片进行编辑。文件 -\u0026gt; 导出 -\u0026gt; 存储为 Web 所用格式 然后在 循环选项 选择 永久。\n在这里也可以降低 图像大小 对图片进行压缩。\n点击 存储 导出新的 GIF。\n\u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2017/11/23/photoshop-edit-gif/","summary":"\u003ch2 id=\"录制-gif\"\u003e录制 GIF\u003c/h2\u003e\n\u003cp\u003e推荐使用 \u003ca href=\"https://www.cockos.com/licecap/\"\u003eLICEcap\u003c/a\u003e 小巧好用。\u003c/p\u003e\n\u003ch2 id=\"gif-查看方法\"\u003eGIF 查看方法\u003c/h2\u003e\n\u003cp\u003e在 Mac 上双击 GIF 将是按帧查看一幅一幅的图片，按住 \u003ccode\u003e空格\u003c/code\u003e 可以动起来。也可以选择 GIF 图片直接点击空格预览。\u003c/p\u003e\n\u003c!-- more --\u003e\n\u003ch2 id=\"gif-编辑\"\u003eGIF 编辑\u003c/h2\u003e\n\u003ch3 id=\"预览\"\u003e预览\u003c/h3\u003e\n\u003cp\u003e在 Mac 中可以直接使用 \u003ccode\u003e预览\u003c/code\u003e 对 GIF 进行删除帧的操作。但是发现再次保存的 GIF 只播放一次，不会循环播放。\u003c/p\u003e\n\u003ch3 id=\"photoshop\"\u003ePhotoshop\u003c/h3\u003e\n\u003cp\u003e使用 Photoshop 打开 GIF，点击 \u003ccode\u003e窗口 -\u0026gt; 时间轴\u003c/code\u003e，可在时间轴中对图片进行编辑。\u003ccode\u003e文件 -\u0026gt; 导出 -\u0026gt; 存储为 Web 所用格式\u003c/code\u003e 然后在 \u003ccode\u003e循环选项\u003c/code\u003e 选择 \u003ccode\u003e永久\u003c/code\u003e。\u003c/p\u003e\n\u003cp\u003e在这里也可以降低 \u003ccode\u003e图像大小\u003c/code\u003e 对图片进行压缩。\u003c/p\u003e\n\u003cp\u003e点击 \u003ccode\u003e存储\u003c/code\u003e 导出新的 GIF。\u003c/p\u003e\n\u003cp\u003e\u0026ndash; EOF \u0026ndash;\u003c/p\u003e","title":"Photoshop 编辑 GIF"},{"content":"遇到的问题 在编写 GitHub 的 README.md 后，其中引用的网络图片无法正常显示，点击 alt 的文字提示：Content length exceeded。\n分析 根据 About anonymized image URLs 这篇文章：上传的图片 URL 将被修改，所以个人信息将不会被跟踪。GitHub 将使用 开源项目 Camo。Camo 将为每一个图片生成一个以 https://camo.githubusercontent.com/ 匿名代理 URL 同时隐藏来自其他用户的浏览器详细信息和相关信息。\n我引用的 GIF 图片有 7MB 多，那么图片大小的限制是多少？\ncamo - server.coffee#L18\ncontent_length_limit = parseInt(process.env.CAMO_LENGTH_LIMIT || 5242880, 10) 换算后大小正好是 5MB。\nReferences 关于 GitHub 无法图片加载的问题 ","permalink":"https://zyf.im/2017/11/22/github-readme-content-length-exceeded/","summary":"\u003ch2 id=\"遇到的问题\"\u003e遇到的问题\u003c/h2\u003e\n\u003cp\u003e在编写 GitHub 的 README.md 后，其中引用的网络图片无法正常显示，点击 \u003ccode\u003ealt\u003c/code\u003e 的文字提示：\u003ccode\u003eContent length exceeded\u003c/code\u003e。\u003c/p\u003e\n\u003c!-- more --\u003e\n\u003ch2 id=\"分析\"\u003e分析\u003c/h2\u003e\n\u003cp\u003e根据 \u003ca href=\"https://help.github.com/articles/about-anonymized-image-urls/\"\u003eAbout anonymized image URLs\u003c/a\u003e 这篇文章：上传的图片 URL 将被修改，所以个人信息将不会被跟踪。GitHub 将使用 \u003ca href=\"https://github.com/atmos/camo\"\u003e开源项目 Camo\u003c/a\u003e。Camo 将为每一个图片生成一个以 \u003ccode\u003ehttps://camo.githubusercontent.com/\u003c/code\u003e 匿名代理 URL 同时隐藏来自其他用户的浏览器详细信息和相关信息。\u003c/p\u003e\n\u003cp\u003e我引用的 GIF 图片有 \u003cstrong\u003e7MB\u003c/strong\u003e 多，那么图片大小的限制是多少？\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://github.com/atmos/camo/blob/master/server.coffee#L18\"\u003ecamo - server.coffee#L18\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-txt\" data-lang=\"txt\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003econtent_length_limit = parseInt(process.env.CAMO_LENGTH_LIMIT || 5242880, 10)\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e换算后大小正好是 \u003cstrong\u003e5MB\u003c/strong\u003e。\u003c/p\u003e\n\u003ch2 id=\"references\"\u003eReferences\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"http://soyaine.cn/blog/2016/12/31/soyaine-daily-070\"\u003e关于 GitHub 无法图片加载的问题\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e","title":"关于 GitHub README.md 中图片加载失败"},{"content":"Ubuntu ssh -oProxyCommand=\u0026#34;nc -x 127.0.0.1:1080 %h %p\u0026#34; ubuntu@111.111.1.1 Mac ssh -o \u0026#34;ProxyCommand nc -X 5 -x 127.0.0.1:1080 %h %p\u0026#34; ubuntu@111.111.1.1 SecoureCRT Session Options - Connection - SSH2 - Firewall，创建、选择代理。\n参数 -o ProxyCommand：SSH 命令选项，你可以理解成使用 “在 SSH 中使用代理”。 nc：netcat 命令。 127.0.0.1:1080：本地 Shadowsocks 的监听地址和监听端口。 命令行 HTTP 代理 export http_proxy=http://127.0.0.1:1087;export https_proxy=http://127.0.0.1:1087; 鉴别自己是否真的使用了代理来登陆服务器 root@ubuntu:~# who root pts/2 2017-05-13 18:13 (xxx.xxx.xxx.xxx) References Mac OS 使用 shadowsock 来代理 ssh 访问服务器 \u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2017/10/28/linux-or-mac-ssh-by-proxy/","summary":"\u003ch2 id=\"ubuntu\"\u003eUbuntu\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003essh -oProxyCommand\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;nc -x 127.0.0.1:1080 %h %p\u0026#34;\u003c/span\u003e ubuntu@111.111.1.1\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"mac\"\u003eMac\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003essh -o \u003cspan class=\"s2\"\u003e\u0026#34;ProxyCommand nc -X 5 -x 127.0.0.1:1080 %h %p\u0026#34;\u003c/span\u003e ubuntu@111.111.1.1\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c!-- more --\u003e\n\u003ch2 id=\"secourecrt\"\u003eSecoureCRT\u003c/h2\u003e\n\u003cp\u003eSession Options - Connection - SSH2 - Firewall，创建、选择代理。\u003c/p\u003e\n\u003ch2 id=\"参数\"\u003e参数\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003e-o ProxyCommand\u003c/code\u003e：SSH 命令选项，你可以理解成使用 “在 SSH 中使用代理”。\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003enc\u003c/code\u003e：netcat 命令。\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e127.0.0.1:1080\u003c/code\u003e：本地 Shadowsocks 的监听地址和监听端口。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"命令行-http-代理\"\u003e命令行 HTTP 代理\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eexport\u003c/span\u003e \u003cspan class=\"nv\"\u003ehttp_proxy\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003ehttp://127.0.0.1:1087\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"nb\"\u003eexport\u003c/span\u003e \u003cspan class=\"nv\"\u003ehttps_proxy\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003ehttp://127.0.0.1:1087\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"鉴别自己是否真的使用了代理来登陆服务器\"\u003e鉴别自己是否真的使用了代理来登陆服务器\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eroot@ubuntu:~# who\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eroot     pts/2        2017-05-13 18:13 \u003cspan class=\"o\"\u003e(\u003c/span\u003exxx.xxx.xxx.xxx\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"references\"\u003eReferences\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.goodspb.net/mac-os-%E4%BD%BF%E7%94%A8-shadowsock-%E6%9D%A5%E4%BB%A3%E7%90%86-ssh-%E8%AE%BF%E9%97%AE%E6%9C%8D%E5%8A%A1%E5%99%A8/\"\u003eMac OS 使用 shadowsock 来代理 ssh 访问服务器\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u0026ndash; EOF \u0026ndash;\u003c/p\u003e","title":"Linux Mac 使用代理连接 SSH"},{"content":"现在自己的开发主力机是：2015 版的 MacBook Pro。对于工程师来讲，MacBook 绝对是用来提高生产力的，不是装杯的。如果条件允许十分推荐，反正我是回不来了。\n一些感受 购买型号选择：15 寸 i7 Pro 没的说，屏大看的很爽。 F1\u0026hellip; 等键并有没有原来想象的那么重要，游览器刷新什么的都有代替的键。我感觉 F 系列的键默认为功能键挺好的。Filco 键盘开始吃灰。 续航时间是真的长，待机功耗很小，不用关机。扣上盖子装包带走，不拿充电线。 触控板真的好用。原来都是没鼠标时不得已才用触控板。(后来发现老司机们都爱触控板) 鼠标 - 滚动方向：自然，需要适应。 Chrome Tab 随便开。 很安静。 装包时边沿有些割手。 软件推荐 2020-03-25 更新： My MacBook | Yifans_Z。\n\u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2017/10/28/simple-macbook-report/","summary":"\u003cp\u003e现在自己的开发主力机是：2015 版的 MacBook Pro。对于工程师来讲，MacBook 绝对是用来提高生产力的，不是装杯的。如果条件允许十分推荐，反正我是回不来了。\u003c/p\u003e\n\u003c!-- more --\u003e\n\u003ch2 id=\"一些感受\"\u003e一些感受\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e购买型号选择：15 寸 i7 Pro 没的说，屏大看的很爽。\u003c/li\u003e\n\u003cli\u003eF1\u0026hellip; 等键并有没有原来想象的那么重要，游览器刷新什么的都有代替的键。我感觉 F 系列的键默认为功能键挺好的。Filco 键盘开始吃灰。\u003c/li\u003e\n\u003cli\u003e续航时间是真的长，待机功耗很小，不用关机。扣上盖子装包带走，不拿充电线。\u003c/li\u003e\n\u003cli\u003e触控板真的好用。原来都是没鼠标时不得已才用触控板。(后来发现老司机们都爱触控板)\u003c/li\u003e\n\u003cli\u003e鼠标 - 滚动方向：自然，需要适应。\u003c/li\u003e\n\u003cli\u003eChrome Tab 随便开。\u003c/li\u003e\n\u003cli\u003e很安静。\u003c/li\u003e\n\u003cli\u003e装包时边沿有些割手。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"软件推荐\"\u003e软件推荐\u003c/h2\u003e\n\u003cp\u003e\u003cstrong\u003e2020-03-25 更新：\u003c/strong\u003e \u003ca href=\"/2019/05/20/my-macbook/\"\u003eMy MacBook | Yifans_Z\u003c/a\u003e。\u003c/p\u003e\n\u003cp\u003e\u0026ndash; EOF \u0026ndash;\u003c/p\u003e","title":"MacBook 使用小感"},{"content":"在代码合并时遇到 conflict 是常有的事情，有些内容是自动生成的资源文件，手工处理起来很麻烦，某一文件如何全部以某一分支的内容为准？\n使用 checkout --theirs . checkout --ours .。\n场景实例 Engineer A、B 同时从 master checkout 自己的功能分支：\n# Engineer A git checkout -b feature-a # Engineer B git checkout -b feature-b Engineer A 开发比较快先进行了 push：\ngit add . git commit -m \u0026#34;feat: feature-a\u0026#34; git checkout master git merge feature-a git push Engineer B 再 push 前需要拉最新的 master，因为改到了同一行代码，出现代码冲突。\nmerge 合并代码 使用 merge 命令导致的代码冲突。\ngit checkout master git pull git merge feature-a 在处理冲突的过程中：\n# 以自己（Engineer B）的代码为准 git checkout --ours . git checkout --ours file.txt # 以他人（Engineer A）的代码为准 git checkout --theirs . rebase 合并代码 使用 rebase 命令导致的代码冲突。\ngit checkout master git merge feature-a git pull --rebase 在处理冲突的过程中：\n# 以自己（Engineer B）的代码为准；与 merge 相反，可以理解为 rebase 时主干是他人的分支 git checkout --theirs . # 以他人（Engineer A）的代码为准；与 merge 相反，可以理解为 rebase 时主干是他人的分支 git checkout --ours . References 化解冲突：git merge 与 git rebase 中的 ours 和 theirs ","permalink":"https://zyf.im/2017/08/30/git-checkout-theirs-resolve-conflict/","summary":"\u003cp\u003e在代码合并时遇到 \u003ccode\u003econflict\u003c/code\u003e 是常有的事情，有些内容是自动生成的资源文件，手工处理起来很麻烦，某一文件如何全部以某一分支的内容为准？\u003c/p\u003e\n\u003cp\u003e使用 \u003ccode\u003echeckout --theirs .\u003c/code\u003e \u003ccode\u003echeckout --ours .\u003c/code\u003e。\u003c/p\u003e\n\u003c!-- more --\u003e\n\u003ch2 id=\"场景实例\"\u003e场景实例\u003c/h2\u003e\n\u003cp\u003eEngineer A、B 同时从 master checkout 自己的功能分支：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Engineer A\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit checkout -b feature-a\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Engineer B\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit checkout -b feature-b\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eEngineer A 开发比较快先进行了 push：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit add .\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit commit -m \u003cspan class=\"s2\"\u003e\u0026#34;feat: feature-a\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit checkout master\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit merge feature-a\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit push\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eEngineer B 再 push 前需要拉最新的 master，因为改到了同一行代码，出现代码冲突。\u003c/p\u003e\n\u003ch3 id=\"merge-合并代码\"\u003emerge 合并代码\u003c/h3\u003e\n\u003cp\u003e使用 merge 命令导致的代码冲突。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit checkout master\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit pull\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit merge feature-a\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e在处理冲突的过程中：\u003c/p\u003e","title":"Git checkout --theirs --ours 解决冲突文件"},{"content":"主要内容：【Git 基本操作】\nGit 基本操作 先来合个影 在 Git 里，“留影”用的命令叫做 tag，更加专业的术语叫做“里程碑”（打 tag，或打标签）。\ngit tag -m \u0026#34;Say bye-bye to all previous practice.\u0026#34; old_practice 里程碑无非也是一个引用，通过记录提交 ID（或者创建 Tag 对象）来为当前版本库状态进行“留影”。\ngit rev-parse refs/tags/old_practice 41bd4e2cce0f8baa9bb4cdda62927b408c846cd6 git describe 显示当前版本库的最新提交的版本号。格式：最近的 tag - 距离此 tag 的个数 - 该提交的 SHA1\ngit describe old_practice # .. commit something git describe old_practice-2-g8861c65 删除文件 rm *.txt 针对的是 工作区，对 暂存区 和 版本库 没有任何影响。\ngit rm detached-commit.txt hack-1.txt new-commit.txt welcome.txt 删除动作加入了暂存区，commit 后在版本库罪行提交中删除了，在历史提交中尚在。\n可以通过下面命令查看历史版本的文件列表：\ngit ls-files --with-tree=HEAD^ detached-commit.txt new-commit.txt welcome.txt 查看在历史版本中尚在的删除文件的内容：\ngit cat-file -p HEAD^:welcome.txt Hello. Nice to meet you. git add -u 命令会对工作区中 所有改动 以及 删除文件 添加到暂存区。\n恢复删除的文件 git cat-file -p HEAD~1:welcome.txt \u0026gt; welcome.txt 然后加入暂存区，提交到版本库：\ngit add -A git commit -m \u0026#34;restore file: welcome.txt\u0026#34; 这是通过再次添加的方式恢复被删除的文件。\ngit add -A 命令会对工作区中 所有改动 以及 新增文件 添加到暂存区。\n移动文件 git mv welcome.txt README 交互界面 git add -i 文件忽略 cat \u0026gt; .gitignore \u0026lt;\u0026lt; EOF \u0026gt; hello \u0026gt; *.o \u0026gt; *.h \u0026gt; EOF 查看被忽略的文件：\ngit status --ignored -s 将忽略的文件强制添加到仓库中：\ngit add -f hello.h git commit -m \u0026#34;add hello.h\u0026#34; [master 48456ab] add hello.h 1 files changed, 1 insertions(+), 0 deletions(-) create mode 100644 src/hello.h 忽略只对未跟踪文件有效，对于已加入版本库的文件无效。 将 hello.h 添加到版本库后，对 hello.h 的修改都会立刻被跟踪到。.gitignore 只是对未入库的文件起作用。\n本地独享式忽略文件\n.gitignore 设置的文件忽略是共享式的，是因为.gitignore 被添加到版本库后成为了版本库的一部分，文件忽略在他人的工作区中同样生效。\n享式忽略有两种方式：\n在版本库.git 目录下的一个文件.git/info/exclude 来设置文件忽略。 通过 Git 的配置变量 core.excludesfile 指定的一个忽略文件，其设置的忽略对所有文件均有效。 git config --global core.excludesfile /home/jiangxin/_gitignore git config core.excludesfile /home/jiangxin/_gitignore cat /home/jiangxin/_gitignore *~ # vim 临时文件 *.pyc # python 的编译文件 .*.mmx # 不是正则表达式哦，因为 FreeMind-MMX 的辅助文件以点开头 Git 忽略语法\n# 表示开始的行被忽略。 通配符。* 任意多字符，? 一个字符，[abc] 可选字符范围。 最后面是一个 / 表示忽略的是整个目录，同名文件不忽略，否则同名的文件和目录都忽略。 最前面 ! 表示不忽略。 # 这是注释行 —— 被忽略 *.a # 忽略所有以 .a 为扩展名的文件。 !lib.a # 但是 lib.a 文件或者目录不要忽略，即使前面设置了对 *.a 的忽略。 /TODO # 只忽略根目录下的 TODO 文件，子目录的 TODO 文件不忽略。 build/ # 忽略所有 build/ 目录下的文件。 doc/*.txt # 忽略文件如 doc/notes.txt，但是文件如 doc/server/arch.txt 不被忽略。 文件归档 如果想压缩工作区文件归档，可能一不小心会把版本库（.git 目录）包含其中，甚至将工作区中的忽略文件、临时文件也包含其中。所以 Git 提供了一个归档命令 git archive。\n# 基于最新提交建立归档文件latest.zip git archive -o latest.zip HEAD # 只将目录 src 和 doc 建立到归档 partial.tar 中 git archive -o partial.tar HEAD src doc # 基于里程碑v1.0建立归档，并且为归档中文件添加目录前缀1.0 git archive --format=tar --prefix=1.0/ v1.0 | gzip \u0026gt; foo-1.0.tar.gz References 2. Git 独奏 — GotGit ","permalink":"https://zyf.im/2017/08/03/got-git-reading-notes-solo-part3/","summary":"\u003cp\u003e主要内容：【Git 基本操作】\u003c/p\u003e\n\u003ch2 id=\"git-基本操作\"\u003eGit 基本操作\u003c/h2\u003e\n\u003ch3 id=\"先来合个影\"\u003e先来合个影\u003c/h3\u003e\n\u003cp\u003e在 Git 里，“留影”用的命令叫做 \u003ccode\u003etag\u003c/code\u003e，更加专业的术语叫做“里程碑”（打 tag，或打标签）。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit tag -m \u003cspan class=\"s2\"\u003e\u0026#34;Say bye-bye to all previous practice.\u0026#34;\u003c/span\u003e old_practice\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e里程碑无非也是一个引用，通过记录提交 ID（或者创建 Tag 对象）来为当前版本库状态进行“留影”。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit rev-parse refs/tags/old_practice\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e41bd4e2cce0f8baa9bb4cdda62927b408c846cd6\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003ccode\u003egit describe\u003c/code\u003e 显示当前版本库的最新提交的版本号。格式：\u003ccode\u003e最近的 tag - 距离此 tag 的个数 - 该提交的 SHA1\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit describe\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eold_practice\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# .. commit something\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit describe\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eold_practice-2-g8861c65\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c!-- more --\u003e\n\u003ch3 id=\"删除文件\"\u003e删除文件\u003c/h3\u003e\n\u003cp\u003e\u003ccode\u003erm *.txt\u003c/code\u003e 针对的是 \u003ccode\u003e工作区\u003c/code\u003e，对 \u003ccode\u003e暂存区\u003c/code\u003e 和 \u003ccode\u003e版本库\u003c/code\u003e 没有任何影响。\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003egit rm detached-commit.txt hack-1.txt new-commit.txt welcome.txt\u003c/code\u003e 删除动作加入了暂存区，commit 后在版本库罪行提交中删除了，在历史提交中尚在。\u003c/p\u003e","title":"【Git 权威指南】读书笔记 - 独奏 - Part 3"},{"content":"【注意】内容不再维护。\nReact 介绍 初识 React React 不是一个完整的 MVC、MVVM 框架，其只负责 View 层，MVC 已经不适用于某些场景的开发 React 跟 Web Components 不冲突 React 的特点就是“轻”，数据单向绑定，独立、小巧、快速、创新 组件化的开发思路，小组件构成大组件，高度可重用 React 应用场景 复杂场景下的高性能 重用组件库，组件组合 “懒”，少做无用功 你总是这样轻言放弃的话，无论过多久都只会原地踏步。 —— 多啦 a 梦\n前置知识 JS CSS Sass Compass Yeoman Grunt Webpack CommonJS NodeJS Git GitHub To Be A Better Engineer 无论知识有多新、项目有多难，只要来了什么姿势都要上 没人疼、没人爱，团队中没人可以帮上忙，要学会借助外力，视频、Google、开源项目 积极要求进步 React 的 JSX 与 Style 官网：React - A JavaScript library for building user interfaces\n罐头是 1810 发明出来的，可是开罐器呢，却在 1858 年才发明出来。有时就是这样，重要的东西可能迟来一步，但却一定会到。生活和爱情，都是如此。程序，当然也不例外。\n\u0026lt;!DOCTYPE html\u0026gt; \u0026lt;html lang=\u0026#34;en\u0026#34;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026#34;UTF-8\u0026#34; /\u0026gt; \u0026lt;meta name=\u0026#34;viewport\u0026#34; content=\u0026#34;width=device-width, initial-scale=1.0\u0026#34; /\u0026gt; \u0026lt;meta http-equiv=\u0026#34;X-UA-Compatible\u0026#34; content=\u0026#34;ie=edge\u0026#34; /\u0026gt; \u0026lt;title\u0026gt;Hello World\u0026lt;/title\u0026gt; \u0026lt;script src=\u0026#34;https://unpkg.com/react@latest/dist/react.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;script src=\u0026#34;https://unpkg.com/react-dom@latest/dist/react-dom.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;script src=\u0026#34;https://unpkg.com/babel-standalone@6.15.0/babel.min.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;style\u0026gt; .fontcolor { color: blue !important; } \u0026lt;/style\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;div id=\u0026#34;root\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;script type=\u0026#34;text/babel\u0026#34;\u0026gt; var Hello = React.createClass({ render: function () { return \u0026lt;div className=\u0026#34;fontcolor\u0026#34;\u0026gt;Hello {this.props.name}!\u0026lt;/div\u0026gt;; }, }); class Welcome extends React.Component { render() { return \u0026lt;h1\u0026gt;Hello, {this.props.name}\u0026lt;/h1\u0026gt;; } } ReactDOM.render( \u0026lt;div\u0026gt; \u0026lt;Hello name=\u0026#34;World\u0026#34; /\u0026gt; \u0026lt;Welcome name=\u0026#34;World\u0026#34; /\u0026gt; \u0026lt;/div\u0026gt;, document.getElementById(\u0026#34;root\u0026#34;) ); \u0026lt;/script\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; 添加组件属性，有一个地方需要注意：class 属性需要写成 className ，for 属性需要写成 htmlFor ，这是因为 class 和 for 是 JavaScript 的保留字。然后，属性名都是驼峰命名法。\n正所谓粉末登场，远近起帆，风云更迭，嬉皮而黄，多少聚散于圆缺。\nReact 组件的生命周期和事件处理 React Components Lifecycle State and Lifecycle - React\nMounted：React Component 被 render 解析生成对应的 DOM 节点，并在插入浏览器的 DOM 结构的一个过程 Update：一个 mounted 的 React Component 被重新 render 的过程（只有影响了 DOM 结构时才会被改变） Unmounted：一个 mounted 的 React Component 对应的 DOM 节点被从 DOM 结构中移除的过程 每一个状态都封装了对应的 hook 函数。will and did hook.\nReact Event Listener Handling Events - React\nclass ClickBtn extends React.Component { handleClick(e) { e.preventDefault(); console.log(\u0026#34;The link was clicked.\u0026#34;); } render() { return ( \u0026lt;a href=\u0026#34;#\u0026#34; onClick={this.handleClick}\u0026gt; Click me \u0026lt;/a\u0026gt; ); } } ReactDOM.render( \u0026lt;div\u0026gt; \u0026lt;Hello name=\u0026#34;World\u0026#34; /\u0026gt; \u0026lt;Welcome name=\u0026#34;World\u0026#34; /\u0026gt; \u0026lt;ClickBtn /\u0026gt; \u0026lt;/div\u0026gt;, document.getElementById(\u0026#34;root\u0026#34;) ); 官方文档值得反复看。\nReferences React 入门课程介绍-慕课网 \u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2017/07/20/imooc-react-getting-started-tutorial/","summary":"\u003cp\u003e【注意】内容不再维护。\u003c/p\u003e\n\u003chr\u003e\n\u003ch2 id=\"react-介绍\"\u003eReact 介绍\u003c/h2\u003e\n\u003ch3 id=\"初识-react\"\u003e初识 React\u003c/h3\u003e\n\u003col\u003e\n\u003cli\u003eReact 不是一个完整的 MVC、MVVM 框架，其只负责 View 层，MVC 已经不适用于某些场景的开发\u003c/li\u003e\n\u003cli\u003eReact 跟 Web Components 不冲突\u003c/li\u003e\n\u003cli\u003eReact 的特点就是“轻”，数据单向绑定，独立、小巧、快速、创新\u003c/li\u003e\n\u003cli\u003e组件化的开发思路，小组件构成大组件，高度可重用\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch3 id=\"react-应用场景\"\u003eReact 应用场景\u003c/h3\u003e\n\u003col\u003e\n\u003cli\u003e复杂场景下的高性能\u003c/li\u003e\n\u003cli\u003e重用组件库，组件组合\u003c/li\u003e\n\u003cli\u003e“懒”，少做无用功\u003c/li\u003e\n\u003c/ol\u003e\n\u003cblockquote\u003e\n\u003cp\u003e你总是这样轻言放弃的话，无论过多久都只会原地踏步。 —— 多啦 a 梦\u003c/p\u003e\u003c/blockquote\u003e\n\u003ch3 id=\"前置知识\"\u003e前置知识\u003c/h3\u003e\n\u003col\u003e\n\u003cli\u003eJS CSS\u003c/li\u003e\n\u003cli\u003eSass Compass\u003c/li\u003e\n\u003cli\u003eYeoman Grunt Webpack\u003c/li\u003e\n\u003cli\u003eCommonJS NodeJS\u003c/li\u003e\n\u003cli\u003eGit GitHub\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch3 id=\"to-be-a-better-engineer\"\u003eTo Be A Better Engineer\u003c/h3\u003e\n\u003col\u003e\n\u003cli\u003e无论知识有多新、项目有多难，只要来了什么姿势都要上\u003c/li\u003e\n\u003cli\u003e没人疼、没人爱，团队中没人可以帮上忙，要学会借助外力，视频、Google、开源项目\u003c/li\u003e\n\u003cli\u003e积极要求进步\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2 id=\"react-的-jsx-与-style\"\u003eReact 的 JSX 与 Style\u003c/h2\u003e\n\u003cp\u003e官网：\u003ca href=\"https://facebook.github.io/react/\"\u003eReact - A JavaScript library for building user interfaces\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e罐头是 1810 发明出来的，可是开罐器呢，却在 1858 年才发明出来。有时就是这样，重要的东西可能迟来一步，但却一定会到。生活和爱情，都是如此。程序，当然也不例外。\u003c/p\u003e\u003c/blockquote\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-html\" data-lang=\"html\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cp\"\u003e\u0026lt;!DOCTYPE html\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003ehtml\u003c/span\u003e \u003cspan class=\"na\"\u003elang\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;en\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003ehead\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003emeta\u003c/span\u003e \u003cspan class=\"na\"\u003echarset\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;UTF-8\u0026#34;\u003c/span\u003e \u003cspan class=\"p\"\u003e/\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003emeta\u003c/span\u003e \u003cspan class=\"na\"\u003ename\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;viewport\u0026#34;\u003c/span\u003e \u003cspan class=\"na\"\u003econtent\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;width=device-width, initial-scale=1.0\u0026#34;\u003c/span\u003e \u003cspan class=\"p\"\u003e/\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003emeta\u003c/span\u003e \u003cspan class=\"na\"\u003ehttp-equiv\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;X-UA-Compatible\u0026#34;\u003c/span\u003e \u003cspan class=\"na\"\u003econtent\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;ie=edge\u0026#34;\u003c/span\u003e \u003cspan class=\"p\"\u003e/\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003etitle\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003eHello World\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003etitle\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003escript\u003c/span\u003e \u003cspan class=\"na\"\u003esrc\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;https://unpkg.com/react@latest/dist/react.js\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003escript\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003escript\u003c/span\u003e \u003cspan class=\"na\"\u003esrc\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;https://unpkg.com/react-dom@latest/dist/react-dom.js\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003escript\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003escript\u003c/span\u003e \u003cspan class=\"na\"\u003esrc\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;https://unpkg.com/babel-standalone@6.15.0/babel.min.js\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003escript\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003estyle\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nc\"\u003efontcolor\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003ecolor\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"kc\"\u003eblue\u003c/span\u003e \u003cspan class=\"cp\"\u003e!important\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003estyle\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003ehead\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003ebody\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003ediv\u003c/span\u003e \u003cspan class=\"na\"\u003eid\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;root\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003ediv\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003escript\u003c/span\u003e \u003cspan class=\"na\"\u003etype\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;text/babel\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      \u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003eHello\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003eReact\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ecreateClass\u003c/span\u003e\u003cspan class=\"p\"\u003e({\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nx\"\u003erender\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"kd\"\u003efunction\u003c/span\u003e \u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e          \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nx\"\u003ediv\u003c/span\u003e \u003cspan class=\"nx\"\u003eclassName\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;fontcolor\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"nx\"\u003eHello\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eprops\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"o\"\u003e!\u0026lt;\u003c/span\u003e\u003cspan class=\"err\"\u003e/div\u0026gt;;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"p\"\u003e},\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      \u003cspan class=\"p\"\u003e});\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      \u003cspan class=\"kr\"\u003eclass\u003c/span\u003e \u003cspan class=\"nx\"\u003eWelcome\u003c/span\u003e \u003cspan class=\"kr\"\u003eextends\u003c/span\u003e \u003cspan class=\"nx\"\u003eReact\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eComponent\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nx\"\u003erender\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e          \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nx\"\u003eh1\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"nx\"\u003eHello\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eprops\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"err\"\u003e/h1\u0026gt;;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      \u003cspan class=\"nx\"\u003eReactDOM\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003erender\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nx\"\u003ediv\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e          \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nx\"\u003eHello\u003c/span\u003e \u003cspan class=\"nx\"\u003ename\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;World\u0026#34;\u003c/span\u003e \u003cspan class=\"o\"\u003e/\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e          \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nx\"\u003eWelcome\u003c/span\u003e \u003cspan class=\"nx\"\u003ename\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;World\u0026#34;\u003c/span\u003e \u003cspan class=\"o\"\u003e/\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"err\"\u003e/div\u0026gt;,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nb\"\u003edocument\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003egetElementById\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;root\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003escript\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003ebody\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003ehtml\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e添加组件属性，有一个地方需要注意：\u003ccode\u003eclass\u003c/code\u003e 属性需要写成 \u003ccode\u003eclassName\u003c/code\u003e ，\u003ccode\u003efor\u003c/code\u003e 属性需要写成 \u003ccode\u003ehtmlFor\u003c/code\u003e ，这是因为 \u003ccode\u003eclass\u003c/code\u003e 和 \u003ccode\u003efor\u003c/code\u003e 是 JavaScript 的保留字。然后，属性名都是驼峰命名法。\u003c/p\u003e","title":"IMOOC React 入门"},{"content":"主要内容：【Git 重置】、【Git 检出】、【恢复进度】\nGit 重置 分支游标 master 的探秘 git log --graph --oneline * e695606 which version checked in? * a0c641e who does commit? * 9e8a761 initialized. 引用 refs/heads/master 就好像是一个游标，在有新的提交发生的时候指向了新的提交。\nGit 提供了 git reset 命令，可以将“游标”指向任意一个存在的提交 ID。注意下面的命令中使用了 --hard 参数，会破坏工作区未提交的改动，慎用。\ngit reset --hard HEAD^ HEAD is now at e695606 which version checked in? 用 reflog 挽救错误的重置 通过 .git/logs 目录下日志文件记录了分支的变更。默认非裸版本库（带有工作区）都提供分支日志功能，这是因为带有工作区的版本库都有如下设置：\ngit config core.logallrefupdates true 查看一下 master 分支的日志文件 .git/logs/refs/heads/master 中的内容。\ntail -5 .git/logs/refs/heads/master Git 提供了一个 git reflog 命令，对这个文件进行操作。\ngit reflog show master | head -5 9e8a761 master@{0}: 9e8a761: updating HEAD e695606 master@{1}: HEAD^: updating HEAD 4902dc3 master@{2}: commit: does master follow this new commit? ... 重置 master 为两次改变之前的值。\ngit reset --hard master@{2} 深入了解 git reset 命令 git reset [-q] [\u0026lt;commit\u0026gt;] [--] \u0026lt;paths\u0026gt;... git reset [--soft | --mixed | --hard | --merge | --keep] [-q] [\u0026lt;commit\u0026gt;] 为了避免路径和引用（或者提交 ID）同名而冲突，可以在 \u0026lt;paths\u0026gt; 前用两个连续的短线（减号）作为分隔。\n--hard 会执行上图中的 1、2、3 全部的三个动作。 替换引用的指向。引用指向新的提交 ID。 替换暂存区。替换后，暂存区的内容和引用指向的目录树一致。 替换工作区。替换后，工作区的内容变得和暂存区一致，也和 HEAD 所指向的目录树内容相同。 --soft 会执行上图中的操作 1。 --mixed（缺省）会执行上图中的操作 1 和操作 2。 git reset git reset HEAD # 仅用 HEAD 指向的目录树重置暂存区，工作区不会受到影响，相当于将之前用 git add 命令更新到暂存区的内容撤出暂存区。引用也未改变，因为引用重置到 HEAD 相当于没有重置。 git reset -- filename git reset HEAD filename # 仅将文件 filename 撤出暂存区，暂存区中其他文件不改变。相当于对命令 git add filename 的反向操作。 git reset --soft HEAD^ # 工作区和暂存区不改变，但是引用向前回退一次。当对最新提交的提交说明或者提交的更改不满意时，撤销最新的提交以便重新提交。git commit 的反向操作。 # 在之前曾经介绍过一个修补提交命令 git commit --amend，用于对最新的提交进行重新提交以修补错误的提交说明或者错误的提交文件。修补提交命令实际上相当于执行了下面两条命令。（注：文件 .git/COMMIT_EDITMSG 保存了上次的提交日志） git reset --soft HEAD^ git commit -e -F .git/COMMIT_EDITMSG git reset HEAD^ # 工作区不改变，但是暂存区会回退到上一次提交之前，引用也会回退一次。 git reset --hard HEAD^ # 彻底撤销最近的提交。引用回退到前一次，而且工作区和暂存区都会回退到上一次提交的状态。自上一次以来的提交全部丢失。 Git 检出 重置命令 git reset 的一个用途就是修改引用（如 master）的游标。如果 HEAD 要改变该如何改变呢？检出命令 git checkout 该命令的实质就是修改 HEAD 本身的指向，该命令不会影响分支“游标”（如 master）。\nHEAD 的重置即检出 git co HEAD^ Note: checking out \u0026#39;HEAD^\u0026#39;. You are in \u0026#39;detached HEAD\u0026#39; state. You can look around, make experimental changes and commit them, and you can discard any commits you make in this state without impacting any branches by performing another checkout. # 您现在处于 \u0026#39;分离头指针\u0026#39; 状态。您可以检查、测试和提交，而不影响任何分支。 # 通过执行另外的一个 checkout 检出指令会丢弃在此状态下的修改和提交。 If you want to create a new branch to retain commits you create, you may do so (now or later) by using -b with the checkout command again. Example: # 如果想保留在此状态下的修改和提交，使用 -b 参数调用 checkout 检出指令以 # 创建新的跟踪分支。如： git checkout -b \u0026lt;new-branch-name\u0026gt; HEAD is now at 3175afd... 什么叫做 detached HEAD “分离头指针”状态？查看一下此时 HEAD 的内容就明白了。\ncat .git/HEAD 3175afde9450a1dc40b09d05a012b45e967cb80f 原来“分离头指针”状态指的就是 HEAD 头指针指向了一个具体的提交 ID，而不是一个引用（分支）。注意上面的 reflog 是 HEAD 头指针的变迁记录，而非 master 分支。\n查看一下 HEAD 和 master 对应的提交 ID，会发现现在它们指向的不一样。\ngit rev-parse HEAD master 3175afde9450a1dc40b09d05a012b45e967cb80f bd08cb462d38b54b930cf1934b0c33f2e4592390 在“分离头指针”模式仍然可以进行提交：\ngit status HEAD detached at 3175afd ... 但是在 checkout 到其他分支时，刚才的提交会丢失，但是这个提交仍然在版本库中，由于这个提交没有被任何分支跟踪到，因此并不能保证这个提交会永久存在。\n实际上当 reflog 中含有该提交的日志过期后，这个提交随时都会从版本库中彻底清除。\n挽救分离头指针 在“分离头指针”模式下进行的测试提交除了使用提交 ID acc2f69 访问之外，不能通过 master 分支或其他引用访问到。使用合并操作 git merge 将提交 acc2f69 合并到 master 分支中来。\ngit merge acc2f69 Merge made by recursive. ... 恢复进度 继续暂存区未完成的实践 # 保存当前工作进度 git stash # 查看保存的进度用命令 git stash list # 最近保存的进度进行恢复 git stash pop git stash pop [--index] [\u0026lt;stash\u0026gt;] # --index 除了恢复工作区的文件外，还尝试恢复暂存区 # 从该 \u0026lt;stash\u0026gt; 中恢复 git stash [save [-p|--patch] [-k|--[no-]keep-index] [-q|--quiet] [-u|--include-untracked] [-a|--all] [\u0026lt;message\u0026gt;]] --patch 会显示工作区和 HEAD 的差异，通过对差异文件的编辑决定在进度中最终要保存的工作区的内容，通过编辑差异文件可以在进度中排除无关内容。 使用 -k 或者 --keep-index 参数，在保存进度后不会将暂存区重置。 # 不删除恢复的进度之外，其余和 git stash pop 命令一样 git stash apply [--index] [\u0026lt;stash\u0026gt;] # 删除一个存储的进度 git stash drop [\u0026lt;stash\u0026gt;] # 删除所有存储的进度 git stash clear # 基于进度创建分支 git stash branch \u0026lt;branchname\u0026gt; \u0026lt;stash\u0026gt; 探秘 git stash 在执行 git stash 命令时，Git 实际调用了一个脚本文件实现相关的功能。\ngit --exec-path /usr/lib/git-core file /usr/lib/git-core/git-stash /usr/lib/git-core/git-stash: POSIX shell script text executable 本地没有被版本控制系统跟踪的文件并不能保存进度。因此本地新文件需要执行添加 add 再执行 git stash 命令。\n在用 git stash 命令保存进度时，提供说明更容易找到对应的进度文件。\n每个进度的标识都是 stash@{\u0026lt;n\u0026gt;} 格式，像极了前面介绍的 reflog 的格式。git stash 的就是用到了前面介绍的引用和引用变更日志 reflog 来实现的。\n用 git stash 保存进度，实际上会将进度保存在引用 refs/stash 所指向的提交中。多次的进度保存，实际上相当于引用 refs/stash 一次又一次的变化，而 refs/stash 引用的变化由 reflog（即.git/logs/refs/stash）所记录下来。\n如何在引用 refs/stash 中同时保存暂存区的进度和工作区中的进度 git log --graph --pretty=raw refs/stash -2 * commit e5c0cdc2dedc3e50e6b72a683d928e19a1d9de48 |\\ tree 780c22449b7ff67e2820e09a6332c360ddc80578 | | parent 2b31c199d5b81099d2ecd91619027ab63e8974ef | | parent c5edbdcc90addb06577ff60f644acd1542369194 | | author Jiang Xin \u0026lt;jiangxin@ossxp.com\u0026gt; 1291623066 +0800 | | committer Jiang Xin \u0026lt;jiangxin@ossxp.com\u0026gt; 1291623066 +0800 | | | | WIP on master: 2b31c19 Merge commit \u0026#39;acc2f69\u0026#39; | | | * commit c5edbdcc90addb06577ff60f644acd1542369194 |/ tree 780c22449b7ff67e2820e09a6332c360ddc80578 | parent 2b31c199d5b81099d2ecd91619027ab63e8974ef | author Jiang Xin \u0026lt;jiangxin@ossxp.com\u0026gt; 1291623066 +0800 | committer Jiang Xin \u0026lt;jiangxin@ossxp.com\u0026gt; 1291623066 +0800 | | index on master: 2b31c19 Merge commit \u0026#39;acc2f69\u0026#39; 最新的提交说明中有 WIP（Work In Progess）字样，说明代表了工作区进度。而最新提交的第二个父提交（上图中显示为第二个提交）有 index on master 字样，说明这个提交代表着暂存区的进度。\nReferences 2. Git 独奏 — GotGit ","permalink":"https://zyf.im/2017/07/20/got-git-reading-notes-solo-part2/","summary":"\u003cp\u003e主要内容：【Git 重置】、【Git 检出】、【恢复进度】\u003c/p\u003e\n\u003ch2 id=\"git-重置\"\u003eGit 重置\u003c/h2\u003e\n\u003ch3 id=\"分支游标-master-的探秘\"\u003e分支游标 master 的探秘\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit log --graph --oneline\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e* e695606 which version checked in?\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e* a0c641e who does commit?\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e* 9e8a761 initialized.\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e引用 \u003ccode\u003erefs/heads/master\u003c/code\u003e 就好像是一个游标，在有新的提交发生的时候指向了新的提交。\u003c/p\u003e\n\u003cp\u003eGit 提供了 \u003ccode\u003egit reset\u003c/code\u003e 命令，可以将“游标”指向任意一个存在的提交 ID。注意下面的命令中使用了 \u003ccode\u003e--hard\u003c/code\u003e 参数，会破坏工作区未提交的改动，慎用。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit reset --hard HEAD^\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eHEAD is now at e695606 which version checked in?\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c!-- more --\u003e\n\u003ch3 id=\"用-reflog-挽救错误的重置\"\u003e用 reflog 挽救错误的重置\u003c/h3\u003e\n\u003cp\u003e通过 \u003ccode\u003e.git/logs\u003c/code\u003e 目录下日志文件记录了分支的变更。默认非裸版本库（带有工作区）都提供分支日志功能，这是因为带有工作区的版本库都有如下设置：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit config core.logallrefupdates\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003etrue\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e查看一下 \u003ccode\u003emaster\u003c/code\u003e 分支的日志文件 \u003ccode\u003e.git/logs/refs/heads/master\u003c/code\u003e 中的内容。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003etail -5 .git/logs/refs/heads/master\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eGit 提供了一个 \u003ccode\u003egit reflog\u003c/code\u003e 命令，对这个文件进行操作。\u003c/p\u003e","title":"【Git 权威指南】读书笔记 - 独奏 - Part 2"},{"content":"主要内容：【Git 初始化】、【Git 暂存区】、【Git 对象】\nGit 初始化 设置一下 Git 的环境变量，这个设置是一次性的工作。即这些设置会在全局文件（用户主目录下的 ~/.gitconfig）或系统文件（/etc/gitconfig）中做永久的记录。\n配置的用户名和邮件地址将在版本库提交时作为提交者的用户名和邮件地址。\ngit config --global user.name \u0026#34;Jiang Xin\u0026#34; git config --global user.email jiangxin@ossxp.com 设置一些 Git 别名，以便可以使用更为简洁的子命令 只在本用户的全局配置中添加 Git 命令别名：\ngit config --global alias.br branch git config --global alias.ci \u0026#34;commit -s\u0026#34; git config --global alias.co checkout git config --global alias.st \u0026#34;-p status\u0026#34; 版本库的初始化 mkdir demo cd demo git init 初始化空的 Git 版本库于 /path/to/my/workspace/demo/.git/\ngit init 命令的后面直接输入目录名称\ncd /path/to/my/workspace git init demo ls -aF ./ ../ .git/ 这个隐藏的 .git 目录就是 Git 版本库（又叫仓库，repository）。\n.git 版本库目录所在的目录，即 /path/to/my/workspace/demo 目录称为 工作区。\n将新建立的文件添加到版本库\ngit add welcome.txt 再执行一次提交操作，使用 -m 参数直接给出了提交说明。\ngit ci -m \u0026#34;initialized\u0026#34; [master (root-commit) 7f0b2be] init 1 file changed, 0 insertions(+), 0 deletions(-) create mode 100644 welcome.txt git ci 是上面配置的别名，我个人觉得 -s 这个参数比较冗余。\n思考：为什么工作区下有一个 .git 目录？ Git 的这种设计，将版本库放在工作区根目录下，所有的版本控制操作（除了和其他远程版本库之间的互操作）都在本地即可完成，不像 Subversion 只有寥寥无几的几个命令才能脱离网络执行。而且 Git 也没有 CVS 和 Subversion 的安全泄漏问题（只要保护好 .git 目录），也没有 Subversion 在本地文件搜索时出现搜索结果混乱的问题，甚至 Git 还提供了一条 git grep 命令来更好地搜索工作区的文件内容。\ngit grep \u0026#34;工作区文件内容搜索\u0026#34; 当工作区中包含了子目录，在子目录中执行 Git 命令时，如何定位版本库呢？ 当在 Git 工作区目录下执行操作的时候，会对目录依次向上递归查找 .git 目录，找到的 .git 目录就是工作区对应的版本库，.git 所在的目录就是工作区的根目录，文件 .git/index 记录了工作区文件的状态（实际上是 暂存区 的状态）。\n如果跟踪一下执行 git status 命令时的磁盘访问，会看到沿目录依次向上递归的过程。\nstrace -e \u0026#39;trace=file\u0026#39; git status 那么有什么办法知道 Git 版本库的位置，以及工作区的根目录在哪里呢？ 显示版本库 .git 目录所在的位置。\ngit rev-parse --git-dir /path/to/my/workspace/demo/.git 显示工作区根目录。\ngit rev-parse --show-toplevel /path/to/my/workspace/demo 把版本库 .git 目录放在工作区，是不是太不安全了？ Git 克隆可以降低因为版本库和工作区混杂在一起导致的版本库被破坏的风险。在本机另外的磁盘/目录中建立 Git 克隆，并在工作区有改动提交时，手动或自动地执行向克隆版本库的推送 git push 操作。如果使用网络协议，还可以实现在其他机器上建立克隆，这样就更安全了（双机备份）。\n思考：git config 命令参数的区别？ 将打开 /path/to/my/workspace/demo/.git/config 文件进行编辑：\ncd /path/to/my/workspace/demo/ git config -e 将打开 /home/jiangxin/.gitconfig（用户主目录下的 .gitconfig 文件）全局配置文件进行编辑：\ngit config -e --global 将打开 /etc/gitconfig 系统级配置文件进行编辑：\ngit config -e --system Git 的三个配置文件分别是 版本库级别的配置文件、全局配置文件（用户主目录下）和 系统级配置文件（/etc 目录下）。\n其中 版本库级别配置文件 的优先级最高，全局配置文件 其次，系统级配置文件 优先级最低。\nGit 配置文件采用的是 INI 文件格式。\ncat /path/to/my/workspace/demo/.git/config [core] repositoryformatversion = 0 filemode = true bare = false logallrefupdates = true 例如读取 [core] 小节的 bare 的属性值\ngit config \u0026lt;section\u0026gt;.\u0026lt;key\u0026gt; git config core.bare false 更改或设置 INI 文件中某个属性\ngit config \u0026lt;section\u0026gt;.\u0026lt;key\u0026gt; \u0026lt;value\u0026gt; git config a.b something git config x.y.z others 打开 .git/config 文件\n[a] b = something [x \u0026#34;y\u0026#34;] z = others 可以用 git config 命令操作任何其他的 INI 文件\nGIT_CONFIG=test.ini git config a.b.c.d \u0026#34;hello, world\u0026#34; GIT_CONFIG=test.ini git config a.b.c.d hello, world 思考：是谁完成的提交？ 当最新的提交删除了 user.name 和 user.email，提交时 Git 对提交者的用户名和邮件地址做了大胆的猜测，这个猜测可能是错的。\n重新设置 user.name 和 user.email，然后执行下面的命令，重新修改最新的提交，改正作者和提交者的错误信息。\ngit commit --amend --allow-empty --reset-author 参数 --amend 是对刚刚的提交进行修补，这样就可以改正前面错误的提交（用户信息错误），而不会产生另外的新提交。 参数 --allow-empty 是因为要进行修补的提交实际上是一个空白提交，Git 默认不允许空白提交。 参数 --reset-author 的含义是将 Author（提交者）的 ID 重置，否则只会影响最新的 Commit（提交者）的 ID。这条命令也会重置 AuthorDate 信息。 思考：随意设置提交者姓名，是否太不安全？ Git 可以随意设置提交的用户名和邮件地址信息，这是分布式版本控制系统的特性使然，每个人都是自己版本库的主人，很难也没有必要进行身份认证从而使用经过认证的用户名作为提交的用户名。\n但是可以使用 GitLab 等服务管理权限。\n思考：命令别名是干什么的？ 命令别名可以帮助用户解决从其他版本控制系统迁移到 Git 后的使用习惯问题。\n备份本章的工作成果 cd /path/to/my/workspace git clone demo demo-step-1 Cloning into demo-step-1... done. Git 暂存区 git log --stat 可以用 git log 查看提交日志，附加的 --stat 参数看到每次提交的文件变更统计。\n修改不能直接提交？ 现在就将修改的文件“添加”到提交暂存区：\ngit add welcome.txt 这时如果和 HEAD（当前版本库的头指针）或者 master 分支（当前工作分支）进行比较，会发现有差异。这个差异才是正常的，因为尚未真正提交么。\ngit diff HEAD 用简洁方式显示状态\ngit status -s M welcome.txt 通过参数 --cached 或者 --staged 参数调用 git diff 命令，看到的是提交暂存区 stage 和版本库中文件的差异。不然看到的是工作区的变动。\ngit diff --cached 现在执行 git commit 命令进行提交。\ngit commit -m \u0026#34;which version checked in?\u0026#34; 如何证明提交成功了呢？通过查看提交日志，看到了新的提交。\ngit log --pretty=oneline 理解 Git 暂存区 stage 当执行 git status 命令（或者 git diff 命令）扫描工作区改动的时候，先依据 .git/index 文件中记录的（工作区跟踪文件的）时间戳、长度等信息判断工作区文件是否改变。\n文件 .git/index 实际上就是一个包含文件索引的目录树，像是一个虚拟的工作区。在这个虚拟工作区的目录树中，记录了文件名、文件的状态信息（时间戳、文件长度等）。文件的内容并不存储其中，而是保存在 Git 对象库 .git/objects 目录中，文件索引建立了文件和对象库中对象实体之间的对应。\n图中可以看出此时 HEAD 实际是指向 master 分支的一个“游标”。所以图示的命令中出现 HEAD 的地方可以用 master 来替换。 图中的 objects 标识的区域为 Git 的对象库，实际位于 .git/objects 目录下，会在后面的章节重点介绍。 当执行 git reset HEAD 命令时，暂存区的目录树会被重写，被 master 分支指向的目录树所替换，但是工作区不受影响。 当执行 git rm --cached \u0026lt;file\u0026gt; 命令时，会直接从暂存区删除文件，工作区则不做出改变。 当执行 git checkout . 或者 git checkout -- \u0026lt;file\u0026gt; 命令时，会用暂存区全部或指定的文件替换工作区的文件。这个操作很危险，会清除工作区中未添加到暂存区的改动。 当执行 git checkout HEAD . 或者 git checkout HEAD \u0026lt;file\u0026gt; 命令时，会用 HEAD 指向的 master 分支中的全部或者部分文件替换暂存区和以及工作区中的文件。这个命令也是极具危险性的，因为不但会清除工作区中未提交的改动，也会清除暂存区中未提交的改动。 Git diff 魔法 有什么办法能够像查看工作区一样的，直观的查看暂存区以及 HEAD 当中的目录树么？\ngit ls-tree -l HEAD 100644 blob fd3c069c1de4f4bc9b15940f490aeb48852f3c42 25 welcome.txt 要显示暂存区的目录树，可以使用 git ls-files 命令。\ngit ls-files -s 100644 18832d35117ef2f013c4009f5b2128dfaeff354f 0 a/b/c/hello.txt 不要使用 git commit -a 提交命令 git commit 可以带上 -a 参数，对本地所有变更的文件执行提交操作，包括本地修改的文件，删除的文件，但不包括未被版本库跟踪的文件。\n这个“偷懒”的提交命令，就会丢掉 Git 暂存区带给用户最大的好处：对提交内容进行控制的能力。\nGit 对象 什么是 HEAD？什么是 master？为什么它们二者可以相互替换使用？为什么 Git 中的很多对象像提交、树、文件内容等都用 40 位的 SHA1 哈希值来表示？\nGit 对象库探秘 40 位十六进制数字组成的 SHA1 哈希值\ngit log -1 --pretty=raw # 这是本次提交的唯一标识。 commit e695606fc5e31b2ff9038a48a3d363f4c21a3d86 # 这是本次提交所对应的目录树。 tree f58da9a820e3fd9d84ab2ca2f1b467ac265038f9 # 这是本地提交的父提交（上一次提交）。 parent a0c641e92b10d8bcca1ed1bf84ca80340fdefee6 which version checked in? 研究 Git 对象 ID 的命令是 git cat-file，用下面的命令可以查看一下这三个 ID 的类型。\ngit cat-file -t e695606 commit git cat-file -t f58d tree git cat-file -t fd3c06 blob 再用 git cat-file 命令查看一下这几个对象的内容。对于 blob 对象，这个对象保存着文件 welcome.txt 的内容。\ngit cat-file -p fd3c06 Hello. Nice to meet you. 这个写对象都存在 Git 库中的 objects 目录下，ID 的前两位作为目录名，后 38 位作为文件名。\nfor id in e695606 f58da9a a0c641e fd3c069; do \\ ls .git/objects/${id:0:2}/${id:2}*; done .git/objects/e6/95606fc5e31b2ff9038a48a3d363f4c21a3d86 .git/objects/f5/8da9a820e3fd9d84ab2ca2f1b467ac265038f9 .git/objects/a0/c641e92b10d8bcca1ed1bf84ca80340fdefee6 .git/objects/fd/3c069c1de4f4bc9b15940f490aeb48852f3c42 HEAD 和 master 的奥秘 git log -1 HEAD git log -1 master git log -1 refs/heads/master 在当前版本库中，HEAD、master 和 refs/heads/master 具有相同的指向。现在到版本库 .git 中一探它们的究竟：\nfind .git -name HEAD -o -name master .git/HEAD .git/logs/HEAD .git/logs/refs/heads/master .git/refs/heads/master 显示一下 .git/HEAD\ncat .git/HEAD ref: refs/heads/master 指向一个引用：refs/heads/master\ncat .git/refs/heads/master e695606fc5e31b2ff9038a48a3d363f4c21a3d86 显示该提交的内容\ngit cat-file -p e695606fc5e31b2ff9038a48a3d363f4c21a3d86 tree f58da9a820e3fd9d84ab2ca2f1b467ac265038f9 parent a0c641e92b10d8bcca1ed1bf84ca80340fdefee6 which version checked in? 原来分支 master 指向的是一个提交 ID（最新提交）。\n这样的分支实现是多么的巧妙啊：既然可以从任何提交开始建立一条历史跟踪链，那么用一个文件指向这个链条的最新提交，那么这个文件就可以用于追踪整个提交历史了。\n这个文件就是 .git/refs/heads/master 文件。\n目录 .git/refs 是保存引用的命名空间，其中 .git/refs/heads 目录下的引用又称为分支。对于分支既可以使用正规的长格式的表示法，如 refs/heads/master，也可以去掉前面的两级目录用 master 来表示。Git 有一个底层命令 git rev-parse 可以用于显示引用对应的提交 ID。\n问题：SHA1 哈希值到底是什么，如何生成的？ 哈希(hash)是一种数据摘要算法（或称散列算法），是信息安全领域当中重要的理论基石。该算法将任意长度的输入经过散列运算转换为固定长度的输出。固定长度的输出可以称为对应的输入的数字摘要或哈希值。\necho -n Git |sha1sum 5819778898df55e3a762f0c5728b457970d72cae - 提交的 SHA1 哈希值生成方法：\ngit cat-file commit HEAD | wc -c 234 # 在提交信息的前面加上内容 `commit 234\u0026lt;null\u0026gt;`（`\u0026lt;null\u0026gt;`为空字符），然后执行 SHA1 哈希算法。 ( printf \u0026#34;commit 234\\000\u0026#34;; git cat-file commit HEAD ) | sha1sum e695606fc5e31b2ff9038a48a3d363f4c21a3d86 - # 上面命令得到的哈希值和用 `git rev-parse` 看到的是一样的。 git rev-parse HEAD e695606fc5e31b2ff9038a48a3d363f4c21a3d86 文件内容的 SHA1 哈希值生成方法：\n# 文件总共包含 25 字节的内容。 git cat-file blob HEAD:welcome.txt | wc -c 25 # 在文件内容的前面加上blob 25\u0026lt;null\u0026gt;的内容，然后执行SHA1哈希算法。 ( printf \u0026#34;blob 25\\000\u0026#34;; git cat-file blob HEAD:welcome.txt ) | sha1sum fd3c069c1de4f4bc9b15940f490aeb48852f3c42 - # 上面命令得到的哈希值和用git rev-parse看到的是一样的。 git rev-parse HEAD:welcome.txt fd3c069c1de4f4bc9b15940f490aeb48852f3c42 树的 SHA1 哈希值的形成方法：\n# HEAD对应的树的内容共包含39个字节。 git cat-file tree HEAD^{tree} | wc -c 39 # 在树的内容的前面加上tree 39\u0026lt;null\u0026gt;的内容，然后执行SHA1哈希算法。 ( printf \u0026#34;tree 39\\000\u0026#34;; git cat-file tree HEAD^{tree} ) | sha1sum f58da9a820e3fd9d84ab2ca2f1b467ac265038f9 - # 上面命令得到的哈希值和用git rev-parse看到的是一样的。 git rev-parse HEAD^{tree} f58da9a820e3fd9d84ab2ca2f1b467ac265038f9 问题：为什么不用顺序的数字来表示提交？ 集中式版本控制系统因为只有一个集中式的版本库，可以很容易的实现依次递增的全局唯一的提交号。Git 作为分布式版本控制系统，开发可以是非线性的。这就要求提交的编号不能仅仅是本地局部有效，而是要“全球唯一”。\n采用部分的 SHA1 哈希值。不必写全 40 位的哈希值，只采用开头的部分，不和现有其他的冲突即可。\n使用 master 代表分支 master 中最新的提交，使用全称 refs/heads/master 亦可。\n使用 HEAD 代表版本库中最近的一次提交。\n符号 ^ 可以用于指代父提交。例如：\nHEAD^ 代表版本库中上一次提交，即最近一次提交的父提交。 HEAD^^ 则代表 HEAD^ 的父提交。 对于一个提交有多个父提交，可以在符号 ^ 后面用数字表示是第几个父提交。例如：\na573106^2 含义是提交 a573106 的多个父提交中的第二个父提交。 HEAD^1 相当于 HEAD^ 含义是 HEAD 多个父提交中的第一个。 HEAD^^2 含义是 HEAD^（HEAD 父提交）的多个父提交中的第二个。 符号 ~\u0026lt;n\u0026gt; 也可以用于指代祖先提交。效果等同：\na573106~5 a573106^^^^^ 提交所对应的树对象：a573106^{tree}\n某一此提交对应的文件对象：a573106:path/to/file\n暂存区中的文件对象：:path/to/file\ngit rev-parse HEAD git cat-file -p e695 git cat-file -p e695^ git rev-parse e695^{tree} References 2. Git 独奏 — GotGit ","permalink":"https://zyf.im/2017/07/19/got-git-reading-notes-solo-part1/","summary":"\u003cp\u003e主要内容：【Git 初始化】、【Git 暂存区】、【Git 对象】\u003c/p\u003e\n\u003ch2 id=\"git-初始化\"\u003eGit 初始化\u003c/h2\u003e\n\u003cp\u003e设置一下 Git 的环境变量，这个设置是一次性的工作。即这些设置会在全局文件（用户主目录下的 \u003ccode\u003e~/.gitconfig\u003c/code\u003e）或系统文件（\u003ccode\u003e/etc/gitconfig\u003c/code\u003e）中做永久的记录。\u003c/p\u003e\n\u003cp\u003e配置的用户名和邮件地址将在版本库提交时作为提交者的用户名和邮件地址。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit config --global user.name \u003cspan class=\"s2\"\u003e\u0026#34;Jiang Xin\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit config --global user.email jiangxin@ossxp.com\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"设置一些-git-别名以便可以使用更为简洁的子命令\"\u003e设置一些 Git 别名，以便可以使用更为简洁的子命令\u003c/h3\u003e\n\u003cp\u003e只在本用户的全局配置中添加 Git 命令别名：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit config --global alias.br branch\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit config --global alias.ci \u003cspan class=\"s2\"\u003e\u0026#34;commit -s\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit config --global alias.co checkout\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit config --global alias.st \u003cspan class=\"s2\"\u003e\u0026#34;-p status\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c!-- more --\u003e\n\u003ch3 id=\"版本库的初始化\"\u003e版本库的初始化\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003emkdir demo\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003ecd\u003c/span\u003e demo\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit init\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e初始化空的 Git 版本库于 \u003ccode\u003e/path/to/my/workspace/demo/.git/\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003egit init 命令的后面直接输入目录名称\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003ecd\u003c/span\u003e /path/to/my/workspace\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit init demo\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003els -aF\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e./  ../  .git/\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e这个隐藏的 \u003ccode\u003e.git\u003c/code\u003e 目录就是 Git 版本库（又叫仓库，repository）。\u003c/p\u003e","title":"【Git 权威指南】读书笔记 - 独奏 - Part 1"},{"content":"Git 是一款分布式版本控制系统，有别于 CVS 和 SVN 等集中式版本控制系统，Git 可以让研发团队更加高效地协同工作、提高生产率。使用 Git，开发人员的工作不会因为频繁地遭遇提交冲突而中断，管理人员也无须为数据的备份而担心。经过 Linux 这样庞大的项目的考验之后，Git 被证明可以胜任任何规模的团队，即便这个团队的成员分布于世界各地。\nGit 是开源社区奉献给每一个人的宝贝，用好它可以实现个人的知识积累、保护好自己的数据，而且还能与他人分享自己的成果。\n版本控制的前世和今生 即便是在 CVS 出现之前的“史前时代”，也已经有了非常好用的源码比较和打补丁的工具：diff 和 patch，他们今天生命力依然顽强。\n对这 hello world 两个文件执行 diff 命令，查看两个文件的差异。如下所示：\ndiff -u hello world | less -N 上面执行 diff 命令的 -u 参数很重要，使得差异输出中带有上下文。管道后面带有 -N 参数的 less 命令（按字母 q 退出）会在输出的每一行前面添加行号，便于对输出结果进行说明。\n命令 patch 相当于 diff 的反向操作\n分布式版本控制系统最大的反传统之处在于，可以不需要集中式的版本库，每个人都工作在通过克隆操作建立的本地版本库中，也就是说每个人都拥有一个完整的版本库。分布式版本控制系统的几乎所有操作包括查看提交日志、提交、创建里程碑和分支、合并分支、回退等都直接在本地完成而不需要网络连接。每个人都是本地版本库的主人，不再有谁能提交谁不能提交的限制，加之多样的协同工作模型（版本库间推送、拉回，及补丁文件传送等）让开源项目的参与度有爆发式增长。\n爱上 Git 的理由 每日的工作备份。鸡蛋不全放在一个篮子里。 异地协同工作。通过一个远程版本库，同步数据。 现场版本控制。在部署的现场，进行源代码的修改，能够将修改结果甚至修改过程一并带走，并能够将修改结果合并至项目对应的代码库中。 避免引入辅助目录。只在工作区的顶级目录下创建名为 .git 的目录（版本库目录），如果认为唯一的一个 .git 目录也过于碍眼，可以将其放到工作区之外的任意目录。一旦这么做了，你在执行 Git 命令时，要通过命令行 --git-dir 或环境变量 GIT_DIR 为工作区指定版本库目录，甚至还要指定工作区目录。 重写提交说明。这个命令如果不带 -m 参数，会进入提交说明编辑界面。 git commit --amend 想吃后悔药。假如提交的数据中不小心包含了一个不应该检入的虚拟机文件——大约有 1 个 GB。 git rm --cached winxp.img git commit --amend 更好用的提交列表。正确的版本控制系统的使用方法是：一次提交只干一件事。而不要在下班时才想起来要提交，那样的话版本控制系统就被降格为文件备份系统了。 更好的差异比较。git diff 工作进度保存。 git stash git checkout \u0026lt;new_branch\u0026gt; # do something git checkout \u0026lt;orignal_branch\u0026gt; git stash pop 代理 SVN 提交实现移动式办公。 无处不在的分页器。-p 快。Git 作为分布式版本控制系统几乎所有的操作都在本地进行。 安装 Git sudo aptitude install git sudo aptitude install git-doc git-svn git-email gitk 软件包 git-svn、git-email、gitk 本来也是 Git 软件包的一部分，但是因为有着不一样的软件包依赖（如更多 perl 模组，tk 等），所以单独作为软件包发布。\n软件包 git-doc 则包含了 Git 的 HTML 格式文档，可以选择安装。如果安装了 Git 的 HTML 格式的文档，则可以通过执行 git help -w \u0026lt;sub-command\u0026gt; 命令，自动用 Web 浏览器打开相关子命令 \u0026lt;sub-command\u0026gt; 的 HTML 帮助。\n中文支持 git config --global core.quotepath false References 1. 初识 Git — GotGit ","permalink":"https://zyf.im/2017/07/12/got-git-reading-notes-meet-git/","summary":"\u003cp\u003eGit 是一款分布式版本控制系统，有别于 CVS 和 SVN 等集中式版本控制系统，Git 可以让研发团队更加高效地协同工作、提高生产率。使用 Git，开发人员的工作不会因为频繁地遭遇提交冲突而中断，管理人员也无须为数据的备份而担心。经过 Linux 这样庞大的项目的考验之后，Git 被证明可以胜任任何规模的团队，即便这个团队的成员分布于世界各地。\u003c/p\u003e\n\u003cp\u003eGit 是开源社区奉献给每一个人的宝贝，用好它可以实现个人的知识积累、保护好自己的数据，而且还能与他人分享自己的成果。\u003c/p\u003e\n\u003ch2 id=\"版本控制的前世和今生\"\u003e版本控制的前世和今生\u003c/h2\u003e\n\u003cp\u003e即便是在 CVS 出现之前的“史前时代”，也已经有了非常好用的源码比较和打补丁的工具：\u003ccode\u003ediff\u003c/code\u003e 和 \u003ccode\u003epatch\u003c/code\u003e，他们今天生命力依然顽强。\u003c/p\u003e\n\u003c!-- more --\u003e\n\u003cp\u003e对这 \u003ccode\u003ehello\u003c/code\u003e \u003ccode\u003eworld\u003c/code\u003e 两个文件执行 diff 命令，查看两个文件的差异。如下所示：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ediff -u hello world \u003cspan class=\"p\"\u003e|\u003c/span\u003e less -N\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e上面执行 \u003ccode\u003ediff\u003c/code\u003e 命令的 \u003ccode\u003e-u\u003c/code\u003e 参数很重要，使得差异输出中带有上下文。管道后面带有 \u003ccode\u003e-N\u003c/code\u003e 参数的 \u003ccode\u003eless\u003c/code\u003e 命令（按字母 \u003ccode\u003eq\u003c/code\u003e 退出）会在输出的每一行前面添加行号，便于对输出结果进行说明。\u003c/p\u003e\n\u003cp\u003e命令 \u003ccode\u003epatch\u003c/code\u003e 相当于 \u003ccode\u003ediff\u003c/code\u003e 的反向操作\u003c/p\u003e\n\u003cp\u003e分布式版本控制系统最大的反传统之处在于，可以不需要集中式的版本库，每个人都工作在通过克隆操作建立的本地版本库中，也就是说每个人都拥有一个完整的版本库。分布式版本控制系统的几乎所有操作包括查看提交日志、提交、创建里程碑和分支、合并分支、回退等都直接在本地完成而不需要网络连接。每个人都是本地版本库的主人，不再有谁能提交谁不能提交的限制，加之多样的协同工作模型（版本库间推送、拉回，及补丁文件传送等）让开源项目的参与度有爆发式增长。\u003c/p\u003e\n\u003ch2 id=\"爱上-git-的理由\"\u003e爱上 Git 的理由\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e每日的工作备份。鸡蛋不全放在一个篮子里。\u003c/li\u003e\n\u003cli\u003e异地协同工作。通过一个远程版本库，同步数据。\u003c/li\u003e\n\u003cli\u003e现场版本控制。在部署的现场，进行源代码的修改，能够将修改结果甚至修改过程一并带走，并能够将修改结果合并至项目对应的代码库中。\u003c/li\u003e\n\u003cli\u003e避免引入辅助目录。只在工作区的顶级目录下创建名为 \u003ccode\u003e.git\u003c/code\u003e 的目录（版本库目录），如果认为唯一的一个 \u003ccode\u003e.git\u003c/code\u003e 目录也过于碍眼，可以将其放到工作区之外的任意目录。一旦这么做了，你在执行 Git 命令时，要通过命令行 \u003ccode\u003e--git-dir\u003c/code\u003e 或环境变量 \u003ccode\u003eGIT_DIR\u003c/code\u003e 为工作区指定版本库目录，甚至还要指定工作区目录。\u003c/li\u003e\n\u003cli\u003e重写提交说明。这个命令如果不带 \u003ccode\u003e-m\u003c/code\u003e 参数，会进入提交说明编辑界面。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit commit --amend\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cul\u003e\n\u003cli\u003e想吃后悔药。假如提交的数据中不小心包含了一个不应该检入的虚拟机文件——大约有 1 个 GB。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit rm --cached winxp.img\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit commit --amend\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cul\u003e\n\u003cli\u003e更好用的提交列表。正确的版本控制系统的使用方法是：一次提交只干一件事。而不要在下班时才想起来要提交，那样的话版本控制系统就被降格为文件备份系统了。\u003c/li\u003e\n\u003cli\u003e更好的差异比较。\u003ccode\u003egit diff\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e工作进度保存。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit stash\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit checkout \u0026lt;new_branch\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# do something\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit checkout \u0026lt;orignal_branch\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit stash pop\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cul\u003e\n\u003cli\u003e代理 SVN 提交实现移动式办公。\u003c/li\u003e\n\u003cli\u003e无处不在的分页器。\u003ccode\u003e-p\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e快。Git 作为分布式版本控制系统几乎所有的操作都在本地进行。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"安装-git\"\u003e安装 Git\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo aptitude install git\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo aptitude install git-doc git-svn git-email gitk\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e软件包 git-svn、git-email、gitk 本来也是 Git 软件包的一部分，但是因为有着不一样的软件包依赖（如更多 perl 模组，tk 等），所以单独作为软件包发布。\u003c/p\u003e","title":"【Git 权威指南】读书笔记 - 初识 Git"},{"content":"简介 HTTP/2（RFC 7540，2015 年发布）是自 1999 年 HTTP/1.1 以来的第一次重大升级，目标是在 不改变应用语义 的前提下，改善延迟、并发和网络效率。浏览器端基本只在 TLS 上启用（h2），明文版本 h2c 仅用于内部服务间通信。\nh2：HTTP/2 over TLS（最常见，浏览器只支持这一种） h2c：HTTP/2 over TCP（无加密） 设计背景 移动端和富媒体时代，请求量激增，HTTP/1.1 的队头阻塞、多个 TCP 连接并行带来的 慢启动/拥塞竞争 成为瓶颈。\n谷歌的 SPDY 原型验证了“单连接、多路复用、压缩头部”等思路；IETF 在 SPDY 3.1 基础上标准化为 HTTP/2。\n核心特性 特性 作用 二进制分帧 (Binary Framing) 把 HTTP 报文拆成小型 Frame；机器易解析、可并行 多路复用 (Multiplexing) 多个请求/响应 共享一个 TCP 连接，互不阻塞 流与优先级 (Stream \u0026amp; Priority) 每个请求是双向 Stream，可指定权重与依赖 头部压缩 (HPACK) 静态 Huffman + 动态表，大幅减少重复的 Header 字节 服务器推送 (Server Push) 服务器可在请求外预送资源 (已被多数浏览器弱化/关闭) 流量控制 端到端窗口，避免单个大文件占满带宽 配置 启用 HTTP/2 需要使用 HTTPS，请先参考 在本地环境使用 HTTPS ｜ ZYF.IM。\n修改 NGINX default.conf 配置文件，启用 HTTP/2：\n# vi default.conf server { listen 443 ssl http2; # 只改这里，添加 http2 server_name localhost; ssl_certificate /etc/ssl/certs/localhost.pem; ssl_certificate_key /etc/ssl/certs/localhost-key.pem; # 只允许 TLSv1.2 和 TLSv1.3 协议，显示禁止 TLSv1.0 和 TLSv1.1 协议 ssl_protocols TLSv1.2 TLSv1.3; # 只保留高强度、带身份验证、且不使用 MD5 的 TLS 1.2（及以下）套件 ssl_ciphers HIGH:!aNULL:!MD5; # 优先使用服务器端加密套件 ssl_prefer_server_ciphers on; location / { root /usr/share/nginx/html; index index.html index.htm; } } docker container restart nginx-ssl 测试 游览器 游览器访问 https://localhost:8443/，在 Chrome 开发者工具 Network 面板勾选 Protocol，可看到 h2 字样。\n或者使用 Chrome 插件 HTTP Indicator：\nHTTP/1.1 显示为灰色。 HTTP/2 显示为蓝色。 HTTP/3 显示为绿色。 curl # -I (--head) 只返回响应头 curl -I https://localhost:8443/ HTTP/2 200 server: nginx/1.29.0 date: Fri, 27 Jun 2025 01:56:55 GMT content-type: text/html content-length: 615 last-modified: Tue, 24 Jun 2025 17:57:38 GMT etag: \u0026#34;685ae712-267\u0026#34; accept-ranges: bytes \u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2017/06/06/nginx-enable-http2/","summary":"\u003ch2 id=\"简介\"\u003e简介\u003c/h2\u003e\n\u003cp\u003eHTTP/2（RFC 7540，2015 年发布）是自 1999 年 HTTP/1.1 以来的第一次重大升级，目标是在 不改变应用语义 的前提下，改善延迟、并发和网络效率。浏览器端基本只在 TLS 上启用（h2），明文版本 h2c 仅用于内部服务间通信。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eh2：HTTP/2 over TLS（最常见，浏览器只支持这一种）\u003c/li\u003e\n\u003cli\u003eh2c：HTTP/2 over TCP（无加密）\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"设计背景\"\u003e设计背景\u003c/h3\u003e\n\u003cp\u003e移动端和富媒体时代，请求量激增，HTTP/1.1 的队头阻塞、多个 TCP 连接并行带来的 慢启动/拥塞竞争 成为瓶颈。\u003c/p\u003e\n\u003cp\u003e谷歌的 SPDY 原型验证了“单连接、多路复用、压缩头部”等思路；IETF 在 SPDY 3.1 基础上标准化为 HTTP/2。\u003c/p\u003e\n\u003ch3 id=\"核心特性\"\u003e核心特性\u003c/h3\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003e特性\u003c/th\u003e\n          \u003cth\u003e作用\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e二进制分帧 (Binary Framing)\u003c/td\u003e\n          \u003ctd\u003e把 HTTP 报文拆成小型 Frame；机器易解析、可并行\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e多路复用 (Multiplexing)\u003c/td\u003e\n          \u003ctd\u003e多个请求/响应 共享一个 TCP 连接，互不阻塞\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e流与优先级 (Stream \u0026amp; Priority)\u003c/td\u003e\n          \u003ctd\u003e每个请求是双向 Stream，可指定权重与依赖\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e头部压缩 (HPACK)\u003c/td\u003e\n          \u003ctd\u003e静态 Huffman + 动态表，大幅减少重复的 Header 字节\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e服务器推送 (Server Push)\u003c/td\u003e\n          \u003ctd\u003e服务器可在请求外预送资源 (已被多数浏览器弱化/关闭)\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e流量控制\u003c/td\u003e\n          \u003ctd\u003e端到端窗口，避免单个大文件占满带宽\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"配置\"\u003e配置\u003c/h2\u003e\n\u003cp\u003e启用 HTTP/2 需要使用 HTTPS，请先参考 \u003ca href=\"/2025/06/26/use-https-in-local-environment/\"\u003e在本地环境使用 HTTPS ｜ ZYF.IM\u003c/a\u003e。\u003c/p\u003e","title":"NGINX 启用 HTTP/2"},{"content":"获取 Nginx 反向代理后的客户端 IP，基本是按一定顺序检测以下参数中的信息：\nHTTP_CLIENT_IP HTTP_X_REAL_FORWARDED_FOR HTTP_X_FORWARDED_FOR REMOTE_ADDR 在未使用 CDN 和反向代理情况下 当业务服务器直接暴露在公网上，并且未使用 CDN 和反向代理服务器时，可以直接使用 remote_addr：\n$_SERVER[\u0026#39;REMOTE_ADDR\u0026#39;] 这时候 HTTP_X_FORWARDED_FOR 和 HTTP_X_REAL_IP 都是可以被伪造的，但 REMOTE_ADDR 是客户端和服务器的握手 IP，即 client 的出口 IP，伪造不了。\n在使用 CDN 和反向代理情况下 铁律 当多层代理或使用 CDN 时，如果代理服务器不把用户的真实 IP 传递下去，那么业务服务器将永远不可能获取到用户的真实 IP。\n如果 WEB 服务器上层也是使用 Nginx 做代理或负载均衡，则需要在代理层的 Nginx 配置中明确 XFF 参数，累加传递上一个请求方的 IP 到 header 请求中。以下是代理层的 Nginx 配置参数。\nproxy_set_header X-Real-IP $remote_addr; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; proxy_set_header Host $http_host; proxy_set_header X-NginX-Proxy true; 只有一层代理的情况 我们按上面的配置发起一个伪造请求，10.100.11.25 是我电脑的 IP，链路为：\n10.100.11.25(client)-\u0026gt;10.200.21.33(Proxy)-\u0026gt;10.200.21.32(Web Server) curl 请求：\ncurl http://10.200.21.33:88/test.php -H \u0026#39;X-Forwarded-For: unkonw, \u0026lt;8.8.8.8\u0026gt; 1.1.1.1\u0026#39; -H \u0026#39;X-Real-IP: 2.2.2.2\u0026#39; 结果为：\n[HTTP_X_FORWARDED_FOR] =\u0026gt; unkonw, \u0026lt;8.8.8.8\u0026gt; 1.1.1.1, 10.100.11.25 [REMOTE_ADDR] =\u0026gt; 10.200.21.33 [HTTP_X_REAL_IP] =\u0026gt; 10.100.11.25 我们可以看到，XFF 被附加上了我的 IP，但前面的一系列伪造内容，可以轻易骗过很多规则，而 HTTP_X_REAL_IP 则传递了我电脑的 IP。因为在上面的配置中，X-Real-IP 已经被设置为握手 IP。\n但多层代理之后，以上面的规则，显然 HTTP_X_REAL_IP 也不会是真实的用户 IP 了。而 HTTP_X_FORWARDED_FOR 则在原有信息（我们伪造的信息）之后附上了握手 IP 一起传递过来了。\n两层或更多代理的情况 我们这里只测试两层，实际链路为：\n10.100.11.25(client)-\u0026gt;10.200.21.34(Proxy)-\u0026gt;10.200.21.33(Proxy)-\u0026gt;10.200.21.32(Web Server) curl 请求：\ncurl http://10.200.21.34:88/test.php -H \u0026#39;X-Forwarded-For: unkonw, \u0026lt;8.8.8.8\u0026gt; 1.1.1.1\u0026#39; -H \u0026#39;X-Real-IP: 2.2.2.2\u0026#39; 两层代理的情况下结果为：\n[HTTP_X_FORWARDED_FOR] =\u0026gt; unkonw, \u0026lt;8.8.8.8\u0026gt; 1.1.1.1, 10.100.11.25, 10.200.21.34 [REMOTE_ADDR] =\u0026gt; 10.200.21.33 [HTTP_X_REAL_IP] =\u0026gt; 10.200.21.34 根据上面的情况，怎么挑出真正的用户 IP 呢？设想三种方案：\n1、第一层代理将用户的真实 IP 放在 X-Real-IP 中传递下去，后面的每一层都使用 X-Real-IP 继续往下传递。配置为：\nproxy_set_header X-Real-IP $remote_addr; # 针对首层代理，拿到真实IP proxy_set_header X-Real-IP $http_x_real_ip; # 针对非首层代理，一直传下去 2、从首层开始，将用户的真实 IP 放在 X-Forwarded-For 中，而不是累加各层服务器的 IP，但这样也不够合理，因为丢掉了整个链路信息。配置为：\nproxy_set_header X-Forwarded-For $remote_addr; # 针对首层代理 proxy_set_header X-Forwarded-For $http_x_forwarded_for; # 针对非首层代理 3、从 X-Forwarded-For 中获取的用户真实 IP，排除掉所有代理 IP，取最后一个符合 IP 规则的，注意不是第一个，因为第一个可能是被伪造的（除非首层代理使用了握手会话 IP 做为值向下传递）。\n一般 CDN 都会将用户的真实 IP 在 XFF 中传递下去。我们可以做几个简单的测试就能知道我们该怎么做。\n注意：Nginx 配置的这两个变量：\n$proxy_add_x_forwarded_for 会累加代理层的 IP 向后传递 $http_x_forwarded_for 仅仅是上层传过来的值 Nginx realip 模块获取真实 IP 秉承一个原则：能通过配置让事情变的更简单和通用的事儿，就不要用程序去解决。即环境对程序透明。 这当然少不了系统运维人员的辛苦。\n如果能在配置中理清，就不必用复杂的程序去解决，因为 Server 上可能有各种应用都要来获取用户 IP，如果规则不统一，结果会不一致。\n程序不知道链路到底经过了几层才转到 WEB Server 上，所以让程序去做兼容并不是个好主意。索性就让程序把所有的代理都当成透明的好了。\n上面介绍的三种方法中，如果不能保证前面的代理层使用我们指定的规则，这时候怎么办呢？只能使用第三种方法。然后我们将各层代理的 IP 排除在外，就取到了真实的用户 IP。这个可以使用 Nginx 的一个模块儿 Module ngx_http_realip_module 来实现。\n原理是从 XFF 中抛弃指定的代理层 IP，那么最后一个符合规则的就是用户 IP。也可以配合第一起方法一起使用。但无论如何，首层代理的规则最重要，直接影响后面的代理层和 WEB Server 的接收结果。\n然后在 Nginx 配置中增加以下配置（可以在 http、server 或 location 段中增加）：\n# set user real ip to remote addr set_real_ip_from 10.200.21.0/24; set_real_ip_from 10.100.23.0/24; real_ip_header X-Forwarded-For; real_ip_recursive on; set_real_ip_from 后面是可信 IP 规则，可以有多条。如果启用 CDN，知道 CDN 的溯源 IP，也要加进来，除排掉可信的，就是用户的真实 IP，会写入 remote_addr 这个变量中。\n在 PHP 中可以使用 $_SERVER['REMOTE_ADDR'] 来获取。而 WEB Server 不使用任何反向代理时，也是取这个值，这就达到了我们之前所说的原则。\nreal_ip_recursive 是递归的去除所配置中的可信 IP。如果只有一层代理，也可以不写这个参数。\nThinkPHP 中的获取 IP 方法 ThinkPHP 的 function 中提供了一个工具方法，在对获取 IP 地址不严格的情况下，可以启用高级模式\n/** * 获取客户端IP地址 * @param integer $type 返回类型 0 返回IP地址 1 返回IPV4地址数字 * @param boolean $adv 是否进行高级模式获取（有可能被伪装） * @return mixed */ function get_client_ip($type = 0, $adv = false) { $type = $type ? 1 : 0; static $ip = NULL; if ($ip !== NULL) return $ip[$type]; if($adv){ if (isset($_SERVER[\u0026#39;HTTP_X_FORWARDED_FOR\u0026#39;])) { $arr = explode(\u0026#39;,\u0026#39;, $_SERVER[\u0026#39;HTTP_X_FORWARDED_FOR\u0026#39;]); $pos = array_search(\u0026#39;unknown\u0026#39;,$arr); if(false !== $pos) unset($arr[$pos]); $ip = trim($arr[0]); }elseif (isset($_SERVER[\u0026#39;HTTP_CLIENT_IP\u0026#39;])) { $ip = $_SERVER[\u0026#39;HTTP_CLIENT_IP\u0026#39;]; }elseif (isset($_SERVER[\u0026#39;REMOTE_ADDR\u0026#39;])) { $ip = $_SERVER[\u0026#39;REMOTE_ADDR\u0026#39;]; } }elseif (isset($_SERVER[\u0026#39;REMOTE_ADDR\u0026#39;])) { $ip = $_SERVER[\u0026#39;REMOTE_ADDR\u0026#39;]; } // IP地址合法验证 $long = sprintf(\u0026#34;%u\u0026#34;,ip2long($ip)); $ip = $long ? array($ip, $long) : array(\u0026#39;0.0.0.0\u0026#39;, 0); return $ip[$type]; } Nginx LOG 记录真实 IP log_format porxy \u0026#39;$http_x_forwarded_for - $remote_user [$time_local] \u0026#39; \u0026#39; \u0026#34;$request\u0026#34; $status $body_bytes_sent \u0026#39; \u0026#39; \u0026#34;$http_referer\u0026#34; \u0026#34;$http_user_agent\u0026#34; \u0026#39;; access_log /usr/local/nginx/logs/access.log porxy; 文章称 nginx reload 配置并不生效，需要 restart。\nReferences 使用 PHP 获取客户端真实 IP 地址？——不可能！ - 也就这样 NGINX 多层转发或使用 CDN 之后如何获取用户真实 IP | Snow Blog Nginx 日志配置详情解析 \u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2017/06/02/php-get-real-ip-after-nginx-using-reverse-proxy-or-cdn/","summary":"\u003cp\u003e获取 Nginx 反向代理后的客户端 IP，基本是按一定顺序检测以下参数中的信息：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eHTTP_CLIENT_IP\u003c/li\u003e\n\u003cli\u003eHTTP_X_REAL_FORWARDED_FOR\u003c/li\u003e\n\u003cli\u003eHTTP_X_FORWARDED_FOR\u003c/li\u003e\n\u003cli\u003eREMOTE_ADDR\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"在未使用-cdn-和反向代理情况下\"\u003e在未使用 CDN 和反向代理情况下\u003c/h2\u003e\n\u003cp\u003e当业务服务器直接暴露在公网上，并且未使用 CDN 和反向代理服务器时，可以直接使用 \u003ccode\u003eremote_addr\u003c/code\u003e：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$_SERVER\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;REMOTE_ADDR\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e这时候 \u003ccode\u003eHTTP_X_FORWARDED_FOR\u003c/code\u003e 和 \u003ccode\u003eHTTP_X_REAL_IP\u003c/code\u003e 都是可以被伪造的，但 \u003ccode\u003eREMOTE_ADDR\u003c/code\u003e 是客户端和服务器的握手 IP，即 client 的出口 IP，伪造不了。\u003c/p\u003e\n\u003c!-- more --\u003e\n\u003ch2 id=\"在使用-cdn-和反向代理情况下\"\u003e在使用 CDN 和反向代理情况下\u003c/h2\u003e\n\u003ch3 id=\"铁律\"\u003e铁律\u003c/h3\u003e\n\u003cp\u003e当多层代理或使用 CDN 时，如果代理服务器不把用户的真实 IP 传递下去，那么业务服务器将永远不可能获取到用户的真实 IP。\u003c/p\u003e\n\u003cp\u003e如果 WEB 服务器上层也是使用 Nginx 做代理或负载均衡，则需要在代理层的 Nginx 配置中明确 XFF 参数，累加传递上一个请求方的 IP 到 header 请求中。以下是代理层的 Nginx 配置参数。\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode class=\"language-conf\" data-lang=\"conf\"\u003eproxy_set_header X-Real-IP $remote_addr;\nproxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\nproxy_set_header Host $http_host;\nproxy_set_header X-NginX-Proxy true;\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"只有一层代理的情况\"\u003e只有一层代理的情况\u003c/h3\u003e\n\u003cp\u003e我们按上面的配置发起一个伪造请求，10.100.11.25 是我电脑的 IP，链路为：\u003c/p\u003e","title":"PHP 中获取 Nginx 使用反向代理或 CDN 后的客户端真实 IP"},{"content":" self:: 调用本类属性、方法；可以抑制方法多态性。 parent:: 调用父类属性、方法。 static:: 调用静态属性、方法；可以体现多态性。 $this-\u0026gt; 调用本实例的属性、方法；$this:: 可以调用静态属性、方法；但是无法在静态方法里使用；可以体现多态性。 -\u0026gt; object-operator, you always know you\u0026rsquo;re dealing with an instance. :: scope-resolution-operator, you need more information about the context. \u0026lt;?php class A { public static function newStaticClass() { return new static(); } public static function newSelfClass() { return new self(); } public function newThisClass() { return new $this(); } } class B extends A { public function newParentClass() { return new parent(); } } class C extends B { public static function newSelfClass() { return new self(); } } $c = new C(); var_dump($c::newStaticClass()); // C and is same C::newStaticClass() var_dump($c::newSelfClass()); // C because self now points to \u0026#34;C\u0026#34; class var_dump($c-\u0026gt;newThisClass()); // C var_dump($c-\u0026gt;newParentClass()); // A because parent was defined *way back* in class \u0026#34;B\u0026#34; References php - When to use self over $this? - Stack Overflow ","permalink":"https://zyf.im/2017/05/25/how-to-use-this-self-parent-in-php/","summary":"\u003cul\u003e\n\u003cli\u003e\u003ccode\u003eself::\u003c/code\u003e 调用本类属性、方法；可以抑制方法多态性。\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eparent::\u003c/code\u003e 调用父类属性、方法。\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003estatic::\u003c/code\u003e 调用静态属性、方法；可以体现多态性。\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e$this-\u0026gt;\u003c/code\u003e 调用本实例的属性、方法；\u003ccode\u003e$this::\u003c/code\u003e 可以调用静态属性、方法；但是无法在静态方法里使用；可以体现多态性。\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e-\u0026gt;\u003c/code\u003e object-operator, you always know you\u0026rsquo;re dealing with an instance.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e::\u003c/code\u003e scope-resolution-operator, you need more information about the context.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e\u0026lt;?\u003c/span\u003e\u003cspan class=\"nx\"\u003ephp\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eA\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"k\"\u003efunction\u003c/span\u003e \u003cspan class=\"nf\"\u003enewStaticClass\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"k\"\u003efunction\u003c/span\u003e \u003cspan class=\"nf\"\u003enewSelfClass\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003efunction\u003c/span\u003e \u003cspan class=\"nf\"\u003enewThisClass\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nv\"\u003e$this\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eB\u003c/span\u003e \u003cspan class=\"k\"\u003eextends\u003c/span\u003e \u003cspan class=\"nx\"\u003eA\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003efunction\u003c/span\u003e \u003cspan class=\"nf\"\u003enewParentClass\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"k\"\u003eparent\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eC\u003c/span\u003e \u003cspan class=\"k\"\u003eextends\u003c/span\u003e \u003cspan class=\"nx\"\u003eB\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"k\"\u003efunction\u003c/span\u003e \u003cspan class=\"nf\"\u003enewSelfClass\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$c\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003eC\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$c\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"na\"\u003enewStaticClass\u003c/span\u003e\u003cspan class=\"p\"\u003e());\u003c/span\u003e \u003cspan class=\"c1\"\u003e// C and is same C::newStaticClass()\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$c\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"na\"\u003enewSelfClass\u003c/span\u003e\u003cspan class=\"p\"\u003e());\u003c/span\u003e \u003cspan class=\"c1\"\u003e// C because self now points to \u0026#34;C\u0026#34; class\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$c\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"na\"\u003enewThisClass\u003c/span\u003e\u003cspan class=\"p\"\u003e());\u003c/span\u003e \u003cspan class=\"c1\"\u003e// C\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"nx\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$c\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"na\"\u003enewParentClass\u003c/span\u003e\u003cspan class=\"p\"\u003e());\u003c/span\u003e \u003cspan class=\"c1\"\u003e// A because parent was defined *way back* in class \u0026#34;B\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"references\"\u003eReferences\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://stackoverflow.com/questions/151969/when-to-use-self-over-this\"\u003ephp - When to use self over $this? - Stack Overflow\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e","title":"PHP 中 this self parent 用法"},{"content":"周末看了《摔跤吧，爸爸》，也是第一次独自电影院看电影，试写一篇影评纪念下。\n注意：严重剧透预警。\n主角爸爸是印度全国摔跤冠军，一心想着为国家赢取一枚金牌。可自己没能实现梦想，把梦想转移给了自己还未出世的孩子。可事与愿违，想要男孩的主角爸爸的前三个孩子都是女孩，第四个还是女孩。主角爸爸近乎要放弃为国争取金牌的梦想时，却意外看的了大女儿、二女儿身上的摔跤天赋。\n主角妈妈在得知主角爸爸准备将女儿们训练为拳击手时，道出了 “你不能将你的梦想施加在女儿们身上”，主角爸爸沉思片刻 “给我一年时间，其间你不要插手，如果没成功，我将有永远放弃我的梦想”。在主角爸爸说出这句话之前，我是反对父母将自己的梦想让孩子去实现的，也更没有去争取过孩子们的想法，现实中这样做的父母我是常为 Loser. 但是主角爸爸的回答让我看到的不是一个：被自己个人梦想冲昏头，用孩子的全部去成就自己的父亲。主角爸爸是讲道理的，一年后如果失败也会甘愿放弃。坚持与固执的区别也许就在此。\n主角爸爸变身为女儿们的魔鬼摔跤教练，每天除了上学就是训练，跑步时衣服不合适换男生衣服，找侄子当陪练，没有力量加餐牛奶、鸡肉，长头发难清理剪成了寸头。受苦中的女儿们找妈妈求情，主角妈妈遵守承诺，不干预主角爸爸的训练。这里真的要给主角妈妈点赞，后面女儿们的成功，女儿们、主角爸爸的努力在明面放着，而主角妈妈的守诺不干预，对主角爸爸的信赖，是同样的伟大。不然那柔弱的耳边风不知乱了多少坚定的意志。\n训练太辛苦的女儿们采用消极怠工对抗主角爸爸。破坏闹钟、破坏场地、假摔示弱。而旷工一天参加好友的婚礼现场被主角爸爸收拾。在与好友诉苦时，才发现了：对比其他女孩一望到底的家庭妇女人生，主角爸爸的狠心是那样让人羡慕。\n观念改变的女儿们开始主动训练。大女儿首次参赛就初露锋芒，差一点将男孩对手打败。逐渐成长的大女儿愈战愈勇的直到赢得全国冠军。全国冠军都会进入国家体育学校学习，大女儿也要离开主角爸爸接受新教练的训练，备战世界大赛。从小镇走出来的大女儿，没了主角爸爸的严格管束，开始着迷于这外面多彩的世界。吃油炸食品、留起头发、逛街、电影院。假期回家的大女儿用自己新学的技巧击败了主角爸爸，更是产生自我膨胀，对主角爸爸传统技术技巧的不屑与不信任。\n国际大赛上大女儿频频失利，无能教练将此归为命运。与此同时坚信主角爸爸训练方式的二儿女也获得全国冠军，进入国家队。在二儿女和主角妈妈的劝解下，一通电话化解了大女儿和主角爸爸的隔阂。主角爸爸亲自来到体育学校，为大女儿备战下次的国际大赛。\n主角爸爸在仔细研究大女儿对手后，制定了针对性的战术帮助大女儿杀入决赛。无能教练为了不让主角爸爸抢了自己的功劳，在决赛开始前将主角爸爸骗入小黑屋，无法让主角爸爸指导大女儿比赛。决赛第二局大女儿没能把握赛点，让对手追平。主角爸爸继续被困，只能默默祈祷。决赛最后一局，大女儿大比分落后，最后 10 秒大女儿脑海闪现着主角爸爸的叮咛，一击 5 分绝杀翻盘，赢得世界冠军。冠军的国歌声奏起，小黑屋中的主角爸爸也被路人解救，冲入赛场的主角爸爸与大女儿四目相对，此时这已经不是大女儿或主角爸爸哪一个人的冠军，而是所有正在与命运抗战者的胜利。\n主角爸爸：“你是我的骄傲”\n电影的专业手法和技术自己不懂，但是自己有个感觉：影片后期有大量的摔跤比赛，时不时有种看奥运赛的感觉，但是自己并没有感到乏味。电影故事情节很寻常，但是娓娓道来，很多细节小事让节奏不拖沓。故事人物有主角爸爸的理性和坚持、主角妈妈的守诺不干预、女儿们自我的成长、侄子的酱油加醋、无能教练损人为己\n电影给我也留下了几个现实问题：\n父母的认识经验一定比子女高的多，主角爸爸在看到女儿们的摔跤天赋时，狠心训练与女儿本身的意愿如何选择？ 父母逐渐变老，他们真的跟不上我们了吗？ 如何辨别无能教练的瞎指挥？ \u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2017/05/14/i-am-proud-of-you/","summary":"\u003cp\u003e周末看了《摔跤吧，爸爸》，也是第一次独自电影院看电影，试写一篇影评纪念下。\u003c/p\u003e\n\u003cp\u003e注意：\u003cstrong\u003e严重剧透预警。\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003e主角爸爸是印度全国摔跤冠军，一心想着为国家赢取一枚金牌。可自己没能实现梦想，把梦想转移给了自己还未出世的孩子。可事与愿违，想要男孩的主角爸爸的前三个孩子都是女孩，第四个还是女孩。主角爸爸近乎要放弃为国争取金牌的梦想时，却意外看的了大女儿、二女儿身上的摔跤天赋。\u003c/p\u003e\n\u003c!-- more --\u003e\n\u003cp\u003e主角妈妈在得知主角爸爸准备将女儿们训练为拳击手时，道出了 “你不能将你的梦想施加在女儿们身上”，主角爸爸沉思片刻 “给我一年时间，其间你不要插手，如果没成功，我将有永远放弃我的梦想”。在主角爸爸说出这句话之前，我是反对父母将自己的梦想让孩子去实现的，也更没有去争取过孩子们的想法，现实中这样做的父母我是常为 Loser. 但是主角爸爸的回答让我看到的不是一个：被自己个人梦想冲昏头，用孩子的全部去成就自己的父亲。主角爸爸是讲道理的，一年后如果失败也会甘愿放弃。坚持与固执的区别也许就在此。\u003c/p\u003e\n\u003cp\u003e主角爸爸变身为女儿们的魔鬼摔跤教练，每天除了上学就是训练，跑步时衣服不合适换男生衣服，找侄子当陪练，没有力量加餐牛奶、鸡肉，长头发难清理剪成了寸头。受苦中的女儿们找妈妈求情，主角妈妈遵守承诺，不干预主角爸爸的训练。这里真的要给主角妈妈点赞，后面女儿们的成功，女儿们、主角爸爸的努力在明面放着，而主角妈妈的守诺不干预，对主角爸爸的信赖，是同样的伟大。不然那柔弱的耳边风不知乱了多少坚定的意志。\u003c/p\u003e\n\u003cp\u003e训练太辛苦的女儿们采用消极怠工对抗主角爸爸。破坏闹钟、破坏场地、假摔示弱。而旷工一天参加好友的婚礼现场被主角爸爸收拾。在与好友诉苦时，才发现了：对比其他女孩一望到底的家庭妇女人生，主角爸爸的狠心是那样让人羡慕。\u003c/p\u003e\n\u003cp\u003e观念改变的女儿们开始主动训练。大女儿首次参赛就初露锋芒，差一点将男孩对手打败。逐渐成长的大女儿愈战愈勇的直到赢得全国冠军。全国冠军都会进入国家体育学校学习，大女儿也要离开主角爸爸接受新教练的训练，备战世界大赛。从小镇走出来的大女儿，没了主角爸爸的严格管束，开始着迷于这外面多彩的世界。吃油炸食品、留起头发、逛街、电影院。假期回家的大女儿用自己新学的技巧击败了主角爸爸，更是产生自我膨胀，对主角爸爸传统技术技巧的不屑与不信任。\u003c/p\u003e\n\u003cp\u003e国际大赛上大女儿频频失利，无能教练将此归为命运。与此同时坚信主角爸爸训练方式的二儿女也获得全国冠军，进入国家队。在二儿女和主角妈妈的劝解下，一通电话化解了大女儿和主角爸爸的隔阂。主角爸爸亲自来到体育学校，为大女儿备战下次的国际大赛。\u003c/p\u003e\n\u003cp\u003e主角爸爸在仔细研究大女儿对手后，制定了针对性的战术帮助大女儿杀入决赛。无能教练为了不让主角爸爸抢了自己的功劳，在决赛开始前将主角爸爸骗入小黑屋，无法让主角爸爸指导大女儿比赛。决赛第二局大女儿没能把握赛点，让对手追平。主角爸爸继续被困，只能默默祈祷。决赛最后一局，大女儿大比分落后，最后 10 秒大女儿脑海闪现着主角爸爸的叮咛，一击 5 分绝杀翻盘，赢得世界冠军。冠军的国歌声奏起，小黑屋中的主角爸爸也被路人解救，冲入赛场的主角爸爸与大女儿四目相对，此时这已经不是大女儿或主角爸爸哪一个人的冠军，而是所有正在与命运抗战者的胜利。\u003c/p\u003e\n\u003cp\u003e主角爸爸：“你是我的骄傲”\u003c/p\u003e\n\u003chr\u003e\n\u003cp\u003e电影的专业手法和技术自己不懂，但是自己有个感觉：影片后期有大量的摔跤比赛，时不时有种看奥运赛的感觉，但是自己并没有感到乏味。电影故事情节很寻常，但是娓娓道来，很多细节小事让节奏不拖沓。故事人物有主角爸爸的理性和坚持、主角妈妈的守诺不干预、女儿们自我的成长、侄子的酱油加醋、无能教练损人为己\u003c/p\u003e\n\u003cp\u003e电影给我也留下了几个现实问题：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e父母的认识经验一定比子女高的多，主角爸爸在看到女儿们的摔跤天赋时，狠心训练与女儿本身的意愿如何选择？\u003c/li\u003e\n\u003cli\u003e父母逐渐变老，他们真的跟不上我们了吗？\u003c/li\u003e\n\u003cli\u003e如何辨别无能教练的瞎指挥？\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u0026ndash; EOF \u0026ndash;\u003c/p\u003e","title":"【摔跤吧，爸爸】随笔"},{"content":"NGNIX 有两份 fastcgi 配置文件，分别是 fastcgi_params 和 fastcgi.conf，其区别只有一点点。到目前为止，由于 package managers，他们仍然引起新用户的混淆。\n在自己系统中还有份 snippets/fastcgi-php.conf，这个又是啥？\nfastcgi_params vs fastcgi.conf 它们都是用于配置 NGINX 与 FastCGI 应用程序通信的参数文件。\nfastcgi_params: 包含了FastCGI应用程序所需的最基本参数，如SCRIPT_FILENAME、QUERY_STRING等。这些参数通常不需要修改。 fastcgi.conf: 包含了更高级的FastCGI参数，可以用于优化FastCGI应用程序的性能，如设置连接超时时间、缓冲区大小等。 fastcgi.conf 比 fastcgi_params 多了一行 SCRIPT_FILENAME 的定义\nfastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name; 注意：$document_root 和 $fastcgi_script_name 之间没有 /。\n原本 NGNIX 只有 fastcgi_params，后来发现很多人在定义 SCRIPT_FILENAME 时使用了硬编码的方式，于是为了规范用法便引入了 fastcgi.conf。\n不过这样的话就产生一个疑问：为什么一定要引入一个新的配置文件，而不是修改旧的配置文件？\n这是因为fastcgi_param 指令是数组型的，和普通指令相同的是：内层替换外层；和普通指令不同的是：当在同级多次使用的时候，是新增而不是替换。\n换句话说，如果在同级定义两次 SCRIPT_FILENAME，那么它们都会被发送到后端，这可能会导致一些潜在的问题，为了避免此类情况，便引入了一个新的配置文件。\nserver { listen 80; server_name foo.com; root /path; index index.html index.htm index.php; location / { try_files $uri $uri/ /index.php$is_args$args; } location ~ \\.php$ { try_files $uri =404; include fastcgi.conf; fastcgi_pass 127.0.0.1:9000; } } fastcgi-php.conf fastcgi-php.conf 是一个 Nginx 配置文件片段，用于配置 Nginx 服务器与 PHP FastCGI 进程之间的通信。它定义了 FastCGI 连接的参数和选项，以及如何处理 PHP 脚本。通常，这个文件是在 Nginx 的主配置文件中包含的，以确保 Nginx 能够正确地将请求发送到 PHP FastCGI 进程。\n# regex to split $uri to $fastcgi_script_name and $fastcgi_path fastcgi_split_path_info ^(.+\\.php)(/.+)$; # Check that the PHP script exists before passing it try_files $fastcgi_script_name =404; # Bypass the fact that try_files resets $fastcgi_path_info # see: http://trac.nginx.org/nginx/ticket/321 set $path_info $fastcgi_path_info; fastcgi_param PATH_INFO $path_info; fastcgi_index index.php; include fastcgi.conf; 从 fastcgi-php.conf 的内容可以看出，它帮我们封装了一些公共代码。\nserver { ... location ~ \\.php$ { include snippets/fastcgi-php.conf; fastcgi_pass 127.0.0.1:9000; } } PHP NGINX Unix Sock 切换 TCP/IP sudo vim /etc/php5/fpm/pool.d/www.conf # 取消注释 listen.backlog = 65536 # 查找 listen = /var/run/php5-fpm.sock # 修改为 listen = 127.0.0.1:9000 and then, edit NGINX configuration file\nfastcgi_pass unix:/var/run/php5-fpm.sock; # 修改为 fastcgi_pass 127.0.0.1:9000; sudo service php5-fpm restart sudo service nginx restart References 如何正确配置 Nginx+PHP | 火丁笔记 fastcgi_params Versus fastcgi.conf - Nginx Config History How To Install Nginx on Ubuntu 16.04 | DigitalOcean nginx-build/fastcgi-php.conf at master · EasyEngine/nginx-build ","permalink":"https://zyf.im/2017/04/22/nginx-fastcgi-params-fastcgi-fastcgi-php/","summary":"\u003cp\u003eNGNIX 有两份 fastcgi 配置文件，分别是 \u003ccode\u003efastcgi_params\u003c/code\u003e 和 \u003ccode\u003efastcgi.conf\u003c/code\u003e，其区别只有一点点。到目前为止，由于 package managers，他们仍然引起新用户的混淆。\u003c/p\u003e\n\u003cp\u003e在自己系统中还有份 \u003ccode\u003esnippets/fastcgi-php.conf\u003c/code\u003e，这个又是啥？\u003c/p\u003e\n\u003ch2 id=\"fastcgi_params-vs-fastcgiconf\"\u003efastcgi_params vs fastcgi.conf\u003c/h2\u003e\n\u003cp\u003e它们都是用于配置 NGINX 与 FastCGI 应用程序通信的参数文件。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003efastcgi_params: 包含了FastCGI应用程序所需的最基本参数，如SCRIPT_FILENAME、QUERY_STRING等。这些参数通常不需要修改。\u003c/li\u003e\n\u003cli\u003efastcgi.conf: 包含了更高级的FastCGI参数，可以用于优化FastCGI应用程序的性能，如设置连接超时时间、缓冲区大小等。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003ccode\u003efastcgi.conf\u003c/code\u003e 比 \u003ccode\u003efastcgi_params\u003c/code\u003e 多了一行 \u003ccode\u003eSCRIPT_FILENAME\u003c/code\u003e 的定义\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode class=\"language-conf\" data-lang=\"conf\"\u003efastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e注意：\u003ccode\u003e$document_root\u003c/code\u003e 和 \u003ccode\u003e$fastcgi_script_name\u003c/code\u003e 之间没有 \u003ccode\u003e/\u003c/code\u003e。\u003c/p\u003e\n\u003cp\u003e原本 NGNIX 只有 \u003ccode\u003efastcgi_params\u003c/code\u003e，后来发现很多人在定义 \u003ccode\u003eSCRIPT_FILENAME\u003c/code\u003e 时使用了硬编码的方式，于是为了规范用法便引入了 \u003ccode\u003efastcgi.conf\u003c/code\u003e。\u003c/p\u003e\n\u003cp\u003e不过这样的话就产生一个疑问：为什么一定要引入一个新的配置文件，而不是修改旧的配置文件？\u003c/p\u003e\n\u003cp\u003e这是因为\u003ccode\u003efastcgi_param\u003c/code\u003e 指令是数组型的，和普通指令相同的是：内层替换外层；和普通指令不同的是：当在同级多次使用的时候，是新增而不是替换。\u003c/p\u003e\n\u003cp\u003e换句话说，如果在同级定义两次 \u003ccode\u003eSCRIPT_FILENAME\u003c/code\u003e，那么它们都会被发送到后端，这可能会导致一些潜在的问题，为了避免此类情况，便引入了一个新的配置文件。\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode class=\"language-conf\" data-lang=\"conf\"\u003eserver {\n    listen 80;\n    server_name foo.com;\n\n    root /path;\n    index index.html index.htm index.php;\n\n    location / {\n        try_files $uri $uri/ /index.php$is_args$args;\n    }\n\n    location ~ \\.php$ {\n        try_files $uri =404;\n\n        include fastcgi.conf;\n        fastcgi_pass 127.0.0.1:9000;\n    }\n}\n\u003c/code\u003e\u003c/pre\u003e\u003ch2 id=\"fastcgi-phpconf\"\u003efastcgi-php.conf\u003c/h2\u003e\n\u003cp\u003e\u003ccode\u003efastcgi-php.conf\u003c/code\u003e 是一个 Nginx 配置文件片段，用于配置 Nginx 服务器与 PHP FastCGI 进程之间的通信。它定义了 FastCGI 连接的参数和选项，以及如何处理 PHP 脚本。通常，这个文件是在 Nginx 的主配置文件中包含的，以确保 Nginx 能够正确地将请求发送到 PHP FastCGI 进程。\u003c/p\u003e","title":"区分 NGINX 中 fastcgi_params fastcgi fastcgi-php"},{"content":"更新 2023-03-20 提问 ChatGPT 3.5\nCGI（Common Gateway Interface）是一种通用的 Web 服务器接口标准，它定义了 Web 服务器和应用程序之间进行通信的方式。CGI 程序在每次请求时都会启动一个新的进程，处理完请求后就会结束进程，因此效率较低。 FastCGI 是 CGI 的一种改进技术，它使用长连接的方式，使得多次请求可以在同一个进程中处理，从而提高了效率。 PHP-CGI 是 PHP 的 CGI 版本，它可以让 PHP 脚本在 Web 服务器上运行，但由于 CGI 的低效率，PHP-CGI 的性能也比较低。 PHP-FPM（PHP FastCGI Process Manager）是一个用于管理 PHP FastCGI 进程的工具，它可以提高 PHP 的性能和稳定性。 关联和区别：\nCGI 和 FastCGI 都是 Web 服务器和应用程序之间通信的方式，但 FastCGI 在性能上比 CGI 更好。 PHP-CGI 和 PHP-FPM 都是 PHP 在 Web 服务器上运行的方式，但 PHP-FPM 可以有效提高 PHP 的性能和稳定性。 作用举例：\n如果使用 CGI 或 PHP-CGI 来运行 PHP 脚本，每次请求都需要启动一个新的进程，效率较低。而如果使用 FastCGI 或 PHP-FPM，则可以使用长连接的方式，提高效率。 使用 PHP-FPM 时，可以配置多个进程，通过负载均衡的方式来分担请求，从而提高稳定性。 CGI Common Gateway Interface，HTTP 服务器与你的或其它机器上的程序进行“交谈”的一种协议，其程序须运行在网络服务器上。\nweb server（比如说 Nginx）只是内容的分发者。\n如果请求 /index.html，那么 web server 会去文件系统中找到这个文件，发送给浏览器，这里分发的是静态数据。 如果现在请求的是 /index.php，根据配置文件，nginx 知道这个不是静态文件，需要去找 PHP 解析器来处理，那么他会把这个请求简单处理后交给 PHP 解析器。Nginx 会传哪些数据给 PHP 解析器呢？url、查询字符串、POST 数据、HTTP header 等等，CGI 就是规定要传哪些数据、以什么样的格式传递给后方处理这个请求的协议。 FastCGI FastCGI 是语言无关的、可伸缩架构的 CGI 开放扩展，其主要行为是将 CGI 解释器进程保持在内存中并因此获得较高的性能。众所周知，CGI 解释器的反复加载是 CGI 性能低下的主要原因（fork-and-execute），如果 CGI 解释器保持在内存中并接受 FastCGI 进程管理器调度，则可以提供良好的性能、伸缩性、Fail-Over 特性等。\nFastCGI 的特点是会在一个进程中依次完成多个请求，以达到提高效率的目的，多数 FastCGI 实现都会维护一个进程池。\n那么 FastCGI 是怎么做的呢？首先，FastCGI 会先启一个 master，解析配置文件，初始化执行环境，然后再启动多个 worker。当请求过来时，master 会传递给一个 worker，然后立即可以接受下一个请求。这样就避免了重复的劳动，效率自然是高。而且当 worker 不够用时，master 可以根据配置预先启动几个 worker 等着；当然空闲 worker 太多时，也会停掉一些，这样就提高了性能，也节约了资源。这就是 FastCGI 对进程的管理。\nPHP-CGI PHP-CGI 只是个 CGI 程序，他自己本身只能解析请求，返回结果，不会进程管理。\nPHP-CGI 的不足：PHP-CGI 变更 php.ini 配置后需重启 PHP-CGI 才能让新的 php-ini 生效，不可以平滑重启。直接杀死 PHP-CGI 进程，PHP 就不能运行了。（PHP-FPM 和 Spawn-FCGI 就没有这个问题，守护进程会平滑从新生成新的子进程。）\nPHP-FPM PHP-FPM 是一个 PHP FastCGI 管理器，是只用于 PHP。\nPHP-FPM 是 PHP 针对 FastCGI 协议的具体实现，也是 PHP 在多种服务器端应用编程端口（SAPI：cgi、fast-cgi、cli、isapi、apache）里使用最普遍、性能最佳的一款进程管理器。\n小故事 你（PHP）去和爱斯基摩人（web 服务器，如 Apache、Nginx）谈生意。你说中文（PHP 代码），他说爱斯基摩语（C 代码），互相听不懂，怎么办？那就都把各自说的话转换成英语（FastCGI 协议）吧。\n怎么转换呢？你就要使用一个翻译机（PHP-FPM）（当然对方也有一个翻译机，那个是他自带的）\n我们这个翻译机是最新型的，老式的那个（PHP-CGI）被淘汰了。\n让我把话说完 FastCGI 是 Nginx 和 PHP 之间的一个通信接口，该接口实际处理过程通过启动 PHP-FPM 进程来解析 PHP 脚本，即 PHP-FPM 相当于一个动态应用服务器，从而实现 Nginx 动态解析 PHP。\n因此，如果 Nginx 服务器需要支持 PHP 解析，需要在 nginx.conf 中增加 PHP 的配置：将 PHP 脚本转发到 FastCGI 进程监听的 IP 地址和端口（php-fpm.conf 中指定）。\n同时，PHP 安装的时候，需要开启支持 FastCGI 选项，并且编译安装 PHP-FPM 补丁/扩展，同时，需要启动 PHP-FPM 进程，才可以解析 Nginx 通过 FastCGI 转发过来的 PHP 脚本\nReferences 搞不清 FastCgi 与 PHP-fpm 之间是个什么样的关系 什么是 CGI、FastCGI、PHP-CGI、PHP-FPM、Spawn-FCGI？ nginx、fastCGI、php-fpm 关系梳理 842864681 新浪博客 概念了解：CGI，FastCGI，PHP-CGI 与 PHP-FPM ","permalink":"https://zyf.im/2017/04/21/cgi-fastcgi-phpcgi-php-fpm/","summary":"\u003cp\u003e更新 2023-03-20 提问 ChatGPT 3.5\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eCGI（Common Gateway Interface）是一种通用的 Web 服务器接口标准，它定义了 Web 服务器和应用程序之间进行通信的方式。CGI 程序在每次请求时都会启动一个新的进程，处理完请求后就会结束进程，因此效率较低。\u003c/li\u003e\n\u003cli\u003eFastCGI 是 CGI 的一种改进技术，它使用长连接的方式，使得多次请求可以在同一个进程中处理，从而提高了效率。\u003c/li\u003e\n\u003cli\u003ePHP-CGI 是 PHP 的 CGI 版本，它可以让 PHP 脚本在 Web 服务器上运行，但由于 CGI 的低效率，PHP-CGI 的性能也比较低。\u003c/li\u003e\n\u003cli\u003ePHP-FPM（PHP FastCGI Process Manager）是一个用于管理 PHP FastCGI 进程的工具，它可以提高 PHP 的性能和稳定性。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e关联和区别：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eCGI 和 FastCGI 都是 Web 服务器和应用程序之间通信的方式，但 FastCGI 在性能上比 CGI 更好。\u003c/li\u003e\n\u003cli\u003ePHP-CGI 和 PHP-FPM 都是 PHP 在 Web 服务器上运行的方式，但 PHP-FPM 可以有效提高 PHP 的性能和稳定性。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e作用举例：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e如果使用 CGI 或 PHP-CGI 来运行 PHP 脚本，每次请求都需要启动一个新的进程，效率较低。而如果使用 FastCGI 或 PHP-FPM，则可以使用长连接的方式，提高效率。\u003c/li\u003e\n\u003cli\u003e使用 PHP-FPM 时，可以配置多个进程，通过负载均衡的方式来分担请求，从而提高稳定性。\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"cgi\"\u003eCGI\u003c/h2\u003e\n\u003cp\u003eCommon Gateway Interface，HTTP 服务器与你的或其它机器上的程序进行“交谈”的一种协议，其程序须运行在网络服务器上。\u003c/p\u003e","title":"区分 CGI FastCGI PHP-CGI PHP-FPM"},{"content":"MySQL 5.7 对比 5.6 有很多的变化。一个常见的需求：按条件分组后，取出每组中某字段最大值的那条记录。其实就是组内排序的问题，我的做法是：子查询先进行倒序排序，外层查询分组。\n示例 +----+----+-------+ | id | no | name | +----+----+-------+ | 5 | 5 | Mike | | 4 | 4 | Herry | | 3 | 3 | wyett | | 2 | 2 | John | | 7 | 2 | John | | 1 | 1 | Mike | | 6 | 1 | John | | 8 | 1 | Mike | | 9 | 1 | Mike | +----+----+-------+ 要求：取出每人（按 name），最大 no 的记录。\nselect * from ( select id,no,name from testorder order by no desc )a group by a.name; +----+----+-------+ | id | no | name | +----+----+-------+ | 4 | 4 | Herry | | 2 | 2 | John | | 5 | 5 | Mike | | 3 | 3 | wyett | +----+----+-------+ 但是在 5.7 中，首先需要关闭 ql_mode = ONLY_FULL_GROUP_BY；相同的 name 值，返回则是取了 最早写入的数据行 ，忽略了 order by no desc，按照数据的逻辑存储顺序来返回\n+----+----+-------+ | id | no | name | +----+----+-------+ | 4 | 4 | Herry | | 2 | 2 | John | | 1 | 1 | Mike | | 3 | 3 | wyett | +----+----+-------+ 等价于\nselect id,no,name from testorder group by name A query such as\nSELECT field1, field2 FROM ( SELECT field1, field2 FROM table1 ORDER BY field2 ) alias returns a result set that is not necessarily ordered by field2. This is not a bug. A \u0026ldquo;table\u0026rdquo; (and subquery in the FROM clause too) is - according to the SQL standard - an unordered set of rows. Rows in a table (or in a subquery in the FROM clause) do not come in any specific order.\n可以总结为：\n在 FROM 后的 subquery 中的 ORDER BY 会被忽略 GROUP BY cloumn 返回的行是无序的 解决方案 select a.id,a.no,a.name from testorder a inner join ( select max(no) no,name from testorder group by name ) b on a.no = b.no and a.name = b.name group by name,no 其他方案：\n对于不符合 ONLY_FULL_GROUP_BY 限制的字段，添加 unique 索引。 使用 ANY_VALUE()，让 MySQL 跳过 ONLY_FULL_GROUP_BY 检测。 小结 MySQL 5.6 Handling of GROUP BY\nIn standard SQL, a query that includes a GROUP BY clause cannot refer to nonaggregated columns in the select list that are not named in the GROUP BY clause.\n在标准 SQL 中，包含 GROUP BY 子句的查询 不能引用 select 列表中未在 GROUP BY 子句中命名的列。\nMySQL extends the standard SQL use of GROUP BY so that the select list can refer to nonaggregated columns not named in the GROUP BY clause. This means that the preceding query is legal in MySQL.\nMySQL 扩展了 GROUP BY 的标准 SQL 使用，以便选择列表可以引用 GROUP BY 子句中未命名的非集合列。这意味着前面的查询在 MySQL 中是合法的。\nHowever, this is useful primarily when all values in each nonaggregated column not named in the GROUP BY are the same for each group. The server is free to choose any value from each group, so unless they are the same, the values chosen are indeterminate.\n但是，主要是在 GROUP BY 中 未命名的每个非分组列中的所有值对于每个组是相同的，这是有用的。服务器可以自由选择每个组中的任何值，因此除非它们相同，所选择的值是 不确定的。\nFurthermore, the selection of values from each group cannot be influenced by adding an ORDER BY clause. Result set sorting occurs after values have been chosen, and ORDER BY does not affect which values within each group the server chooses.\n此外，通过添加 ORDER BY 子句不会影响来自每个组的值的选择。结果集排序发生在选择值后，ORDER BY 不影响 服务选择的每个组中的哪些值。\nMySQL 5.7 Handling of GROUP BY\nMySQL 5.7.5 and up implements detection of functional dependence. If the ONLY_FULL_GROUP_BY SQL mode is enabled (which it is by default), MySQL rejects queries for which the select list, HAVING condition, or ORDER BY list refer to nonaggregated columns that are neither named in the GROUP BY clause nor are functionally dependent on them. (Before 5.7.5, MySQL does not detect functional dependency and ONLY_FULL_GROUP_BY is not enabled by default.)\nMySQL 5.7.5 及以上功能依赖检测功能。如果启用了 ONLY_FULL_GROUP_BY SQL 模式（默认情况下），MySQL 将拒绝对列表，HAVING 条件或 ORDER BY 列表的查询引用在 GROUP BY 子句中既未命名的非集合列，也不在功能上依赖于它们。（5.7.5 之前，MySQL 没有检测到功能依赖关系，默认情况下不启用 ONLY_FULL_GROUP_BY）\nYou can achieve the same effect without disabling ONLY_FULL_GROUP_BY by using ANY_VALUE() to refer to the nonaggregated column.\n你可以通过使用 ANY_VALUE() 使禁用了 ONLY_FULL_GROUP_BY 的 SQL，来实现相同的效果来引用非聚合列。\n5.6 与 5.7 的区别 5.6 升级到 5.7 版本要注意：\nsql_mode 默认值的改变。 optimizer_switch 值的改变。 备库升级影响主备复制。 SELECT @@SQL_MODE, @@GLOBAL.SQL_MODE; -- 5.6 -- NO_ENGINE_SUBSTITUTION -- 5.7 -- ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION ONLY_FULL_GROUP_BY SELECT 查询的字段必须是 GROUP BY 中出现的或者使用聚合函数的或者是具有唯一索引的。 STRICT_TRANS_TABLES 在该模式下，如果一个值不能插入到一个事务表中，则中断当前的操作，对非事务表不做任何限制。 NO_ZERO_IN_DATE 在严格模式，不接受月或日部分为 0 的日期。如果使用 IGNORE 选项，我们为类似的日期插入'0000-00-00\u0026rsquo;。在非严格模式，可以接受该日期，但会生成警告。 NO_ZERO_DATE 在严格模式，不要将 \u0026lsquo;0000-00-00\u0026rsquo;做为合法日期。你仍然可以用 IGNORE 选项插入零日期。在非严格模式，可以接受该日期，但会生成警告。 ERROR_FOR_DIVISION_BY_ZERO 在严格模式，在 INSERT 或 UPDATE 过程中，如果被零除(或 MOD(X，0))，则产生错误(否则为警告)。如果未给出该模式，被零除时 MySQL 返回 NULL。如果用到 INSERT IGNORE 或 UPDATE IGNORE 中，MySQL 生成被零除警告，但操作结果为 NULL。 NO_AUTO_CREATE_USER 防止 GRANT 自动创建新用户，除非还指定了密码。 NO_ENGINE_SUBSTITUTION 如果需要的存储引擎被禁用或未编译，那么抛出错误。不设置此值时，用默认的存储引擎替代，并抛出一个异常。 STRICT_TRANS_TABLES 和 STRICT_ALL_TABLES 的区别 唯一的区别是：对于不支持事务的表，若开启 STRICT_TRANS_TABLES，MySQL 会尝试将一个不合法的字段值转换成一个值最近的合法值插入表中；而开启 STRICT_ALL_TABLES 后，则表现为不写入数据，且抛出错误。\n因为现在绝大部分用的 InnoDB 引擎，是支持事务的，所以基本不用关心这种区别。\n严格模式和非严格模式的区别 SET sql_mode = \u0026#39;STRICT_TRANS_TABLES\u0026#39;; 严格模式下不能在无符号整数字段插入负值。\n非严格模式下，会存储为 0。 严格模式下，报错。 严格模式下，无默认值的 NOT NULL 字段在插入数据时必须指定值。\n非严格模式下，若不插入数据会存储字段类型的默认值。 严格模式下，报错。 严格模式下，插入字符串不能超出定义长度\n非严格模式下，会成功插入数据，但是内容被截断。 严格模式下，报错。 References MySQL 组内排序取最大值 | mysqlwyett sql - MySQL Group By and Order By; - Stack Overflow MySQL5.7 中的 sql_mode 默认值 | zhihu MySQL: 严格模式 | letianbiji \u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2017/04/20/mysql-group-by-and-order-by-difference-between-56-57/","summary":"\u003cp\u003eMySQL 5.7 对比 5.6 有很多的变化。一个常见的需求：按条件分组后，取出每组中某字段最大值的那条记录。其实就是组内排序的问题，我的做法是：子查询先进行倒序排序，外层查询分组。\u003c/p\u003e\n\u003ch2 id=\"示例\"\u003e示例\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-md\" data-lang=\"md\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e+----+----+-------+\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e| id | no | name |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e+----+----+-------+\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e| 5 | 5 | Mike |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e| 4 | 4 | Herry |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e| 3 | 3 | wyett |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e| 2 | 2 | John |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e| 7 | 2 | John |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e| 1 | 1 | Mike |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e| 6 | 1 | John |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e| 8 | 1 | Mike |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e| 9 | 1 | Mike |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e+----+----+-------+\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e要求：取出每人（按 name），最大 no 的记录。\u003c/p\u003e","title":"MySQL 5.6 5.7 组内排序的区别"},{"content":"MySQL 创建用户、修改密码、删除用户；查看、授予、撤销用户权限；对 MySQL 远程访问的新理解。\n-- 创建用户 + 授权 GRANT ALL PRIVILEGES ON _._ TO \u0026#39;tom\u0026#39;@\u0026#39;%\u0026#39; IDENTIFIED BY \u0026#39;pwd123\u0026#39; WITH GRANT OPTION; -- 查询权限 SHOW GRANTS FOR \u0026#39;tom\u0026#39;@\u0026#39;%\u0026#39;; -- 授权 GRANT SELECT ON `my_db`.* TO \u0026#39;tom\u0026#39;@\u0026#39;%\u0026#39;; -- 撤权 REVOKE ALL PRIVILEGES ON `my_db`.* FROM \u0026#39;tom\u0026#39;@\u0026#39;%\u0026#39;; REVOKE GRANT OPTION ON `my_db`.* from \u0026#39;tom\u0026#39;@\u0026#39;%\u0026#39;; -- not necessary FLUSH PRIVILEGES; 管理用户 创建用户 CREATE USER \u0026#39;username\u0026#39;@\u0026#39;host\u0026#39; IDENTIFIED BY \u0026#39;password\u0026#39;; username：创建的用户名 host：该用户在哪个主机上可以登陆。如果是本地用户可用 localhost；如果想让该用户可以从任意远程主机登陆，可以使用通配符 % password：该用户的登陆密码。密码可以为空，如果为空则该用户可以不需要密码登陆服务器 例子：\nCREATE USER \u0026#39;dog\u0026#39;@\u0026#39;localhost\u0026#39; IDENTIFIED BY \u0026#39;123456\u0026#39;; CREATE USER \u0026#39;pig\u0026#39;@\u0026#39;192.168.1.%\u0026#39; IDENDIFIED BY \u0026#39;123456\u0026#39;; CREATE USER \u0026#39;pig\u0026#39;@\u0026#39;%\u0026#39; IDENTIFIED BY \u0026#39;123456\u0026#39;; CREATE USER \u0026#39;pig\u0026#39;@\u0026#39;%\u0026#39; IDENTIFIED BY \u0026#39;\u0026#39;; CREATE USER \u0026#39;pig\u0026#39;@\u0026#39;%\u0026#39;; 修改用户密码 SET PASSWORD FOR \u0026#39;username\u0026#39;@\u0026#39;host\u0026#39; = PASSWORD(\u0026#39;newpassword\u0026#39;); SET PASSWORD FOR \u0026#39;pig\u0026#39;@\u0026#39;%\u0026#39; = PASSWORD(\u0026#34;123456\u0026#34;); 如果修改当前登陆用户密码：\nSET PASSWORD = PASSWORD(\u0026#34;newpassword\u0026#34;); 删除用户 DROP USER \u0026#39;username\u0026#39;@\u0026#39;host\u0026#39;; 访问授权 查看用户权限 SHOW GRANTS FOR \u0026#39;pig\u0026#39;@\u0026#39;%\u0026#39;; 授予用户权限 GRANT PRIVILEGES ON databasename.tablename TO \u0026#39;username\u0026#39;@\u0026#39;host\u0026#39; GRANT SELECT, INSERT ON test.user TO \u0026#39;pig\u0026#39;@\u0026#39;%\u0026#39;; GRANT ALL ON *.* TO \u0026#39;pig\u0026#39;@\u0026#39;%\u0026#39;; privileges：用户的操作权限，如 SELECT INSERT UPDATE 等，如果要授予所的权限则使用 ALL databasename：数据库名 tablename：表名，如果要授予该用户对所有数据库和表的相应操作权限则可用 * 表示 注意： 用以上命令授权的用户不能给其它用户授权，如果想让该用户可以授权，用 WITH GRANT OPTION 命令：\nGRANT PRIVILEGES ON databasename.tablename TO \u0026#39;username\u0026#39;@\u0026#39;host\u0026#39; WITH GRANT OPTION; 撤销用户权限 REVOKE PRIVILEGE ON databasename.tablename FROM \u0026#39;username\u0026#39;@\u0026#39;host\u0026#39;; REVOKE SELECT ON *.* FROM \u0026#39;pig\u0026#39;@\u0026#39;%\u0026#39;; 注意： 假如你在给用户\u0026rsquo;pig\u0026rsquo;@\u0026rsquo;%\u0026lsquo;授权的时候是这样的（或类似的）：\nGRANT SELECT ON test.user TO \u0026#39;pig\u0026#39;@\u0026#39;%\u0026#39;; 则在使用：\nREVOKE SELECT ON _._ FROM \u0026#39;pig\u0026#39;@\u0026#39;%\u0026#39;; 命令并 不能 撤销该用户对 test 数据库中 user 表的 SELECT 操作。\n相反，如果授权使用的是：\nGRANT SELECT ON _._ TO \u0026#39;pig\u0026#39;@\u0026#39;%\u0026#39;; 则：\nREVOKE SELECT ON test.user FROM \u0026#39;pig\u0026#39;@\u0026#39;%\u0026#39;; 命令 也不能 撤销该用户对 test 数据库中 user 表的 SELECT 权限。\n具体信息可以用查看命令：\nSHOW GRANTS FOR \u0026#39;pig\u0026#39;@\u0026#39;%\u0026#39;; 刷新权限 FLUSH PRIVILEGES; 开启远程访问 通过上面的配置，可以发现：开启 MySQL 远程访问，其实就是修改用户权限：\n-- 只允许 192.168.1.100 连接 GRANT ALL PRIVILEGES ON _._ TO \u0026#39;root\u0026#39;@\u0026#39;192.168.1.100\u0026#39; IDENTIFIED BY \u0026#39;pwd123\u0026#39; WITH GRANT OPTION; -- 允许所有 ip 访问 GRANT ALL PRIVILEGES ON _._ TO \u0026#39;root\u0026#39;@\u0026#39;%\u0026#39; IDENTIFIED BY \u0026#39;pwd123\u0026#39; WITH GRANT OPTION; 注意： Ubuntu 上还需要修改 MySQL 配置文件\nsudo vim /etc/mysql/mysql.conf.d/mysqld.cnf 将 bind-address = 127.0.0.1 这一行注释掉, 即:\n#bind-address = 127.0.0.1 重启 MySQL\n补充 查询当前用户：\nmysql\u0026gt; SELECT CURRENT_USER(); HOST User 被条目匹配的连接 \u0026rsquo;thomas.loc.gov\u0026rsquo; \u0026lsquo;fred\u0026rsquo; fred, 从 thomas.loc.gov 连接 \u0026rsquo;thomas.loc.gov' '' 任何用户, 从 thomas.loc.gov 连接 \u0026lsquo;%\u0026rsquo; \u0026lsquo;fred\u0026rsquo; fred, 从任何主机连接 \u0026lsquo;%\u0026rsquo; '' 任何用户, 从任何主机连接 \u0026lsquo;%.loc.gov\u0026rsquo; \u0026lsquo;fred\u0026rsquo; fred, 从在 loc.gov 域的任何主机连接 \u0026lsquo;x.y.%\u0026rsquo; \u0026lsquo;fred\u0026rsquo; fred, 从 x.y.net、x.y.com,x.y.edu 等联接（这或许无用） \u0026lsquo;144.155.166.177\u0026rsquo; \u0026lsquo;fred\u0026rsquo; fred, 从有 144.155.166.177 的主机连接 \u0026lsquo;144.155.166.%\u0026rsquo; \u0026lsquo;fred\u0026rsquo; fred, 从 144.155.166 C 类子网的任何主机连接 可以在 Host 字段使用 IP 通配符值（例如，'144.155.166.%' 匹配在一个子网上的每台主机），有可能某人可能企图探究这种能力，通过命名一台主机为 144.155.166.somewhere.com。为了阻止这样的企图，MySQL 不允许匹配以数字和一个点起始的主机名，这样，如果你用一个命名为类似 1.2.foo.com 的主机，它的名字决不会匹配授权表中的 Host 列。只有一个 IP 数字能匹配 IP 通配符值。\nReferences MySQL 创建用户与授权 - 简书 5.7.5. 访问控制, 阶段 1：连接核实 \u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2017/04/11/mysql-manage-user-and-grant/","summary":"\u003cp\u003eMySQL 创建用户、修改密码、删除用户；查看、授予、撤销用户权限；对 MySQL 远程访问的新理解。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sql\" data-lang=\"sql\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e-- 创建用户 + 授权\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003eGRANT\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eALL\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003ePRIVILEGES\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eON\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003e_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003e_\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eTO\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;tom\u0026#39;\u003c/span\u003e\u003cspan class=\"o\"\u003e@\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;%\u0026#39;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eIDENTIFIED\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eBY\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;pwd123\u0026#39;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eWITH\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eGRANT\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eOPTION\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"c1\"\u003e-- 查询权限\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003eSHOW\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eGRANTS\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eFOR\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;tom\u0026#39;\u003c/span\u003e\u003cspan class=\"o\"\u003e@\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;%\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"c1\"\u003e-- 授权\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003eGRANT\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eSELECT\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eON\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"n\"\u003emy_db\u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eTO\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;tom\u0026#39;\u003c/span\u003e\u003cspan class=\"o\"\u003e@\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;%\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"c1\"\u003e-- 撤权\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003eREVOKE\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eALL\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003ePRIVILEGES\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eON\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"n\"\u003emy_db\u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eFROM\u003c/span\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;tom\u0026#39;\u003c/span\u003e\u003cspan class=\"o\"\u003e@\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;%\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003eREVOKE\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eGRANT\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eOPTION\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eON\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"n\"\u003emy_db\u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003efrom\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;tom\u0026#39;\u003c/span\u003e\u003cspan class=\"o\"\u003e@\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;%\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"c1\"\u003e-- not necessary\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"n\"\u003eFLUSH\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003ePRIVILEGES\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"管理用户\"\u003e管理用户\u003c/h2\u003e\n\u003ch3 id=\"创建用户\"\u003e创建用户\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eCREATE USER \u003cspan class=\"s1\"\u003e\u0026#39;username\u0026#39;\u003c/span\u003e@\u003cspan class=\"s1\"\u003e\u0026#39;host\u0026#39;\u003c/span\u003e IDENTIFIED BY \u003cspan class=\"s1\"\u003e\u0026#39;password\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cul\u003e\n\u003cli\u003e\u003ccode\u003eusername\u003c/code\u003e：创建的用户名\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003ehost\u003c/code\u003e：该用户在哪个主机上可以登陆。如果是本地用户可用 \u003ccode\u003elocalhost\u003c/code\u003e；如果想让该用户可以从任意远程主机登陆，可以使用通配符 \u003ccode\u003e%\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003epassword\u003c/code\u003e：该用户的登陆密码。密码可以为空，如果为空则该用户可以不需要密码登陆服务器\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e例子：\u003c/p\u003e","title":"MySQL 管理用户与访问授权"},{"content":"解决你的问题的方法是将你的用户加入 sudoers 文件。\nsudo visudo 在文件底部输入：\nusername ALL=(ALL) NOPASSWD: ALL 这只适用于终端窗口中的 sudo 命令。例如，当你尝试在 software center 中安装软件包时，将提示你输入密码。\nReferences command line - Execute sudo without Password? - Ask Ubuntu ","permalink":"https://zyf.im/2017/04/10/execute-sudo-without-password-in-ubuntu-terminal/","summary":"\u003cp\u003e解决你的问题的方法是将你的用户加入 sudoers 文件。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo visudo\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e在文件底部输入：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-txt\" data-lang=\"txt\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eusername ALL=(ALL) NOPASSWD: ALL\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e这只适用于终端窗口中的 sudo 命令。例如，当你尝试在 software center 中安装软件包时，将提示你输入密码。\u003c/p\u003e\n\u003c!--more --\u003e\n\u003ch2 id=\"references\"\u003eReferences\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"http://askubuntu.com/questions/147241/execute-sudo-without-password\"\u003ecommand line - Execute sudo without Password? - Ask Ubuntu\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e","title":"Ubuntu 命令行下免密码执行 sudo 命令"},{"content":"使用邮件发送程序的执行情况、运行日志都非常方便，Ubuntu 下搭建邮件服务也不复杂。\nsendmail install sudo apt-get install sendmail configure run sendmail\u0026rsquo;s config and answer Y to everything\nsudo sendmailconfig mail install sudo apt-get install mailutils test echo \u0026#39;test-email-content\u0026#39; | mail -s \u0026#39;email title\u0026#39; xxx@gmail.com sendmail mail 区别 先需要搞清三个概念：\n邮件用户代理（MUA，Mail User Agent） 邮件传送代理（MTA，Mail Transport Agent） 邮件分发代理（MDA，Mail Deliver Agent） sedmail 是负责邮件传输的 MTA，类似 apache、nginx 的作用。mail 是用户使用客户端 MUA，类似 foxmail。\nReferences Install and configure Sendmail on Ubuntu Linux 下 mail、mailx 和 sendmail 的区别？ - 知乎 ","permalink":"https://zyf.im/2017/04/06/using-sendmail-mail-in-ubuntu/","summary":"\u003cp\u003e使用邮件发送程序的执行情况、运行日志都非常方便，Ubuntu 下搭建邮件服务也不复杂。\u003c/p\u003e\n\u003ch2 id=\"sendmail\"\u003esendmail\u003c/h2\u003e\n\u003ch3 id=\"install\"\u003einstall\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo apt-get install sendmail\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c!-- more --\u003e\n\u003ch3 id=\"configure\"\u003econfigure\u003c/h3\u003e\n\u003cp\u003erun sendmail\u0026rsquo;s config and answer \u003ccode\u003eY\u003c/code\u003e to everything\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo sendmailconfig\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"mail\"\u003email\u003c/h2\u003e\n\u003ch3 id=\"install-1\"\u003einstall\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo apt-get install mailutils\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"test\"\u003etest\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eecho\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;test-email-content\u0026#39;\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e mail -s \u003cspan class=\"s1\"\u003e\u0026#39;email title\u0026#39;\u003c/span\u003e xxx@gmail.com\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"sendmail-mail-区别\"\u003esendmail mail 区别\u003c/h2\u003e\n\u003cp\u003e先需要搞清三个概念：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e邮件用户代理（MUA，Mail User Agent）\u003c/li\u003e\n\u003cli\u003e邮件传送代理（MTA，Mail Transport Agent）\u003c/li\u003e\n\u003cli\u003e邮件分发代理（MDA，Mail Deliver Agent）\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003esedmail 是负责邮件传输的 MTA，类似 apache、nginx 的作用。mail 是用户使用客户端 MUA，类似 foxmail。\u003c/p\u003e\n\u003ch2 id=\"references\"\u003eReferences\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://gist.github.com/adamstac/7462202\"\u003eInstall and configure Sendmail on Ubuntu\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.zhihu.com/question/19728556\"\u003eLinux 下 mail、mailx 和 sendmail 的区别？ - 知乎\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e","title":"Ubuntu 下使用 sendmail mail 发送邮件"},{"content":"Pushing to a non-bare repo is now possible (Git 2.3.0 February 2015).\nAnd it is possible when you are pushing the branch currently checked out at the remote repo!\n现在已经是可以在俩个 non-bare 的仓库之间推送代码。\n只需要再远程仓库配置：\ngit config receive.denyCurrentBranch updateInstead 就可以直接 push 分支到远程，并更新工作区。此方法可以用于项目部署。\nreceive-pack: add another option for receive.denyCurrentBranch\nWhen synchronizing between working directories, it can be handy to update the current branch via \u0026lsquo;push\u0026rsquo; rather than \u0026lsquo;pull\u0026rsquo;, e.g. when pushing a fix from inside a VM, or when pushing a fix made on a user\u0026rsquo;s machine (where the developer is not at liberty to install an ssh daemon let alone know the user\u0026rsquo;s password).\nThe common workaround – pushing into a temporary branch and then merging on the other machine – is no longer necessary with this patch.\nThe new option is:\nupdateInstead: Update the working tree accordingly, but refuse to do so if there are any uncommitted changes.\nin remote repo:\ngit config receive.denyCurrentBranch updateInstead and then you can use git push to synchronize between working directories in local repo.\nReferences cannot push into git repository - Stack Overflow receive-pack: add another option for receive.denyCurrentBranch ","permalink":"https://zyf.im/2017/03/30/git-synchronizing-between-working-directories-by-push/","summary":"\u003cp\u003e\u003cem\u003ePushing to a non-bare repo is now possible (Git 2.3.0 February 2015).\u003c/em\u003e\u003c/p\u003e\n\u003cp\u003eAnd it is possible when you are pushing the branch currently checked out at the remote repo!\u003c/p\u003e\n\u003cp\u003e现在已经是可以在俩个 non-bare 的仓库之间推送代码。\u003c/p\u003e\n\u003cp\u003e只需要再远程仓库配置：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit config receive.denyCurrentBranch updateInstead\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e就可以直接 \u003ccode\u003epush\u003c/code\u003e 分支到远程，并更新工作区。此方法可以用于项目部署。\u003c/p\u003e\n\u003c!--more --\u003e\n\u003cp\u003e\u003cstrong\u003ereceive-pack: add another option for \u003ccode\u003ereceive.denyCurrentBranch\u003c/code\u003e\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003eWhen synchronizing between working directories, it can be handy to update the current branch via \u0026lsquo;push\u0026rsquo; rather than \u0026lsquo;pull\u0026rsquo;, e.g. when pushing a fix from inside a VM, or when pushing a fix made on a user\u0026rsquo;s machine (where the developer is not at liberty to install an ssh daemon let alone know the user\u0026rsquo;s password).\u003c/p\u003e","title":"Git 在工作目录之间使用 push 进行同步"},{"content":"服务器是使用 publickey 进行连接，当在 git push 时发生 Permission denied (publickey)。同时解决 ssh-add 重启后失效。\n解决 ssh-add your_publickey 如果遇到报错\nCould not open a connection to your authentication agent. Try to\neval `ssh-agent` 注意： 在重启电脑后失效，一直没有找的其他合适的解决方案，所以选择在 ~/.bashrc 或 ~/.zshrc 中添加：\nssh-add your_publickey 2\u0026gt; /dev/null 2\u0026gt; /dev/null 是为了保持静默运行\nReferences ssh 连接提示 Permission denied (publickey) 怎么破？ | 吴川斌的博客 ","permalink":"https://zyf.im/2017/03/30/resolving-ssh-permission-denied-publickey/","summary":"\u003cp\u003e服务器是使用 publickey 进行连接，当在 git push 时发生 \u003ccode\u003ePermission denied (publickey)\u003c/code\u003e。同时解决 ssh-add 重启后失效。\u003c/p\u003e\n\u003ch2 id=\"解决\"\u003e解决\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003essh-add your_publickey\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e如果遇到报错\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eCould not open a connection to your authentication agent.\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eTry to\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eeval\u003c/span\u003e \u003cspan class=\"sb\"\u003e`\u003c/span\u003essh-agent\u003cspan class=\"sb\"\u003e`\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c!--more --\u003e\n\u003cp\u003e\u003cstrong\u003e注意：\u003c/strong\u003e 在重启电脑后失效，一直没有找的其他合适的解决方案，所以选择在 \u003ccode\u003e~/.bashrc\u003c/code\u003e 或 \u003ccode\u003e~/.zshrc\u003c/code\u003e 中添加：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003essh-add your_publickey 2\u0026gt; /dev/null\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003ccode\u003e2\u0026gt; /dev/null\u003c/code\u003e 是为了保持静默运行\u003c/p\u003e\n\u003ch2 id=\"references\"\u003eReferences\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"http://www.mr-wu.cn/ssh-permission-denied-publickey/\"\u003essh 连接提示 Permission denied (publickey) 怎么破？ | 吴川斌的博客\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e","title":"解决 SSH 连接提示 Permission denied publickey"},{"content":"sogou 输入法突然无法选词输入中文，候选词位置出现白框，多次重重装 fcitx 和 sogou 也没有解决。尝试使用 google pinyin 代替，但是感觉很不顺手。\nissue in GitHub sogou 输入法 GitHub 上的一些 issue：\n#43 #177 #179 解决 方案一 try to lastest version\n方案二 clean fcitx, SogouPY*, sogou-qimpanel in ~/.config, then relogin and try again\ncd ~/.config sudo rm -rf fcitx SogouPY sogou-qimpanel References ubuntu-sogou-不能显示候选词 | Color Win\u0026rsquo;s Notes \u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2017/03/17/resolving-ubuntu-sogou-can-not-select-word/","summary":"\u003cp\u003esogou 输入法突然无法选词输入中文，候选词位置出现白框，多次重重装 fcitx 和 sogou 也没有解决。尝试使用 google pinyin 代替，但是感觉很不顺手。\u003c/p\u003e\n\u003c!-- more --\u003e\n\u003ch2 id=\"issue-in-github\"\u003eissue in GitHub\u003c/h2\u003e\n\u003cp\u003esogou 输入法 GitHub 上的一些 issue：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/FZUG/repo/issues/43\"\u003e#43\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/FZUG/repo/issues/177\"\u003e#177\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/FZUG/repo/issues/179\"\u003e#179\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"解决\"\u003e解决\u003c/h2\u003e\n\u003ch3 id=\"方案一\"\u003e方案一\u003c/h3\u003e\n\u003cp\u003etry to lastest version\u003c/p\u003e\n\u003ch3 id=\"方案二\"\u003e方案二\u003c/h3\u003e\n\u003cp\u003eclean \u003ccode\u003efcitx\u003c/code\u003e, \u003ccode\u003eSogouPY*\u003c/code\u003e, \u003ccode\u003esogou-qimpanel\u003c/code\u003e in \u003ccode\u003e~/.config\u003c/code\u003e, then relogin and try again\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003ecd\u003c/span\u003e ~/.config\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo rm -rf  fcitx SogouPY sogou-qimpanel\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"references\"\u003eReferences\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://colorwin.github.io/2017/02/17/ubuntu-sogou/\"\u003eubuntu-sogou-不能显示候选词 | Color Win\u0026rsquo;s Notes\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u0026ndash; EOF \u0026ndash;\u003c/p\u003e","title":"解决 Ubuntu Sogou 无法选词输入中文"},{"content":"git log 中的一个清晰的提交线图是很方便进行 code review 和代码回退 git pull --rebase 主要是为是将提交约线图平坦化，而 git merge --no-ff 则是刻意制造分叉\npull rebase perform a rebase after fetching\n状况 Git 作为分布式版本控制系统，所有修改操作都是基于本地的，在团队协作过程中，假设你和你的同伴在本地中分别有各自的新提交，而你的同伴先于你 push 了代码到远程分支上，所以你必须先执行 git pull 来获取同伴的提交，然后才能 push 自己的提交到远程分支。\n按照 Git 的默认策略，如果远程分支和本地分支之间的提交线图有分叉的话（即不是 fast-forwarded），Git 会执行一次 merge 操作，因此产生一次没意义的提交记录，从而造成了像上图那样的混乱。\n解决 其实在 pull 操作的时候，使用 git pull --rebase 选项即可很好地解决上述问题。 加上 --rebase 参数的作用是，提交线图有分叉的话，Git 会 rebase 策略来代替默认的 merge 策略。 假设提交线图在执行 pull 前是这样的：\nA---B---C remotes/origin/master / D---E---F---G master 如果是执行 git pull 后，结果多出了 H 这个没必要的提交记录。提交线图会变成这样：\nA---B---C remotes/origin/master / \\ D---E---F---G---H master 如果是执行 git pull --rebase 的话，提交线图就会变成这样：\nremotes/origin/master | D---E---A---B---C---F\u0026#39;---G\u0026#39; master F G 两个提交通过 rebase 方式重新拼接在 C 之后，多余的分叉去掉了，目的达到。\n注意 使用 git log --graph 可查看提交线图 使用 git pull --rebase 是为了使提交线图更好看，从而方便 code review 和代码回退 使用 git pull --rebase 比直接 pull 容易导致冲突的产生，如果预期冲突比较多的话，建议还是直接 pull\nmerge no-ff generate a merge commit even if the merge resolve\n例子 1 git pull --rebase 策略目的是修整提交线图，使其形成一条直线，而即将要用到的 git merge --no-ff \u0026lt;branch-name\u0026gt; 策略偏偏是反行其道，刻意地弄出提交线图分叉出来。\n假设你在本地准备合并两个分支，而刚好这两个分支是 fast-forwarded 的，那么直接合并后你得到一个直线的提交线图，当然这样没什么坏处，但如果你想更清晰地告诉你同伴：这一系列的提交都是为了实现同一个目的，那么你可以刻意地将这次提交内容弄成一次提交线图分叉。\n执行 git merge --no-ff \u0026lt;branch-name\u0026gt; 的结果大概会是这样的：\n中间的分叉线路图很清晰的显示这些提交都是为了实现：complete adjusting user domains and tags\n例子 2 往往在合并分支之前（假设要在本地将 feature 分支合并到 dev 分支），会先检查 feature 分支是否部分落后于远程 dev 分支：\ngit checkout dev git pull # 更新 dev 分支 git log feature..dev # 对比 如果没有输出任何提交信息的话，即表示 feature 对于 dev 分支是 up-to-date 的。如果有输出的话而马上执行了 git merge --no-ff 的话，提交线图会变成这样：\n所以这时在合并前，通常先执行：\ngit checkout feature git rebase dev 这样就可以将 feature 重新拼接到更新了的 dev 之后，然后就可以合并了。这时分叉点将上移，最终得到一个干净舒服的提交线图\n总结 使用 git pull --rebase 和 git merge --no-ff 其实和直接使用 git pull git merge 得到的代码应该是一样。 使用 git pull --rebase 主要是为是将提交约线图平坦化，而 git merge --no-ff 则是刻意制造分叉。 References 洁癖者用 Git：pull \u0026ndash;rebase 和 merge \u0026ndash;no-ff \u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2017/03/17/git-pull-rebase-and-merge-no-ff-to-keep-clear-commit-graph/","summary":"\u003cp\u003egit log 中的一个清晰的提交线图是很方便进行 code review 和代码回退\n\u003ccode\u003egit pull --rebase\u003c/code\u003e 主要是为是将提交约线图平坦化，而 \u003ccode\u003egit merge --no-ff\u003c/code\u003e 则是刻意制造分叉\u003c/p\u003e\n\u003ch2 id=\"pull-rebase\"\u003epull rebase\u003c/h2\u003e\n\u003cblockquote\u003e\n\u003cp\u003eperform a rebase after fetching\u003c/p\u003e\u003c/blockquote\u003e\n\u003ch3 id=\"状况\"\u003e状况\u003c/h3\u003e\n\u003cp\u003eGit 作为分布式版本控制系统，所有修改操作都是基于本地的，在团队协作过程中，假设你和你的同伴在本地中分别有各自的新提交，而你的同伴先于你 push 了代码到远程分支上，所以你必须先执行 \u003ccode\u003egit pull\u003c/code\u003e 来获取同伴的提交，然后才能 push 自己的提交到远程分支。\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"170317-git-pull-rebase-and-merge-no-ff-to-keep-clear-commit-graph-01\" loading=\"lazy\" src=\"https://user-images.githubusercontent.com/9289792/80202129-c1cdfb00-8657-11ea-814e-49f8618f301c.jpg\"\u003e\u003c/p\u003e\n\u003cp\u003e按照 Git 的默认策略，如果远程分支和本地分支之间的提交线图有分叉的话（即不是 fast-forwarded），Git 会执行一次 merge 操作，因此产生\u003cstrong\u003e一次没意义的提交记录\u003c/strong\u003e，从而造成了像上图那样的混乱。\u003c/p\u003e\n\u003ch3 id=\"解决\"\u003e解决\u003c/h3\u003e\n\u003cp\u003e其实在 pull 操作的时候，使用 \u003ccode\u003egit pull --rebase\u003c/code\u003e 选项即可很好地解决上述问题。 加上 \u003ccode\u003e--rebase\u003c/code\u003e 参数的作用是，提交线图有分叉的话，Git 会 \u003ccode\u003erebase\u003c/code\u003e 策略来代替默认的 \u003ccode\u003emerge\u003c/code\u003e 策略。\n假设提交线图在执行 pull 前是这样的：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                 A---B---C  remotes/origin/master\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                /\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e           D---E---F---G  master\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e如果是执行 \u003ccode\u003egit pull\u003c/code\u003e 后，结果多出了 H 这个没必要的提交记录。提交线图会变成这样：\u003c/p\u003e","title":"Git pull rebase 和 merge no-ff 保持提交线图整洁"},{"content":"使用代理上 Google 时，Google 常会根据网络代理的区域进行重定向跳转。例如：使用韩国代理时，google.com 会跳转到 https://www.google.co.kr/，搜索结果也多为韩语，很是不方便。\n解决的办法其实也很简单：访问 https://www.google.com/ncr 就可以了。\nncr 表示：No Country Redirection，禁止区域重定向。\n\u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2017/03/14/google-no-country-redirection/","summary":"\u003cp\u003e使用代理上 Google 时，Google 常会根据网络代理的区域进行重定向跳转。例如：使用韩国代理时，\u003ccode\u003egoogle.com\u003c/code\u003e 会跳转到 \u003ccode\u003ehttps://www.google.co.kr/\u003c/code\u003e，搜索结果也多为韩语，很是不方便。\u003c/p\u003e\n\u003cp\u003e解决的办法其实也很简单：访问 \u003ccode\u003ehttps://www.google.com/ncr\u003c/code\u003e 就可以了。\u003c/p\u003e\n\u003c!-- more --\u003e\n\u003cp\u003e\u003ccode\u003encr\u003c/code\u003e 表示：No Country Redirection，禁止区域重定向。\u003c/p\u003e\n\u003cp\u003e\u0026ndash; EOF \u0026ndash;\u003c/p\u003e","title":"禁止 Google 根据区域重定向跳转"},{"content":"在使用 Git 时，我们经常会遇到修改本地提交记录的情况。比如：修改最近一次提交记，还比如：将多次小的 commit 合并成一个大的 commit。\n这种做发有利也有弊，利在：review 代码时，可以按功能看，可以省去 review 一些前期写的无效的代码；弊是：一次提交修改过多，如果有问题，不利于调试。\n具体情况具体分析，是解决问题的金句。\n修改最近一次提交记录 修改提交说明 如果只想更改最近一次的提交说明，只需输入：\ngit commit --amend 然后你就会进入文本编辑器，输入你想要的内容，保存并退出即可\n改被提交的快照 如果你完成 commit 后又想修改被提交的快照，增加或者修改其中的文件。\n先执行 git add 命令，将修改的文件添加到缓存区，然后运行 git commit -amend 命令，该命令会获取你当前的暂存区的内容一并提交到最后一次 commit\n例如：新加了一个文件 new_file.cpp ，想要合并到最后一次提交，过程如下：\ngit add new_file.cpp git commit -amend 也可以直接运行下面的命令，不过要小心，不要提交了多余的文件\ngit commit -a -amend 将文件从本次提交中移除 如果想把已经 commit 的文件从这次 commit 移除的话，运行命令：\ngit reset [-soft] HEAD~1 # -soft可加可不加，默认就是soft选项 git checkout -filename # 要从本次提交移除的文件名 git commit -m \u0026#34;new commit\u0026#34; 修改多个提交记录 要修改历史中更早的提交，你必须采用更复杂的工具。Git 没有一个修改历史的工具，但是你可以使用 rebase 工具来衍合一系列的提交到它们原来所在的 HEAD 上。\n依靠这个交互式的 rebase 工具，你就可以停留在每一次提交后，如果你想修改或改变说明、增加文件或任何其他事情。你可以通过给 git rebase -i 命令以交互方式进行 rebase。\n例如，你想修改最近三次的提交说明，或者其中任意一次，你必须给 git rebase -i 提供一个参数，指明你想要修改的提交的父提交。\n例如 HEAD~3 是指从 HEAD 指针到 HEAD+3 的位置，也就是最近第 4 次提交。所以想修改最近 3 次提交，你需要指明第 3 次提交的父提交（第 4 次提交）即 HEAD~3。运行命令：\ngit rebase -i HEAD~3 再次提醒这是一个衍合命令，也就是 HEAD~3 到 HEAD 范围内的每一次提交都会被重写，不管你是否修改提交说明 SHA-1 的值都会发生变化。\n所以千万不要涵盖你已经推送到中心服务器的提交。这么做会使其他开发者产生混乱，因为你提供了同样变更的不同版本。运行该命令后进入交互界面，类似：\npick fecb551 Init the view model pick bb199a0 Update the version pick bc5cd9d Add new method # Rebase f77f585..fecb551 onto f77f585 # # Commands: # p, pick = use commit # r, reword = use commit, but edit the commit message # e, edit = use commit, but stop for amending # s, squash = use commit, but meld into previous commit # f, fixup = like \u0026#34;squash\u0026#34;, but discard this commit\u0026#39;s log message # x, exec = run command (the rest of the line) using shell # # These lines can be re-ordered; they are executed from top to bottom. # If you remove a line here THAT COMMIT WILL BE LOST. # However, if you remove everything, the rebase will be aborted. # Note that empty commits are commented out 根据命令提示，就可以进行历史更改了。很重要的一点是你得注意这些提交的顺序与你通常通过 log 命令看到的是相反的。\n如果你运行 log，你会看到下面这样的结果：\npick bc5cd9d Add new method pick bb199a0 Update the version pick fecb551 Init the view model 修改指定提交 例如：只修改最近第 3 次提交说明可以进行如下更改：\nreword fecb551 Init the view model pick bb199a0 Update the version pick bc5cd9d Add new method ... 保存并退出编辑器，rebase 命令在衍合到第 3 次提交时会进入提交说明编辑页面，在此进行编辑新的提交说明，保存并退出即可，rebase 命令继续进行直至完成全部衍合操作。\n如果你不仅想要修改提交说明，还要更改提交，可以进行如下更改：\nedit fecb551 Init the view model pick bb199a0 Update the version pick bc5cd9d Add new method ... 保存并退出编辑器，rebase 命令在衍合到第三次提交时会等待你提交新的更改，并提示你修改完成后运行 git commit –amend 命令，然后运行 git rebase –continue 继续进行 rebase 直至完成全部衍合。\n重排提交 你也可以使用 git rebase -i 命令对提交历史彻底重排或删除提交。例如你想删除”Update the version”这个提交，并且修改其他两次提交的顺序，可以将：\npick fecb551 Init the view model pick bb199a0 Update the version pick bc5cd9d Add new method ... 改为：\npick bc5cd9d Add new method pick fecb551 Init the view model 然后保存并退出编辑器，此时 rebase 命令会先应用 bc5cd9d (Add new method)，然后应用 fecb551 (Init the view model) bb199a0 Update the version 这次提交。然后保存并退出编辑器，此时 rebase 命令会先应用 bc5cd9d (Add new method)，然后应用 fecb551 (Init the view model)，接着停止。\n执行完上诉操作，你已经修改了这些提交的顺序，并且删除了 bb199a0 (Update the version) 这次提交。\n合并提交 git rebase -i 命令还可以将一系列提交合并成一个提交。从上面的脚本提示中可以看到 s, squash = use commit, but meld into previous commit 提示。\n如果用 squash 修饰提交就可以进行提交之间的合并，例如可以将脚本修改成这样：\npick fecb551 Init the view model squash bb199a0 Update the version squash bc5cd9d Add new method 保存并退出编辑器，rebase 命令会应用全部三次变更然后进入编辑器来归并三次提交说明。当你保存之后，你就拥有了一个包含前三次提交的全部变更的单一提交。\n拆分提交 拆分提交实际上就是撤销一次提交，然后分多次进行重新提交。例如你想将三次提交中的中间一次拆分。将 ”Update the version” 拆分成两次提交：”Update the version1” 和 ”Update the version2”，可以进行如下修改：\npick fecb551 Init the view model edit bb199a0 Update the version pick bc5cd9d Add new method 当 rebase 到 bb199a0 时，会进入等待你提交新 commit 的状态，这时看可以运行 git reset HEAD^ 对当前提交进行重置，然后分别运行 git add 命令添加想要提交的文件，分别进行 git commit，最后运行 git rebase –continue 完成所有衍合。整体过程如下：\ngit reset HEAD^ git add file1 git commit -m \u0026#39;Update the version1\u0026#39; git add file2 git commit -m \u0026#39;Update the version2\u0026#39; git rebase --continue 执行完上诉操作，提交历史看起来就像这样了：\n1c002dd Add new method 9b29157 Update the version2 35cfb2b Update the version1 f3cc40e Init the view model 再次提醒，这会修改你列表中的提交的 SHA 值，所以请确保这个列表里不包含你已经推送到共享仓库的提交。\nReferences Git 修改提交历史 - GLGJing’s Blog ","permalink":"https://zyf.im/2017/03/13/git-modify-commits-history/","summary":"\u003cp\u003e在使用 Git 时，我们经常会遇到修改本地提交记录的情况。比如：修改最近一次提交记，还比如：将多次小的 \u003ccode\u003ecommit\u003c/code\u003e 合并成一个大的 \u003ccode\u003ecommit\u003c/code\u003e。\u003c/p\u003e\n\u003cp\u003e这种做发有利也有弊，利在：review 代码时，可以按功能看，可以省去 review 一些前期写的无效的代码；弊是：一次提交修改过多，如果有问题，不利于调试。\u003c/p\u003e\n\u003cp\u003e具体情况具体分析，是解决问题的金句。\u003c/p\u003e\n\u003ch2 id=\"修改最近一次提交记录\"\u003e修改最近一次提交记录\u003c/h2\u003e\n\u003ch3 id=\"修改提交说明\"\u003e修改提交说明\u003c/h3\u003e\n\u003cp\u003e如果只想更改最近一次的提交说明，只需输入：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit commit --amend\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e然后你就会进入文本编辑器，输入你想要的内容，保存并退出即可\u003c/p\u003e\n\u003ch3 id=\"改被提交的快照\"\u003e改被提交的快照\u003c/h3\u003e\n\u003cp\u003e如果你完成 \u003ccode\u003ecommit\u003c/code\u003e 后又想修改被提交的快照，增加或者修改其中的文件。\u003c/p\u003e\n\u003cp\u003e先执行 \u003ccode\u003egit add\u003c/code\u003e 命令，将修改的文件添加到缓存区，然后运行 \u003ccode\u003egit commit -amend\u003c/code\u003e 命令，该命令会获取你当前的暂存区的内容一并提交到最后一次 \u003ccode\u003ecommit\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e例如：新加了一个文件 \u003ccode\u003enew_file.cpp\u003c/code\u003e ，想要合并到最后一次提交，过程如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit add new_file.cpp\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit commit -amend\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e也可以直接运行下面的命令，不过要小心，不要提交了多余的文件\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit commit -a -amend\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"将文件从本次提交中移除\"\u003e将文件从本次提交中移除\u003c/h3\u003e\n\u003cp\u003e如果想把已经 \u003ccode\u003ecommit\u003c/code\u003e 的文件从这次 \u003ccode\u003ecommit\u003c/code\u003e 移除的话，运行命令：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit reset \u003cspan class=\"o\"\u003e[\u003c/span\u003e-soft\u003cspan class=\"o\"\u003e]\u003c/span\u003e HEAD~1 \u003cspan class=\"c1\"\u003e# -soft可加可不加，默认就是soft选项\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit checkout -filename \u003cspan class=\"c1\"\u003e# 要从本次提交移除的文件名\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit commit -m \u003cspan class=\"s2\"\u003e\u0026#34;new commit\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c!-- more --\u003e\n\u003ch2 id=\"修改多个提交记录\"\u003e修改多个提交记录\u003c/h2\u003e\n\u003cp\u003e要修改历史中更早的提交，你必须采用更复杂的工具。Git 没有一个修改历史的工具，但是你可以使用 rebase 工具来衍合一系列的提交到它们原来所在的 HEAD 上。\u003c/p\u003e","title":"Git 修改提交历史"},{"content":"在使用 empty(mixed $var) 时要考虑 $var 的 类型，尤其是在判断数据库查询后的字段。\nbool empty(mixed $var) 以下的东西被认为是空 true 的：\n\u0026quot;\u0026quot;（空字符串） 0 （作为整数的 0） 0.0 （作为浮点数的 0） \u0026quot;0\u0026quot; （作为字符串的 0） NULL FALSE array() 一个空数组 $var 未初始化的变量 new stdClass() 不包含任何属性的对象 注意： string 的判断要非常注意，数据库查询后的字段常常为 string，应该进行正确的类型转换。\n以下的东西被认为是非空 false 的：\n$var = true; $var = 1; $var = -1; $var = \u0026ldquo;0.0\u0026rdquo;; $var = \u0026ldquo;foo\u0026rdquo;; $var = array(0); $var = new stdClass(); $var-\u0026gt;property = null; $str = \u0026#39;0.0\u0026#39;; echo empty($str); // false 很可能和预期是相反的 echo empty((float)$str); // true \u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2017/03/09/php-empty-method-judge-0/","summary":"\u003cp\u003e在使用 \u003ccode\u003eempty(mixed $var)\u003c/code\u003e 时要考虑 \u003ccode\u003e$var\u003c/code\u003e 的 \u003cstrong\u003e类型\u003c/strong\u003e，尤其是在判断数据库查询后的字段。\u003c/p\u003e\n\u003c!-- more --\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-txt\" data-lang=\"txt\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ebool empty(mixed $var)\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e以下的东西被认为是空 \u003ccode\u003etrue\u003c/code\u003e 的：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003e\u0026quot;\u0026quot;\u003c/code\u003e（空字符串）\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e0\u003c/code\u003e （作为整数的 0）\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e0.0\u003c/code\u003e （作为浮点数的 0）\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e\u0026quot;0\u0026quot;\u003c/code\u003e （作为字符串的 0）\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eNULL\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eFALSE\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003earray()\u003c/code\u003e 一个空数组\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e$var\u003c/code\u003e 未初始化的变量\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003enew stdClass()\u003c/code\u003e 不包含任何属性的对象\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cstrong\u003e注意：\u003c/strong\u003e string 的判断要非常注意，数据库查询后的字段常常为 string，应该进行正确的类型转换。\u003c/p\u003e\n\u003cp\u003e以下的东西被认为是非空 \u003ccode\u003efalse\u003c/code\u003e 的：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e$var = true;\u003c/li\u003e\n\u003cli\u003e$var = 1;\u003c/li\u003e\n\u003cli\u003e$var = -1;\u003c/li\u003e\n\u003cli\u003e$var = \u0026ldquo;0.0\u0026rdquo;;\u003c/li\u003e\n\u003cli\u003e$var = \u0026ldquo;foo\u0026rdquo;;\u003c/li\u003e\n\u003cli\u003e$var = array(0);\u003c/li\u003e\n\u003cli\u003e$var = new stdClass(); $var-\u0026gt;property = null;\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$str\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;0.0\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eecho\u003c/span\u003e \u003cspan class=\"k\"\u003eempty\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$str\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"c1\"\u003e// false 很可能和预期是相反的\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003eecho\u003c/span\u003e \u003cspan class=\"k\"\u003eempty\u003c/span\u003e\u003cspan class=\"p\"\u003e((\u003c/span\u003e\u003cspan class=\"nx\"\u003efloat\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"nv\"\u003e$str\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"c1\"\u003e// true\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u0026ndash; EOF \u0026ndash;\u003c/p\u003e","title":"PHP empty 方法判断 0.0"},{"content":"crontab -r 是一个很危险的命令，它将直接重置 crontab 中的内容；输入 crontab 后，使用 ctrl + d 退出也将清空 crontab 中的内容。所以 crontab 内容的定时备份也变得有必要了。\n备份脚本 crontab_bak.sh\n#!/bin/bash crontab -l \u0026gt; /home/tom/crontab_bak/bak`date \u0026#39;+%Y%m%d_%H%M%S\u0026#39;`.txt config in crontab\n12 12 * * * /bin/bash /home/tom/crontab_bak/crontab_bak.sh crontab 常用命令 crontab -l # 列举 crontab 的任务 crontab -e # 编辑 crontab 的任务 crontab -r # 删除 crontab 的任务；风险 crontab -h # crontab 的帮助 crontab -i # 删除 crontab 前进行提示 \u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2017/03/07/linux-crontab-content-backup/","summary":"\u003cp\u003e\u003ccode\u003ecrontab -r\u003c/code\u003e 是一个很危险的命令，它将直接重置 crontab 中的内容；输入 \u003ccode\u003ecrontab\u003c/code\u003e 后，使用 \u003ccode\u003ectrl + d\u003c/code\u003e 退出也将清空 crontab 中的内容。所以 crontab 内容的定时备份也变得有必要了。\u003c/p\u003e\n\u003ch2 id=\"备份脚本\"\u003e备份脚本\u003c/h2\u003e\n\u003cp\u003e\u003ccode\u003ecrontab_bak.sh\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cp\"\u003e#!/bin/bash\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cp\"\u003e\u003c/span\u003ecrontab -l \u0026gt; /home/tom/crontab_bak/bak\u003cspan class=\"sb\"\u003e`\u003c/span\u003edate \u003cspan class=\"s1\"\u003e\u0026#39;+%Y%m%d_%H%M%S\u0026#39;\u003c/span\u003e\u003cspan class=\"sb\"\u003e`\u003c/span\u003e.txt\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003econfig in crontab\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"m\"\u003e12\u003c/span\u003e \u003cspan class=\"m\"\u003e12\u003c/span\u003e * * * /bin/bash /home/tom/crontab_bak/crontab_bak.sh\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c!-- more --\u003e\n\u003ch2 id=\"crontab-常用命令\"\u003ecrontab 常用命令\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ecrontab -l  \u003cspan class=\"c1\"\u003e# 列举 crontab 的任务\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ecrontab -e  \u003cspan class=\"c1\"\u003e# 编辑 crontab 的任务\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ecrontab -r  \u003cspan class=\"c1\"\u003e# 删除 crontab 的任务；风险\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ecrontab -h  \u003cspan class=\"c1\"\u003e# crontab 的帮助\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ecrontab -i  \u003cspan class=\"c1\"\u003e# 删除 crontab 前进行提示\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u0026ndash; EOF \u0026ndash;\u003c/p\u003e","title":"Linux crontab 内容定时备份"},{"content":"在配置新服务器时遇到 Setting locale failed 的警告，要求 Please check that your locale settings\nperl: warning: Setting locale failed. perl: warning: Please check that your locale settings: LANGUAGE = (unset), LC_ALL = (unset), LC_MESSAGES = \u0026#34;zh_CN.UTF-8\u0026#34;, LANG = \u0026#34;zh_CN.UTF-8\u0026#34; are supported and installed on your system. perl: warning: Falling back to the standard locale (\u0026#34;C\u0026#34;). 解决方法 安装 localepurge 管理语言文件 sudo apt-get install localepurge 选择我们想要的语言，例如 en_US.UTF-8 和 zh_CN.UTF-8 当然也可以使用以下命令再次进行配置：\nsudo dpkg-reconfigure localepurge 生成自己想要的语言 sudo locale-gen zh_CN.UTF-8 en_US.UTF-8 打印出当前的配置信息\nlocale 默认情况下终端 ssh 的时候会将本地的 locale 传到服务器中，可以通过命令指定 ssh 服务器的语言：\nLC_ALL=en_US.UTF-8 ssh \u0026lt;host\u0026gt; References ubuntu 解决语言设置错误的问题 —— 文翼的博客 \u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2017/03/03/resolving-ubuntu-warning-setting-locale-failed/","summary":"\u003cp\u003e在配置新服务器时遇到 \u003ccode\u003eSetting locale failed\u003c/code\u003e 的警告，要求 \u003ccode\u003ePlease check that your locale settings\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eperl: warning: Setting locale failed.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eperl: warning: Please check that your locale settings:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nv\"\u003eLANGUAGE\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nb\"\u003eunset\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nv\"\u003eLC_ALL\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nb\"\u003eunset\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nv\"\u003eLC_MESSAGES\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;zh_CN.UTF-8\u0026#34;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nv\"\u003eLANG\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;zh_CN.UTF-8\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    are supported and installed on your system.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eperl: warning: Falling back to the standard locale \u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;C\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e.\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c!-- more --\u003e\n\u003ch2 id=\"解决方法\"\u003e解决方法\u003c/h2\u003e\n\u003ch3 id=\"安装-localepurge-管理语言文件\"\u003e安装 localepurge 管理语言文件\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo apt-get install localepurge\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e选择我们想要的语言，例如 \u003ccode\u003een_US.UTF-8\u003c/code\u003e 和 \u003ccode\u003ezh_CN.UTF-8\u003c/code\u003e\n当然也可以使用以下命令再次进行配置：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo dpkg-reconfigure localepurge\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"生成自己想要的语言\"\u003e生成自己想要的语言\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo locale-gen zh_CN.UTF-8 en_US.UTF-8\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e打印出当前的配置信息\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003elocale\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e默认情况下终端 ssh 的时候会将本地的 locale 传到服务器中，可以通过命令指定 ssh 服务器的语言：\u003c/p\u003e","title":"解决 Ubuntu warning Setting locale failed"},{"content":"【注意】内容不再维护。\nHTML+CSS 基础课程-慕课网\n2017 年一个心愿，认真学习前端，成为公司里最厉害前端工程师。Flag 立的还是很大的。\n第 1 章 HTML 介绍 HTML 是网页内容的载体。内容就是网页制作者放在页面上想要让用户浏览的信息，可以包含文字、图片、视频等。 CSS 样式是表现。就像网页的外衣。比如，标题字体、颜色变化，或为标题加入背景图片、边框等。所有这些用来改变内容外观的东西称之为表现。 JavaScript 是用来实现网页上的特效效果。如：鼠标滑过弹出下拉菜单。或鼠标滑过表格的背景颜色改变。还有焦点新闻（新闻图片）的轮换。可以这么理解，有动画的，有交互的一般都是用 JavaScript 来实现的。 第 2 章 认识标签(第一部分) 常常会听到一个词，语义化。说的通俗点就是：明白每个标签的用途（在什么情况下使用此标签合理）。\n比如，网页上的文章的标题就可以用标题标签，网页上的各个栏目的栏目名称也可以使用标题标签。文章中内容的段落就得放在段落标签中，在文章中有想强调的文本，就可以使用 em 标签表示强调等等。 语义化可以给我们带来什么样的好处呢？\n更容易被搜索引擎收录。 更容易让屏幕阅读器读出网页内容。 1、在网页上要展示出来的页面内容一定要放在 body 标签中；\n2、如果想在网页上显示文章，这时就需要 \u0026lt;p\u0026gt; 标签了，把文章的段落放到 \u0026lt;p\u0026gt; 标签；\n\u0026lt;p\u0026gt;段落文本\u0026lt;/p\u0026gt; 3、标题标签一共有 6 个，h1、h2、h3、h4、h5、h6 分别为一级标题、二级标题、三级标题、四级标题、五级标题、六级标题。并且依据重要性递减。\u0026lt;h1\u0026gt; 是最高的等级：\n\u0026lt;hx\u0026gt;标题文本\u0026lt;/hx\u0026gt; \u0026lt;!-- x为1-6 --\u0026gt; 4、在一段话中特别强调某几个文字，这时候就可以用到 \u0026lt;em\u0026gt; 或 \u0026lt;strong\u0026gt; 标签。在浏览器中 \u0026lt;em\u0026gt; 默认用斜体表示，\u0026lt;strong\u0026gt; 用粗体表示。两个标签相比，目前国内前端程序员更喜欢使用 \u0026lt;strong\u0026gt; 表示强调：\n\u0026lt;em\u0026gt;需要强调的文本\u0026lt;/em\u0026gt; \u0026lt;strong\u0026gt;需要强调的文本\u0026lt;/strong\u0026gt; 5、\u0026lt;span\u0026gt; 标签是没有语义的，它的作用就是为了设置单独的样式用的：\n\u0026lt;span\u0026gt;文本\u0026lt;/span\u0026gt; 6、想引用某个作家的一句诗，这样会使你的文章更加出彩，那么 \u0026lt;q\u0026gt; 标签是你所需要的：\n\u0026lt;q\u0026gt;引用文本\u0026lt;/q\u0026gt; 7、\u0026lt;blockquote\u0026gt; 的作用也是引用别人的文本。但它是对长文本的引用，如在文章中引入大段某知名作家的文字，这时需要这个标签。\n\u0026lt;blockquote\u0026gt;引用文本\u0026lt;/blockquote\u0026gt; 8、使用 \u0026lt;br\u0026gt; 标签分行显示文本\nXHTML 1.0 写法：\u0026lt;br /\u0026gt;\nHTML 4.01 写法：\u0026lt;br\u0026gt;\n注意：现在一般使用 XHTML 1.0 的版本的写法（其它标签也是），这种版本比较规范。\n9、为你的网页中添加一些空格 \u0026amp;nbsp;\n10、\u0026lt;hr\u0026gt; 添加水平横线\nHTML 4.01 版本：\u0026lt;hr\u0026gt;\nXHTML 1.0 版本：\u0026lt;hr /\u0026gt;\n\u0026lt;hr /\u0026gt; 标签的在浏览器中的默认样式线条比较粗，颜色为灰色，可能有些人觉得这种样式不美观，没有关系，这些外在样式在我们以后学习了 CSS 样式表之后，都可以对其修改。\n11、联系地址信息如公司的地址就可以 \u0026lt;address\u0026gt; 标签。也可以定义一个地址（比如电子邮件地址）、签名或者文档的作者身份：\n\u0026lt;address\u0026gt;联系地址信息\u0026lt;/address\u0026gt; 12、网页中显示一些计算机专业的编程代码，当代码为一行代码时，你就可以使用 \u0026lt;code\u0026gt; 标签：\n\u0026lt;code\u0026gt;var i=i+300;\u0026lt;/code\u0026gt; 13、如果是多行代码，可以使用 \u0026lt;pre\u0026gt; 标签：\n\u0026lt;pre\u0026gt;语言代码段\u0026lt;/pre\u0026gt; \u0026lt;pre\u0026gt; 标签的主要作用：预格式化的文本。被包围在 \u0026lt;/pre\u0026gt; 元素中的文本通常会保留空格和换行符。 注意：\u0026lt;pre\u0026gt; 标签不只是为显示计算机的源代码时用的，在你需要在网页中预显示格式时都可以使用它，只是 \u0026lt;pre\u0026gt; 标签的一个常见应用就是用来展示计算机的源代码。\n第 3 章 认识标签(第二部分) 1、使用 ul，添加列表：\n\u0026lt;ul\u0026gt; \u0026lt;li\u0026gt;信息\u0026lt;/li\u0026gt; \u0026lt;li\u0026gt;信息\u0026lt;/li\u0026gt; ...... \u0026lt;/ul\u0026gt; 2、使用 ol，添加有前后顺序的列表：\n\u0026lt;ol\u0026gt; \u0026lt;li\u0026gt;信息\u0026lt;/li\u0026gt; \u0026lt;li\u0026gt;信息\u0026lt;/li\u0026gt; ...... \u0026lt;/ol\u0026gt; 3、把一些独立的逻辑部分划分出来，放在一个 \u0026lt;div\u0026gt; 标签中，这个 \u0026lt;div\u0026gt; 标签的作用就相当于一个容器：\n\u0026lt;div\u0026gt;…\u0026lt;/div\u0026gt; 4、给 div 命名，使逻辑更加清晰。可以为这一个独立的逻辑部分设置一个名称，用 id 属性来为 \u0026lt;div\u0026gt; 提供唯一的名称：\n\u0026lt;div id=\u0026#34;版块名称\u0026#34;\u0026gt;…\u0026lt;/div\u0026gt; 5、table 标签，认识网页上的表格：\n\u0026lt;table\u0026gt;…\u0026lt;/table\u0026gt;：整个表格以 \u0026lt;table\u0026gt; 标记开始、\u0026lt;/table\u0026gt; 标记结束\n\u0026lt;tbody\u0026gt;…\u0026lt;/tbody\u0026gt;：当表格内容非常多时，表格会下载一点显示一点，但如果加上 \u0026lt;tbody\u0026gt; 标签后，这个表格就要等表格内容全部下载完才会显示\n\u0026lt;tr\u0026gt;…\u0026lt;/tr\u0026gt;：表格的一行，所以有几对 tr 表格就有几行。\n\u0026lt;td\u0026gt;…\u0026lt;/td\u0026gt;：表格的一个单元格，一行中包含几对 \u0026lt;td\u0026gt;...\u0026lt;/td\u0026gt;，说明一行中就有几列\n\u0026lt;th\u0026gt;…\u0026lt;/th\u0026gt;：表格的头部的一个单元格，表格表头\n6、caption 标签，为表格添加标题和摘要：\n摘要：摘要的内容是不会在浏览器中显示出来的。它的作用是增加表格的可读性（语义化），使搜索引擎更好的读懂表格内容，还可以使屏幕阅读器更好的帮助特殊用户读取表格内容：\n\u0026lt;table summary=\u0026#34;表格简介文本\u0026#34;\u0026gt;\u0026lt;/table\u0026gt; 标题：用以描述表格内容，标题的显示位置：表格上方：\n\u0026lt;table\u0026gt; \u0026lt;caption\u0026gt; 标题文本 \u0026lt;/caption\u0026gt; \u0026lt;tr\u0026gt; \u0026lt;td\u0026gt;…\u0026lt;/td\u0026gt; \u0026lt;td\u0026gt;…\u0026lt;/td\u0026gt; … \u0026lt;/tr\u0026gt; … \u0026lt;/table\u0026gt; 第 4 章 认识标签(第三部分) 1、使用 \u0026lt;a\u0026gt; 标签可实现超链接：\n\u0026lt;a href=\u0026#34;目标网址\u0026#34; title=\u0026#34;鼠标滑过显示的文本\u0026#34;\u0026gt;链接显示的文本\u0026lt;/a\u0026gt; title 属性的作用，鼠标滑过链接文字时会显示这个属性的文本内容。这个属性在实际网页开发中作用很大，主要方便搜索引擎了解链接地址的内容（语义化更友好）。\n2、在新建浏览器窗口中打开链接：\n\u0026lt;a href=\u0026#34;目标网址\u0026#34; target=\u0026#34;_blank\u0026#34;\u0026gt;click here!\u0026lt;/a\u0026gt; 3、使用 mailto 在网页中链接 Email 地址：\n\u0026lt;a href=\u0026#34;mailto:yy@imooc.com?subject=主题名称\u0026amp;body=邮件内容\u0026amp;cc=yy@mail.com\u0026#34;\u0026gt;\u0026lt;/a\u0026gt; 4、\u0026lt;img\u0026gt; 为网页插入图片：\n\u0026lt;img src=\u0026#34;图片地址\u0026#34; alt=\u0026#34;下载失败时的替换文本\u0026#34; title=\u0026#34;提示文本\u0026#34; /\u0026gt; 第 5 章 与浏览者交互，表单标签 1、form 标签与用户交互：\n表单是可以把浏览者输入的数据传送到服务器端，这样服务器端程序就可以处理表单传过来的数据。\naction：浏览者输入的数据被传送到的地方，比如一个 PHP 页面(save.php)\nmethod：数据传送的方式（get/post）\n\u0026lt;form method=\u0026#34;post/get\u0026#34; action=\u0026#34;save.php\u0026#34;\u0026gt; \u0026lt;label for=\u0026#34;username\u0026#34;\u0026gt;用户名:\u0026lt;/label\u0026gt; \u0026lt;input type=\u0026#34;text\u0026#34; name=\u0026#34;username\u0026#34; /\u0026gt; \u0026lt;label for=\u0026#34;pass\u0026#34;\u0026gt;密码:\u0026lt;/label\u0026gt; \u0026lt;input type=\u0026#34;password\u0026#34; name=\u0026#34;pass\u0026#34; /\u0026gt; \u0026lt;/form\u0026gt; 2、文本输入框、密码输入框：\ntype：当 type=\u0026quot;text\u0026quot; 时，输入框为文本输入框；当 type=\u0026quot;password\u0026quot; 时, 输入框为密码输入框 name：为文本框命名，以备后台程序使用 value：为文本输入框设置默认值（一般起到提示作用） \u0026lt;input type=\u0026#34;text/password\u0026#34; name=\u0026#34;名称\u0026#34; value=\u0026#34;文本\u0026#34; /\u0026gt; 3、文本域，支持多行文本输入：\n\u0026lt;textarea rows=\u0026#34;行数\u0026#34; cols=\u0026#34;列数\u0026#34;\u0026gt;文本\u0026lt;/textarea\u0026gt; 注意：这两个属性可用 CSS 样式的 width 和 height 来代替：col 用 width、row 用 height 来代替。\n4、使用单选框、复选框，让用户选择：\ntype：当 type=\u0026ldquo;radio\u0026rdquo; 时，控件为单选框；当 type=\u0026ldquo;checkbox\u0026rdquo; 时，控件为复选框\n注意：同一组的单选按钮，name 取值一定要一致，比如上面例子为同一个名称\u0026quot;radioLove\u0026quot;，这样同一组的单选按钮才可以起到单选的作用。\n\u0026lt;input type=\u0026#34;radio/checkbox\u0026#34; value=\u0026#34;值\u0026#34; name=\u0026#34;名称\u0026#34; checked=\u0026#34;checked\u0026#34; /\u0026gt; 5、使用下拉列表框，节省空间：\n设置 selected=\u0026quot;selected\u0026quot; 属性，则该选项就被默认选中：\n\u0026lt;select\u0026gt; \u0026lt;option value=\u0026#34;看书\u0026#34;\u0026gt;看书\u0026lt;/option\u0026gt; \u0026lt;option value=\u0026#34;旅游\u0026#34; selected=\u0026#34;selected\u0026#34;\u0026gt;旅游\u0026lt;/option\u0026gt; \u0026lt;option value=\u0026#34;运动\u0026#34;\u0026gt;运动\u0026lt;/option\u0026gt; \u0026lt;option value=\u0026#34;购物\u0026#34;\u0026gt;购物\u0026lt;/option\u0026gt; \u0026lt;/select\u0026gt; 6、使用提交按钮，提交数据：\n\u0026lt;input type=\u0026#34;submit\u0026#34; value=\u0026#34;提交\u0026#34; /\u0026gt; 7、使用重置按钮，重置表单信息：\n\u0026lt;input type=\u0026#34;reset\u0026#34; value=\u0026#34;重置\u0026#34; /\u0026gt; 8、form 表单中的 label 标签：\nlabel 标签不会向用户呈现任何特殊效果，它的作用是为鼠标用户改进了可用性。如果你在 label 标签内点击文本，就会触发此控件。就是说，当用户单击选中该 label 标签时，浏览器就会自动将焦点转到和标签相关的表单控件上（就自动选中和该 label 标签相关连的表单控件上）：\n\u0026lt;label for=\u0026#34;控件id名称\u0026#34;\u0026gt;\u0026lt;/label\u0026gt; 注意：标签的 for 属性中的值应当与相关控件的 id 属性值一定要相同。\n\u0026lt;form\u0026gt; \u0026lt;label for=\u0026#34;male\u0026#34;\u0026gt;男\u0026lt;/label\u0026gt; \u0026lt;input type=\u0026#34;radio\u0026#34; name=\u0026#34;gender\u0026#34; id=\u0026#34;male\u0026#34; /\u0026gt; \u0026lt;br /\u0026gt; \u0026lt;label for=\u0026#34;female\u0026#34;\u0026gt;女\u0026lt;/label\u0026gt; \u0026lt;input type=\u0026#34;radio\u0026#34; name=\u0026#34;gender\u0026#34; id=\u0026#34;female\u0026#34; /\u0026gt; \u0026lt;label for=\u0026#34;email\u0026#34;\u0026gt;输入你的邮箱地址\u0026lt;/label\u0026gt; \u0026lt;input type=\u0026#34;email\u0026#34; id=\u0026#34;email\u0026#34; placeholder=\u0026#34;Enter email\u0026#34; /\u0026gt; \u0026lt;/form\u0026gt; 第 6 章 开始学习 CSS，为网页添加样式 认识 CSS 样式。CSS 全称为“层叠样式表 (Cascading Style Sheets)”，它主要是用于定义 HTML 内容在浏览器内的显示样式，如文字大小、颜色、字体加粗等 CSS 样式的优势。批量定义样式 CSS 代码语法。CSS 样式由 选择符 和 声明 组成，而 声明 又由 属性 和 值 组成 选择符：又称选择器，指明网页中要应用样式规则的元素 声明：在英文大括号 {} 中的的就是声明，属性和值之间用英文冒号 : 分隔。当有多条声明时，中间可以英文分号 ; 分隔，如下所示： p { font-size: 12px; color: red; } 最后一条声明可以没有分号，但是为了以后修改方便，一般也加上分号 为了使用样式更加容易阅读，可以将每条代码写在一个新行内 4、CSS 注释代码\n用 /*注释语句*/ 来标明（HTML 中使用 \u0026lt;!--注释语句--\u0026gt;）\n第 7 章 CSS 样式基本知识 1、内联式 CSS 样式\n内联式 CSS 样式表就是把 CSS 代码直接写在现有的 HTML 标签中\n\u0026lt;p style=\u0026#34;color:red\u0026#34;\u0026gt;这里文字是红色。\u0026lt;/p\u0026gt; 2、嵌入式 CSS 样式\n嵌入式 CSS 样式，就是可以把 CSS 样式代码写在 \u0026lt;style type=\u0026quot;text/css\u0026quot;\u0026gt;\u0026lt;/style\u0026gt; 标签之间\n\u0026lt;style type=\u0026#34;text/css\u0026#34;\u0026gt; span { color: red; } \u0026lt;/style\u0026gt; 3、外部式 CSS 样式\n外部式 CSS 样式（也可称为外联式）就是把 CSS 代码写一个单独的外部文件中，这个 CSS 样式文件以 .css 为扩展名，在 \u0026lt;head\u0026gt; 内（不是在 \u0026lt;style\u0026gt; 标签内）使用 \u0026lt;link\u0026gt; 标签将 CSS 样式文件链接到 HTML 文件内\n\u0026lt;link href=\u0026#34;base.css\u0026#34; rel=\u0026#34;stylesheet\u0026#34; type=\u0026#34;text/css\u0026#34; /\u0026gt; CSS 样式文件名称以有意义的英文字母命名，如 main.css rel=\u0026quot;stylesheet\u0026quot; type=\u0026quot;text/css\u0026quot; 是固定写法不可修改 \u0026lt;link\u0026gt; 标签位置一般写在 \u0026lt;head\u0026gt; 标签之内 4、三种方法的优先级\n内联式 \u0026gt; 嵌入式 \u0026gt; 外部式\n但是嵌入式\u0026gt;外部式有一个前提：嵌入式 css 样式的位置一定在外部式的后面。其实总结来说，就是 就近原则（离被设置元素越近优先级别越高）\n第 8 章 CSS 选择器 1、什么是选择器？\n每一条 CSS 样式声明（定义）由两部分组成\n选择器 { 样式; } 2、标签选择器\n标签选择器其实就是 HTML 代码中的标签。如右侧代码编辑器中的 \u0026lt;html\u0026gt;、\u0026lt;body\u0026gt;、\u0026lt;h1\u0026gt;、\u0026lt;p\u0026gt;\np { font-size: 12px; line-height: 1.6em; } 3、类选择器\n.类选器名称{css样式代码;} 4、ID 选择器\n#ID选择器名称{css样式代码;} 5、类和 ID 选择器的区别\n相同点：可以应用于任何元素\n不同点：\nID 选择器只能在文档中使用一次 可以使用类选择器词列表方法为一个元素同时设置多个样式（不能使用 ID 词列表） \u0026lt;style\u0026gt; .stress { color: red; } .bigsize { font-size: 25px; } \u0026lt;/style\u0026gt; \u0026lt;p\u0026gt; 到了\u0026lt;span class=\u0026#34;stress bigsize\u0026#34;\u0026gt;三年级\u0026lt;/span \u0026gt;下学期时，我们班上了一节公开课... \u0026lt;/p\u0026gt; 6、子选择器\n子选择器 \u0026gt; 用于选择指定标签元素的第一代子元素\n.food \u0026gt; li { border: 1px solid red; } 7、包含（后代）选择器\n包含选择器 空格 用于选择指定标签元素下的后辈元素\n.first span { color: red; } 总结：\u0026gt; 作用于元素的第一代后代，空格 作用于元素的所有后代。\n8、通用选择器\n通用选择器 * 作用是匹配 HTML 中所有标签元素\n* { color: red; } 9、伪类选择符\n伪类选择符，它允许给 HTML 不存在的标签（标签的某种状态）设置样式，比如说我们给 HTML 中一个标签元素的鼠标滑过的状态来设置字体颜色：\na:hover { color: red; } 10、分组选择符\nHTML 多个标签元素设置同一个样式时，可以使用分组选择符 ,\nh1, span { color: red; } 它相当于：\nh1 { color: red; } span { color: red; } 第 9 章 CSS 继承、层叠和特殊性 1、继承\nCSS 的某些样式是具有继承性的。继承是一种规则，它允许样式不仅应用于某个特定 HTML 标签元素，而且应用于其后代。\n比如下面代码：如某种颜色应用于 p 标签，这个颜色设置不仅应用 p 标签，还应用于 p 标签中的所有子元素文本，这里子元素为 span 标签\np{color:red;} \u0026lt;p\u0026gt;三年级时，我还是一个\u0026lt;span\u0026gt;胆小如鼠\u0026lt;/span\u0026gt;的小女孩。\u0026lt;/p\u0026gt; 但注意有一些 CSS 样式是不具有继承性的，例如：\np{border:1px solid red;} \u0026lt;p\u0026gt;三年级时，我还是一个\u0026lt;span\u0026gt;胆小如鼠\u0026lt;/span\u0026gt;的小女孩。\u0026lt;/p\u0026gt; 在上面例子中它代码的作用只是给 p 标签设置了边框为 1 像素、红色、实心边框线，而对于子元素 span 是没用起到作用的\n2、特殊性\n有的时候我们为同一个元素设置了不同的 CSS 样式代码，那么元素会启用哪一个 CSS 样式\np{color:red;} .first{color:green;} \u0026lt;p class=\u0026#34;first\u0026#34;\u0026gt;三年级时，我还是一个\u0026lt;span\u0026gt;胆小如鼠\u0026lt;/span\u0026gt;的小女孩。\u0026lt;/p\u0026gt; p 和 .first 都匹配到了 p 这个标签上，那么会显示哪种颜色呢？green 是正确的颜色。因为浏览器是根据权值来判断使用哪种 css 样式的，权值高的就使用哪种 css 样式。下面是权值的规则：\n标签 的权值为 1，类选择符 的权值为 10，ID选择符 的权值最高为 100\np { color: red; } /*权值为1*/ p span { color: green; } /*权值为1+1=2*/ .warning { color: white; } /*权值为10*/ p span.warning { color: purple; } /*权值为1+1+10=12*/ #footer .note p { color: yellow; } /*权值为100+10+1=111*/ 注意：还有一个权值比较特殊\u0026ndash;继承也有权值但很低，有的文献提出它只有 0.1，所以可以理解为继承的权值最低\n3、层叠\n层叠就是在 html 文件中对于同一个元素可以有多个 CSS 样式存在，当有相同权重的样式存在时，会根据这些 CSS 样式的前后顺序来决定，处于最后面的 css 样式会被应用。\np{color:red;} p{color:green;} \u0026lt;p class=\u0026#34;first\u0026#34;\u0026gt;三年级时，我还是一个\u0026lt;span\u0026gt;胆小如鼠\u0026lt;/span\u0026gt;的小女孩。\u0026lt;/p\u0026gt; 最后 p 中的文本会设置为 green。所以 CSS 样式优先级：\n内联样式表（标签内部）\u0026gt; 嵌入样式表（当前文件中）\u0026gt; 外部样式表（外部文件中）\n4、重要性\n使用 !important 为某些样式设置具有最高权值\np{color:red!important;} p{color:green;} \u0026lt;p class=\u0026#34;first\u0026#34;\u0026gt;三年级时，我还是一个\u0026lt;span\u0026gt;胆小如鼠\u0026lt;/span\u0026gt;的小女孩。\u0026lt;/p\u0026gt; 这时 p 段落中的文本会显示的 red\n注意：!important 要写在分号的前面\n当网页制作者不设置 CSS 样式时，浏览器会按照自己的一套样式来显示网页。并且用户也可以在浏览器中设置自己习惯的样式，比如有的用户习惯把字号设置为大一些，使其查看网页的文本更加清楚。这时注意样式优先级为：浏览器默认的样式 \u0026lt; 网页制作者样式 \u0026lt; 用户自己设置的样式，但记住 !important 优先级样式是个例外，权值高于用户自己设置的样式\n第 10 章 CSS 格式化排版 1、字体\nbody { font-family: \u0026#34;宋体\u0026#34;; } 这里注意不要设置不常用的字体，因为如果用户本地电脑上如果没有安装你设置的字体，就会显示浏览器默认的字体。（因为用户是否可以看到你设置的字体样式取决于用户本地电脑上是否安装你设置的字体。）\n现在一般网页喜欢设置“微软雅黑”，如下代码：\nbody { font-family: \u0026#34;Microsoft Yahei\u0026#34;; } 或\nbody { font-family: \u0026#34;微软雅黑\u0026#34;; } 注意：第一种方法比第二种方法兼容性更好一些。使用微软雅黑，没有版权问题吗？）\n2、字号、颜色\nbody { font-size: 12px; color: #666; } 3、粗体、斜体、下划线、删除线\np span { font-weight: bold; } p a { font-style: italic; } p a { text-decoration: underline; } .oldPrice { text-decoration: line-through; } 4、段落排版 - 缩进\np { text-indent: 2em; } 注意：2em 的意思就是文字的 2 倍大小\n5、段落排版 - 行间距（行高）\np { line-height: 1.5em; } 6、段落排版 - 中文字间距、字母间距\nh1 { letter-spacing: 50px; // 中文字间隔、字母间隔设置 word-spacing: 50px; // 单词间距设置 } 7、段落排版 - 对齐 为块状元素中的文本、图片设置居中/左/右\nh1 { text-align: center/left/right; } 第 11 章 CSS 盒模型 1、元素分类 HTML 中标签元素大体被分为三类：块状元素、内联元素（又叫行内元素）和内联块状元素。常用的块状元素有：\n\u0026lt;div\u0026gt;、\u0026lt;p\u0026gt;、\u0026lt;h1\u0026gt;...\u0026lt;h6\u0026gt;、\u0026lt;ol\u0026gt;、\u0026lt;ul\u0026gt;、\u0026lt;dl\u0026gt;、\u0026lt;table\u0026gt;、\u0026lt;address\u0026gt;、\u0026lt;blockquote\u0026gt; 、\u0026lt;form\u0026gt; 常用的内联元素有：\n\u0026lt;a\u0026gt;、\u0026lt;span\u0026gt;、\u0026lt;br\u0026gt;、\u0026lt;i\u0026gt;、\u0026lt;em\u0026gt;、\u0026lt;strong\u0026gt;、\u0026lt;label\u0026gt;、\u0026lt;q\u0026gt;、\u0026lt;var\u0026gt;、\u0026lt;cite\u0026gt;、\u0026lt;code\u0026gt; 常用的内联块状元素有：\n\u0026lt;img\u0026gt;、\u0026lt;input\u0026gt; 2、块级元素\n在 HTML 中 \u0026lt;div\u0026gt;、 \u0026lt;p\u0026gt;、\u0026lt;h1\u0026gt;、\u0026lt;form\u0026gt;、\u0026lt;ul\u0026gt; 和 \u0026lt;li\u0026gt; 就是块级元素。设置 display:block 就是将元素显示为块级元素。\n如下代码就是将内联元素 a 转换为块状元素：\na { display: block; } 块级元素特点：\n每个块级元素都从新的一行开始，并且其后的元素也另起一行； 元素的高度、宽度、行高以及顶和底边距都可设置； 元素宽度在不设置的情况下，是它本身父容器的 100%（和父元素的宽度一致），除非设定一个宽度； 3、内联元素\n在 HTML 中，\u0026lt;span\u0026gt;、\u0026lt;a\u0026gt;、\u0026lt;label\u0026gt;、 \u0026lt;strong\u0026gt; 和 \u0026lt;em\u0026gt; 就是典型的内联元素（行内元素）（inline）元素。当然块状元素也可以通过代码 display:inline 将元素设置为内联元素。\n如下代码就是将块状元素 div 转换为内联元素，从而使 div 元素具有内联元素特点\ndiv { display: inline; } 内联元素特点：\n和其他元素都在一行上； 元素的高度、宽度及顶部和底部边距不可设置； 元素的宽度就是它包含的文字或图片的宽度，不可改变； 4、内联块状元素\n内联块状元素（inline-block）就是同时具备内联元素、块状元素的特点。\u0026lt;img\u0026gt;、\u0026lt;input\u0026gt; 标签就是这种内联块状标签：\ndiv { display: inline-block; } inline-block 元素特点：\n和其他元素都在一行上； 元素的高度、宽度、行高以及顶和底边距都可设置； 5、盒模型\n内填充（padding）：页面元素与内容之间的距离 外边距（margin）：两个盒子模型之间的距离 边框（border） 内填充、外边距、边框都有 4 个方向（如内填充分为 padding-top/padding-bottom/padding-left/padding-right） 注意：内部元素的实际高度是：内容高度+上下内填充高度+上下边框的高度，宽度同理\n6、边框\n边框可以设置它的粗细、样式和颜色\ndiv { border: 2px solid red; } 上面是 border 代码的缩写形式，分开写：\ndiv { border-width: 2px; border-style: solid; border-color: red; } 注意：\nborder-style（边框样式）常见样式有：dashed（虚线）| dotted（点线）| solid（实线） border-color（边框颜色）中的颜色可设置为十六进制颜色，如：border-color:#888; border-width（边框宽度）中的宽度也可以设置为：thin | medium | thick，最常还是用象素（px） 单独设置某一边框\ndiv { border-bottom: 1px solid red; border-top: 1px solid red; border-right: 1px solid red; border-left: 1px solid red; } 7、宽度和高度\nCSS 定义的宽（width）和高（height），指的是填充以里的内容范围\n因此一个元素实际宽度（盒子的宽度）= 左边界 + 左边框 + 左填充 + 内容宽度 + 右填充 + 右边框 + 右边界\ndiv { width: 200px; padding: 20px; border: 1px solid red; margin: 10px; } 元素的实际长度为：10px + 1px + 20px + 200px + 20px + 1px + 10px = 262px\n9、填充\n元素内容与边框之间是可以设置距离的，称之为“填充”。填充也可分为上、右、下、左（顺时针）\ndiv { padding: 20px 10px 15px 30px; } 可以分开写上面代码：\ndiv { padding-top: 20px; padding-right: 10px; padding-bottom: 15px; padding-left: 30px; } 如果上、右、下、左的填充都为 10px; 可以这么写：\ndiv { padding: 10px; } 如果上下填充一样为 10px，左右一样为 20px，可以这么写：\ndiv { padding: 10px 20px; } 10、边界\n元素与其它元素之间的距离可以使用边界（margin）来设置。边界也是可分为上、右、下、左\ndiv { margin: 20px 10px 15px 30px; } 其他同 padding\n第 12 章 CSS 布局模型 1、CSS 布局模型\n如果说布局模型是本，那么 CSS 布局模板就是末了，是外在的表现形式。CSS 包含 3 种基本的布局模型，用英文概括为：Flow、Layer 和 Float\n流动模型（Flow） 浮动模型 (Float) 层模型（Layer） 2、流动模型\n流动（Flow）是默认的网页布局模式。流动布局模型具有 2 个比较典型的特征：\n第一点，块状元素都会在所处的包含元素内自上而下按顺序垂直延伸分布，因为在默认状态下，块状元素的宽度都为 100%。实际上，块状元素都会以行的形式占据位置 \u0026lt;div id=\u0026#34;box2\u0026#34;\u0026gt;box2\u0026lt;/div\u0026gt; \u0026lt;!--块状元素，由于没有设置宽度，宽度默认显示为100%--\u0026gt; \u0026lt;h1\u0026gt;标题\u0026lt;/h1\u0026gt; \u0026lt;!--块状元素，由于没有设置宽度，宽度默认显示为100%--\u0026gt; \u0026lt;p\u0026gt; 文本段文本段文本段文本段文本段文本段文本段文本段文本段文本段文本段文本段文本段文本段文本段文本段文本段。 \u0026lt;/p\u0026gt; \u0026lt;!--块状元素，由于没有设置宽度，宽度默认显示为100%--\u0026gt; \u0026lt;div id=\u0026#34;box1\u0026#34;\u0026gt;box1\u0026lt;/div\u0026gt; \u0026lt;!--块状元素，由于设置了width:300px，宽度显示为300px--\u0026gt; 第二点，在流动模型下，内联元素都会在所处的包含元素内从左到右水平分布显示\n\u0026lt;a href=\u0026#34;http://www.imooc.com\u0026#34;\u0026gt;www.imooc.com\u0026lt;/a\u0026gt;\u0026lt;span\u0026gt;强调\u0026lt;/span\u0026gt;\u0026lt;em\u0026gt;重点\u0026lt;/em\u0026gt; \u0026lt;strong\u0026gt;强调\u0026lt;/strong\u0026gt; 3、浮动模型\n块状元素这么霸道都是独占一行，设置元素浮动可以实现让两个块状元素并排显示\n任何元素在默认情况下是不能浮动的，但可以用 CSS 定义为浮动，如 div、p、table、img 等元素都可以被定义为浮动。如下代码可以实现两个 div 元素一行显示。\n\u0026lt;style\u0026gt; div { width: 200px; height: 200px; border: 2px red solid; float: left; } \u0026lt;/style\u0026gt; \u0026lt;div id=\u0026#34;div1\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;div id=\u0026#34;div2\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; 4、层模型\n层布局模型就像是图像软件 PhotoShop 中非常流行的图层编辑功能一样，每个图层能够精确定位操作。网页上局部使用层布局是有其方便之处的\nCSS 定义了一组定位（positioning）属性来支持层布局模型\n绝对定位（position: absolute） 相对定位（position: relative） 固定定位（position: fixed） 如果想为元素设置层模型中的绝对定位，需要设置 position:absolute(表示绝对定位)，这条语句的作用将元素从文档流中拖出来，然后使用 left、right、top、bottom 属性相对于其最接近的一个具有定位属性的父包含块进行绝对定位。如果不存在这样的包含块，则相对于 body 元素，即相对于浏览器窗口。 4、层模型 - 绝对定位\n如果想为元素设置层模型中的绝对定位，需要设置 position:absolute （表示绝对定位），这条语句的作用将元素从文档流中拖出来，然后使用 left、right、top、bottom 属性相对于其最接近的一个具有定位属性的父包含块进行绝对定位。如果不存在这样的包含块，则相对于 body 元素，即相对于浏览器窗口\n如下面代码可以实现 div 元素相对于浏览器窗口向右移动 100px，向下移动 50px\n\u0026lt;style\u0026gt; div { width: 200px; height: 200px; border: 2px red solid; position: absolute; left: 100px; top: 50px; } \u0026lt;/style\u0026gt; \u0026lt;div id=\u0026#34;div1\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; 5、层模型 - 相对定位\n如果想为元素设置层模型中的相对定位，需要设置 position:relative（表示相对定位），它通过 left、right、top、bottom 属性确定元素在正常文档流中的偏移位置。相对定位完成的过程是首先按 static(float) 方式生成一个元素(并且元素像层一样浮动了起来)，然后相对于以前的位置移动，移动的方向和幅度由 left、right、top、bottom 属性确定，偏移前的位置保留不动\n\u0026lt;style\u0026gt; #div1 { width: 200px; height: 200px; border: 2px red solid; position: relative; left: 100px; top: 50px; } \u0026lt;/style\u0026gt; \u0026lt;div id=\u0026#34;div1\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; 什么叫做“偏移前的位置保留不动”呢？\n\u0026lt;body\u0026gt; \u0026lt;div id=\u0026#34;div1\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;span\u0026gt;偏移前的位置还保留不动，覆盖不了前面的div没有偏移前的位置\u0026lt;/span\u0026gt; \u0026lt;/body\u0026gt; 6、层模型 - 固定定位\nfixed：表示固定定位，与 absolute 定位类型类似，但它的相对移动的坐标是视图（屏幕内的网页窗口）本身。由于视图本身是固定的，它不会随浏览器窗口的滚动条滚动而变化，除非你在屏幕中移动浏览器窗口的屏幕位置，或改变浏览器窗口的显示大小，因此固定定位的元素会始终位于浏览器窗口内视图的某个位置，不会受文档流动影响，这与 background-attachment:fixed; 属性功能相同。\n以下代码可以实现相对于浏览器视图向右移动 100px，向下移动 50px。并且拖动滚动条时位置固定不变\n\u0026lt;style type=\u0026#34;text/css\u0026#34;\u0026gt; #div1 { width: 200px; height: 200px; border: 2px red solid; position: fixed; left: 100px; top: 50px; } \u0026lt;/style\u0026gt; \u0026lt;p\u0026gt; 文本文本文本文本文本文本文本文本文本文本文本文本文本文本文本文本文本文本文本文本文本文本文本文本文本文本文本文本文本文本文本文本文本文本。 \u0026lt;/p\u0026gt; ... 7、Relative 与 Absolute 组合使用\n使用 position:absolute 可以实现被设置元素相对于浏览器（body）设置定位以后，使用 position:relative 可以相对于其它元素进行定位。但是必须遵守下面规范：\n参照定位的元素必须是相对定位元素的前辈元素： \u0026lt;div id=\u0026#34;box1\u0026#34;\u0026gt; \u0026lt;!--参照定位的元素--\u0026gt; \u0026lt;div id=\u0026#34;box2\u0026#34;\u0026gt;相对参照元素进行定位\u0026lt;/div\u0026gt; \u0026lt;!--相对定位元素--\u0026gt; \u0026lt;/div\u0026gt; 参照定位的元素必须加入 position:relative; #box1 { width: 200px; height: 200px; position: relative; } 定位元素加入 position:absolute，便可以使用 top、bottom、left、right 来进行偏移定位了 #box2 { position: absolute; top: 20px; left: 30px; } 这样 box2 就可以相对于父元素 box1 定位了（这里注意参照物就可以不是浏览器了，而可以自由设置了）\n第 13 章 CSS 代码缩写，占用更少的带宽 盒模型代码简写 还记得在讲盒模型时外边距（margin）、内边距（padding）和边框（border)设置上下左右四个方向的边距是按照顺时针方向设置的：上右下左\n/* 上设置为10px、右设置为15px、下设置为12px、左设置为14px */ margin: 10px 15px 12px 14px; margin: 10px 10px 10px 10px; /* 可缩写为：*/ margin: 10px; margin: 10px 20px 10px 20px; /* 可缩写为：*/ margin: 10px 20px; /* 如果left和right的值相同，如下面代码：*/ margin: 10px 20px 30px 20px; /* 可缩写为：*/ margin: 10px 20px 30px; /* padding、border的缩写方法和margin是一致的。*/ 颜色值缩写 当设置的颜色是 16 进制的色彩值时，如果每两位的值相同，可以缩写一半\np { color: #000000; } /* 可以缩写为：*/ p { color: #000; } p { color: #336699; } /* 可以缩写为：*/ p { color: #369; } 字体缩写 body { font-style: italic; font-variant: small-caps; font-weight: bold; font-size: 12px; line-height: 1.5em; font-family: \u0026#34;宋体\u0026#34;, sans-serif; } /* 这么多行的代码其实可以缩写为一句：*/ body { font: italic small-caps bold 12px/1.5em \u0026#34;宋体\u0026#34;, sans-serif; } 注意：\n使用这一简写方式你至少要指定 font-size 和 font-family 属性，其他的属性（如 font-weight、font-style、font-variant、line-height）如未指定将自动使用默认值。 在缩写时 font-size 与 line-height 中间要加入 / 斜扛。 一般情况下因为对于中文网站，英文还是比较少的，所以下面缩写代码比较常用： body { font: 12px/1.5em \u0026#34;宋体\u0026#34;, sans-serif; } /* 只是有字号、行间距、中文字体、英文字体设置 */ 第 14 章 单位和值 颜色值 字体颜色（color）、背景颜色（background-color）、边框颜色（border）等：\n/* 英文命令颜色 */ p { color: red; } /* RGB颜色 */ p { color: rgb(133, 45, 200); } /* 每一项的值可以是 0~255 之间的整数，也可以是 0%~100% 的百分数。如：*/ p { color: rgb(20%, 33%, 25%); } /* 十六进制颜色。原理其实也是 RGB 设置，值由 0-255 变成了十六进制 00-ff */ p { color: #00ffff; } 长度值 长度单位总结一下，目前比较常用到 px（像素）、em、% 百分比，要注意其实这三种单位都是相对单位。\n像素：像素为什么是相对单位呢？因为像素指的是显示器上的小点（CSS 规范中假设“90 像素=1 英寸”）。实际情况是浏览器会使用显示器的实际像素值有关，在目前大多数的设计者都倾向于使用像素（px）作为单位 em：就是本元素给定字体的 font-size 值，如果元素的 font-size 为 14px ，那么 1em = 14px；如果 font-size 为 18px，那么 1em = 18px。如下代码： p { font-size: 12px; text-indent: 2em; } /* 上面代码就是可以实现段落首行缩进 24px（也就是两个字体大小的距离）*/ 下面注意一个特殊情况： 但当给 font-size 设置单位为 em 时，此时计算的标准以 p 的父元素的 font-size 为基础。如下代码：\n\u0026lt;p\u0026gt;以这个\u0026lt;span\u0026gt;例子\u0026lt;/span\u0026gt;为例。\u0026lt;/p\u0026gt; // css: p{font-size:14px} span{font-size:0.8em;} // 结果 span 中的字体“例子”字体大小就为 11.2px（14 * 0.8 = 11.2px）。 百分比 p { font-size: 12px; line-height: 130%; } 设置行高（行间距）为字体的 130%（12 * 1.3 = 15.6px）\n第 15 章 CSS 样式设置小技巧 水平居中 - 行内元素 如果被设置元素为文本、图片等行内元素时，水平居中是通过给父元素设置 text-align:center 来实现的\n\u0026lt;body\u0026gt; \u0026lt;div class=\u0026#34;txtCenter\u0026#34;\u0026gt;我想要在父容器中水平居中显示。\u0026lt;/div\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;style\u0026gt; .txtCenter { text-align: center; } \u0026lt;/style\u0026gt; 水平居中 - 定宽块状元素 当被设置元素为 块状元素 时用 text-aligncenter 就不起作用了，这时也分两种情况：定宽块状元素 和 不定宽块状元素。\n满足 定宽 和 块状 两个条件的元素是可以通过设置 左右margin 值为 auto 来实现居中的。\n\u0026lt;body\u0026gt; \u0026lt;div\u0026gt;我是定宽块状元素，哈哈，我要水平居中显示。\u0026lt;/div\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;style\u0026gt; div { border: 1px solid red; /*为了显示居中效果明显为 div 设置了边框*/ width: 200px; /*定宽*/ margin: 20px auto; /* margin-left 与 margin-right 设置为 auto */ // 注意：元素的“上下 margin” 是可以随意设置的 } \u0026lt;/style\u0026gt; 水平居中 - 不定宽块状元素方法（一） 不定宽度的块状元素有三种方法居中：\n加入 table 标签 设置 display: inline 方法：与第一种类似，显示类型设为 行内元素，进行不定宽元素的属性设置 设置 position:relative 和 left:50%：利用 相对定位 的方式，将元素向左偏移 50% ，即达到居中的目的 加入 table 标签是利用 table 标签的长度自适应性，即不定义其长度也不默认父元素 body 的长度（table 其长度根据其内文本长度决定），因此可以看做一个定宽度块元素，然后再利用定宽度块状居中的 margin 的方法，使其水平居中\n第一步：为需要设置的居中的元素外面加入一个 table 标签 ( 包括 \u0026lt;tbody\u0026gt;、\u0026lt;tr\u0026gt;、\u0026lt;td\u0026gt; )\n第二步：为这个 table 设置 左右 margin 居中（这个和定宽块状元素的方法一样）\n\u0026lt;div\u0026gt; \u0026lt;table\u0026gt; \u0026lt;tbody\u0026gt; \u0026lt;tr\u0026gt; \u0026lt;td\u0026gt; \u0026lt;ul\u0026gt; \u0026lt;li\u0026gt;我是第一行文本\u0026lt;/li\u0026gt; \u0026lt;li\u0026gt;我是第二行文本\u0026lt;/li\u0026gt; \u0026lt;li\u0026gt;我是第三行文本\u0026lt;/li\u0026gt; \u0026lt;/ul\u0026gt; \u0026lt;/td\u0026gt; \u0026lt;/tr\u0026gt; \u0026lt;/tbody\u0026gt; \u0026lt;/table\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;style\u0026gt; table { border: 1px solid; margin: 0 auto; } \u0026lt;/style\u0026gt; 水平居中 - 不定宽块状元素方法（二） 改变块级元素的 display 为 inline 类型（设置为 行内元素 显示），然后使用 text-align:center 来实现居中效果。\n\u0026lt;body\u0026gt; \u0026lt;div class=\u0026#34;container\u0026#34;\u0026gt; \u0026lt;ul\u0026gt; \u0026lt;li\u0026gt;\u0026lt;a href=\u0026#34;#\u0026#34;\u0026gt;1\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt; \u0026lt;li\u0026gt;\u0026lt;a href=\u0026#34;#\u0026#34;\u0026gt;2\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt; \u0026lt;li\u0026gt;\u0026lt;a href=\u0026#34;#\u0026#34;\u0026gt;3\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt; \u0026lt;/ul\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;style\u0026gt; .container { text-align: center; } /* margin:0;padding:0（消除文本与div边框之间的间隙）*/ .container ul { list-style: none; margin: 0; padding: 0; display: inline; } /* margin-right:8px（设置li文本之间的间隔）*/ .container li { margin-right: 8px; display: inline; } \u0026lt;/style\u0026gt; 这种方法相比第一种方法的优势是不用增加无语义标签，但也存在着一些问题：它将块状元素的 display 类型改为 inline，变成了行内元素，所以少了一些功能，比如设定长度值\n水平居中 - 不定宽块状元素方法（三） 通过给父元素设置 float，然后给父元素设置 position:relative 和 left:50%，子元素设置 position:relative 和 left: -50% 来实现水平居中 div 中间有条平分界线，然后将 ul 的最左端与 div 的平分线对其； li 中有条平分线，然后将 li 的平分线与 ul 的最左端对其； 简单的说就是：div 和 li 都有条平分线，然后 ul 的最左端作为平分线标准，div 和 li 都与其对其，然后 div 确定外框，则 li 就是在 div 的中间\n注：可以使用 clear:both; 清除浮动\n\u0026lt;body\u0026gt; \u0026lt;div class=\u0026#34;container\u0026#34;\u0026gt; \u0026lt;ul\u0026gt; \u0026lt;li\u0026gt;\u0026lt;a href=\u0026#34;#\u0026#34;\u0026gt;1\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt; \u0026lt;li\u0026gt;\u0026lt;a href=\u0026#34;#\u0026#34;\u0026gt;2\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt; \u0026lt;li\u0026gt;\u0026lt;a href=\u0026#34;#\u0026#34;\u0026gt;3\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt; \u0026lt;/ul\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;style\u0026gt; .container { float: left; position: relative; left: 50%; } .container ul { list-style: none; margin: 0; padding: 0; position: relative; left: -50%; } .container li { float: left; display: inline; margin-right: 8px; } \u0026lt;/style\u0026gt; 垂直居中 - 父元素高度确定的单行文本 分两种情况：父元素高度确定的单行文本，以及父元素高度确定的多行文本\n父元素高度确定的单行文本的竖直居中的方法是通过设置父元素的 height 和 line-height 高度一致来实现的 （height: 该元素的高度，line-height: 顾名思义，行高（行间距），指在文本中，行与行之间的基线间的距离 ）\nline-height 与 font-size 的计算值之差，在 CSS 中成为“行间距”。分为两半，分别加到一个文本行内容的顶部和底部\n这种文字行高与块高一致带来了一个弊端：当文字内容的长度大于块的宽时，就有内容脱离了块（溢出）\n\u0026lt;div class=\u0026#34;container\u0026#34;\u0026gt;hi,imooc!\u0026lt;/div\u0026gt; \u0026lt;style\u0026gt; .container { height: 100px; line-height: 100px; background: #999; } \u0026lt;/style\u0026gt; 垂直居中 - 父元素高度确定的多行文本（方法一） 使用插入 table (包括 tbody、tr、td)标签，同时设置 vertical-align：middle\nCSS 中有一个用于竖直居中的属性 vertical-align，在父元素设置此样式时，会对 inline-block 类型的子元素都有用。下面看一下例子：\n\u0026lt;table\u0026gt; \u0026lt;tbody\u0026gt; \u0026lt;tr\u0026gt; \u0026lt;td class=\u0026#34;wrap\u0026#34;\u0026gt; \u0026lt;div\u0026gt; \u0026lt;p\u0026gt;看我是否可以居中。\u0026lt;/p\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/td\u0026gt; \u0026lt;/tr\u0026gt; \u0026lt;/tbody\u0026gt; \u0026lt;/table\u0026gt; \u0026lt;style\u0026gt; table td { height: 500px; background: #ccc; } \u0026lt;/style\u0026gt; 因为 td 标签默认情况下就默认设置了 vertical-align: middle，所以我们不需要显式地设置了\n垂直居中 - 父元素高度确定的多行文本（方法二） 在 chrome、firefox 及 IE8 以上的浏览器下可以设置块级元素的 display 为 table-cell（设置为表格单元显示），激活 vertical-align 属性，但注意 IE6、7 并不支持这个样式，兼容性比较差\n\u0026lt;div class=\u0026#34;container\u0026#34;\u0026gt; \u0026lt;div\u0026gt; \u0026lt;p\u0026gt;看我是否可以居中。\u0026lt;/p\u0026gt; \u0026lt;p\u0026gt;看我是否可以居中。\u0026lt;/p\u0026gt; \u0026lt;p\u0026gt;看我是否可以居中。\u0026lt;/p\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;style\u0026gt; .container { height: 300px; background: #ccc; display: table-cell; /*IE8以上及Chrome、Firefox*/ vertical-align: middle; /*IE8以上及Chrome、Firefox*/ } \u0026lt;/style\u0026gt; 这种方法的好处是不用添加多余的无意义的标签，但缺点也很明显，它的兼容性不是很好，不兼容 IE6、7 而且这样修改 display 的 block 变成了 table-cell，破坏了原有的块状元素的性质（笔者：IE6、7 基本可以放弃了）\n隐性改变 display 类型 有一个有趣的现象就是当为元素（不论之前是什么类型元素，display:none 除外）设置以下 2 个句之一：\nposition : absolute float : left 或 float:right 只要 HTML 代码中出现以上两句之一，元素的 display 显示类型就会自动变为以 display:inline-block（块状元素）的方式显示，当然就可以设置元素的 width 和 height 了，且默认宽度不占满父元素 如下面的代码，a 标签是 行内元素 ，所以设置它的 width 是 没有效果的，但是设置为 position:absolute 以后，就可以了\n\u0026lt;div class=\u0026#34;container\u0026#34;\u0026gt; \u0026lt;a href=\u0026#34;#\u0026#34; title=\u0026#34;\u0026#34;\u0026gt;进入课程请单击这里\u0026lt;/a\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;style\u0026gt; .container a { position: absolute; width: 200px; background: #ccc; } \u0026lt;/style\u0026gt; \u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2017/02/23/imooc-html-css-basic-course/","summary":"\u003cp\u003e【注意】内容不再维护。\u003c/p\u003e\n\u003chr\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ca href=\"http://www.imooc.com/learn/9\"\u003eHTML+CSS 基础课程-慕课网\u003c/a\u003e\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003e2017 年一个心愿，认真学习前端，成为公司里最厉害前端工程师。Flag 立的还是很大的。\u003c/p\u003e\n\u003ch2 id=\"第-1-章-html-介绍\"\u003e第 1 章 HTML 介绍\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003eHTML 是网页内容的载体。内容就是网页制作者放在页面上想要让用户浏览的信息，可以包含文字、图片、视频等。\u003c/li\u003e\n\u003cli\u003eCSS 样式是表现。就像网页的外衣。比如，标题字体、颜色变化，或为标题加入背景图片、边框等。所有这些用来改变内容外观的东西称之为表现。\u003c/li\u003e\n\u003cli\u003eJavaScript 是用来实现网页上的特效效果。如：鼠标滑过弹出下拉菜单。或鼠标滑过表格的背景颜色改变。还有焦点新闻（新闻图片）的轮换。可以这么理解，有动画的，有交互的一般都是用 JavaScript 来实现的。\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2 id=\"第-2-章-认识标签第一部分\"\u003e第 2 章 认识标签(第一部分)\u003c/h2\u003e\n\u003cp\u003e常常会听到一个词，\u003cstrong\u003e语义化\u003c/strong\u003e。说的通俗点就是：明白每个标签的用途（在什么情况下使用此标签合理）。\u003c/p\u003e\n\u003cp\u003e比如，网页上的文章的标题就可以用标题标签，网页上的各个栏目的栏目名称也可以使用标题标签。文章中内容的段落就得放在段落标签中，在文章中有想强调的文本，就可以使用 \u003ccode\u003eem\u003c/code\u003e 标签表示强调等等。\n语义化可以给我们带来什么样的好处呢？\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e更容易被搜索引擎收录。\u003c/li\u003e\n\u003cli\u003e更容易让屏幕阅读器读出网页内容。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e1、在网页上要展示出来的页面内容一定要放在 \u003ccode\u003ebody\u003c/code\u003e 标签中；\u003c/p\u003e\n\u003cp\u003e2、如果想在网页上显示文章，这时就需要 \u003ccode\u003e\u0026lt;p\u0026gt;\u003c/code\u003e 标签了，把文章的段落放到 \u003ccode\u003e\u0026lt;p\u0026gt;\u003c/code\u003e 标签；\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-html\" data-lang=\"html\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003ep\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e段落文本\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003ep\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e3、标题标签一共有 6 个，h1、h2、h3、h4、h5、h6 分别为一级标题、二级标题、三级标题、四级标题、五级标题、六级标题。并且依据重要性递减。\u003ccode\u003e\u0026lt;h1\u0026gt;\u003c/code\u003e 是最高的等级：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-html\" data-lang=\"html\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003ehx\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e标题文本\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003ehx\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e   \u003cspan class=\"c\"\u003e\u0026lt;!-- x为1-6 --\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e4、在一段话中特别强调某几个文字，这时候就可以用到 \u003ccode\u003e\u0026lt;em\u0026gt;\u003c/code\u003e 或 \u003ccode\u003e\u0026lt;strong\u0026gt;\u003c/code\u003e 标签。在浏览器中 \u003ccode\u003e\u0026lt;em\u0026gt;\u003c/code\u003e 默认用斜体表示，\u003ccode\u003e\u0026lt;strong\u0026gt;\u003c/code\u003e 用粗体表示。两个标签相比，目前国内前端程序员更喜欢使用 \u003ccode\u003e\u0026lt;strong\u0026gt;\u003c/code\u003e 表示强调：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-html\" data-lang=\"html\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eem\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e需要强调的文本\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eem\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-html\" data-lang=\"html\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003estrong\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e需要强调的文本\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003estrong\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e5、\u003ccode\u003e\u0026lt;span\u0026gt;\u003c/code\u003e 标签是没有语义的，它的作用就是为了设置单独的样式用的：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-html\" data-lang=\"html\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003espan\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e文本\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003espan\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e6、想引用某个作家的一句诗，这样会使你的文章更加出彩，那么 \u003ccode\u003e\u0026lt;q\u0026gt;\u003c/code\u003e 标签是你所需要的：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-html\" data-lang=\"html\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eq\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e引用文本\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eq\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e7、\u003ccode\u003e\u0026lt;blockquote\u0026gt;\u003c/code\u003e 的作用也是引用别人的文本。但它是对长文本的引用，如在文章中引入大段某知名作家的文字，这时需要这个标签。\u003c/p\u003e","title":"IMOOC HTML+CSS 基础课程笔记"},{"content":"2016 肯定是很特别的一年。年初离开了老师的队伍，来北京找实习。年中和 318 告别，大学毕业了。年末换房学做饭，开始另种生活。对于 2017 更多了对自己的期待。\n2016 是在保定的雾霾中开始。结束了大为，决定离开老师的队伍，来北京实习，这对我来说是一个不大不小的决定。老师带着，跟学长一起走到这里，这里有了很多宝贵的东西，有很多回忆，很多故事可以讲。选择离开，主要还是想看看在这之外的是什么样子。\n朋友、老师、爸妈都为我的实习操过心，不过推荐的地方在各种奇怪的理由下都没有成。自己开始在拉勾上投简历，一次次来返在京石铁路上。面试一直是不顺的。完全没有想到对实习生有如此高的要求，很多技术问题正中下怀。心里是有落差的，在我当时的想法里，那些在工程中是用不易用到的，但也感到自己技术知识的浅薄。面试了俩三家后也发现了套路，回答不好的、答不上的问题，回去查查准备准备，下回就能用上。\n没什么难度的大学毕业。大学里更多的收获是跟着老师、学长在课堂外搞事，是和宿舍的、好朋友在一起的时间。真的好幸运啊，遇到 318 的舍友们。没想到和你们每一个人都超级聊的来。大四的时候人就渐渐不齐，但只要宿舍在，不到最后毕业真的不知道要分别了。我们相互影响着成长，至少除去了我很多很 low 的思想。我们相互练着酒量、每天演着戏、日常说着骚话。\n德育答辩上一个同学说：我常翘课、考试挂科，但我大学四年过的很坦荡，我会因为和舍友游戏上的一个好玩的套路高兴很久。我收获朋友。我没什么后悔的。 这很戳中我的泪点。没什么后悔的，也是对我大学的注脚。愿你们成家的幸福，工作的有成。\n从上学到工作，过渡的很平稳。工作中有一些挑战，但总之是还应对的来。可没有什么出众的地方，我不想过的太平凡，愿有一技之长，独挡一面。我常说自己：菜啊、傻啊、什么的，我确实不想用这些来词来逃避问题，我想尽快的甩掉这些。我也愿自己可以更有底气和勇气说出，现在不能说出的话，愿更决绝的对大事小情做决定。\n年末随着公司搬家，自己也搬了。炒菜做饭成了每天另一部分。也许才是真正生活二字的开始。\n突然想到学长提的一个问题：你们有谁把技术当做以后安身立命的本事？ 现在对于我来说，这问题的答案比任何时候都更加清晰。\n最后，还是怀揣着 2014 末的敬请期待，让一切皆有可能，开始 2017。\n—— 送给 木林木丶\n\u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2016/12/31/review-2016/","summary":"\u003cp\u003e2016 肯定是很特别的一年。年初离开了老师的队伍，来北京找实习。年中和 318 告别，大学毕业了。年末换房学做饭，开始另种生活。对于 2017 更多了对自己的期待。\u003c/p\u003e\n\u003c!-- more --\u003e\n\u003ciframe frameborder=\"no\" border=\"0\" marginwidth=\"0\" marginheight=\"0\" width=260 height=52 src=\"//music.163.com/outchain/player?type=2\u0026id=31445772\u0026auto=0\u0026height=32\"\u003e\u003c/iframe\u003e\n\u003cp\u003e2016 是在保定的雾霾中开始。结束了大为，决定离开老师的队伍，来北京实习，这对我来说是一个不大不小的决定。老师带着，跟学长一起走到这里，这里有了很多宝贵的东西，有很多回忆，很多故事可以讲。选择离开，主要还是想看看在这之外的是什么样子。\u003c/p\u003e\n\u003cp\u003e朋友、老师、爸妈都为我的实习操过心，不过推荐的地方在各种奇怪的理由下都没有成。自己开始在拉勾上投简历，一次次来返在京石铁路上。面试一直是不顺的。完全没有想到对实习生有如此高的要求，很多技术问题正中下怀。心里是有落差的，在我当时的想法里，那些在工程中是用不易用到的，但也感到自己技术知识的浅薄。面试了俩三家后也发现了套路，回答不好的、答不上的问题，回去查查准备准备，下回就能用上。\u003c/p\u003e\n\u003cp\u003e没什么难度的大学毕业。大学里更多的收获是跟着老师、学长在课堂外搞事，是和宿舍的、好朋友在一起的时间。真的好幸运啊，遇到 318 的舍友们。没想到和你们每一个人都超级聊的来。大四的时候人就渐渐不齐，但只要宿舍在，不到最后毕业真的不知道要分别了。我们相互影响着成长，至少除去了我很多很 low 的思想。我们相互练着酒量、每天演着戏、日常说着骚话。\u003c/p\u003e\n\u003cp\u003e德育答辩上一个同学说：我常翘课、考试挂科，但我大学四年过的很坦荡，我会因为和舍友游戏上的一个好玩的套路高兴很久。我收获朋友。我没什么后悔的。\n这很戳中我的泪点。没什么后悔的，也是对我大学的注脚。愿你们成家的幸福，工作的有成。\u003c/p\u003e\n\u003cp\u003e从上学到工作，过渡的很平稳。工作中有一些挑战，但总之是还应对的来。可没有什么出众的地方，我不想过的太平凡，愿有一技之长，独挡一面。我常说自己：菜啊、傻啊、什么的，我确实不想用这些来词来逃避问题，我想尽快的甩掉这些。我也愿自己可以更有底气和勇气说出，现在不能说出的话，愿更决绝的对大事小情做决定。\u003c/p\u003e\n\u003cp\u003e年末随着公司搬家，自己也搬了。炒菜做饭成了每天另一部分。也许才是真正生活二字的开始。\u003c/p\u003e\n\u003cp\u003e突然想到学长提的一个问题：你们有谁把技术当做以后安身立命的本事？\n现在对于我来说，这问题的答案比任何时候都更加清晰。\u003c/p\u003e\n\u003cp\u003e最后，还是怀揣着 2014 末的敬请期待，让一切皆有可能，开始 2017。\u003c/p\u003e\n\u003cp\u003e—— 送给 木林木丶\u003c/p\u003e\n\u003cp\u003e\u0026ndash; EOF \u0026ndash;\u003c/p\u003e","title":"回顾 2016"},{"content":"UFW (Uncomplicated Firewall) 作为 iptables 的前端应用，给用户提供了简单的接口界面。使用着不需要去记非常复杂的 iptables 语法。UFW 也使用了 简单英语 作为它的参数。像 allow、deny、reset 就是他们当中的一部分。UFW 绝对是那些想要快速、简单的就建立自己的防火墙，而且还很安全的用户的最佳替代品之一。\n检查系统上是否已经安装 UFW sudo dpkg --get-selections | grep ufw 安装 UFW sudo apt-get install ufw UFW 常用命令 查看 UFW 状态 sudo ufw status see configured rules even when inactive ufw show added 启用/禁用 UFW # 启用 sudo ufw enable # 禁用 sudo ufw disable 先添加 ufw allow ssh，防止墙掉自己\n查看 UFW 规则 需要先启用 UFW\nsudo ufw status verbose 在每条规则上加个序号数字\nsudo ufw status numbered 添加 UFW 允许规则 允许特定服务程序\nsudo ufw allow ssh 允许特定服务程序特定协议\nsudo ufw allow ssh/tcp 允许特定端口\nsudo ufw allow 8080 允许特定端口特定协议\nsudo ufw allow 8080/tcp 允许范围端口特定协议，必须指明协议 udp 或 tcp\nsudo ufw allow 2290:2300/tcp 允许特定 IP\nsudo ufw allow from 192.168.0.104 允许范围 IP\nsudo ufw allow from 192.168.0.0/24 networking - UFW - allow range of IP addresees? - Ask Ubuntu IPv4 subnetting reference - Wikipedia 组合参数\n可以把 IP 地址、协议和端口这些组合在一起用。创建一条规则，限制仅仅来自于 192.168.0.104 的 IP ，而且只能使用 tcp 协议和通过 22 端口来访问本地资源：\nsudo ufw allow from 192.168.0.104 proto tcp to any port 22 添加 UFW 拒绝规则 创建拒绝规则的命令和允许的规则类似，仅需要把 allow 参数换成 deny 参数就可以。\nsudo ufw deny ftp 删除 UFW 规则 方法一：\nsudo ufw delete allow ftp 方法二：按行号删除\n# 显示行号 sudo ufw status numbered # 按行号删除 sudo ufw delete 1 重置 UFW 所有规则 sudo ufw reset References Debian/Ubuntu 系统中安装和配置 UFW－简单的防火墙-技术 ◆ 学习|Linux.中国-开源社区 See configured rules even when inactive ","permalink":"https://zyf.im/2016/10/10/manage-iptables-using-ufw-in-ubuntu/","summary":"\u003cp\u003eUFW (Uncomplicated Firewall) 作为 \u003ccode\u003eiptables\u003c/code\u003e 的前端应用，给用户提供了简单的接口界面。使用着不需要去记非常复杂的 \u003ccode\u003eiptables\u003c/code\u003e 语法。UFW 也使用了 简单英语 作为它的参数。像 allow、deny、reset 就是他们当中的一部分。UFW 绝对是那些想要快速、简单的就建立自己的防火墙，而且还很安全的用户的最佳替代品之一。\u003c/p\u003e\n\u003ch2 id=\"检查系统上是否已经安装-ufw\"\u003e检查系统上是否已经安装 UFW\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo dpkg --get-selections \u003cspan class=\"p\"\u003e|\u003c/span\u003e grep ufw\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"安装-ufw\"\u003e安装 UFW\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo apt-get install ufw\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c!-- more --\u003e\n\u003ch2 id=\"ufw-常用命令\"\u003eUFW 常用命令\u003c/h2\u003e\n\u003ch3 id=\"查看-ufw-状态\"\u003e查看 UFW 状态\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo ufw status\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"see-configured-rules-even-when-inactive\"\u003esee configured rules even when inactive\u003c/h3\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003eufw show added\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"启用禁用-ufw\"\u003e启用/禁用 UFW\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# 启用\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo ufw \u003cspan class=\"nb\"\u003eenable\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# 禁用\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo ufw disable\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e先添加 \u003ccode\u003eufw allow ssh\u003c/code\u003e，防止墙掉自己\u003c/p\u003e\n\u003ch3 id=\"查看-ufw-规则\"\u003e查看 UFW 规则\u003c/h3\u003e\n\u003cp\u003e需要先启用 UFW\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo ufw status verbose\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e在每条规则上加个序号数字\u003c/p\u003e","title":"Ubuntu 下使用 UFW 管理防火墙服务"},{"content":"本文总结的是书中的：第 5 章 继承\n前几章的总结在：ZYF.IM-【Core Java】读书笔记 Part1\n5 继承 5.1 类、超类和子类 1、有些人认为 super 与 this 引用是类似的概念，实际上，这样比较并不太恰当。这是因为 super 不是一个对象的引用，不能将 super 赋予另一个对象变量，它只是一个指示编译器调用超类方法的特殊关键字。 2、使用 super 或 this 调用构造器的语句必须时子类构造器的第一条语句。也就是说 super 和 this 不能同时出现在一个构造器中。 3、this 关键字。\n引用隐式参数 调用该类其他的构造器 4、super 关键字\n调用超类的方法 调用超类的构造器 5、调用构造器的语句只能作为另一个构造器的第一条语句出现。 6、一个对象变量可以指示多种实际类型的现象被称为多态。在运行时能够自动的选择则调用哪个方法的现象称为动态绑定。 7、Manager[] managers = new Manager[10]; 将它转换成 Employee[] 数组是完全合法的： Employee[] staff = managers;// OK 毕竟如果manager[i]是一个 Manager，也一定是一个 Employee，然而，实际上，将会发生一些令人惊讶的事情。要切记 managers 和 staff 引用的时同一个数组。现在请看： staff[0] = new Employee(\u0026quot;Harry Hacker\u0026quot;, ..); 编译器竟然接纳了这个赋值操作。staff[0]与manager[0]引用的是同一个对象，似乎我们把一个普通雇员擅自归入了经理行列中了。这时一个种很忌讳发生的情形，当调用managers[0].setBonus(1000)的时候，将会导致调用一个不存在的实例域，今儿搅乱相邻存储空间的内容。 为了确保不发生这类错误，所有数组都要牢记创建它们的元素类型，并负责监督仅将类型兼容的引用存储到数组中。\n8、调用对象方法的执行过程\n编译器查看对象的声明类型和方法名。假设调用 x.f(param)，编译器将会一一列举所有 C 类中名为 f 的方法和其他超类中访问属性为 public 且名为 f 的方法（超类的私有方法不可访问）。 编译器将查看调用方法时提供的参数类型。如果在所有名为 f 的方法中存在一个与提供的参数类型完全匹配，就选择这个方法。这个工程称为重载解析。 Tips：返回类型不是签名方法的一部分，因此，在覆盖方法时，一定要保证返回类型的兼容性。允许子类将覆盖方法的返回类型定义为原返回类型的子类型。 如果是 private 方法、static 方法、final 方法或者构造器，那么编译器将可以准确的知道应该调用哪个方法，我们将这种调用方式称为静态绑定。与此对应，调用的方法依赖于隐式参数的实际类型，并且在运行时实现动态绑定。 9、动态绑定与静态绑定区别对比 9.1）静态绑定发生在编译时期，动态绑定发生在运行时 9.2）使用 private 或 static 或 final 修饰的变量或者方法，使用静态绑定。而虚方法（可以被子类重写的方法）则会根据运行时的对象进行动态绑定。 9.3）静态绑定使用类信息来完成，而动态绑定则需要使用对象信息来完成。 9.4）重载(Overload)的方法使用静态绑定完成，而重写(Override)的方法则使用动态绑定完成。\n10、当程序运行，并且采用动态绑定调用方法时，虚拟机一定调用与 x 所引用对象的实际类型最合适的那个类的方法。假设 x 的实际类型是 D，它是 C 类的子类。如果 D 类定义了方法 f(String)，就直接调用它；否则，将在 D 类的超类中寻找 f(String)，以此类推。\n11、每次调用方法都要进行搜索，时间开销相当大。因此，虚拟机预先为每个类创建了一个方法表，其中列出了所有方法的签名和实际调用的方法。这样一来，在真正调用方法的时候，虚拟机仅查找这个表就行了。\n5.1 类、超类和子类 1、4 个访问修饰符\n仅对本类可 - private 对所有类可见 - publice 对本包和所有子类可见 - protected 对本包可见 - 默认，不需要修饰符 2、编写一个完美的 equals 方法的建议 2.1）参数命名为 otherObject，稍后需要将它转换成另一个叫做 other 的变量 2.2）检测 this 与 otherObject 是否引用同一个对象： if(this == otherObject) return true; 这条语句只是一个优化。实际上，这是一种经常采用的形式。因为计算这个等试要比一个一个的比较类中的域付出的代价小得多。 2.3）检测 otherObject 是否为 null，如果为 null，返回 false。这项检测时很有必要的。 if(otherObject == null) return false; 2.4）比较 this 与 otherObject 是否属于同一个类。如果 equals 的语义在每一个子类中有所改变（子类能够拥有自己的相等概念），就使用 getClass 检测： if(getClass() != otherObject.getClass()) return false; 如果所有的子类都拥有统一的语义（由超类决定相等的概念）就使用 instanceof 检测： if(!(otherObject instanceof ClassName)) return false; 2.5）将 otherObject 转换为相应的类类型变量 ClassName other = (ClassName)otherObject; 2.6）现在开始对所有需要比较的域进行比较了。使用 == 比较基本类型域，使用 equals 比较对象域。如果所有的域都匹配，就返回 true；否则返回 false 2.7）完整的例子：\nclass Employee { ... public boolean equals(Object otherObject) { // a quick test to see if the objects are identical if(this == otherObject) return true; // must return false if the explicit parameter is null if(otherObject == null) return false; // if the classes don`t match, they can`t be equal if(getClass() != otherObject.getClass()) return false; // now we know otherObject is a non-null values Emloyee other = (Emloyee)otherObject; // test whether the fields have identical values return name.equals(other.name) \u0026amp;\u0026amp; salary == other.salary \u0026amp;\u0026amp; hrieDay.equals(other.hirDay); } } References 技术小黑屋-Java 中的静态绑定和动态绑定 ","permalink":"https://zyf.im/2016/09/23/core-java-reading-notes-part2/","summary":"\u003cp\u003e本文总结的是书中的：第 5 章 继承\u003c/p\u003e\n\u003cp\u003e前几章的总结在：\u003ca href=\"/2016/05/06/core-java-reading-notes/\"\u003eZYF.IM-【Core Java】读书笔记 Part1\u003c/a\u003e\u003c/p\u003e\n\u003c!-- more --\u003e\n\u003ch2 id=\"5-继承\"\u003e5 继承\u003c/h2\u003e\n\u003ch3 id=\"51-类超类和子类\"\u003e5.1 类、超类和子类\u003c/h3\u003e\n\u003cp\u003e1、有些人认为 \u003ccode\u003esuper\u003c/code\u003e 与 \u003ccode\u003ethis\u003c/code\u003e 引用是类似的概念，实际上，这样比较并不太恰当。这是因为 \u003ccode\u003esuper\u003c/code\u003e 不是一个对象的引用，不能将 \u003ccode\u003esuper\u003c/code\u003e 赋予另一个对象变量，它只是一个指示编译器调用超类方法的特殊关键字。\n2、使用 \u003ccode\u003esuper\u003c/code\u003e 或 \u003ccode\u003ethis\u003c/code\u003e 调用构造器的语句必须时子类构造器的第一条语句。也就是说 \u003ccode\u003esuper\u003c/code\u003e 和 \u003ccode\u003ethis\u003c/code\u003e 不能同时出现在一个构造器中。\n3、\u003ccode\u003ethis\u003c/code\u003e 关键字。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e引用隐式参数\u003c/li\u003e\n\u003cli\u003e调用该类其他的构造器\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e4、\u003ccode\u003esuper\u003c/code\u003e 关键字\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e调用超类的方法\u003c/li\u003e\n\u003cli\u003e调用超类的构造器\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e5、调用构造器的语句只能作为另一个构造器的第一条语句出现。\n6、一个对象变量可以指示多种实际类型的现象被称为多态。在运行时能够自动的选择则调用哪个方法的现象称为动态绑定。\n7、\u003ccode\u003eManager[] managers = new Manager[10];\u003c/code\u003e 将它转换成 \u003ccode\u003eEmployee[]\u003c/code\u003e 数组是完全合法的：\n\u003ccode\u003eEmployee[] staff = managers;// OK\u003c/code\u003e\n毕竟如果\u003ccode\u003emanager[i]\u003c/code\u003e是一个 Manager，也一定是一个 Employee，然而，实际上，将会发生一些令人惊讶的事情。要切记 managers 和 staff 引用的时同一个数组。现在请看：\n\u003ccode\u003estaff[0] = new Employee(\u0026quot;Harry Hacker\u0026quot;, ..);\u003c/code\u003e\n编译器竟然接纳了这个赋值操作。\u003ccode\u003estaff[0]\u003c/code\u003e与\u003ccode\u003emanager[0]\u003c/code\u003e引用的是同一个对象，似乎我们把一个普通雇员擅自归入了经理行列中了。这时一个种很忌讳发生的情形，当调用\u003ccode\u003emanagers[0].setBonus(1000)\u003c/code\u003e的时候，将会导致调用一个不存在的实例域，今儿搅乱相邻存储空间的内容。\n为了确保不发生这类错误，所有数组都要牢记创建它们的元素类型，并负责监督仅将类型兼容的引用存储到数组中。\u003c/p\u003e","title":"【Core Java】读书笔记 Part 2"},{"content":"LeetCode Shell 的试题多为文本操作，195. Tenth Line、193. Valid Phone Numbers、192. Word Frequency、194. Transpose File 暂时只有 4 道题，就整合在这一起了\nShell 中文本处理的事情基本 awk sed grep sort uniq tail head 几个命令组合组合就搞定了\n195. Tenth Line 大体意思 How would you print just the 10th line of a file? For example, assume that file.txt has the following content:\nLine 1 Line 2 Line 3 Line 4 Line 5 Line 6 Line 7 Line 8 Line 9 Line 10 Your script should output the tenth line, which is:\nLine 10 打印出文本文件中第 10 行的内容。\n自己的解法 cat file.txt | tail -n +10 | head -n 1 这是学习了：linux 如何显示一个文件的某几行(中间几行) - 香格里拉(^o^)/\n别人的解法 方法一：\nawk \u0026#39;NR==10\u0026#39; file.txt # awk的默认动作就是打印$0，所以NR==10后面可以不用加{print $0} 方法二：\nsed -n \u0026#39;10p\u0026#39; file.txt # 如果不够10行，则什么也不打印 方法三：\nline=$(cat file.txt | wc -l) # 千万注意，等号前后一定不要有空格 if [ \u0026#34;$line\u0026#34; -ge 10 ] ; then # $line的双引号也可以不用加 cat file.txt | head -n 10 | tail -n 1 fi Reference: leetcode-195 Tenth Line - 2\u0026gt; /dev/null\n193. Valid Phone Numbers 大体意思 Given a text file file.txt that contains list of phone numbers (one per line), write a one liner bash script to print all valid phone numbers. You may assume that a valid phone number must appear in one of the following two formats: (xxx) xxx-xxxx or xxx-xxx-xxxx. (x means a digit) You may also assume each line in the text file must not contain leading or trailing white spaces.\nFor example, assume that file.txt has the following content:\n987-123-4567 123 456 7890 (123) 456-7890 Your script should output the following valid phone numbers:\n987-123-4567 (123) 456-7890 匹配有效的电话号码\n自己的解法 cat file.txt | grep \u0026#39;^[0-9]\\{3\\}-[0-9]\\{3\\}-[0-9]\\{4\\}$\\|^([0-9]\\{3\\}) [0-9]\\{3\\}-[0-9]\\{4\\}$\u0026#39; 别人的解法 grep -P \u0026#39;^(\\(\\d{3}\\)|\\d{3}-)\\d{3}-\\d{4}$\u0026#39; file.txt Reference: LeetCode 193: Valid Phone Numbers – Revo\n192. Word Frequency 大体意思 Write a bash script to calculate the frequency of each word in a text file words.txt.\nFor simplicity sake, you may assume:\nwords.txt contains only lowercase characters and space ' ' characters. Each word must consist of lowercase characters only. Words are separated by one or more whitespace characters. For example, assume that words.txt has the following content:\nthe day is sunny the the the sunny is is Your script should output the following, sorted by descending frequency:\nthe 4 is 3 sunny 2 day 1 Note: Don\u0026rsquo;t worry about handling ties, it is guaranteed that each word\u0026rsquo;s frequency count is unique.\n统计单词出现的频次，然后倒序排列\n别人的解法 awk \u0026#39;{i=1;while(i\u0026lt;=NF){print $i;i++}}\u0026#39; words.txt | sort | uniq -c | sort -k1nr | awk \u0026#39;{print $2 \u0026#34; \u0026#34; $1}\u0026#39; 1、利用 awk 默认一行一条记录，默认以空格划分每条记录，NF 为划分的总块数先打印出所有单词 2、排序 + 统计 + 消除重复 3、输出\nReference: LeetCode 192 Word Frequency - wangxiaobupt 的专栏\nawk \u0026#39; { for (i=1; i\u0026lt;=NF; i++) { ++S[$i]; } } END { for (i in S) { print i, S[i] } } \u0026#39; words.txt | sort -nr -k 2 Reference: leetcode/solutions/192.Word_Frequency at master · illuz/leetcode\n194. Transpose File 大体意思 Given a text file file.txt, transpose its content.\nYou may assume that each row has the same number of columns and each field is separated by the ' ' character.\nFor example, if file.txt has the following content:\nname age alice 21 ryan 30 Output the following:\nname alice ryan age 21 30 别人的解法 awk \u0026#39; { for (i = 1; i \u0026lt;= NF; i++) { if(NR == 1) { s[i] = $i; } else { s[i] = s[i] \u0026#34; \u0026#34; $i; } } } END { for (i = 1; s[i] != \u0026#34;\u0026#34;; i++) { print s[i]; } }\u0026#39; file.txt Reference: leetcode/solutions/194.Transpose_File at master · illuz/leetcode\n总结 Shell 中文本处理的事情基本 awk sed grep sort uniq tail head 几个命令组合组合就搞定了，各命令的常用方法之后总结\n","permalink":"https://zyf.im/2016/09/19/leetcode-shell-solutions/","summary":"\u003cp\u003eLeetCode Shell 的试题多为文本操作，\u003ca href=\"https://leetcode.com/problems/tenth-line/\"\u003e195. Tenth Line\u003c/a\u003e、\u003ca href=\"https://leetcode.com/problems/valid-phone-numbers/\"\u003e193. Valid Phone Numbers\u003c/a\u003e、\u003ca href=\"https://leetcode.com/problems/word-frequency/\"\u003e192. Word Frequency\u003c/a\u003e、\u003ca href=\"https://leetcode.com/problems/transpose-file/\"\u003e194. Transpose File\u003c/a\u003e 暂时只有 4 道题，就整合在这一起了\u003c/p\u003e\n\u003cp\u003eShell 中文本处理的事情基本 \u003ccode\u003eawk\u003c/code\u003e \u003ccode\u003esed\u003c/code\u003e \u003ccode\u003egrep\u003c/code\u003e \u003ccode\u003esort\u003c/code\u003e \u003ccode\u003euniq\u003c/code\u003e \u003ccode\u003etail\u003c/code\u003e \u003ccode\u003ehead\u003c/code\u003e 几个命令组合组合就搞定了\u003c/p\u003e\n\u003c!-- more --\u003e\n\u003ch2 id=\"195-tenth-line\"\u003e\u003ca href=\"https://leetcode.com/problems/tenth-line/\"\u003e195. Tenth Line\u003c/a\u003e\u003c/h2\u003e\n\u003ch3 id=\"大体意思\"\u003e大体意思\u003c/h3\u003e\n\u003cp\u003eHow would you print just the 10th line of a file?\nFor example, assume that file.txt has the following content:\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003eLine 1\nLine 2\nLine 3\nLine 4\nLine 5\nLine 6\nLine 7\nLine 8\nLine 9\nLine 10\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eYour script should output the tenth line, which is:\u003c/p\u003e","title":"LeetCode Shell 解题集合"},{"content":"sysv-rc-conf gives an easy to use interface for managing \u0026ldquo;/etc/rc{runlevel}.d/\u0026rdquo; symlinks. The interface comes in two different flavors, one that simply allows turning services on or off and another that allows for more fine tuned management of the symlinks.\n安装 sysv-rc-conf sudo apt-get install sysv-rc-conf 使用 sysv-rc-conf sudo sysv-rc-conf 操作界面十分简洁，你可以用鼠标点击，也可以用键盘方向键定位，用空格键选择，用 Ctrl+n 翻下一页，用 Ctrl+p 翻上一页，用 q 退出。\n相关知识 Ubuntu 运行级别 Linux 系统任何时候都运行在一个指定的运行级上，并且不同的运行级的程序和服务都不同，所要完成的工作和要达到的目的都不同，系统可以在这些运行级之间进行切换，以完成不同的工作。\nUbuntu 的系统运行级别：\n0 停机 1 单用户，Does not configure network interfaces, start daemons, or allow non-root logins 2 多用户，无网络连接 Does not configure network interfaces or start daemons 3 多用户，启动网络连接 Starts the system normally. 4 用户自定义 5 多用户带图形界面 6 重启 查看当前运行级别，执行命令：\nrunlevel runlevel 显示上次的运行级别和当前的运行级别，“N”表示没有上次的运行级别。\n切换运行级别，执行命令：\nint [0123456Ss] 即在 init 命令后跟一个参数，此参数是要切换到的运行级的运行级代号，如：用 init 0 命令关机；用 init 6 命令重新启动。\nls /etc/rc* 对于以 K 开头的文件，系统将终止对应的服务； 对于以 S 开头的文件，系统将启动对应的服务；\nLinux 系统主要启动步骤 1、读取 MBR 的信息，启动 Boot Manager\nWindows 使用 NTLDR 作为 Boot Manager，如果您的系统中安装多个版本的 Windows，您就需要在 NTLDR 中选择您要进入的系统。Linux 通常使用功能强大，配置灵活的 GRUB 作为 Boot Manager。\n2、加载系统内核，启动 init 进程\ninit 进程是 Linux 的根进程，所有的系统进程都是它的子进程。\n3、init 进程读取 /etc/inittab 文件中的信息，并进入预设的运行级别，按顺序运行该运行级别对应文件夹下的脚本。脚本通常以 start 参数启动，并指向一个系统中的程序。通常情况下，/etc/rcS.d/ 目录下的启动脚本首先被执行，然后是 /etc/rcN.d/ 目录。例如您设定的运行级别为 3，那么它对应的启动目录为 /etc/rc3.d/。\n4、根据 /etc/rcS.d/ 文件夹中对应的脚本启动 Xwindow 服务器 xorg Xwindow 为 Linux 下的图形用户界面系统。\n5、启动登录管理器，等待用户登录 Ubuntu 系统默认使用 GDM 作为登录管理器，您在登录管理器界面中输入用户名和密码后，便可以登录系统。\n常见的系统服务 acpi-support 高级电源管理支持 acpid acpi 守护程序。这两个用于电源管理，非常重要 alsa 声音子系统 alsa-utils anacron cron 的子系统，将系统关闭期间的计划任务，在下一次系统运行时执行 apmd acpi 的扩展 atd 类似于 cron 的任务调度系统。建议关闭 binfmt-support 核心支持其他二进制的文件格式。建议开启 bluez-utiles 蓝牙设备支持 bootlogd 启动日志。开启它 cron 任务调度系统，建议开启 cupsys 打印机子系统 dbus 消息总线系统(message bus system)。非常重要 dns-clean 使用拨号连接时，清除 dns 信息 evms 企业卷管理系统(Enterprise Volumn Management system) fetchmail 邮件用户代理守护进程，用于收取邮件 gdm gnome 登录和桌面管理器。 gdomap gpm 终端中的鼠标支持 halt 别动它 hdparm 调整硬盘的脚本，配置文件为 /etc/hdparm.conf hibernate 系统休眠 hotkey-setup 笔记本功能键支持。支持类型包括: HP， Acer， ASUS， Sony，Dell， 和 IBM hotplug and hotplug-net 即插即用支持，比较复杂，建议不要动它 hplip HP 打印机和图形子系统 ifrename 网络接口重命名脚本。如果您有十块网卡，您应该开启它 inetd 在文件 /etc/inetd.conf 中，注释掉所有你不需要的服务。如果该文件不包含任何服务，那关闭它是很安全的 klogd 重要 linux-restricted-modules-common 受限模块支持 /lib/linux-restricted-modules/ 文件夹中的模块为受限模块。例如某些驱动程序，如果您没有使用受限模块，就不需要开启它 lvm 逻辑卷管理系统支持 makedev 创建设备文件，非常重要 mdamd 磁盘阵列 module-init-tools 从/etc/modules 加载扩展模块，建议开启 networking 网络支持。按 /etc/network/interfaces 文件预设激活网络，非常重要 ntpdate 时间同步服务，建议关闭 pcmcia pcmcia 设备支持 powernowd 移动 CPU 节能支持 ppp and ppp-dns 拨号连接 readahead 预加载库文件 reboot 别动它 resolvconf 自动配置 DNS rmnologin 清除 nologin rsync rsync 守护程序 sendsigs 在重启和关机期间发送信号 single 激活单用户模式 ssh ssh 守护程序。建议开启 stop-bootlogd 在 2，3，4，5 运行级别中停止 bootlogd 服务 sudo 检查 sudo 状态。重要 sysklogd 系统日志 udev \u0026amp; udev-mab 用户空间 dev 文件系统(userspace dev filesystem)。重要 umountfs 卸载文件系统 urandom 随机数生成器 usplash 开机画面支持 vbesave 显卡 BIOS 配置工具。保存显卡的状态 xorg-common 设置 X 服务 ICE socket。 adjtimex 调整核心时钟的工具 dirmngr 证书列表管理工具，和 gnupg 一起工作。 hwtools irqs 优化工具 libpam-devperm 系统崩溃之后，用于修理设备文件许可的守护程序。 lm-sensors 板载传感器支持 mdadm-raid 磁盘陈列管理器 screen-cleanup 清除开机屏幕的脚本 xinetd 管理其他守护进程的一个 inetd 超级守护程序 References Ubuntu 下使用 sysv-rc-conf 管理服务 » 冰河的博客 Ubuntu 下使用 sysv-rc-conf 管理服务 - AderStep 启动 - Ubuntu 中文 ","permalink":"https://zyf.im/2016/09/19/manage-startup-program-using-sysv-rc-conf-in-ubuntu/","summary":"\u003cp\u003e\u003ccode\u003esysv-rc-conf\u003c/code\u003e gives an easy to use interface for managing \u0026ldquo;/etc/rc{runlevel}.d/\u0026rdquo; symlinks. The interface comes in two different flavors, one that simply allows turning services on or off and another that allows for more fine tuned management of the symlinks.\u003c/p\u003e\n\u003ch2 id=\"安装-sysv-rc-conf\"\u003e安装 sysv-rc-conf\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo apt-get install sysv-rc-conf\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"使用-sysv-rc-conf\"\u003e使用 sysv-rc-conf\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo sysv-rc-conf\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e操作界面十分简洁，你可以用鼠标点击，也可以用键盘方向键定位，用空格键选择，用 \u003ccode\u003eCtrl+n\u003c/code\u003e 翻下一页，用 \u003ccode\u003eCtrl+p\u003c/code\u003e 翻上一页，用 \u003ccode\u003eq\u003c/code\u003e 退出。\u003c/p\u003e\n\u003c!-- more --\u003e\n\u003ch2 id=\"相关知识\"\u003e相关知识\u003c/h2\u003e\n\u003ch3 id=\"ubuntu-运行级别\"\u003eUbuntu 运行级别\u003c/h3\u003e\n\u003cp\u003eLinux 系统任何时候都运行在一个指定的运行级上，并且不同的运行级的程序和服务都不同，所要完成的工作和要达到的目的都不同，系统可以在这些运行级之间进行切换，以完成不同的工作。\u003c/p\u003e\n\u003cp\u003eUbuntu 的系统运行级别：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e 停机\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e 单用户，Does not configure network interfaces, start daemons, or allow non-root logins\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"m\"\u003e2\u003c/span\u003e 多用户，无网络连接 Does not configure network interfaces or start daemons\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"m\"\u003e3\u003c/span\u003e 多用户，启动网络连接 Starts the system normally.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"m\"\u003e4\u003c/span\u003e 用户自定义\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"m\"\u003e5\u003c/span\u003e 多用户带图形界面\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"m\"\u003e6\u003c/span\u003e 重启\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e查看当前运行级别，执行命令：\u003c/p\u003e","title":"Ubuntu 下使用 sysv-rc-conf 管理开机启动服务"},{"content":"自己总结的比较规范的 Eclipse Java 注释模板\nEclipse Java 注释模板设置 Window -\u0026gt; Preference -\u0026gt; Java -\u0026gt; CodeStyle -\u0026gt; Code Template 然后展开 Comments 节点就是所有需设置注释的元素\n各项注释模板 Files /** * Copyright © ${year}. All rights reserved. * * @Title: ${file_name} * @Prject: ${project_name} * @Package: ${package_name} * @Description: ${todo} * @author: ${user} * @date: ${date} ${time} */ Types /** * * * @ClassName: ${type_name} * @Description: ${todo} * @author: ${user} * @date: ${date} ${time} * ${tags} */ Fields /** * @fieldName: ${field} * @fieldType: ${field_type} * @Description: ${todo} */ Constructors /** * @Title:${enclosing_type} * @Description:${todo} * ${tags} */ Methods /** * * * @Title: ${enclosing_method} * @Description: ${todo} * @author: ${user} * ${tags} * @return: ${return_type} */ Overriding methods /* (no Javadoc) * \u0026lt;p\u0026gt;Title: ${enclosing_method}\u0026lt;/p\u0026gt; * \u0026lt;p\u0026gt;Description: \u0026lt;/p\u0026gt; * ${tags} * ${see_to_overridden} */ 定制 ${user} 显示内容 找到你的 Eclipse 安装路径，打开 eclipse.ini 文件，在 -vmargs 下面添加\n-Duser.name=姓名 + 空格 + 邮箱地址 ","permalink":"https://zyf.im/2016/09/18/eclipse-java-comments-templates/","summary":"\u003cp\u003e自己总结的比较规范的 Eclipse Java 注释模板\u003c/p\u003e\n\u003ch2 id=\"eclipse-java-注释模板设置\"\u003eEclipse Java 注释模板设置\u003c/h2\u003e\n\u003cp\u003eWindow -\u0026gt; Preference -\u0026gt; Java -\u0026gt; CodeStyle -\u0026gt; Code Template 然后展开 Comments 节点就是所有需设置注释的元素\u003c/p\u003e\n\u003c!-- more --\u003e\n\u003ch2 id=\"各项注释模板\"\u003e各项注释模板\u003c/h2\u003e\n\u003ch3 id=\"files\"\u003eFiles\u003c/h3\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e/**\n * Copyright © ${year}. All rights reserved.\n *\n * @Title: ${file_name}\n * @Prject: ${project_name}\n * @Package: ${package_name}\n * @Description: ${todo}\n * @author: ${user}\n * @date: ${date} ${time}\n */\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"types\"\u003eTypes\u003c/h3\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e/**\n *\n *\n * @ClassName: ${type_name}\n * @Description: ${todo}\n * @author: ${user}\n * @date: ${date} ${time}\n * ${tags}\n */\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"fields\"\u003eFields\u003c/h3\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e/**\n * @fieldName: ${field}\n * @fieldType: ${field_type}\n * @Description: ${todo}\n */\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"constructors\"\u003eConstructors\u003c/h3\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e/**\n * @Title:${enclosing_type}\n * @Description:${todo}\n * ${tags}\n */\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"methods\"\u003eMethods\u003c/h3\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e/**\n *\n *\n * @Title: ${enclosing_method}\n * @Description: ${todo}\n * @author: ${user}\n * ${tags}\n * @return: ${return_type}\n */\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"overriding-methods\"\u003eOverriding methods\u003c/h3\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e/* (no Javadoc)\n * \u0026lt;p\u0026gt;Title: ${enclosing_method}\u0026lt;/p\u0026gt;\n * \u0026lt;p\u0026gt;Description: \u0026lt;/p\u0026gt;\n * ${tags}\n * ${see_to_overridden}\n */\n\u003c/code\u003e\u003c/pre\u003e\u003ch2 id=\"定制-user-显示内容\"\u003e定制 ${user} 显示内容\u003c/h2\u003e\n\u003cp\u003e找到你的 Eclipse 安装路径，打开 \u003ccode\u003eeclipse.ini\u003c/code\u003e 文件，在 -vmargs 下面添加\u003c/p\u003e","title":"Eclipse Java 注释模板"},{"content":"最近常在 SQL 中使用到 LIMIT ? ?，在执行 LIMIT 0, 1000 与 LIMIT 100000, 1000 时，查询速度明显有很大的区别，而且随着 LIMIT 的偏移量的增加，查询速度越来越慢。是否有办法对 SQL 中 LIMIT 查询进行优化呢？\nLIMIT 速度慢的原因 LIMIT 100000, 1000 的意思扫描满足条件的 101000 行，扔掉前面的 100000 行，返回最后的 1000 行，问题就在这里。\nLIMIT 优化思路 1、尽可能从索引中直接获取数据，避免或减少直接扫描行数据的频率 2、尽可能减少扫描的记录数，也就是先确定起始的范围，再往后取 N 条记录即可\nLIMIT 优化示例 原始 SQL -- 含条件 SELECT * FROM `t1` WHERE ftype=1 ORDER BY id DESC LIMIT 100, 10; -- 不含 WHERE SELECT * FROM `t1` ORDER BY id DESC LIMIT 100, 10; 子查询优化 SQL -- 采用子查询的方式优化，在子查询里先从索引获取到最大 id，然后倒序排，再取 10 行结果集 -- 注意这里采用了 2 次倒序排，因此在取 LIMIT 的 start 值时，比原来的值加了 10，即 935510，否则结果将和原来的不一致 SELECT * FROM (SELECT * FROM `t1` WHERE id \u0026gt; ( SELECT id FROM `t1` WHERE ftype=1 ORDER BY id DESC LIMIT 935510, 1) LIMIT 10) T ORDER BY id DESC; INNER 优化 SQL -- 采用 INNER JOIN 优化，JOIN 子句里也优先从索引获取 ID 列表，然后直接关联查询获得最终结果，这里不需要加 10 SELECT * FROM `t1` INNER JOIN ( SELECT id FROM `t1` WHERE ftype=1 ORDER BY id DESC LIMIT 935500,10) t2 USING (id); 1、要学着使用 EXPLAIN 对 SQL 进行优化调整 2、推荐使用 INNER 优化 SQL 3、发现了一个 ubuntu 中监控 MySQL 的 mytop 命令，刚刚安装还没细研究\nsudo apt-get install mytop 4、USING (id) 如果两个表的字段名都一样，那么可以用 using(字段名) 来协商条件，效果跟 on a.id = b.id 一样\nReferences MySQL 优化案例系列 — 分页优化 | iMySQL MYSQL 分页 limit 速度太慢优化方法 | Fienda blog \u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2016/09/18/mysql-limit-query-optimization/","summary":"\u003cp\u003e最近常在 SQL 中使用到 \u003ccode\u003eLIMIT ? ?\u003c/code\u003e，在执行 \u003ccode\u003eLIMIT 0, 1000\u003c/code\u003e 与 \u003ccode\u003eLIMIT 100000, 1000\u003c/code\u003e 时，查询速度明显有很大的区别，而且随着 LIMIT 的偏移量的增加，查询速度越来越慢。是否有办法对 SQL 中 LIMIT 查询进行优化呢？\u003c/p\u003e\n\u003c!-- more --\u003e\n\u003ch2 id=\"limit-速度慢的原因\"\u003eLIMIT 速度慢的原因\u003c/h2\u003e\n\u003cp\u003eLIMIT 100000, 1000 的意思扫描满足条件的 101000 行，扔掉前面的 100000 行，返回最后的 1000 行，问题就在这里。\u003c/p\u003e\n\u003ch2 id=\"limit-优化思路\"\u003eLIMIT 优化思路\u003c/h2\u003e\n\u003cp\u003e1、尽可能从索引中直接获取数据，避免或减少直接扫描行数据的频率\n2、尽可能减少扫描的记录数，也就是先确定起始的范围，再往后取 N 条记录即可\u003c/p\u003e\n\u003ch2 id=\"limit-优化示例\"\u003eLIMIT 优化示例\u003c/h2\u003e\n\u003ch3 id=\"原始-sql\"\u003e原始 SQL\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sql\" data-lang=\"sql\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e-- 含条件\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003eSELECT\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eFROM\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"n\"\u003et1\u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eWHERE\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eftype\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eORDER\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eBY\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eid\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eDESC\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eLIMIT\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e100\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e10\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"c1\"\u003e-- 不含 WHERE\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003eSELECT\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eFROM\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"n\"\u003et1\u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eORDER\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eBY\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eid\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eDESC\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eLIMIT\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e100\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e10\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"子查询优化-sql\"\u003e子查询优化 SQL\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sql\" data-lang=\"sql\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e-- 采用子查询的方式优化，在子查询里先从索引获取到最大 id，然后倒序排，再取 10 行结果集\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e-- 注意这里采用了 2 次倒序排，因此在取 LIMIT 的 start 值时，比原来的值加了 10，即 935510，否则结果将和原来的不一致\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003eSELECT\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eFROM\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003eSELECT\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eFROM\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"n\"\u003et1\u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eWHERE\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eid\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eSELECT\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eid\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eFROM\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"n\"\u003et1\u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eWHERE\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eftype\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eORDER\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eBY\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eid\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eDESC\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eLIMIT\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e935510\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"k\"\u003eLIMIT\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e10\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003eORDER\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eBY\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eid\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eDESC\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"inner-优化-sql\"\u003eINNER 优化 SQL\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sql\" data-lang=\"sql\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e-- 采用 INNER JOIN 优化，JOIN 子句里也优先从索引获取 ID 列表，然后直接关联查询获得最终结果，这里不需要加 10\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003eSELECT\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eFROM\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"n\"\u003et1\u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"k\"\u003eINNER\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eJOIN\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eSELECT\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eid\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eFROM\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"n\"\u003et1\u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"k\"\u003eWHERE\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eftype\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eORDER\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eBY\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eid\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eDESC\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eLIMIT\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e935500\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"mi\"\u003e10\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003et2\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"k\"\u003eUSING\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eid\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e1、要学着使用 \u003ccode\u003eEXPLAIN\u003c/code\u003e 对 SQL 进行优化调整\n2、推荐使用 INNER 优化 SQL\n3、发现了一个 ubuntu 中监控 MySQL 的 \u003ccode\u003emytop\u003c/code\u003e 命令，刚刚安装还没细研究\u003c/p\u003e","title":"MySQL LIMIT 查询优化"},{"content":"Windows 下因为 Eclipse 自带了 Maven 插件，还算够用就懒得安装 Maven 了。在不使用代理的情况下，用 Maven 的下载库不是一般的慢。Eclipse Maven 的插件怎么配置国内的镜像库呢？其实很简单。\n创建 settings.xml 文件 注意两个地方： 1、\u0026lt;localRepository\u0026gt;C:\\Users\\Lenovo\\.m2\\repository\u0026lt;/localRepository\u0026gt; 本地仓库位置 2、镜像配置，选取的是 aliyun 的\n\u0026lt;mirrors\u0026gt; \u0026lt;mirror\u0026gt; \u0026lt;id\u0026gt;alimaven\u0026lt;/id\u0026gt; \u0026lt;name\u0026gt;aliyun maven\u0026lt;/name\u0026gt; \u0026lt;url\u0026gt;http://maven.aliyun.com/nexus/content/groups/public/\u0026lt;/url\u0026gt; \u0026lt;mirrorOf\u0026gt;central\u0026lt;/mirrorOf\u0026gt; \u0026lt;/mirror\u0026gt; \u0026lt;/mirrors\u0026gt; 完整的 settings.xml 文件\n\u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;UTF-8\u0026#34;?\u0026gt; \u0026lt;!-- | This is the configuration file for Maven. It can be specified at two levels: | | 1. User Level. This settings.xml file provides configuration for a single user, | and is normally provided in ${user.home}/.m2/settings.xml. | | NOTE: This location can be overridden with the CLI option: | | -s /path/to/user/settings.xml | | 2. Global Level. This settings.xml file provides configuration for all Maven | users on a machine (assuming they\u0026#39;re all using the same Maven | installation). It\u0026#39;s normally provided in | ${maven.home}/conf/settings.xml. | | NOTE: This location can be overridden with the CLI option: | | -gs /path/to/global/settings.xml | | |--\u0026gt; \u0026lt;settings xmlns=\u0026#34;http://maven.apache.org/SETTINGS/1.0.0\u0026#34; xmlns:xsi=\u0026#34;http://www.w3.org/2001/XMLSchema-instance\u0026#34; xsi:schemaLocation=\u0026#34;http://maven.apache.org/SETTINGS/1.0.0 http://maven.apache.org/xsd/settings-1.0.0.xsd\u0026#34;\u0026gt; \u0026lt;!-- Change in below line --\u0026gt; \u0026lt;localRepository\u0026gt;C:\\Users\\Lenovo\\.m2\\repository\u0026lt;/localRepository\u0026gt; \u0026lt;interactiveMode\u0026gt;true\u0026lt;/interactiveMode\u0026gt; \u0026lt;offline\u0026gt;false\u0026lt;/offline\u0026gt; \u0026lt;pluginGroups\u0026gt; \u0026lt;!-- pluginGroup | Specifies a further group identifier to use for plugin lookup. \u0026lt;pluginGroup\u0026gt;com.your.plugins\u0026lt;/pluginGroup\u0026gt; --\u0026gt; \u0026lt;/pluginGroups\u0026gt; \u0026lt;proxies\u0026gt; \u0026lt;!-- \u0026lt;proxy\u0026gt; \u0026lt;id\u0026gt;optional\u0026lt;/id\u0026gt; \u0026lt;active\u0026gt;true\u0026lt;/active\u0026gt; \u0026lt;protocol\u0026gt;http\u0026lt;/protocol\u0026gt; \u0026lt;username\u0026gt;proxyuser\u0026lt;/username\u0026gt; \u0026lt;password\u0026gt;proxypass\u0026lt;/password\u0026gt; \u0026lt;host\u0026gt;proxy.host.net\u0026lt;/host\u0026gt; \u0026lt;port\u0026gt;80\u0026lt;/port\u0026gt; \u0026lt;nonProxyHosts\u0026gt;local.net|some.host.com\u0026lt;/nonProxyHosts\u0026gt; \u0026lt;/proxy\u0026gt; --\u0026gt; \u0026lt;/proxies\u0026gt; \u0026lt;servers\u0026gt; \u0026lt;!-- \u0026lt;server\u0026gt; \u0026lt;id\u0026gt;deploymentRepo\u0026lt;/id\u0026gt; \u0026lt;username\u0026gt;crunchify\u0026lt;/username\u0026gt; \u0026lt;password\u0026gt;crunchify\u0026lt;/password\u0026gt; \u0026lt;/server\u0026gt; --\u0026gt; \u0026lt;/servers\u0026gt; \u0026lt;mirrors\u0026gt; \u0026lt;mirror\u0026gt; \u0026lt;id\u0026gt;alimaven\u0026lt;/id\u0026gt; \u0026lt;name\u0026gt;aliyun maven\u0026lt;/name\u0026gt; \u0026lt;url\u0026gt;http://maven.aliyun.com/nexus/content/groups/public/\u0026lt;/url\u0026gt; \u0026lt;mirrorOf\u0026gt;central\u0026lt;/mirrorOf\u0026gt; \u0026lt;/mirror\u0026gt; \u0026lt;/mirrors\u0026gt; \u0026lt;profiles\u0026gt; \u0026lt;/profiles\u0026gt; \u0026lt;/settings\u0026gt; 设置 Eclipse Maven Plugin Window -\u0026gt; Preferences -\u0026gt; Maven -\u0026gt; User Settings -\u0026gt; User settings Browse 选择上面创建的 setting.xml -\u0026gt; ok\n","permalink":"https://zyf.im/2016/09/14/eclipse-maven-settings-mirror-in-china/","summary":"\u003cp\u003eWindows 下因为 Eclipse 自带了 Maven 插件，还算够用就懒得安装 Maven 了。在不使用代理的情况下，用 Maven 的下载库不是一般的慢。Eclipse Maven 的插件怎么配置国内的镜像库呢？其实很简单。\u003c/p\u003e\n\u003c!-- more --\u003e\n\u003ch2 id=\"创建-settingsxml-文件\"\u003e创建 settings.xml 文件\u003c/h2\u003e\n\u003cp\u003e注意两个地方：\n1、\u003ccode\u003e\u0026lt;localRepository\u0026gt;C:\\Users\\Lenovo\\.m2\\repository\u0026lt;/localRepository\u0026gt;\u003c/code\u003e 本地仓库位置\n2、镜像配置，选取的是 aliyun 的\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-xml\" data-lang=\"xml\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nt\"\u003e\u0026lt;mirrors\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nt\"\u003e\u0026lt;mirror\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nt\"\u003e\u0026lt;id\u0026gt;\u003c/span\u003ealimaven\u003cspan class=\"nt\"\u003e\u0026lt;/id\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nt\"\u003e\u0026lt;name\u0026gt;\u003c/span\u003ealiyun maven\u003cspan class=\"nt\"\u003e\u0026lt;/name\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nt\"\u003e\u0026lt;url\u0026gt;\u003c/span\u003ehttp://maven.aliyun.com/nexus/content/groups/public/\u003cspan class=\"nt\"\u003e\u0026lt;/url\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nt\"\u003e\u0026lt;mirrorOf\u0026gt;\u003c/span\u003ecentral\u003cspan class=\"nt\"\u003e\u0026lt;/mirrorOf\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nt\"\u003e\u0026lt;/mirror\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nt\"\u003e\u0026lt;/mirrors\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e完整的 settings.xml 文件\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-xml\" data-lang=\"xml\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cp\"\u003e\u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;UTF-8\u0026#34;?\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c\"\u003e\u0026lt;!--\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c\"\u003e | This is the configuration file for Maven. It can be specified at two levels:\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c\"\u003e |\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c\"\u003e |  1. User Level. This settings.xml file provides configuration for a single user,\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c\"\u003e |                 and is normally provided in ${user.home}/.m2/settings.xml.\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c\"\u003e |\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c\"\u003e |                 NOTE: This location can be overridden with the CLI option:\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c\"\u003e |\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c\"\u003e |                 -s /path/to/user/settings.xml\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c\"\u003e |\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c\"\u003e |  2. Global Level. This settings.xml file provides configuration for all Maven\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c\"\u003e |                 users on a machine (assuming they\u0026#39;re all using the same Maven\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c\"\u003e |                 installation). It\u0026#39;s normally provided in\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c\"\u003e |                 ${maven.home}/conf/settings.xml.\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c\"\u003e |\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c\"\u003e |                 NOTE: This location can be overridden with the CLI option:\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c\"\u003e |\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c\"\u003e |                 -gs /path/to/global/settings.xml\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c\"\u003e | |\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c\"\u003e |--\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nt\"\u003e\u0026lt;settings\u003c/span\u003e \u003cspan class=\"na\"\u003exmlns=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;http://maven.apache.org/SETTINGS/1.0.0\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e          \u003cspan class=\"na\"\u003exmlns:xsi=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;http://www.w3.org/2001/XMLSchema-instance\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e          \u003cspan class=\"na\"\u003exsi:schemaLocation=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;http://maven.apache.org/SETTINGS/1.0.0 http://maven.apache.org/xsd/settings-1.0.0.xsd\u0026#34;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"c\"\u003e\u0026lt;!--  Change in below line  --\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nt\"\u003e\u0026lt;localRepository\u0026gt;\u003c/span\u003eC:\\Users\\Lenovo\\.m2\\repository\u003cspan class=\"nt\"\u003e\u0026lt;/localRepository\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nt\"\u003e\u0026lt;interactiveMode\u0026gt;\u003c/span\u003etrue\u003cspan class=\"nt\"\u003e\u0026lt;/interactiveMode\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nt\"\u003e\u0026lt;offline\u0026gt;\u003c/span\u003efalse\u003cspan class=\"nt\"\u003e\u0026lt;/offline\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nt\"\u003e\u0026lt;pluginGroups\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c\"\u003e\u0026lt;!-- pluginGroup\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c\"\u003e     | Specifies a further group identifier to use for plugin lookup.\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c\"\u003e    \u0026lt;pluginGroup\u0026gt;com.your.plugins\u0026lt;/pluginGroup\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c\"\u003e    --\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nt\"\u003e\u0026lt;/pluginGroups\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nt\"\u003e\u0026lt;proxies\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c\"\u003e\u0026lt;!--\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c\"\u003e    \u0026lt;proxy\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c\"\u003e      \u0026lt;id\u0026gt;optional\u0026lt;/id\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c\"\u003e      \u0026lt;active\u0026gt;true\u0026lt;/active\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c\"\u003e      \u0026lt;protocol\u0026gt;http\u0026lt;/protocol\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c\"\u003e      \u0026lt;username\u0026gt;proxyuser\u0026lt;/username\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c\"\u003e      \u0026lt;password\u0026gt;proxypass\u0026lt;/password\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c\"\u003e      \u0026lt;host\u0026gt;proxy.host.net\u0026lt;/host\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c\"\u003e      \u0026lt;port\u0026gt;80\u0026lt;/port\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c\"\u003e      \u0026lt;nonProxyHosts\u0026gt;local.net|some.host.com\u0026lt;/nonProxyHosts\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c\"\u003e    \u0026lt;/proxy\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c\"\u003e    --\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nt\"\u003e\u0026lt;/proxies\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nt\"\u003e\u0026lt;servers\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c\"\u003e\u0026lt;!--\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c\"\u003e    \u0026lt;server\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c\"\u003e      \u0026lt;id\u0026gt;deploymentRepo\u0026lt;/id\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c\"\u003e      \u0026lt;username\u0026gt;crunchify\u0026lt;/username\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c\"\u003e      \u0026lt;password\u0026gt;crunchify\u0026lt;/password\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c\"\u003e    \u0026lt;/server\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c\"\u003e \t--\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nt\"\u003e\u0026lt;/servers\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nt\"\u003e\u0026lt;mirrors\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nt\"\u003e\u0026lt;mirror\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nt\"\u003e\u0026lt;id\u0026gt;\u003c/span\u003ealimaven\u003cspan class=\"nt\"\u003e\u0026lt;/id\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nt\"\u003e\u0026lt;name\u0026gt;\u003c/span\u003ealiyun maven\u003cspan class=\"nt\"\u003e\u0026lt;/name\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e     \u003cspan class=\"nt\"\u003e\u0026lt;url\u0026gt;\u003c/span\u003ehttp://maven.aliyun.com/nexus/content/groups/public/\u003cspan class=\"nt\"\u003e\u0026lt;/url\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e     \u003cspan class=\"nt\"\u003e\u0026lt;mirrorOf\u0026gt;\u003c/span\u003ecentral\u003cspan class=\"nt\"\u003e\u0026lt;/mirrorOf\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e     \u003cspan class=\"nt\"\u003e\u0026lt;/mirror\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nt\"\u003e\u0026lt;/mirrors\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nt\"\u003e\u0026lt;profiles\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nt\"\u003e\u0026lt;/profiles\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nt\"\u003e\u0026lt;/settings\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"设置-eclipse-maven-plugin\"\u003e设置 Eclipse Maven Plugin\u003c/h2\u003e\n\u003cp\u003eWindow -\u0026gt; Preferences -\u0026gt; Maven -\u0026gt; User Settings -\u0026gt; User settings Browse 选择上面创建的 \u003ccode\u003esetting.xml\u003c/code\u003e -\u0026gt; ok\u003c/p\u003e","title":"Eclipse Maven 配置使用国内镜像库"},{"content":"262. Trips and Users The Trips table holds all taxi trips. Each trip has a unique Id, while Client_Id and Driver_Id are both foreign keys to the Users_Id at the Users table. Status is an ENUM type of (‘completed’, ‘cancelled_by_driver’, ‘cancelled_by_client’).\n+----+-----------+-----------+---------+--------------------+----------+ | Id | Client_Id | Driver_Id | City_Id | Status |Request_at| +----+-----------+-----------+---------+--------------------+----------+ | 1 | 1 | 10 | 1 | completed |2013-10-01| | 2 | 2 | 11 | 1 | cancelled_by_driver|2013-10-01| | 3 | 3 | 12 | 6 | completed |2013-10-01| | 4 | 4 | 13 | 6 | cancelled_by_client|2013-10-01| | 5 | 1 | 10 | 1 | completed |2013-10-02| | 6 | 2 | 11 | 6 | completed |2013-10-02| | 7 | 3 | 12 | 6 | completed |2013-10-02| | 8 | 2 | 12 | 12 | completed |2013-10-03| | 9 | 3 | 10 | 12 | completed |2013-10-03| | 10 | 4 | 13 | 12 | cancelled_by_driver|2013-10-03| +----+-----------+-----------+---------+--------------------+----------+ The Users table holds all users. Each user has an unique Users_Id, and Role is an ENUM type of (‘client’, ‘driver’, ‘partner’).\n+----------+--------+--------+ | Users_Id | Banned | Role | +----------+--------+--------+ | 1 | No | client | | 2 | Yes | client | | 3 | No | client | | 4 | No | client | | 10 | No | driver | | 11 | No | driver | | 12 | No | driver | | 13 | No | driver | +----------+--------+--------+ Write a SQL query to find the cancellation rate of requests made by unbanned clients between Oct 1, 2013 and Oct 3, 2013. For the above tables, your SQL query should return the following rows with the cancellation rate being rounded to two decimal places.\n+------------+-------------------+ | Day | Cancellation Rate | +------------+-------------------+ | 2013-10-01 | 0.33 | | 2013-10-02 | 0.00 | | 2013-10-03 | 0.50 | +------------+-------------------+ 大体意思 写一个 SQL 语句，查询非禁止客户（Users 表中 Banned 列为 No 的客户）在 2013-10-1 至 2013-10-3 间的单据取消率，结果为四舍五入后的两位有效数字。\n别人的解法 SELECT Request_at DAY, ROUND(SUM(IF(Status = \u0026#39;completed\u0026#39;, 0, 1)) / COUNT(*), 2) \u0026#39;Cancellation Rate\u0026#39; FROM Trips t LEFT JOIN Users t1 ON t.Client_Id = t1.Users_Id WHERE t1.Banned = \u0026#39;No\u0026#39; AND Request_at BETWEEN \u0026#39;2013-10-01\u0026#39; AND \u0026#39;2013-10-03\u0026#39; GROUP BY t.Re quest_at; 这道题主要是统计计算\n笔记： 1、函数：ROUND(column_name,decimals) column_name 必需。要舍入的字段 decimals 必需。规定要返回的小数位数\n2、SUM(IF(Status = 'completed', 0, 1)) 统计 SUM 这里也好巧妙\n3、having 与 where 的区别 having 字句可以让我们筛选成组后的各种数据，where 字句在聚合前先筛选记录，也就是说作用在 group by 和 having 字句前。而 having 子句在聚合后对组记录进行筛选。\nSELECT region, SUM(population), SUM(area) FROM bbc GROUP BY region HAVING SUM(area) \u0026gt; 1000000 在这里，我们不能用 where 来筛选超过 1000000 的地区，因为表中不存在这样一条记录。相反，having 子句可以让我们筛选成组后的各组数据\nReference: LeetCode：Trips and Users - 出租车接单取消率 - Tsybius2014 \u0026gt; mysql 中的 where 和 having 子句的区别 - Hukin\n","permalink":"https://zyf.im/2016/09/14/leetcode-database-trips-and-users-262/","summary":"\u003cp\u003e\u003ca href=\"https://leetcode.com/problems/trips-and-users/\"\u003e262. Trips and Users\u003c/a\u003e\n  The \u003ccode\u003eTrips\u003c/code\u003e table holds all taxi trips. Each trip has a unique Id, while Client_Id and Driver_Id are both foreign keys to the Users_Id at the \u003ccode\u003eUsers\u003c/code\u003e table. Status is an ENUM type of (‘completed’, ‘cancelled_by_driver’, ‘cancelled_by_client’).\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sql\" data-lang=\"sql\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e+\u003c/span\u003e\u003cspan class=\"c1\"\u003e----+-----------+-----------+---------+--------------------+----------+\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eId\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eClient_Id\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eDriver_Id\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eCity_Id\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e        \u003c/span\u003e\u003cspan class=\"n\"\u003eStatus\u003c/span\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"n\"\u003eRequest_at\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"o\"\u003e+\u003c/span\u003e\u003cspan class=\"c1\"\u003e----+-----------+-----------+---------+--------------------+----------+\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e     \u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"w\"\u003e     \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"mi\"\u003e10\u003c/span\u003e\u003cspan class=\"w\"\u003e     \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e     \u003c/span\u003e\u003cspan class=\"n\"\u003ecompleted\u003c/span\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"mi\"\u003e2013\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e10\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e01\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e2\u003c/span\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e     \u003c/span\u003e\u003cspan class=\"mi\"\u003e2\u003c/span\u003e\u003cspan class=\"w\"\u003e     \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"mi\"\u003e11\u003c/span\u003e\u003cspan class=\"w\"\u003e     \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ecancelled_by_driver\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"mi\"\u003e2013\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e10\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e01\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e3\u003c/span\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e     \u003c/span\u003e\u003cspan class=\"mi\"\u003e3\u003c/span\u003e\u003cspan class=\"w\"\u003e     \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"mi\"\u003e12\u003c/span\u003e\u003cspan class=\"w\"\u003e     \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"mi\"\u003e6\u003c/span\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e     \u003c/span\u003e\u003cspan class=\"n\"\u003ecompleted\u003c/span\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"mi\"\u003e2013\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e10\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e01\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e4\u003c/span\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e     \u003c/span\u003e\u003cspan class=\"mi\"\u003e4\u003c/span\u003e\u003cspan class=\"w\"\u003e     \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"mi\"\u003e13\u003c/span\u003e\u003cspan class=\"w\"\u003e     \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"mi\"\u003e6\u003c/span\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ecancelled_by_client\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"mi\"\u003e2013\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e10\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e01\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e5\u003c/span\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e     \u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"w\"\u003e     \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"mi\"\u003e10\u003c/span\u003e\u003cspan class=\"w\"\u003e     \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e     \u003c/span\u003e\u003cspan class=\"n\"\u003ecompleted\u003c/span\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"mi\"\u003e2013\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e10\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e02\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e6\u003c/span\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e     \u003c/span\u003e\u003cspan class=\"mi\"\u003e2\u003c/span\u003e\u003cspan class=\"w\"\u003e     \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"mi\"\u003e11\u003c/span\u003e\u003cspan class=\"w\"\u003e     \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"mi\"\u003e6\u003c/span\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e     \u003c/span\u003e\u003cspan class=\"n\"\u003ecompleted\u003c/span\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"mi\"\u003e2013\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e10\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e02\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e7\u003c/span\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e     \u003c/span\u003e\u003cspan class=\"mi\"\u003e3\u003c/span\u003e\u003cspan class=\"w\"\u003e     \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"mi\"\u003e12\u003c/span\u003e\u003cspan class=\"w\"\u003e     \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"mi\"\u003e6\u003c/span\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e     \u003c/span\u003e\u003cspan class=\"n\"\u003ecompleted\u003c/span\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"mi\"\u003e2013\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e10\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e02\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e8\u003c/span\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e     \u003c/span\u003e\u003cspan class=\"mi\"\u003e2\u003c/span\u003e\u003cspan class=\"w\"\u003e     \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"mi\"\u003e12\u003c/span\u003e\u003cspan class=\"w\"\u003e     \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"mi\"\u003e12\u003c/span\u003e\u003cspan class=\"w\"\u003e   \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e     \u003c/span\u003e\u003cspan class=\"n\"\u003ecompleted\u003c/span\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"mi\"\u003e2013\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e10\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e03\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e9\u003c/span\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e     \u003c/span\u003e\u003cspan class=\"mi\"\u003e3\u003c/span\u003e\u003cspan class=\"w\"\u003e     \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"mi\"\u003e10\u003c/span\u003e\u003cspan class=\"w\"\u003e     \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"mi\"\u003e12\u003c/span\u003e\u003cspan class=\"w\"\u003e   \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e     \u003c/span\u003e\u003cspan class=\"n\"\u003ecompleted\u003c/span\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"mi\"\u003e2013\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e10\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e03\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e10\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e     \u003c/span\u003e\u003cspan class=\"mi\"\u003e4\u003c/span\u003e\u003cspan class=\"w\"\u003e     \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"mi\"\u003e13\u003c/span\u003e\u003cspan class=\"w\"\u003e     \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"mi\"\u003e12\u003c/span\u003e\u003cspan class=\"w\"\u003e   \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ecancelled_by_driver\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"mi\"\u003e2013\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e10\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e03\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"o\"\u003e+\u003c/span\u003e\u003cspan class=\"c1\"\u003e----+-----------+-----------+---------+--------------------+----------+\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e  The \u003ccode\u003eUsers\u003c/code\u003e table holds all users. Each user has an unique Users_Id, and Role is an ENUM type of (‘client’, ‘driver’, ‘partner’).\u003c/p\u003e","title":"LeetCode Database Trips and Users 262"},{"content":"184. Department Highest Salary The Employee table holds all employees. Every employee has an Id, a salary, and there is also a column for the department Id.\n+----+-------+--------+--------------+ | Id | Name | Salary | DepartmentId | +----+-------+--------+--------------+ | 1 | Joe | 70000 | 1 | | 2 | Henry | 80000 | 2 | | 3 | Sam | 60000 | 2 | | 4 | Max | 90000 | 1 | +----+-------+--------+--------------+ The Department table holds all departments of the company.\n+----+----------+ | Id | Name | +----+----------+ | 1 | IT | | 2 | Sales | +----+----------+ Write a SQL query to find employees who have the highest salary in each of the departments. For the above tables, Max has the highest salary in the IT department and Henry has the highest salary in the Sales department.\n+------------+----------+--------+ | Department | Employee | Salary | +------------+----------+--------+ | IT | Max | 90000 | | Sales | Henry | 80000 | +------------+----------+--------+ 大体意思 查询出每一个部门中收入最后的员工的信息\n自己的解法 一开始时自己没有考虑收入最高可能有并列的情况，就直接 MAX()，加 join in 了；同时也要考虑到：所属部门不存在的情况；修改后 SQL 为\nSELECT d.NAME Department, e.NAME Employee, e.Salary FROM Employee e JOIN ( SELECT max( salary ) salary, departmentId FROM Employee GROUP BY departmentId ) m USING ( salary, departmentId ) JOIN Department d ON e.departmentId = d.id 别人的解法 基本都是连表查询的套路，但是有一段总结还是有些意思的。\n1、聚合函数 max() 的效率不如嵌套子查询 2、in 与 exists 效率差不多，当时在网上查的是：\nin 和 not in 也要慎用，否则会导致全表扫描 很多时候用 exists 代替 in 是一个好的选择\n3、将 join on 代替了 where 判断，效率提升很多，后来有个看过 MYSQL 源码的大神说：\n在 MySQL 的 SELECT 查询当中，其核心算法就是 JOIN 查询算法。其他的查询语句都相应向 JOIN 靠拢：单表查询被当作 JOIN 的特例；子查询被尽量转换为 JOIN 查询\n4、将 join 替换为了 straight_join，还是源码大神说的：\n对于多表查询，如果可以确定表按照某一固定次序处理可以获得较好的效率，则建议加上 STRAIGHT_JOIN 子句，以减少优化器对表进行重排序优化的过程。 该子句一方面可以用于优化器无法给出最优排列的 SQL 语句；另一方面同样适用于优化器可以给出最优排列的 SQL 语句，因为 MySQL 算出最优排列也需要耗费较长的流程。 对于后一状况，可以根据 EXPLAIN 的提示选定表的顺序，并加上 STRAIGHT_JOIN 子句固定该顺序。该状况下的使用前提是几个表之间的数据量比例会一直保持在某一顺序，否则在各表数据此消彼长之后会适得其反。\n对于经常调用的 SQL 语句，这一方法效果较好；同时操作的表越多，效果越好。\nReference: leetcode-184-Department Highest Salary 优化记录 - M-zyh\n","permalink":"https://zyf.im/2016/09/12/leetcode-database-department-highest-salary-184/","summary":"\u003cp\u003e\u003ca href=\"https://leetcode.com/problems/department-highest-salary/\"\u003e184. Department Highest Salary\u003c/a\u003e\n  The \u003ccode\u003eEmployee\u003c/code\u003e table holds all employees. Every employee has an Id, a salary, and there is also a column for the department Id.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sql\" data-lang=\"sql\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e+\u003c/span\u003e\u003cspan class=\"c1\"\u003e----+-------+--------+--------------+\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eId\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eName\u003c/span\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eSalary\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eDepartmentId\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"o\"\u003e+\u003c/span\u003e\u003cspan class=\"c1\"\u003e----+-------+--------+--------------+\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eJoe\u003c/span\u003e\u003cspan class=\"w\"\u003e   \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e70000\u003c/span\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"w\"\u003e            \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e2\u003c/span\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eHenry\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e80000\u003c/span\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e2\u003c/span\u003e\u003cspan class=\"w\"\u003e            \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e3\u003c/span\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eSam\u003c/span\u003e\u003cspan class=\"w\"\u003e   \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e60000\u003c/span\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e2\u003c/span\u003e\u003cspan class=\"w\"\u003e            \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e4\u003c/span\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eMax\u003c/span\u003e\u003cspan class=\"w\"\u003e   \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e90000\u003c/span\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"w\"\u003e            \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"o\"\u003e+\u003c/span\u003e\u003cspan class=\"c1\"\u003e----+-------+--------+--------------+\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e  The \u003ccode\u003eDepartment\u003c/code\u003e table holds all departments of the company.\u003c/p\u003e","title":"LeetCode Database Department Highest Salary 184"},{"content":"180. Consecutive Numbers Write a SQL query to find all numbers that appear at least three times consecutively.\n+----+-----+ | Id | Num | +----+-----+ | 1 | 1 | | 2 | 1 | | 3 | 1 | | 4 | 2 | | 5 | 1 | | 6 | 2 | | 7 | 2 | +----+-----+ For example, given the above Logs table, 1 is the only number that appears consecutively for at least three times.\n大体意思 写 SQL 查询出连续出现至少 3 次的 Num\n自己的解法 SELECT DISTINCT L1.Num AS ConsecutiveNums FROM Logs L1 JOIN Logs L2 ON L1.Id + 1 = L2.Id JOIN Logs L3 ON L1.Id + 2 = L3.Id WHERE L1.Num = L2.Num AND L1.Num = L3.Num 很传统连表查询，但是有坑的地方，就是依靠的时 Id，所以局限是 Id 要连贯\n别人的解法 首先，增加一个 rank 字段，记录序号，初始值为 1，当后一个值与前一个值相等时，序号加 1。之后，把所有 rank 值大于等于 3 的都检索出来，再去重即可。\nSELECT DISTINCT(Num) AS ConsecutiveNums FROM (SELECT Id,Num, @Rank:=IF(@prevNum != Num,1,@Rank+1) AS Rank, @prevNum:=Num FROM Logs) t, (SELECT @Rank:=0,@prevNum:=NULL) r WHERE t.Rank \u0026gt;= 3; 自己的理解 (SELECT @Rank:=0,@prevNum:=NULL) r 是个巧妙的地方，对变量进行了初始化\nReference: 【leetcode Database】180. Consecutive Numbers - Kevin_zhai 的博客\n","permalink":"https://zyf.im/2016/09/11/leetcode-database-consecutive-numbers-180/","summary":"\u003cp\u003e\u003ca href=\"https://leetcode.com/problems/consecutive-numbers/\"\u003e180. Consecutive Numbers\u003c/a\u003e\n  Write a SQL query to find all numbers that appear at least three times consecutively.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sql\" data-lang=\"sql\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e+\u003c/span\u003e\u003cspan class=\"c1\"\u003e----+-----+\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eId\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eNum\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"o\"\u003e+\u003c/span\u003e\u003cspan class=\"c1\"\u003e----+-----+\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e2\u003c/span\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e3\u003c/span\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e4\u003c/span\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"mi\"\u003e2\u003c/span\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e5\u003c/span\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e6\u003c/span\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"mi\"\u003e2\u003c/span\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e7\u003c/span\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"mi\"\u003e2\u003c/span\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"o\"\u003e+\u003c/span\u003e\u003cspan class=\"c1\"\u003e----+-----+\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eFor example, given the above \u003ccode\u003eLogs\u003c/code\u003e table, \u003ccode\u003e1\u003c/code\u003e is the only number that appears consecutively for at least three times.\u003c/p\u003e","title":"LeetCode Database Consecutive Numbers 180"},{"content":"176. Second Highest Salary Write a SQL query to get the second highest salary from the Employee table.\n+----+--------+ | Id | Salary | +----+--------+ | 1 | 100 | | 2 | 200 | | 3 | 300 | +----+--------+ For example, given the above Employee table, the second highest salary is 200. If there is no second highest salary, then the query should return null.\n大体意思 写 SQL 查询出第二高薪水的 Id。如何没有第二高，则返回 null\n自己的解法 SELECT Salary FROM Employee ORDER BY Salary DESC LIMIT 1,1 但是在没有第二高的时候将没有返回值，不符合题意；看了别人的，发现自己也少考虑 DISTINCT\n别人的解法 多加一层 SELECT 并添加一个 IF 条件判断。如果结果有 0 行则返回 NULL，有 1 行返回正常结果。由于可以预期上一步结果只有一个，所以这里可以用 COUNT 而不用 GROUP BY。\n构造测试数据：\nCREATE TABLE IF NOT EXISTS Employee ( Id INT, Salary INT ); DELETE FROM Employee; INSERT INTO Employee VALUES (1, 100), (2, 200), (3, 100), (4, 300); 预期结果：\n+---------------------+ | SecondHighestSalary | +---------------------+ | 200 | +---------------------+ 解法一：\nSELECT IF(COUNT(Salary) \u0026gt;= 1, Salary, NULL) AS SecondHighestSalary FROM (SELECT DISTINCT Salary FROM Employee ORDER BY Salary DESC LIMIT 1 , 1) tmp 解法二： 正常 Ranking 类问题解法，使用自定义变量计算排名。接着和上面一种解法类似需要对结果进行处理，没有第 2 名的返回 NULL：\nSELECT IF(COUNT(Salary) \u0026gt;= 1, Salary, NULL) AS SecondHighestSalary FROM (SELECT DISTINCT Salary FROM (SELECT Id, Salary, @rank:=IF(@prevVal \u0026gt; Salary, @rank:=@rank + 1, @rank) AS Rank, @prevVal:=Salary FROM Employee, (SELECT @prevVal:=NULL) x, (SELECT @rank:=1) y ORDER BY Salary DESC) tmp WHERE tmp.Rank = 2) tmp2 解法三： 上面两种解法都是可以扩展到任意排名的，如果想偏一点可以得到其他解法。排名第 2 可以看做是除了 MAX 之外的 MAX，可以得到这两种类似的解法。由于 MAX 函数可以返回 NULL 结果，就不用在进一步加工结果。\nSELECT MAX(Salary) FROM Employee WHERE Salary \u0026lt; (SELECT MAX(Salary) FROM Employee) SELECT MAX(Salary) FROM Employee WHERE Salary NOT IN (SELECT MAX(Salary) FROM Employee) Reference: Leetcode Database: #176 Second Highest Salary | tsuinteru\n","permalink":"https://zyf.im/2016/09/11/leetcode-database-second-highest-salary-176/","summary":"\u003cp\u003e\u003ca href=\"https://leetcode.com/problems/second-highest-salary/\"\u003e176. Second Highest Salary\u003c/a\u003e\n  Write a SQL query to get the second highest salary from the \u003ccode\u003eEmployee\u003c/code\u003e table.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sql\" data-lang=\"sql\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e+\u003c/span\u003e\u003cspan class=\"c1\"\u003e----+--------+\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eId\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eSalary\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"o\"\u003e+\u003c/span\u003e\u003cspan class=\"c1\"\u003e----+--------+\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e100\u003c/span\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e2\u003c/span\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e200\u003c/span\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e3\u003c/span\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e300\u003c/span\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"o\"\u003e+\u003c/span\u003e\u003cspan class=\"c1\"\u003e----+--------+\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eFor example, given the above Employee table, the second highest salary is \u003ccode\u003e200\u003c/code\u003e. If there is no second highest salary, then the query should return \u003ccode\u003enull\u003c/code\u003e.\u003c/p\u003e\n\u003c!-- more --\u003e\n\u003ch3 id=\"大体意思\"\u003e大体意思\u003c/h3\u003e\n\u003cp\u003e写 SQL 查询出第二高薪水的 Id。如何没有第二高，则返回 \u003ccode\u003enull\u003c/code\u003e\u003c/p\u003e","title":"LeetCode Database Second Highest Salary 176"},{"content":"197. Rising Temperature Given a Weather table, write a SQL query to find all dates\u0026rsquo; Ids with higher temperature compared to its previous (yesterday\u0026rsquo;s) dates.\n+---------+------------+------------------+ | Id(INT) | Date(DATE) | Temperature(INT) | +---------+------------+------------------+ | 1 | 2015-01-01 | 10 | | 2 | 2015-01-02 | 25 | | 3 | 2015-01-03 | 20 | | 4 | 2015-01-04 | 30 | +---------+------------+------------------+ For example, return the following Ids for the above Weather table:\n+----+ | Id | +----+ | 2 | | 4 | +----+ 大体意思 写 SQL 查询出温度比昨天大的日期 Id\n别人的解法 The DATEDIFF() function returns the time between two dates\nSELECT w1.Id FROM Weather w1, Weather w2 WHERE w1.Temperature \u0026gt; w2.Temperature AND (DATEDIFF(w1.Date, w2.Date) = 1 ) Reference: LeetCode Q197 Rising Temperature | Lei Jiang Coding\n","permalink":"https://zyf.im/2016/09/11/leetcode-database-rising-temperature-197/","summary":"\u003cp\u003e\u003ca href=\"https://leetcode.com/problems/rising-temperature/\"\u003e197. Rising Temperature\u003c/a\u003e\n  Given a \u003ccode\u003eWeather\u003c/code\u003e table, write a SQL query to find all dates\u0026rsquo; Ids with higher temperature compared to its previous (yesterday\u0026rsquo;s) dates.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sql\" data-lang=\"sql\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e+\u003c/span\u003e\u003cspan class=\"c1\"\u003e---------+------------+------------------+\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eId\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nb\"\u003eINT\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nb\"\u003eDate\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nb\"\u003eDATE\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eTemperature\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nb\"\u003eINT\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"o\"\u003e+\u003c/span\u003e\u003cspan class=\"c1\"\u003e---------+------------+------------------+\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e       \u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e2015\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e01\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e01\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e               \u003c/span\u003e\u003cspan class=\"mi\"\u003e10\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e       \u003c/span\u003e\u003cspan class=\"mi\"\u003e2\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e2015\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e01\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e02\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e               \u003c/span\u003e\u003cspan class=\"mi\"\u003e25\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e       \u003c/span\u003e\u003cspan class=\"mi\"\u003e3\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e2015\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e01\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e03\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e               \u003c/span\u003e\u003cspan class=\"mi\"\u003e20\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e       \u003c/span\u003e\u003cspan class=\"mi\"\u003e4\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e2015\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e01\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e04\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e               \u003c/span\u003e\u003cspan class=\"mi\"\u003e30\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"o\"\u003e+\u003c/span\u003e\u003cspan class=\"c1\"\u003e---------+------------+------------------+\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c!-- more --\u003e\n\u003cp\u003eFor example, return the following Ids for the above Weather table:\u003c/p\u003e","title":"LeetCode Database Rising Temperature 197"},{"content":"MyBatis Generator (MBG) 是一个 Mybatis 的代码生成器。MBG 可以内省数据库的表（或多个表）然后生成可以用来访问（多个）表的基础对象。 这样和数据库表进行交互时不需要创建对象和配置文件。MBG 的解决了对数据库操作有最大影响的一些简单的 CRUD（插入、查询、更新、删除）操作。\nMybatis Generator 文档 Mybatis Generator 官方原版 Mybatis Generator 中文版 通过 Maven 运行 MBG MyBatis Generator (MBG) 包含了一个可以集成到 Maven 构建的 Maven 插件，按照 Maven 的配置惯例，将 MBG 集成到 Maven 很容易。\npom.xml 配置 ... \u0026lt;properties\u0026gt; ... \u0026lt;!-- 设置一些变量 --\u0026gt; \u0026lt;!-- plugin versions --\u0026gt; \u0026lt;plugin.mybatis.generator\u0026gt;1.3.5\u0026lt;/plugin.mybatis.generator\u0026gt; \u0026lt;!-- plugin setting --\u0026gt; \u0026lt;mybatis.generator.generatorConfig.xml\u0026gt;${basedir}/src/test/resources/generatorConfig.xml\u0026lt;/mybatis.generator.generatorConfig.xml\u0026gt; \u0026lt;mybatis.generator.generatorConfig.properties\u0026gt;file:///${basedir}/src/test/resources/generatorConfig.properties\u0026lt;/mybatis.generator.generatorConfig.properties\u0026gt; \u0026lt;/properties\u0026gt; ... \u0026lt;build\u0026gt; ... \u0026lt;plugins\u0026gt; ... \u0026lt;!-- Mybatis generator代码生成插件 配置 --\u0026gt; \u0026lt;plugin\u0026gt; \u0026lt;groupId\u0026gt;org.mybatis.generator\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;mybatis-generator-maven-plugin\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;${plugin.mybatis.generator}\u0026lt;/version\u0026gt; \u0026lt;configuration\u0026gt; \u0026lt;configurationFile\u0026gt;${mybatis.generator.generatorConfig.xml}\u0026lt;/configurationFile\u0026gt; \u0026lt;overwrite\u0026gt;true\u0026lt;/overwrite\u0026gt; \u0026lt;verbose\u0026gt;true\u0026lt;/verbose\u0026gt; \u0026lt;/configuration\u0026gt; \u0026lt;/plugin\u0026gt; \u0026lt;/plugins\u0026gt; \u0026lt;/build\u0026gt; ... generatorConfig.xml 核心配置 非常完整的 MBG 核心配置文件，配合文档效果更佳。因为有大量的注释篇幅长，建议复制到 xml 文件中查看 generatorConfig.xml 的文件位置要对应在 pom.xml 中的：\n\u0026lt;mybatis.generator.generatorConfig.xml\u0026gt;${basedir}/src/test/resources/generatorConfig.xml\u0026lt;/mybatis.generator.generatorConfig.xml\u0026gt; \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;UTF-8\u0026#34;?\u0026gt; \u0026lt;!DOCTYPE generatorConfiguration PUBLIC \u0026#34;-//mybatis.org//DTD MyBatis Generator Configuration 1.0//EN\u0026#34; \u0026#34;http://mybatis.org/dtd/mybatis-generator-config_1_0.dtd\u0026#34;\u0026gt; \u0026lt;!-- 配置生成器 --\u0026gt; \u0026lt;generatorConfiguration\u0026gt; \u0026lt;!-- 可以用于加载配置项或者配置文件，在整个配置文件中就可以使用${propertyKey}的方式来引用配置项 --\u0026gt; \u0026lt;!-- resource：配置资源加载地址，使用resource，MBG从classpath开始找，比如com/myproject/generatorConfig.properties --\u0026gt; \u0026lt;!-- url：配置资源加载地质，使用URL的方式，比如file:///C:/myfolder/generatorConfig.properties. 注意，两个属性只能选址一个; --\u0026gt; \u0026lt;!-- 另外，如果使用了mybatis-generator-maven-plugin，那么在pom.xml中定义的properties都可以直接在generatorConfig.xml中使用 --\u0026gt; \u0026lt;!-- \u0026lt;properties resource=\u0026#34;\u0026#34; url=\u0026#34;\u0026#34; /\u0026gt; --\u0026gt; \u0026lt;!-- 配置文件路径 --\u0026gt; \u0026lt;properties url=\u0026#34;${mybatis.generator.generatorConfig.properties}\u0026#34; /\u0026gt; \u0026lt;!-- 在MBG工作的时候，需要额外加载的依赖包 location属性指明加载jar/zip包的全路径 --\u0026gt; \u0026lt;!-- 数据库访问的驱动包 --\u0026gt; \u0026lt;classPathEntry location=\u0026#34;${mbg.drive.class.path}\u0026#34; /\u0026gt; \u0026lt;!-- context:生成一组对象的环境 id:必选，上下文id，用于在生成错误时提示 --\u0026gt; \u0026lt;!-- defaultModelType:指定生成对象的样式 1，conditional：类似hierarchical; 2，flat：所有内容（主键，blob）等全部生成在一个对象中; 3，hierarchical：主键生成一个XXKey对象(key class)，Blob等单独生成一个对象，其他简单属性在一个对象中(record class) --\u0026gt; \u0026lt;!--targetRuntime: 1，MyBatis3：默认的值，生成基于MyBatis3.x以上版本的内容，包括XXXBySample; 2，MyBatis3Simple：类似MyBatis3，只是不生成XXXBySample; introspectedColumnImpl：类全限定名，用于扩展MBG --\u0026gt; \u0026lt;context id=\u0026#34;mysql_mbg\u0026#34; defaultModelType=\u0026#34;flat\u0026#34; targetRuntime=\u0026#34;MyBatis3Simple\u0026#34;\u0026gt; \u0026lt;!-- 自动识别数据库关键字，默认false，如果设置为true，根据SqlReservedWords中定义的关键字列表; 一般保留默认值，遇到数据库关键字（Java关键字），使用columnOverride覆盖 --\u0026gt; \u0026lt;property name=\u0026#34;autoDelimitKeywords\u0026#34; value=\u0026#34;false\u0026#34; /\u0026gt; \u0026lt;!-- 生成的Java文件的编码 --\u0026gt; \u0026lt;property name=\u0026#34;javaFileEncoding\u0026#34; value=\u0026#34;UTF-8\u0026#34; /\u0026gt; \u0026lt;!-- 格式化java代码 --\u0026gt; \u0026lt;property name=\u0026#34;javaFormatter\u0026#34; value=\u0026#34;org.mybatis.generator.api.dom.DefaultJavaFormatter\u0026#34; /\u0026gt; \u0026lt;!-- 格式化XML代码 --\u0026gt; \u0026lt;property name=\u0026#34;xmlFormatter\u0026#34; value=\u0026#34;org.mybatis.generator.api.dom.DefaultXmlFormatter\u0026#34; /\u0026gt; \u0026lt;!-- beginningDelimiter和endingDelimiter：指明数据库的用于标记数据库对象名的符号，比如ORACLE就是双引号，MYSQL默认是`反引号; --\u0026gt; \u0026lt;property name=\u0026#34;beginningDelimiter\u0026#34; value=\u0026#34;`\u0026#34; /\u0026gt; \u0026lt;property name=\u0026#34;endingDelimiter\u0026#34; value=\u0026#34;`\u0026#34; /\u0026gt; \u0026lt;!--关闭注释 --\u0026gt; \u0026lt;commentGenerator\u0026gt; \u0026lt;property name=\u0026#34;suppressAllComments\u0026#34; value=\u0026#34;true\u0026#34; /\u0026gt; \u0026lt;/commentGenerator\u0026gt; \u0026lt;!-- 必须要有的，使用这个配置链接数据库 @TODO:是否可以扩展 --\u0026gt; \u0026lt;jdbcConnection driverClass=\u0026#34;com.mysql.jdbc.Driver\u0026#34; connectionURL=\u0026#34;${mbg.jdbc.url}\u0026#34; userId=\u0026#34;${mbg.jdbc.username}\u0026#34; password=\u0026#34;${mbg.jdbc.password}\u0026#34;\u0026gt; \u0026lt;!-- 这里面可以设置property属性，每一个property属性都设置到配置的Driver上 --\u0026gt; \u0026lt;/jdbcConnection\u0026gt; \u0026lt;!-- java类型处理器 用于处理DB中的类型到Java中的类型，默认使用JavaTypeResolverDefaultImpl; 注意一点，默认会先尝试使用Integer，Long，Short等来对应DECIMAL和 NUMERIC数据类型; --\u0026gt; \u0026lt;javaTypeResolver type=\u0026#34;org.mybatis.generator.internal.types.JavaTypeResolverDefaultImpl\u0026#34;\u0026gt; \u0026lt;!-- true：使用BigDecimal对应DECIMAL和 NUMERIC数据类型 false：默认, scale\u0026gt;0;length\u0026gt;18：使用BigDecimal; scale=0;length[10,18]：使用Long; scale=0;length[5,9]：使用Integer; scale=0;length\u0026lt;5：使用Short; --\u0026gt; \u0026lt;property name=\u0026#34;forceBigDecimals\u0026#34; value=\u0026#34;false\u0026#34; /\u0026gt; \u0026lt;/javaTypeResolver\u0026gt; \u0026lt;!-- java模型创建器，是必须要的元素 负责：1，key类（见context的defaultModelType）;2，java类;3，查询类 --\u0026gt; \u0026lt;!-- targetPackage：生成的类要放的包，真实的包受enableSubPackages属性控制; --\u0026gt; \u0026lt;!-- targetProject：目标项目，指定一个存在的目录下，生成的内容会放到指定目录中，如果目录不存在，MBG不会自动建目录 --\u0026gt; \u0026lt;javaModelGenerator targetPackage=\u0026#34;${mbg.model.package}\u0026#34; targetProject=\u0026#34;src/test/java\u0026#34;\u0026gt; \u0026lt;!-- for MyBatis3/MyBatis3Simple 自动为每一个生成的类创建一个构造方法，构造方法包含了所有的field;而不是使用setter; --\u0026gt; \u0026lt;property name=\u0026#34;constructorBased\u0026#34; value=\u0026#34;false\u0026#34; /\u0026gt; \u0026lt;!-- 在targetPackage的基础上，根据数据库的schema再生成一层package，最终生成的类放在这个package下，默认为false --\u0026gt; \u0026lt;property name=\u0026#34;enableSubPackages\u0026#34; value=\u0026#34;false\u0026#34; /\u0026gt; \u0026lt;!-- for MyBatis3 / MyBatis3Simple 是否创建一个不可变的类，如果为true， 那么MBG会创建一个没有setter方法的类，取而代之的是类似constructorBased的类 --\u0026gt; \u0026lt;property name=\u0026#34;immutable\u0026#34; value=\u0026#34;false\u0026#34; /\u0026gt; \u0026lt;!-- 设置一个根对象，如果设置了这个根对象，那么生成的keyClass或者recordClass会继承这个类;在Table的rootClass属性中可以覆盖该选项 --\u0026gt; \u0026lt;!-- 注意：如果在key class或者record class中有root class相同的属性，MBG就不会重新生成这些属性了， 包括： 1，属性名相同，类型相同，有相同的getter/setter方法; --\u0026gt; \u0026lt;!-- \u0026lt;property name=\u0026#34;rootClass\u0026#34; value=\u0026#34;com.domain.BaseDomain\u0026#34; /\u0026gt; --\u0026gt; \u0026lt;!-- 设置是否在getter方法中，对String类型字段调用trim()方法 --\u0026gt; \u0026lt;property name=\u0026#34;trimStrings\u0026#34; value=\u0026#34;false\u0026#34; /\u0026gt; \u0026lt;/javaModelGenerator\u0026gt; \u0026lt;!-- 生成SQL map的XML文件生成器，注意，在Mybatis3之后，我们可以使用mapper.xml文件+Mapper接口（或者不用mapper接口）， 或者只使用Mapper接口+Annotation，所以，如果 javaClientGenerator配置中配置了需要生成XML的话，这个元素就必须配置 targetPackage/targetProject:同javaModelGenerator --\u0026gt; \u0026lt;sqlMapGenerator targetPackage=\u0026#34;${mbg.xml.mapper.package}\u0026#34; targetProject=\u0026#34;src/test/java\u0026#34;\u0026gt; \u0026lt;!-- 在targetPackage的基础上，根据数据库的schema再生成一层package，最终生成的类放在这个package下，默认为false --\u0026gt; \u0026lt;property name=\u0026#34;enableSubPackages\u0026#34; value=\u0026#34;false\u0026#34; /\u0026gt; \u0026lt;/sqlMapGenerator\u0026gt; \u0026lt;!-- 对于mybatis来说，即生成Mapper接口，注意，如果没有配置该元素，那么默认不会生成Mapper接口 targetPackage/targetProject:同javaModelGenerator --\u0026gt; \u0026lt;!-- type：选择怎么生成mapper接口（在MyBatis3/MyBatis3Simple下）： --\u0026gt; \u0026lt;!-- 1，ANNOTATEDMAPPER：会生成使用Mapper接口+Annotation的方式创建（SQL生成在annotation中），不会生成对应的XML; --\u0026gt; \u0026lt;!-- 2，MIXEDMAPPER：使用混合配置，会生成Mapper接口，并适当添加合适的Annotation，但是XML会生成在XML中; --\u0026gt; \u0026lt;!-- 3，XMLMAPPER：会生成Mapper接口，接口完全依赖XML; --\u0026gt; \u0026lt;!-- 注意，如果context是MyBatis3Simple：只支持ANNOTATEDMAPPER和XMLMAPPER --\u0026gt; \u0026lt;javaClientGenerator targetPackage=\u0026#34;${mbg.xml.mapper.package}\u0026#34; type=\u0026#34;XMLMAPPER\u0026#34; targetProject=\u0026#34;src/test/java\u0026#34;\u0026gt; \u0026lt;!-- 在targetPackage的基础上，根据数据库的schema再生成一层package，最终生成的类放在这个package下，默认为false --\u0026gt; \u0026lt;property name=\u0026#34;enableSubPackages\u0026#34; value=\u0026#34;false\u0026#34; /\u0026gt; \u0026lt;!-- 可以为所有生成的接口添加一个父接口，但是MBG只负责生成，不负责检查 --\u0026gt; \u0026lt;!-- \u0026lt;property name=\u0026#34;rootInterface\u0026#34; value=\u0026#34;\u0026#34;/\u0026gt; --\u0026gt; \u0026lt;/javaClientGenerator\u0026gt; \u0026lt;!-- 选择一个table来生成相关文件，可以有一个或多个table，必须要有table元素 选择的table会生成一下文件： --\u0026gt; \u0026lt;!-- 1，SQL map文件 2，生成一个主键类; 3，除了BLOB和主键的其他字段的类; 4，包含BLOB的类; 5，一个用户生成动态查询的条件类（selectByExample, deleteByExample），可选; 6，Mapper接口（可选） --\u0026gt; \u0026lt;!-- 必要： --\u0026gt; \u0026lt;!-- tableName ：要生成对象的表名; 注意：大小写敏感问题。正常情况下，MBG会自动的去识别数据库标识符的大小写敏感度，在一般情况下，MBG会 根据设置的schema，catalog或tablename去查询数据表，按照下面的流程： 1，如果schema，catalog或tablename中有空格，那么设置的是什么格式，就精确的使用指定的大小写格式去查询; 2，否则，如果数据库的标识符使用大写的，那么MBG自动把表名变成大写再查找; 3，否则，如果数据库的标识符使用小写的，那么MBG自动把表名变成小写再查找; 4，否则，使用指定的大小写格式查询; 另外的，如果在创建表的时候，使用的\u0026#34;\u0026#34;把数据库对象规定大小写，就算数据库标识符是使用的大写，在这种情况下也会使用给定的大小写来创建表名; 这个时候，请设置delimitIdentifiers=\u0026#34;true\u0026#34;即可保留大小写格式; --\u0026gt; \u0026lt;!-- 可选： --\u0026gt; \u0026lt;!-- 1，schema：数据库的schema; --\u0026gt; \u0026lt;!-- 2，catalog：数据库的catalog; --\u0026gt; \u0026lt;!-- 3，alias：为数据表设置的别名，如果设置了alias，那么生成的所有的SELECT SQL语句中，列名会变成：alias_actualColumnName --\u0026gt; \u0026lt;!-- 4，domainObjectName：生成的domain类的名字，如果不设置，直接使用表名作为domain类的名字;可以设置为somepck.domainName，那么会自动把domainName类再放到somepck包里面; --\u0026gt; \u0026lt;!-- 5，enableInsert（默认true）：指定是否生成insert语句; 6，enableSelectByPrimaryKey（默认true）：指定是否生成按照主键查询对象的语句（就是getById或get）; --\u0026gt; \u0026lt;!-- 7，enableSelectByExample（默认true）：MyBatis3Simple为false，指定是否生成动态查询语句; --\u0026gt; \u0026lt;!-- 8，enableUpdateByPrimaryKey（默认true）：指定是否生成按照主键修改对象的语句（即update); --\u0026gt; \u0026lt;!-- 9，enableDeleteByPrimaryKey（默认true）：指定是否生成按照主键删除对象的语句（即delete）; --\u0026gt; \u0026lt;!-- 10，enableDeleteByExample（默认true）：MyBatis3Simple为false，指定是否生成动态删除语句; --\u0026gt; \u0026lt;!-- 11，enableCountByExample（默认true）：MyBatis3Simple为false，指定是否生成动态查询总条数语句（用于分页的总条数查询）; --\u0026gt; \u0026lt;!-- 12，enableUpdateByExample（默认true）：MyBatis3Simple为false，指定是否生成动态修改语句（只修改对象中不为空的属性）; --\u0026gt; \u0026lt;!-- 13，modelType：参考context元素的defaultModelType，相当于覆盖; --\u0026gt; \u0026lt;!-- 14，delimitIdentifiers：参考tableName的解释，注意，默认的delimitIdentifiers是双引号，如果类似MYSQL这样的数据库，使用的是`（反引号，那么还需要设置context的beginningDelimiter和endingDelimiter属性） --\u0026gt; \u0026lt;!-- 15，delimitAllColumns：设置是否所有生成的SQL中的列名都使用标识符引起来。默认为false，delimitIdentifiers参考context的属性 注意，table里面很多参数都是对javaModelGenerator，context等元素的默认属性的一个复写; --\u0026gt; \u0026lt;table tableName=\u0026#34;test_handbook\u0026#34;\u0026gt; \u0026lt;!-- 参考 javaModelGenerator 的 constructorBased属性 --\u0026gt; \u0026lt;!-- \u0026lt;property name=\u0026#34;constructorBased\u0026#34; value=\u0026#34;false\u0026#34; /\u0026gt; --\u0026gt; \u0026lt;!-- 默认为false，如果设置为true，在生成的SQL中，table名字不会加上catalog或schema; --\u0026gt; \u0026lt;!-- \u0026lt;property name=\u0026#34;ignoreQualifiersAtRuntime\u0026#34; value=\u0026#34;false\u0026#34; /\u0026gt; --\u0026gt; \u0026lt;!-- 参考 javaModelGenerator 的 immutable 属性 --\u0026gt; \u0026lt;!-- \u0026lt;property name=\u0026#34;immutable\u0026#34; value=\u0026#34;false\u0026#34; /\u0026gt; --\u0026gt; \u0026lt;!-- 指定是否只生成domain类，如果设置为true，只生成domain类，如果还配置了sqlMapGenerator，那么在mapper XML文件中，只生成resultMap元素 --\u0026gt; \u0026lt;!-- \u0026lt;property name=\u0026#34;modelOnly\u0026#34; value=\u0026#34;false\u0026#34; /\u0026gt; --\u0026gt; \u0026lt;!-- 参考 javaModelGenerator 的 rootClass 属性 \u0026lt;property name=\u0026#34;rootClass\u0026#34; value=\u0026#34;\u0026#34;/\u0026gt; --\u0026gt; \u0026lt;!-- 参考javaClientGenerator 的 rootInterface 属性 \u0026lt;property name=\u0026#34;rootInterface\u0026#34; value=\u0026#34;\u0026#34;/\u0026gt; --\u0026gt; \u0026lt;!-- 如果设置了runtimeCatalog，那么在生成的SQL中，使用该指定的catalog，而不是table元素上的catalog \u0026lt;property name=\u0026#34;runtimeCatalog\u0026#34; value=\u0026#34;\u0026#34;/\u0026gt; --\u0026gt; \u0026lt;!-- 如果设置了runtimeSchema，那么在生成的SQL中，使用该指定的schema，而不是table元素上的schema \u0026lt;property name=\u0026#34;runtimeSchema\u0026#34; value=\u0026#34;\u0026#34;/\u0026gt; --\u0026gt; \u0026lt;!-- 如果设置了runtimeTableName，那么在生成的SQL中，使用该指定的tablename，而不是table元素上的tablename \u0026lt;property name=\u0026#34;runtimeTableName\u0026#34; value=\u0026#34;\u0026#34;/\u0026gt; --\u0026gt; \u0026lt;!-- 注意，该属性只针对MyBatis3Simple有用; 如果选择的runtime是MyBatis3Simple，那么会生成一个SelectAll方法，如果指定了selectAllOrderByClause，那么会在该SQL中添加指定的这个order条件; --\u0026gt; \u0026lt;!-- \u0026lt;property name=\u0026#34;selectAllOrderByClause\u0026#34; value=\u0026#34;age desc,username asc\u0026#34; /\u0026gt; --\u0026gt; \u0026lt;!-- 如果设置为true，生成的model类会直接使用column本身的名字，而不会再使用驼峰命名方法，比如BORN_DATE，生成的属性名字就是BORN_DATE,而不会是bornDate --\u0026gt; \u0026lt;property name=\u0026#34;useActualColumnNames\u0026#34; value=\u0026#34;true\u0026#34; /\u0026gt; \u0026lt;!-- generatedKey用于生成生成主键的方法 --\u0026gt; \u0026lt;!-- 如果设置了该元素，MBG会在生成的\u0026lt;insert\u0026gt;元素中生成一条正确的\u0026lt;selectKey\u0026gt;元素， --\u0026gt; \u0026lt;!-- 该元素可选 column:主键的列名; sqlStatement：要生成的selectKey语句， --\u0026gt; \u0026lt;!-- 有以下可选项： --\u0026gt; \u0026lt;!-- Cloudscape:相当于selectKey的SQL为： VALUES IDENTITY_VAL_LOCAL() --\u0026gt; \u0026lt;!-- DB2 :相当于selectKey的SQL为： VALUES IDENTITY_VAL_LOCAL() --\u0026gt; \u0026lt;!-- DB2_MF :相当于selectKey的SQL为：SELECT IDENTITY_VAL_LOCAL() FROM SYSIBM.SYSDUMMY1 --\u0026gt; \u0026lt;!-- Derby :相当于selectKey的SQL为：VALUES IDENTITY_VAL_LOCAL() --\u0026gt; \u0026lt;!-- HSQLDB :相当于selectKey的SQL为：CALL IDENTITY() --\u0026gt; \u0026lt;!-- Informix :相当于selectKey的SQL为：select dbinfo(\u0026#39;sqlca.sqlerrd1\u0026#39;) from systables where tabid=1 --\u0026gt; \u0026lt;!-- MySql :相当于selectKey的SQL为：SELECT LAST_INSERT_ID() --\u0026gt; \u0026lt;!-- SqlServer :相当于selectKey的SQL为：SELECT SCOPE_IDENTITY() --\u0026gt; \u0026lt;!-- SYBASE :相当于selectKey的SQL为：SELECT @@IDENTITY --\u0026gt; \u0026lt;!-- JDBC :相当于在生成的insert元素上添加useGeneratedKeys=\u0026#34;true\u0026#34;和keyProperty属性 --\u0026gt; \u0026lt;!-- \u0026lt;generatedKey column=\u0026#34;\u0026#34; sqlStatement=\u0026#34;\u0026#34;/\u0026gt; --\u0026gt; \u0026lt;!-- 该元素会在根据表中列名计算对象属性名之前先重命名列名，非常适合用于表中的列都有公用的前缀字符串的时候， --\u0026gt; \u0026lt;!-- 比如列名为：CUST_ID,CUST_NAME,CUST_EMAIL,CUST_ADDRESS等; --\u0026gt; \u0026lt;!-- 那么就可以设置searchString为\u0026#34;^CUST_\u0026#34;，并使用空白替换，那么生成的Customer对象中的属性名称就不是 custId,custName等，而是先被替换为ID,NAME,EMAIL,然后变成属性：id，name，email; --\u0026gt; \u0026lt;!-- 注意，MBG是使用java.util.regex.Matcher.replaceAll来替换searchString和replaceString的， 如果使用了columnOverride元素，该属性无效; --\u0026gt; \u0026lt;!-- \u0026lt;columnRenamingRule searchString=\u0026#34;\u0026#34; replaceString=\u0026#34;\u0026#34;/\u0026gt; --\u0026gt; \u0026lt;!-- 用来修改表中某个列的属性，MBG会使用修改后的列来生成domain的属性; column:要重新设置的列名; 注意，一个table元素中可以有多个columnOverride元素 --\u0026gt; \u0026lt;!-- \u0026lt;columnOverride column=\u0026#34;username\u0026#34;\u0026gt; --\u0026gt; \u0026lt;!-- 使用property属性来指定列要生成的属性名称 --\u0026gt; \u0026lt;!-- \u0026lt;property name=\u0026#34;property\u0026#34; value=\u0026#34;userName\u0026#34; /\u0026gt; --\u0026gt; \u0026lt;!-- javaType用于指定生成的domain的属性类型，使用类型的全限定名 \u0026lt;property name=\u0026#34;javaType\u0026#34; value=\u0026#34;\u0026#34;/\u0026gt; --\u0026gt; \u0026lt;!-- jdbcType用于指定该列的JDBC类型 \u0026lt;property name=\u0026#34;jdbcType\u0026#34; value=\u0026#34;\u0026#34;/\u0026gt; --\u0026gt; \u0026lt;!-- typeHandler 用于指定该列使用到的TypeHandler，如果要指定，配置类型处理器的全限定名 注意，mybatis中，不会生成到mybatis-config.xml中的typeHandler 只会生成类似：where id = #{id,jdbcType=BIGINT,typeHandler=com._520it.mybatis.MyTypeHandler}的参数描述 \u0026lt;property name=\u0026#34;jdbcType\u0026#34; value=\u0026#34;\u0026#34;/\u0026gt; --\u0026gt; \u0026lt;!-- 参考table元素的delimitAllColumns配置，默认为false \u0026lt;property name=\u0026#34;delimitedColumnName\u0026#34; value=\u0026#34;\u0026#34;/\u0026gt; --\u0026gt; \u0026lt;!-- \u0026lt;/columnOverride\u0026gt; --\u0026gt; \u0026lt;!-- ignoreColumn设置一个MGB忽略的列，如果设置了改列，那么在生成的domain中，生成的SQL中，都不会有该列出现 column:指定要忽略的列的名字; delimitedColumnName：参考table元素的delimitAllColumns配置，默认为false 注意，一个table元素中可以有多个ignoreColumn元素 \u0026lt;ignoreColumn column=\u0026#34;deptId\u0026#34; delimitedColumnName=\u0026#34;\u0026#34;/\u0026gt; --\u0026gt; \u0026lt;/table\u0026gt; \u0026lt;/context\u0026gt; \u0026lt;/generatorConfiguration\u0026gt; 相关的 properties 文件 generatorConfig.properties generatorConfig.properties 要对应在 pom.xml 中的：\n\u0026lt;mybatis.generator.generatorConfig.properties\u0026gt;file:///${basedir}/src/test/resources/generatorConfig.properties\u0026lt;/mybatis.generator.generatorConfig.properties\u0026gt; # 数据库驱动 jar 路径 mbg.drive.class.path=/home/yifan/.m2/repository/mysql/mysql-connector-java/5.1.39/mysql-connector-java-5.1.39.jar # 数据库连接参数 mbg.jdbc.driver=com.mysql.jdbc.Driver mbg.jdbc.url=jdbc:mysql://localhost:3306/test?useUnicode=true\u0026amp;characterEncoding=utf-8 mbg.jdbc.username=root mbg.jdbc.password=root # 包路径配置 mbg.model.package=com.test.demo.mybatis mbg.dao.package=com.test.demo.mybatis mbg.xml.mapper.package=com.test.demo.mybatis 生成代码 方法一：Eclipse Maven 运行 如果是在 Eclipse 中，选择 pom.xml 文件，击右键先择： Run AS \u0026gt; Maven Build… \u0026gt; 在 Goals 框中输入：mybatis-generator:generate 在 Console 中可以看 log\n生成代码 方法二：Shell 运行 如果在命令行输入 Maven 命令即可，注意：一定是当前项目目录下运行该命令：\nmvn mybatis-generator:generate Eclipse Plugin 运行 MGB 详细见：MyBatis Generator - Running MyBatis Generator with Eclipse\n1、如果使用这种方法，将不在依靠 Maven，pox.xml 中的配置将可以省去 2、加载 properties 文件需变化，自己一直没搞清楚 properties 的路径应该怎么写，后来变量就直接写在 generatorConfig.xml 中了。要是有明白的小伙伴，可以在下面留言 3、需要下载 plugin：Help \u0026gt; Eclipse Marketplace\u0026hellip; \u0026gt; Search for \u0026ldquo;MyBatis Generator\u0026rdquo;；这个也是个局限，就是用的人还需要下载 Eclipse plugin，所以推荐上面使用 Maven 的方法\nReferences Mybatis Generator 官方原版 Mybatis Generator 中文版 Mybatis Generator 最完整配置详解 - 简书 用 Maven 插件生成 Mybatis 代码 - 边城刀客的博客 ","permalink":"https://zyf.im/2016/09/10/mybatis-generator-tutorial/","summary":"\u003cp\u003eMyBatis Generator (MBG) 是一个 Mybatis 的代码生成器。MBG 可以内省数据库的表（或多个表）然后生成可以用来访问（多个）表的基础对象。 这样和数据库表进行交互时不需要创建对象和配置文件。MBG 的解决了对数据库操作有最大影响的一些简单的 CRUD（插入、查询、更新、删除）操作。\u003c/p\u003e\n\u003ch2 id=\"mybatis-generator-文档\"\u003eMybatis Generator 文档\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"http://www.mybatis.org/generator/index.html\"\u003eMybatis Generator 官方原版\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"http://mbg.cndocs.tk/index.html\"\u003eMybatis Generator 中文版\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"通过-maven-运行-mbg\"\u003e通过 Maven 运行 MBG\u003c/h2\u003e\n\u003cp\u003eMyBatis Generator (MBG) 包含了一个可以集成到 Maven 构建的 Maven 插件，按照 Maven 的配置惯例，将 MBG 集成到 Maven 很容易。\u003c/p\u003e\n\u003c!-- more --\u003e\n\u003ch3 id=\"pomxml-配置\"\u003e\u003ccode\u003epom.xml\u003c/code\u003e 配置\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-xml\" data-lang=\"xml\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e...\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nt\"\u003e\u0026lt;properties\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  ...\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"c\"\u003e\u0026lt;!-- 设置一些变量 --\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"c\"\u003e\u0026lt;!-- plugin versions --\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nt\"\u003e\u0026lt;plugin.mybatis.generator\u0026gt;\u003c/span\u003e1.3.5\u003cspan class=\"nt\"\u003e\u0026lt;/plugin.mybatis.generator\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"c\"\u003e\u0026lt;!-- plugin setting --\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nt\"\u003e\u0026lt;mybatis.generator.generatorConfig.xml\u0026gt;\u003c/span\u003e${basedir}/src/test/resources/generatorConfig.xml\u003cspan class=\"nt\"\u003e\u0026lt;/mybatis.generator.generatorConfig.xml\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nt\"\u003e\u0026lt;mybatis.generator.generatorConfig.properties\u0026gt;\u003c/span\u003efile:///${basedir}/src/test/resources/generatorConfig.properties\u003cspan class=\"nt\"\u003e\u0026lt;/mybatis.generator.generatorConfig.properties\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nt\"\u003e\u0026lt;/properties\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e...\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nt\"\u003e\u0026lt;build\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  ...\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nt\"\u003e\u0026lt;plugins\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    ...\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c\"\u003e\u0026lt;!-- Mybatis generator代码生成插件 配置 --\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nt\"\u003e\u0026lt;plugin\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      \u003cspan class=\"nt\"\u003e\u0026lt;groupId\u0026gt;\u003c/span\u003eorg.mybatis.generator\u003cspan class=\"nt\"\u003e\u0026lt;/groupId\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      \u003cspan class=\"nt\"\u003e\u0026lt;artifactId\u0026gt;\u003c/span\u003emybatis-generator-maven-plugin\u003cspan class=\"nt\"\u003e\u0026lt;/artifactId\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      \u003cspan class=\"nt\"\u003e\u0026lt;version\u0026gt;\u003c/span\u003e${plugin.mybatis.generator}\u003cspan class=\"nt\"\u003e\u0026lt;/version\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      \u003cspan class=\"nt\"\u003e\u0026lt;configuration\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nt\"\u003e\u0026lt;configurationFile\u0026gt;\u003c/span\u003e${mybatis.generator.generatorConfig.xml}\u003cspan class=\"nt\"\u003e\u0026lt;/configurationFile\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nt\"\u003e\u0026lt;overwrite\u0026gt;\u003c/span\u003etrue\u003cspan class=\"nt\"\u003e\u0026lt;/overwrite\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nt\"\u003e\u0026lt;verbose\u0026gt;\u003c/span\u003etrue\u003cspan class=\"nt\"\u003e\u0026lt;/verbose\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      \u003cspan class=\"nt\"\u003e\u0026lt;/configuration\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nt\"\u003e\u0026lt;/plugin\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nt\"\u003e\u0026lt;/plugins\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nt\"\u003e\u0026lt;/build\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e...\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"generatorconfigxml-核心配置\"\u003e\u003ccode\u003egeneratorConfig.xml\u003c/code\u003e 核心配置\u003c/h3\u003e\n\u003cp\u003e非常完整的 MBG 核心配置文件，配合文档效果更佳。因为有大量的注释篇幅长，建议复制到 xml 文件中查看\ngeneratorConfig.xml 的文件位置要对应在 pom.xml 中的：\u003c/p\u003e","title":"Mybatis Generator 使用配置"},{"content":"本文主要参考了 imooc-SpringMVC 起步 视频教程和 SpringMVC 从入门到精通 系列 - HansonQ ，还有自己的一些总结。\n主要内容：MVC 简介、前端控制器模式、SpringMVC 基本概念、SpringMVC 配置、SpringMVC 中的注解、SpringMVC 数据绑定。\nMVC 简介 1、MVC 是一种架构模式\n程序分层，分工合作，既相互独立，又协同工作，分为三层：模型层、视图层和控制层\n2、MVC 是一种思考方式\nView：视图层，为用户提供 UI，重点关注数据的呈现，为用户提供界面 Model：模型层，业务数据的信息表示，关注支撑业务的信息构成，通常是多个业务实体的组合 Controller：控制层，调用业务逻辑产生合适的数据（Model），传递数据给视图用于呈现 MVC 设计模式在 B/S 下的应用：\n①：浏览器发送请求到控制器(这里要知道控制器的作用) ②：控制器不能处理请求必须交给模型层来处理接着去访问数据库 ③：模型层将处理好的结果返回给控制层 ④：控制层将逻辑视图响应给浏览器(浏览器显示的是渲染过的视图)\nMVC 本质：MVC 的核心思想是业务数据抽取同业务数据呈现相分离；分离有利于程序简化，方便编程\n前端控制器模式 前端控制器模式（Front Controller Pattern）是用来提供一个集中的请求处理机制，所有的请求都将由一个单一的处理程序处理。该处理程序可以做认证/授权/记录日志，或者跟踪请求，然后把请求传给相应的处理程序。\n前端控制器（Front Controller）- 处理应用程序所有类型请求的单个处理程序，应用程序可以是基于 web 的应用程序，也可以是基于桌面的应用程序。 调度器（Dispatcher） - 前端控制器可能使用一个调度器对象来调度请求到相应的具体处理程序。 视图（View） - 视图是为请求而创建的对象。 前端控制器的主要作用：\n指前端控制器将我们的请求分发给我们的控制器去生成业务数据 将生成的业务数据分发给恰当的视图模版来生成最终的视图界面 SpringMVC 基本概念 对组件说明：\nDispatherServlet：前端控制器 用户请求到达前端控制器，相当于 MVC 中的 C，而 DispatherServlet 是整个流程的核心，它来调用其他组件来处理用户的请求，前端控制器的存在降低了其他组件之间的耦合度。 HandlerMapping：处理器映射器 它的作用就好比去看电影要拿着电影票根据电影票上面的座位号找到座位其中座位就是 Handler，电影票以及上面的座位号就是 URL HandlerMapping 负责根据用户请求找到 Handler 即处理器，SpringMVC 提供了不同的映射器实现不同的映射方式，例如：配置文件方式，实现接口方式，注解方式等。 Handler：处理器 Handler 是后端控制器，在前端控制器的控制下后端控制器对具体的用户请求进行处理，Handler 涉及到具体的用户业务请求，所以一般情况下需要程序员根据业务需求开发。 HandlerAdapter：处理器适配器 通过 HandlerAdapter 对处理器进行执行，这是适配器模式的应用，通过适配器可以对更多类型的处理器进行执行。播放的电影是 3D 的你看不清楚，因此电影院跟你说你要想看清电影就必须戴 3D 眼镜。也就是说 Handler 满足一定的要求才可以被执行。 ViewResolver：视图解析器 ViewResolver 负责将处理结果生成 View 视图，ViewResolver 首先根据逻辑视图名解析成物理视图名即具体的页面地址，再生成 View 视图对象，最后对 View 进行渲染将处理结果通过页面展示给用户。 工作原理解释说明： 1、用户发送请求到 SpringMVC 框架提供的 DispatcherServlet 这个前端控制器（了解 struts2 的朋友也都知道其实 struts2 也有一个前端控制器 web.xml 中的 filter 标签就是）。 2、前端控制器会去找处理器映射器（HandlerMapping），处理器映射器根据请求 url 找到具体的处理器，生成处理器对象及处理器拦截器（如果有则生成）一并返回给 DispatcherServlet 。 3、根据处理器映射器返回的处理器，DispatcherServlet 会找“合适”的处理器适配器（HandlerAdapter） 4、处理器适配器 HandlerAdpater 会去执行处理器（Handler 开发的时候会被叫成 Controller 也叫后端控制器在 struts2 中 action 也是一个后端控制器）执行之前会有转换器、数据绑定、校验器等等完成上面这些才会去正在执行 Handler 5、后端控制器 Handler 执行完成之后返回一个 ModelAndView 对象 。 6、处理器适配器 HandlerAdpater 会将这个 ModelAndView 返回前端控制器 DispatcherServlet。前端控制器会将 ModelAndView 对象交给视图解析器 ViewResolver。 7、视图解析器 ViewResolver 解析 ModelAndView 对象之后返回逻辑视图。 8、前端控制器 DispatcherServlet 对逻辑视图进行渲染（数据填充）之后返回真正的物理 View 并响应给浏览器。\nSpringMVC 配置 1、前端控制器需要在 web.xml 中配置\n\u0026lt;!-- 配置前端控制器 --\u0026gt; \u0026lt;servlet\u0026gt; \u0026lt;servlet-name\u0026gt;web-dispatcher\u0026lt;/servlet-name\u0026gt; \u0026lt;servlet-class\u0026gt;org.springframework.web.servlet.DispatcherServlet\u0026lt;/servlet-class\u0026gt; \u0026lt;!--加载前端控制器配置文件 上下文配置位置--\u0026gt; \u0026lt;init-param\u0026gt; \u0026lt;!-- 备注： contextConfigLocation：指定 SpringMVC 配置的加载位置，如果不指定则默认加载 WEB-INF/[DispatcherServlet 的 Servlet 名字]-servlet.xml --\u0026gt; \u0026lt;param-name\u0026gt;contextConfigLocation\u0026lt;/param-name\u0026gt; \u0026lt;param-value\u0026gt;classpath:spring/spring-*.xml\u0026lt;/param-value\u0026gt; \u0026lt;/init-param\u0026gt; \u0026lt;!-- 表示随WEB服务器启动 --\u0026gt; \u0026lt;load-on-startup\u0026gt;1\u0026lt;/load-on-startup\u0026gt; \u0026lt;/servlet\u0026gt; \u0026lt;servlet-mapping\u0026gt; \u0026lt;servlet-name\u0026gt;web-dispatcher\u0026lt;/servlet-name\u0026gt; \u0026lt;!-- 备注：可以拦截三种请求 第一种：拦截固定后缀的url，比如设置为 *.do、*.action， 例如：/user/add.action 此方法最简单,不会导致静态资源（jpg,js,css）被拦截 第二种：拦截所有,设置为/，例如：/user/add /user/add.action此方法可以实现REST风格的url, 很多互联网类型的应用使用这种方式.但是此方法会导致静态文件(jpg,js,css)被拦截后不能正常显示.需要特殊处理 第三种：拦截所有,设置为/*，此设置方法错误,因为请求到Action,当action转到jsp时再次被拦截,提示不能根据jsp路径mapping成功 --\u0026gt; \u0026lt;!-- 默认匹配所有的请求 --\u0026gt; \u0026lt;url-pattern\u0026gt;/\u0026lt;/url-pattern\u0026gt; \u0026lt;/servlet-mapping\u0026gt; 2、在 spring/spring-web.xml 配置视图解析器\n\u0026lt;!-- 配置视图解析器 --\u0026gt; \u0026lt;!-- InternalResourceViewResolver：支持JSP视图解析 --\u0026gt; \u0026lt;!-- viewClass：JstlView 表示JSP模板页面需要使用JSTL标签库，所以classpath中必须包含jstl的相关jar包； --\u0026gt; \u0026lt;!-- prefix 和 suffix：查找视图页面的前缀和后缀，最终视图的址为： --\u0026gt; \u0026lt;!-- 前缀+逻辑视图名+后缀，逻辑视图名需要在controller中返回ModelAndView指定，比如逻辑视图名为hello，--\u0026gt; \u0026lt;!-- 则最终返回的jsp视图地址 \u0026#34;WEB-INF/jsp/hello.jsp\u0026#34; --\u0026gt; \u0026lt;bean class=\u0026#34;org.springframework.web.servlet.view.InternalResourceViewResolver\u0026#34;\u0026gt; \u0026lt;!-- 决定视图类型，如果添加了jstl支持（即有jstl.jar），那么默认就是解析为jstl视图 --\u0026gt; \u0026lt;property name=\u0026#34;viewClass\u0026#34; value=\u0026#34;org.springframework.web.servlet.view.JstlView\u0026#34; /\u0026gt; \u0026lt;!-- 视图前缀 --\u0026gt; \u0026lt;property name=\u0026#34;prefix\u0026#34; value=\u0026#34;/WEB-INF/jsp/\u0026#34; /\u0026gt; \u0026lt;!-- 视图后缀 --\u0026gt; \u0026lt;property name=\u0026#34;suffix\u0026#34; value=\u0026#34;.jsp\u0026#34; /\u0026gt; \u0026lt;/bean\u0026gt; 3、在 spring/spring-web.xml 配置 注解模式\n\u0026lt;!-- 自动加载RequestMappingHandlerMapping和RequestMappingHandlerAdapter， --\u0026gt; \u0026lt;!-- 可用在xml配置文件中使用\u0026lt;mvc:annotation-driven\u0026gt;替代注解处理器和适配器的配置。 --\u0026gt; \u0026lt;mvc:annotation-driven/\u0026gt; 4、在 spring/spring-web.xml 配置 扫描 web 相关的 bean\n\u0026lt;!-- 组件扫描器：可以扫描 @Controller、@Service、@Repository 等等 --\u0026gt; \u0026lt;context:component-scan base-package=\u0026#34;com.controller\u0026#34; /\u0026gt; SpringMVC 中的注解 @Controller @Controller 注解，用于标识这个类是一个后端控制器（类似 struts 中的 action），主要作用就是接受页面的参数，转发页面。 @Controller 源码：\n@Target({ElementType.TYPE}) // 表明只能定义在类上面 @Retention(RetentionPolicy.RUNTIME) //保留策略是RUNTIME，在JVM加载类时，会把注解加载到JVM内存中（它是唯一可以用反射来读取注解的策略） @Documented //@Documented用于描述其它类型的annotation应该被作为被标注的程序成员的公共API，因此可以被例如javadoc此类的工具文档化。Documented是一个标记注解，没有成员。 @Component //spring框架规定当一个类不好归类（service、dao、controller）的时候可以使用这个注解，由此可见即便好归类内部还是使用的@Component注解 public @interface Controller { /** * The value may indicate a suggestion for a logical component name, * to be turned into a Spring bean in case of an autodetected component. * @return the suggested component name, if any */ String value() default \u0026#34;\u0026#34;; } @RequestMapping 这个注解的作用目标就跟 @Controller 不一样了，这个注解可以定义在类上面也可以定义在方法上面。\n/** * 1.@RequestMapping：除了修饰方法,还可以修饰类 * 2.类定义处：提供初步的请求信息映射.相对于WEB应用的根目录(窄化请求) * 3.方法处：提供进一步的细分映射信息。相对于类定义处的URL。 * 若类定义处为标注@RequestMapping,则方法出的URL相对于WEB应用的根目录 */ @Target({ElementType.METHOD, ElementType.TYPE}) @Retention(RetentionPolicy.RUNTIME) @Documented @Mapping public @interface RequestMapping { String[] value() default {}; RequestMethod[] method() default {}; //限制请求方式 String[] params() default {}; //要求请求的URL包含指定的参数 } 代码实例\n@Controller @RequestMapping(\u0026#34;/demo\u0026#34;) public class IndexController { @RequestMapping(value = \u0026#34;/test\u0026#34;, method = RequestMethod.GET) public String index(Model model, HttpServletRequest request) { // 在游览器访问 http://localhost:8080/demo/test 将进入这里 model.addAttribute(\u0026#34;originURL\u0026#34;, \u0026#34;\u0026#34;); model.addAttribute(\u0026#34;controllerName\u0026#34;, \u0026#34;index\u0026#34;); return \u0026#34;index\u0026#34;; } } @RequestMapping 还支持 Ant 方格的请求\n?：匹配文件中的一个字符 *：匹配文件中任意字符 **：**匹配多层路径 /user/*/createUser : 匹配 -/user/aa/createUser 或者 -/user/aa/createUser /user/**/createUser : 匹配 -/user/aa/createUser 或者 -/user/createUser 或者 -/user/aa/cc/createUser /user/createUser?? : 匹配 -/user/aa/createUseraa @PathVariable @PathVariable 这个注解支持现在当下较为流行的 Restful 风格的 URL。 先说说这个注解的作用，支持将 url 中的占位符参数绑定到目标方法的参数上， 该功能也是 SpringMVC 实现 Restful 风格 url 的重要措施。\n代码实例\n// http://localhost:8080/demo/sss @RequestMapping(value = \u0026#34;/{slug:.+}\u0026#34;, method = RequestMethod.GET) public String index2(@PathVariable(\u0026#34;slug\u0026#34;) String slug, Model model) { LOG.info(\u0026#34;DemoController index2 slug \u0026#34; + slug); // common model.addAttribute(\u0026#34;originURL\u0026#34;, \u0026#34;demo/\u0026#34;); model.addAttribute(\u0026#34;controllerName\u0026#34;, \u0026#34;demo\u0026#34;); model.addAttribute(\u0026#34;controllerMethod\u0026#34;, \u0026#34;index2\u0026#34;); model.addAttribute(\u0026#34;slug\u0026#34;, slug); return \u0026#34;demo\u0026#34;; } //slug = sss 我们熟悉的请求应该是 POST 和 GET 请求，这两个请求也是最常用的而实际上 HTTP1.1 请求还有 PUT、DELETE 等 8 种来表名请求的动作。\n在 SpringMVC 中要实现 PUT 和 DELETE 请求需要在 web.xml 额外配置一个过滤器，这个过滤器的作用就是把 POST 请求变为 PUT 和 DELETE 请求。 关于 Restful 的内容计划单独写。\n@RequestParam @Target(ElementType.PARAMETER) @Retention(RetentionPolicy.RUNTIME) @Documented public @interface RequestParam { String value() default \u0026#34;\u0026#34;;//值即为请求参数的参数名 boolean required() default true;//该参数是否是必须。默认值为true String defaultValue() default ValueConstants.DEFAULT_NONE;//请求参数的默认值 } // http://localhost:8080/demo/para?slug=google @RequestMapping(value = \u0026#34;/para\u0026#34;, method = RequestMethod.GET) public String index3(@RequestParam(value = \u0026#34;slug\u0026#34;, defaultValue = \u0026#34;\u0026#34;) String slug, Model model) { model.addAttribute(\u0026#34;originURL\u0026#34;, \u0026#34;demo/\u0026#34;); model.addAttribute(\u0026#34;controllerName\u0026#34;, \u0026#34;demo\u0026#34;); model.addAttribute(\u0026#34;controllerMethod\u0026#34;, \u0026#34;index3\u0026#34;); model.addAttribute(\u0026#34;slug\u0026#34;, slug); return \u0026#34;demo\u0026#34;; } slug = google 另外还有一点要提示一下，参数没有加这个注解也能映射成功，这是应为 SpringMVC 框架支持请求参数和目标方法参数一致的时候可以省略这个注解。\n@ResponseBody /** * Annotation that indicates a method return value should be bound to the web * response body. Supported for annotated handler methods in Servlet environments. * * 这个注解指明一个方法的返回值应该绑定在 web response body 中，在 Servlet 环境中支持注解处理方法 * * \u0026lt;p\u0026gt;As of version 4.0 this annotation can also be added on the type level in * which case it is inherited and does not need to be added on the method level. */ @Target({ElementType.TYPE, ElementType.METHOD}) @Retention(RetentionPolicy.RUNTIME) @Documented public @interface ResponseBody { } 代码\n// http://localhost:8080/demo/json @RequestMapping(value = \u0026#34;/json\u0026#34;, method = RequestMethod.POST) public @ResponseBody Domain index7(HttpServletRequest request, Model model) { LOG.info(\u0026#34;DemoController demo index7\u0026#34;); model.addAttribute(\u0026#34;originURL\u0026#34;, \u0026#34;demo/\u0026#34;); model.addAttribute(\u0026#34;controllerName\u0026#34;, \u0026#34;demo\u0026#34;); model.addAttribute(\u0026#34;controllerMethod\u0026#34;, \u0026#34;index7\u0026#34;); Domain domain = new Domain(); domain.setDomain(\u0026#34;gggoogle.com\u0026#34;); domain.setId(100); return domain; } /* response body { \u0026#34;id\u0026#34;: 100, \u0026#34;domain\u0026#34;: \u0026#34;gggoogle.com\u0026#34; } */ SpringMVC 数据绑定 简单说一下场景： 对于一个注册页面有很多信息譬如：用户名、密码、确认密码、邮箱、手机、兴趣等等。这时候就会想能不能将这些个参数包装在一个对象中（POJO），用这个 POJO 来做目标方法的形参上面。\n可以说的是 SpringMVC 是支持将 POJO 作为目标参数的。当然也是要遵循一些规则的，就是表单的 name 属性值要和 POJO 的属性值要一致。当然了，这样又会有一个新的疑问支不支持级联属性答案是支持的。\npublic class Address { private String city; ... } public class Persion { private String name; private Address address; ... } \u0026lt;form action=\u0026#34;/demo/pojo\u0026#34;\u0026gt; NAME:\u0026lt;input type=\u0026#34;text\u0026#34; name=\u0026#34;name\u0026#34; /\u0026gt; CITY:\u0026lt;input type=\u0026#34;text\u0026#34; name=\u0026#34;address.city\u0026#34; /\u0026gt; \u0026lt;/form\u0026gt; @RequestMapping(value = \u0026#34;/pojo\u0026#34;, method = RequestMethod.POST) public String index4(Persion persion, Model model) { `model.addAttribute(\u0026#34;originURL\u0026#34;, \u0026#34;demo/\u0026#34;); model.addAttribute(\u0026#34;controllerName\u0026#34;, \u0026#34;demo\u0026#34;); model.addAttribute(\u0026#34;controllerMethod\u0026#34;, \u0026#34;index4\u0026#34;); model.addAttribute(\u0026#34;persion\u0026#34;, persion); return \u0026#34;demo\u0026#34;;` } SpringMVC 使用 Servlet API 可以使用 Servlet 原生的 API 作为目标方法的参数。具体支持以下类型：HttpServletRequest、HttpServletResponse、HttpSession、java.security.Principal、Locale、InputStream、OutputStream、Reader、Writer\n// http://localhost:8080/demo/req?slug=facebook @RequestMapping(value = \u0026#34;/req\u0026#34;, method = RequestMethod.GET) public String index5(HttpServletRequest request, Model model) { String slug = request.getParameter(\u0026#34;slug\u0026#34;); model.addAttribute(\u0026#34;originURL\u0026#34;, \u0026#34;demo/\u0026#34;); model.addAttribute(\u0026#34;controllerName\u0026#34;, \u0026#34;demo\u0026#34;); model.addAttribute(\u0026#34;controllerMethod\u0026#34;, \u0026#34;index5\u0026#34;); model.addAttribute(\u0026#34;slug\u0026#34;, slug); return \u0026#34;demo\u0026#34;; } References IMOOC-SpringMVC 起步 SpringMVC 从入门到精通 系列 - HansonQ ","permalink":"https://zyf.im/2016/09/07/springmvc-getting-started-tutorial/","summary":"\u003cp\u003e本文主要参考了 \u003ca href=\"http://www.imooc.com/video/7237\"\u003eimooc-SpringMVC 起步\u003c/a\u003e 视频教程和 \u003ca href=\"http://www.imooc.com/article/3804\"\u003eSpringMVC 从入门到精通 系列 - HansonQ\u003c/a\u003e ，还有自己的一些总结。\u003c/p\u003e\n\u003cp\u003e主要内容：MVC 简介、前端控制器模式、SpringMVC 基本概念、SpringMVC 配置、SpringMVC 中的注解、SpringMVC 数据绑定。\u003c/p\u003e\n\u003c!-- more --\u003e\n\u003ch2 id=\"mvc-简介\"\u003eMVC 简介\u003c/h2\u003e\n\u003cp\u003e1、MVC 是一种架构模式\u003c/p\u003e\n\u003cp\u003e程序分层，分工合作，既相互独立，又协同工作，分为三层：模型层、视图层和控制层\u003c/p\u003e\n\u003cp\u003e2、MVC 是一种思考方式\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eView：视图层，为用户提供 UI，重点关注数据的呈现，为用户提供界面\u003c/li\u003e\n\u003cli\u003eModel：模型层，业务数据的信息表示，关注支撑业务的信息构成，通常是多个业务实体的组合\u003c/li\u003e\n\u003cli\u003eController：控制层，调用业务逻辑产生合适的数据（Model），传递数据给视图用于呈现\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eMVC 设计模式在 B/S 下的应用：\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"160907-springmvc-getting-started-tutorial-mvc\" loading=\"lazy\" src=\"https://user-images.githubusercontent.com/9289792/80199601-1cfdee80-8654-11ea-8328-9d74c174b2bc.gif\"\u003e\u003c/p\u003e\n\u003cp\u003e①：浏览器发送请求到控制器(这里要知道控制器的作用)\n②：控制器不能处理请求必须交给模型层来处理接着去访问数据库\n③：模型层将处理好的结果返回给控制层\n④：控制层将逻辑视图响应给浏览器(浏览器显示的是渲染过的视图)\u003c/p\u003e\n\u003cp\u003eMVC 本质：\u003cstrong\u003eMVC 的核心思想是业务数据抽取同业务数据呈现相分离；分离有利于程序简化，方便编程\u003c/strong\u003e\u003c/p\u003e\n\u003ch2 id=\"前端控制器模式\"\u003e前端控制器模式\u003c/h2\u003e\n\u003cp\u003e前端控制器模式（Front Controller Pattern）是用来提供一个集中的请求处理机制，所有的请求都将由一个单一的处理程序处理。该处理程序可以做认证/授权/记录日志，或者跟踪请求，然后把请求传给相应的处理程序。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e前端控制器（Front Controller）- 处理应用程序所有类型请求的单个处理程序，应用程序可以是基于 web 的应用程序，也可以是基于桌面的应用程序。\u003c/li\u003e\n\u003cli\u003e调度器（Dispatcher） - 前端控制器可能使用一个调度器对象来调度请求到相应的具体处理程序。\u003c/li\u003e\n\u003cli\u003e视图（View） - 视图是为请求而创建的对象。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e前端控制器的主要作用：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e指前端控制器将我们的请求分发给我们的控制器去生成业务数据\u003c/li\u003e\n\u003cli\u003e将生成的业务数据分发给恰当的视图模版来生成最终的视图界面\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cimg alt=\"160907-springmvc-getting-started-tutorial-front-controller\" loading=\"lazy\" src=\"https://user-images.githubusercontent.com/9289792/80201864-63a11800-8657-11ea-91cb-2b2a2f55f6a6.jpg\"\u003e\u003c/p\u003e\n\u003ch2 id=\"springmvc-基本概念\"\u003eSpringMVC 基本概念\u003c/h2\u003e\n\u003cp\u003e\u003cimg alt=\"160907-springmvc-getting-started-tutorial-springmvc01\" loading=\"lazy\" src=\"https://user-images.githubusercontent.com/9289792/80199605-1d968500-8654-11ea-8f05-57d4685934bb.jpg\"\u003e\u003c/p\u003e\n\u003cp\u003e对组件说明：\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eDispatherServlet：前端控制器 用户请求到达前端控制器，相当于 MVC 中的 C，而 DispatherServlet 是整个流程的核心，它来调用其他组件来处理用户的请求，前端控制器的存在降低了其他组件之间的耦合度。\u003c/li\u003e\n\u003cli\u003eHandlerMapping：处理器映射器 它的作用就好比去看电影要拿着电影票根据电影票上面的座位号找到座位其中座位就是 Handler，电影票以及上面的座位号就是 URL HandlerMapping 负责根据用户请求找到 Handler 即处理器，SpringMVC 提供了不同的映射器实现不同的映射方式，例如：配置文件方式，实现接口方式，注解方式等。\u003c/li\u003e\n\u003cli\u003eHandler：处理器 Handler 是后端控制器，在前端控制器的控制下后端控制器对具体的用户请求进行处理，Handler 涉及到具体的用户业务请求，所以一般情况下需要程序员根据业务需求开发。\u003c/li\u003e\n\u003cli\u003eHandlerAdapter：处理器适配器 通过 HandlerAdapter 对处理器进行执行，这是适配器模式的应用，通过适配器可以对更多类型的处理器进行执行。播放的电影是 3D 的你看不清楚，因此电影院跟你说你要想看清电影就必须戴 3D 眼镜。也就是说 Handler 满足一定的要求才可以被执行。\u003c/li\u003e\n\u003cli\u003eViewResolver：视图解析器 ViewResolver 负责将处理结果生成 View 视图，ViewResolver 首先根据逻辑视图名解析成物理视图名即具体的页面地址，再生成 View 视图对象，最后对 View 进行渲染将处理结果通过页面展示给用户。\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e\u003cimg alt=\"160907-springmvc-getting-started-tutorial-springmvc02\" loading=\"lazy\" src=\"https://user-images.githubusercontent.com/9289792/80199609-1d968500-8654-11ea-997b-67a5862bfd25.jpg\"\u003e\u003c/p\u003e","title":"SpringMVC 入门使用"},{"content":"走出校园已经两个月了，因为之前的暑期也没怎么在家待过，大一在中康、大二在腾骏、大三在大为，大四毕业也就是现在，所以也没有什么特别的感觉。可以说，这两个月也做了些事情，学了些东西的。\n从学校毕业，最直接的影响就是自己更加专注于计算机知识，不用再为学业担心。确定了先走技术的道路，也让自己不那么迷茫做什么。工作规律，自己开始读读书，才觉的读书是件有意思的事。也逼着自己常常写点东西，主要是觉的：写东西的时候自己会主动的思考，文笔练着练着也就能进步吧。\n（一）\nDMV 是毕业后自己第一个项目，全栈开发。初版两周上线，后有花了一周多的时间编写了答题记录的功能。其中的收获是：项目框架的搭建和前端入门知识。原来的项目搭建都不是自己做的，也一直觉的是一件很难的事情。也许就是因为没有做过才觉的难，做过之后也觉的不过如此。项目的页面不多，但都是自己一点点写的，HTML JS 原来也就是自己改改，没有完整写过，这次算是一次不错的锻炼。写前端的时候才发现现在的前端真的是日新月异 AngularJS React 好多好多自己都没有听过的东西，也是从 Mengqi 那里了解到了很多。可惜的是自己没有实际的用上这些，如有机会一定尝试。\nDMV 项目流量平平，因为有 Domain 类项目的工作，DMV 的维护就暂时放置了，还是心有不舍的。期间和 John 聊过一次关于产品的事基本总结为：\n产品项目是会有失败的，有流量的项目才有维护的意义。 大型项目只有成功与失败之分，没有中间项，失败将代价很大。 不一定要留住用户。 更小的成本更高的流量，高流量后就可以做很多的事。 （二）\nDomain 信息类项目，使用的架构和 DMV 一致，逻辑更加简单。自己主要做了数据整理，收获是关于 SQL 命令。SQL 就可以直接处理很多的事情。使用了 RMI 做数据同步，用反射写了一段程序，是一次有突破的尝试。 一次看到自己年初的简历，笑了。自己是真敢写，能写个 Hello World 就敢标成了解。从会用到原理，是接下要走的路。\n（三）\n最近在看设计模式和算法的书，一直在做 LeetCode 的题。设计模式没用过，逮到能用机会绝不错过。算法健脑，刚刚开始接触觉的挺有意思，对数据结构也是种了解。\n（四）\n再次参加舍友的婚礼，又个结婚了。大一奶了一口，现在成真。祝福 Lu\u0026amp;Feifei。\n（五）\n来说说程序员那无处安放的创造力\n有了锤子想找钉子是很正常的原始冲动，但我们必须认识到，创造力对于程序员这个职业来讲，是锦上添花的东西。如果你没有强大的工程能力，那么创造力也不过是无本之木。所以扎扎实实的把工程基础打好，这是最根本的。\n在此基础上，我比较推荐程序员采用内外两条线来培养自己。在公司内的项目上采取相对保守的策略，尽力把稳定性做到最好，培养出自己卓越的工程能力；然后在公司外的开源项目和自己的独立项目上，采用一些新的技术、实践一些新的想法、充分发挥自己的创造力，梦想还是要有的，对吧。\n这样做最明显的好处是，你可以了解到新技术和激进方案的优缺点，从而在进行方案选型时，有更多的依据；还有一个职业发展上的好处：如果不是主负责人，公司的项目往往不能代表你的能力；但独立项目却可以作为一个非常好的能力证明出现在你的简历里边。\n你可以是一个身怀绝技的手艺人，在自己家里你尝试各种手法各种风格的个人作品；但当你参与颐和园这种级别的工程时，好好的把自己负责的石头雕成总设计师要求的样子就好 —— 毕竟这个时代一个人已经很难负责整个项目了。这就是我所理解的程序员的工匠精神。\n摘自：程序员到底是一个什么职业？\n（尾）\n现在自己能听见进去一些原来听不去的话了。我不认为自己是被同化了，也许是心中少了些恶意。\n状态不错，继续前进。\n\u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2016/08/31/2016-08-report/","summary":"\u003cp\u003e走出校园已经两个月了，因为之前的暑期也没怎么在家待过，大一在中康、大二在腾骏、大三在大为，大四毕业也就是现在，所以也没有什么特别的感觉。可以说，这两个月也做了些事情，学了些东西的。\u003c/p\u003e\n\u003c!-- more --\u003e\n\u003cp\u003e从学校毕业，最直接的影响就是自己更加专注于计算机知识，不用再为学业担心。确定了先走技术的道路，也让自己不那么迷茫做什么。工作规律，自己开始读读书，才觉的读书是件有意思的事。也逼着自己常常写点东西，主要是觉的：写东西的时候自己会主动的思考，文笔练着练着也就能进步吧。\u003c/p\u003e\n\u003cp\u003e（一）\u003c/p\u003e\n\u003cp\u003eDMV 是毕业后自己第一个项目，全栈开发。初版两周上线，后有花了一周多的时间编写了答题记录的功能。其中的收获是：项目框架的搭建和前端入门知识。原来的项目搭建都不是自己做的，也一直觉的是一件很难的事情。也许就是因为没有做过才觉的难，做过之后也觉的不过如此。项目的页面不多，但都是自己一点点写的，HTML JS 原来也就是自己改改，没有完整写过，这次算是一次不错的锻炼。写前端的时候才发现现在的前端真的是日新月异 AngularJS React 好多好多自己都没有听过的东西，也是从 Mengqi 那里了解到了很多。可惜的是自己没有实际的用上这些，如有机会一定尝试。\u003c/p\u003e\n\u003cp\u003eDMV 项目流量平平，因为有 Domain 类项目的工作，DMV 的维护就暂时放置了，还是心有不舍的。期间和 John 聊过一次关于产品的事基本总结为：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e产品项目是会有失败的，有流量的项目才有维护的意义。\u003c/li\u003e\n\u003cli\u003e大型项目只有成功与失败之分，没有中间项，失败将代价很大。\u003c/li\u003e\n\u003cli\u003e不一定要留住用户。\u003c/li\u003e\n\u003cli\u003e更小的成本更高的流量，高流量后就可以做很多的事。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e（二）\u003c/p\u003e\n\u003cp\u003eDomain 信息类项目，使用的架构和 DMV 一致，逻辑更加简单。自己主要做了数据整理，收获是关于 SQL 命令。SQL 就可以直接处理很多的事情。使用了 RMI 做数据同步，用反射写了一段程序，是一次有突破的尝试。\n一次看到自己年初的简历，笑了。自己是真敢写，能写个 Hello World 就敢标成了解。从会用到原理，是接下要走的路。\u003c/p\u003e\n\u003cp\u003e（三）\u003c/p\u003e\n\u003cp\u003e最近在看设计模式和算法的书，一直在做 LeetCode 的题。设计模式没用过，逮到能用机会绝不错过。算法健脑，刚刚开始接触觉的挺有意思，对数据结构也是种了解。\u003c/p\u003e\n\u003cp\u003e（四）\u003c/p\u003e\n\u003cp\u003e再次参加舍友的婚礼，又个结婚了。大一奶了一口，现在成真。祝福 Lu\u0026amp;Feifei。\u003c/p\u003e\n\u003cp\u003e（五）\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e来说说程序员那无处安放的创造力\u003c/p\u003e\n\u003cp\u003e有了锤子想找钉子是很正常的原始冲动，但我们必须认识到，创造力对于程序员这个职业来讲，是锦上添花的东西。如果你没有强大的工程能力，那么创造力也不过是无本之木。所以扎扎实实的把工程基础打好，这是最根本的。\u003c/p\u003e\n\u003cp\u003e在此基础上，我比较推荐程序员采用内外两条线来培养自己。在公司内的项目上采取相对保守的策略，尽力把稳定性做到最好，培养出自己卓越的工程能力；然后在公司外的开源项目和自己的独立项目上，采用一些新的技术、实践一些新的想法、充分发挥自己的创造力，梦想还是要有的，对吧。\u003c/p\u003e\n\u003cp\u003e这样做最明显的好处是，你可以了解到新技术和激进方案的优缺点，从而在进行方案选型时，有更多的依据；还有一个职业发展上的好处：如果不是主负责人，公司的项目往往不能代表你的能力；但独立项目却可以作为一个非常好的能力证明出现在你的简历里边。\u003c/p\u003e\n\u003cp\u003e你可以是一个身怀绝技的手艺人，在自己家里你尝试各种手法各种风格的个人作品；但当你参与颐和园这种级别的工程时，好好的把自己负责的石头雕成总设计师要求的样子就好 —— 毕竟这个时代一个人已经很难负责整个项目了。这就是我所理解的程序员的工匠精神。\u003c/p\u003e\n\u003cp\u003e摘自：\u003ca href=\"http://mp.weixin.qq.com/s?__biz=MzI5OTI5Njg2Mg==\u0026amp;mid=2247483667\u0026amp;idx=1\u0026amp;sn=d6e5953c7a7835148e3822b919b82416#rd\"\u003e程序员到底是一个什么职业？\u003c/a\u003e\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003e（尾）\u003c/p\u003e\n\u003cp\u003e现在自己能听见进去一些原来听不去的话了。我不认为自己是被同化了，也许是心中少了些恶意。\u003c/p\u003e\n\u003cp\u003e状态不错，继续前进。\u003c/p\u003e\n\u003cp\u003e\u0026ndash; EOF \u0026ndash;\u003c/p\u003e","title":"刚刚毕业的两个月小结"},{"content":"191. Number of 1 Bits Write a function that takes an unsigned integer and returns the number of ’1\u0026rsquo; bits it has (also known as the Hamming weight). For example, the 32-bit integer ’11\u0026rsquo; has binary representation 00000000000000000000000000001011, so the function should return 3.\n大体意思 写一个函数，输入一个无符号整数，返回其中值为 1 的比特位的个数（这个值也被称为数字汉明重量）\n自己的思路 循环判断最后一位是否是 1\npublic int hammingWeight(int n) { int result = 0; while (n != 0) { if ((n \u0026amp; 1) == 1) { result++; } n = n \u0026gt;\u0026gt; 1; } return result; } 在 Submit Solution\nSubmission Result: Time Limit Exceeded Last executed input: 2147483648 (10000000000000000000000000000000) 别人的算法 2147483648 输入超过了 Java 语言中整型的上限\n原来问题就出在输入可能是无符号数字上！当输入为 2147483648 时，Java 会将这个数字判断位 -1，而右移符号 \u0026raquo; 在计算时会保持数字的符号位，即正数右移高位补 0，负数右移高位补 1。使用这种规则进行右移，会导致数字在右移过程中被不断补 1，这样循环永远无法停止！因此，如果输入为负数，也应该保持右移时高位补 0，位运算符 \u0026raquo;\u0026gt; 可以帮助我们解决这个问题。\npublic int hammingWeight(int n) { int counter = 0; while (n != 0) { if (n % 2 != 0) { counter++; } n = n \u0026gt;\u0026gt;\u0026gt; 1; } return counter; } \u0026gt;\u0026gt; 是带符号右移，负数高位补 1，正数补 0 \u0026lt;\u0026lt; 左移不管负数还是正数，在低位永远补 0 \u0026gt;\u0026gt;\u0026gt; 是不带符号右移，不论负数还是正数，高位补 0 引用：LeetCode：Number of 1 Bits-整数的汉明重量-Tsybius2014\n别人的算法 2 资料：Int 型数值存储 资料：原码, 反码, 补码 补码：正数为其本身，负数为取反加一\n// you need to treat n as an unsigned value public int hammingWeight(int n) { long l = Integer.toUnsignedLong(n); int count = 0; for (; l != 0; l = l \u0026gt;\u0026gt; 1) { if ((l \u0026amp; 1) == 1) count ++; } return count; } 所以在 Java 中需要将 int 转换为 unsigned int 的时候，可以将 int 转换到容量更大的 long 中就行了，直接 ((long) x) \u0026amp; 0xffffffffL 或者使用函数 Integer.toUnsignedLong()。\n引用：nekocode/leetcode-solutions-191. Number of 1 Bits\n","permalink":"https://zyf.im/2016/08/31/leetcode-number-of-1-bits-191/","summary":"\u003cp\u003e\u003ca href=\"https://leetcode.com/problems/number-of-1-bits/\"\u003e191. Number of 1 Bits\u003c/a\u003e\n  Write a function that takes an unsigned integer and returns the number of ’1\u0026rsquo; bits it has (also known as the Hamming weight).\n  For example, the 32-bit integer ’11\u0026rsquo; has binary representation \u003ccode\u003e00000000000000000000000000001011\u003c/code\u003e, so the function should return 3.\u003c/p\u003e\n\u003c!-- more --\u003e\n\u003chr\u003e\n\u003ch3 id=\"大体意思\"\u003e大体意思\u003c/h3\u003e\n\u003cp\u003e写一个函数，输入一个无符号整数，返回其中值为 1 的比特位的个数（这个值也被称为数字汉明重量）\u003c/p\u003e\n\u003ch3 id=\"自己的思路\"\u003e自己的思路\u003c/h3\u003e\n\u003cp\u003e循环判断最后一位是否是 \u003ccode\u003e1\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003epublic\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nf\"\u003ehammingWeight\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003en\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eresult\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003ewhile\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003en\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e!=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"k\"\u003eif\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e((\u003c/span\u003e\u003cspan class=\"n\"\u003en\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e==\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e   \u003c/span\u003e\u003cspan class=\"n\"\u003eresult\u003c/span\u003e\u003cspan class=\"o\"\u003e++\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"n\"\u003en\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003en\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u0026gt;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003ereturn\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eresult\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e在 Submit Solution\u003c/p\u003e","title":"LeetCode Number of 1 Bits 191"},{"content":"202. Happy Number Write an algorithm to determine if a number is \u0026ldquo;happy\u0026rdquo;. A happy number is a number defined by the following process: Starting with any positive integer, replace the number by the sum of the squares of its digits, and repeat the process until the number equals 1 (where it will stay), or it loops endlessly in a cycle which does not include 1. Those numbers for which this process ends in 1 are happy numbers.\nExample: 19 is a happy number\n1^2 + 9^2 = 82 8^2 + 2^2 = 68 6^2 + 8^2 = 100 1^2 + 0^2 + 0^2 = 1 大体意思 题目说的是取任意一个正整数，不断各个数位上数字的平方和，若最终收敛为 1，则该数字为happy number，否则程序可能从某个数开始陷入循环。\n自己的思路 关键：通过 / 和 % 取 int 各个位的数字；用 set 判重复\npublic static boolean isHappy(int n) { Set\u0026lt;Integer\u0026gt; result = new HashSet\u0026lt;\u0026gt;(); int newN = 0; do { do { int end = n % 10; n = n / 10; newN += Math.pow(end, 2); } while (n != 0); n = newN; newN = 0; if (result.contains(n)) { return false; } else { if (n == 1) { return true; } else { result.add(n); } } } while (true); } 套路：取各个位数字\ndo { int end = n % 10; n = n / 10; } while (n != 0); ","permalink":"https://zyf.im/2016/08/29/leetcode-happy-number-202/","summary":"\u003cp\u003e\u003ca href=\"https://leetcode.com/problems/happy-number/\"\u003e202. Happy Number\u003c/a\u003e\n  Write an algorithm to determine if a number is \u0026ldquo;happy\u0026rdquo;.\n  A happy number is a number defined by the following process: Starting with any positive integer, replace the number by the sum of the squares of its digits, and repeat the process until the number equals 1 (where it will stay), or it loops endlessly in a cycle which does not include 1. Those numbers for which this process ends in 1 are happy numbers.\u003c/p\u003e","title":"LeetCode Happy Number 202"},{"content":"13. Roman to Integer Given a roman numeral, convert it to an integer. Input is guaranteed to be within the range from 1 to 3999.\nwikipedia-罗马数字\n罗马数字共有 7 个，即 I（1）、V（5）、X（10）、L（50）、C（100）、D（500）和 M（1000）。按照下述的规则可以表示任意正整数。需要注意的是罗马数字中没有“0”，与进位制无关。一般认为罗马数字只用来记数，而不作演算。\n重复数次：一个罗马数字重复几次，就表示这个数的几倍。\n右加左减：\n在较大的罗马数字的右边记上较小的罗马数字，表示大数字加小数字。 在较大的罗马数字的左边记上较小的罗马数字，表示大数字减小数字。 左减的数字有限制，仅限于 I、X、C。比如 45 不可以写成 VL，只能是 XLV 但是，左减时不可跨越一个位值。比如，99 不可以用 IC（100-1）表示，而是用 XCIX（[100-10]+[10-1]）表示。（等同于阿拉伯数字每位数字分别表示。） 左减数字必须为一位，比如 8 写成 VIII，而非 IIX。 右加数字不可连续超过三位，比如 14 写成 XIV，而非 XIIII。（见下方“数码限制”一项。） 加线乘千：\n在罗马数字的上方加上一条横线或者加上下标的 Ⅿ，表示将这个数乘以 1000，即是原数的 1000 倍。 同理，如果上方有两条横线，即是原数的 1000000（1000^{{2}}）倍。 数码限制：\n同一数码最多只能连续出现三次，如 40 不可表示为 XXXX，而要表示为 XL。 例外：由于 IV 是古罗马神话主神朱庇特（即 IVPITER，古罗马字母里没有 J 和 U）的首字，因此有时用 IIII 代替 IV。 自己的解法 做一个数组对照的字典，遵守此条规定：在较大的罗马数字的左边记上较小的罗马数字，表示大数字减小数字。\npublic int romanToInt(String s) { char[] chr = s.toCharArray(); Map\u0026lt;String, Integer\u0026gt; map = new HashMap\u0026lt;\u0026gt;(); map.put(\u0026#34;I\u0026#34;, 1); map.put(\u0026#34;V\u0026#34;, 5); map.put(\u0026#34;X\u0026#34;, 10); map.put(\u0026#34;L\u0026#34;, 50); map.put(\u0026#34;C\u0026#34;, 100); map.put(\u0026#34;D\u0026#34;, 500); map.put(\u0026#34;M\u0026#34;, 1000); int result = 0; for (int i = 0; i \u0026lt; chr.length - 1; i++) { int nowInt = map.get(String.valueOf(chr[i])); int nextInt = map.get(String.valueOf(chr[i + 1])); if (nowInt \u0026lt; nextInt) { result -= nowInt; } else { result += nowInt; } } result += map.get(String.valueOf(chr[chr.length - 1])); return result; } ","permalink":"https://zyf.im/2016/08/25/leetcode-roman-to-integer-13/","summary":"\u003cp\u003e\u003ca href=\"https://leetcode.com/problems/roman-to-integer/\"\u003e13. Roman to Integer\u003c/a\u003e\n  Given a roman numeral, convert it to an integer.\n  Input is guaranteed to be within the range from 1 to 3999.\u003c/p\u003e\n\u003c!-- more --\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ca href=\"https://zh.wikipedia.org/wiki/%E7%BD%97%E9%A9%AC%E6%95%B0%E5%AD%97\"\u003ewikipedia-罗马数字\u003c/a\u003e\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003e罗马数字共有 7 个，即 I（1）、V（5）、X（10）、L（50）、C（100）、D（500）和 M（1000）。按照下述的规则可以表示任意正整数。需要注意的是罗马数字中没有“0”，与进位制无关。一般认为罗马数字只用来记数，而不作演算。\u003c/p\u003e\n\u003cp\u003e重复数次：一个罗马数字重复几次，就表示这个数的几倍。\u003c/p\u003e\n\u003cp\u003e右加左减：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e在较大的罗马数字的右边记上较小的罗马数字，表示大数字加小数字。\u003c/li\u003e\n\u003cli\u003e在较大的罗马数字的左边记上较小的罗马数字，表示大数字减小数字。\u003c/li\u003e\n\u003cli\u003e左减的数字有限制，仅限于 I、X、C。比如 45 不可以写成 VL，只能是 XLV\u003c/li\u003e\n\u003cli\u003e但是，左减时不可跨越一个位值。比如，99 不可以用 IC（100-1）表示，而是用 XCIX（[100-10]+[10-1]）表示。（等同于阿拉伯数字每位数字分别表示。）\u003c/li\u003e\n\u003cli\u003e左减数字必须为一位，比如 8 写成 VIII，而非 IIX。\u003c/li\u003e\n\u003cli\u003e右加数字不可连续超过三位，比如 14 写成 XIV，而非 XIIII。（见下方“数码限制”一项。）\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e加线乘千：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e在罗马数字的上方加上一条横线或者加上下标的 Ⅿ，表示将这个数乘以 1000，即是原数的 1000 倍。\u003c/li\u003e\n\u003cli\u003e同理，如果上方有两条横线，即是原数的 1000000（1000^{{2}}）倍。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e数码限制：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e同一数码最多只能连续出现三次，如 40 不可表示为 XXXX，而要表示为 XL。\u003c/li\u003e\n\u003cli\u003e例外：由于 IV 是古罗马神话主神朱庇特（即 IVPITER，古罗马字母里没有 J 和 U）的首字，因此有时用 IIII 代替 IV。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"自己的解法\"\u003e自己的解法\u003c/h3\u003e\n\u003cp\u003e做一个数组对照的字典，遵守此条规定：在较大的罗马数字的左边记上较小的罗马数字，表示大数字减小数字。\u003c/p\u003e","title":"LeetCode Roman to Integer 13"},{"content":"169. Majority Element\nGiven an array of size n, find the majority element. The majority element is the element that appears more than [ n/2 ] times.\nYou may assume that the array is non-empty and the majority element always exist in the array.\n题目大意 给定一个数组，找这个数组中的主元素，主元素是元素出现次数大于⌊ n/2 ⌋的元素。 假设给定的数组非空，主元素都存在。\n自己的解法 将数组进行排序，根据题意，那么中间的这个数就是 majority element\npublic int majorityElement(int[] nums) { Arrays.sort(nums); return nums[nums.length / 2]; } 别人的解法 【LeetCode-面试算法经典-Java 实现】【169-Majority Element（主元素）】\n用一个标记 cnt 记录某个元素出现的次数，如果后面的元素和它相同就加一，有一个元素和他不相同就减一，当 cnt 小于等于 0 时重新记录新的元素。\npublic int majorityElement(int[] nums) { int main = nums[0]; // 用于记录主元素，假设第一个是主元素 int count = 1; // 用于抵消数的个数 for (int i = 1; i \u0026lt; nums.length; i++) { // 从第二个元素开始到最后一个元素 if (main == nums[i]) { // 如果两个数相同就不能抵消 count++; // 用于抵消的数据加1 } else { if (count \u0026gt; 0) { // 如果不相同，并且有可以抵消的数 count--; // 进行数据抵消 } else { // 如果不相同，并且没有可以抵消的数 main = nums[i]; // 记录最后不可以抵消的数 } } } // 对于数组中可能没有主元素的情况，题中说明存在，此步可以省略。 // count = 0; // for (int a : nums) { // if (a == main) { // count++; // } // } // if (count \u0026gt;= nums.length / 2) { // return main; // } else { // throw new RuntimeException(\u0026#34;No majority element\u0026#34;); // } return main; } ","permalink":"https://zyf.im/2016/08/24/leetcode-majority-element-169/","summary":"\u003cp\u003e\u003ca href=\"https://leetcode.com/problems/majority-element/\"\u003e169. Majority Element\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eGiven an array of size n, find the majority element. The majority element is the element that appears more than [ n/2 ] times.\u003c/p\u003e\n\u003cp\u003eYou may assume that the array is non-empty and the majority element always exist in the array.\u003c/p\u003e\n\u003c!-- more --\u003e\n\u003ch3 id=\"题目大意\"\u003e题目大意\u003c/h3\u003e\n\u003cp\u003e给定一个数组，找这个数组中的主元素，主元素是元素出现次数大于⌊ n/2 ⌋的元素。\n假设给定的数组非空，主元素都存在。\u003c/p\u003e\n\u003ch3 id=\"自己的解法\"\u003e自己的解法\u003c/h3\u003e\n\u003cp\u003e将数组进行排序，根据题意，那么中间的这个数就是 majority element\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003epublic\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nf\"\u003emajorityElement\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"o\"\u003e[]\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003enums\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"n\"\u003eArrays\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003esort\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003enums\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"k\"\u003ereturn\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003enums\u003c/span\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003enums\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003elength\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003e2\u003c/span\u003e\u003cspan class=\"o\"\u003e]\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"别人的解法\"\u003e别人的解法\u003c/h3\u003e\n\u003cp\u003e\u003ca href=\"http://blog.csdn.net/DERRANTCM/article/details/47902549\"\u003e【LeetCode-面试算法经典-Java 实现】【169-Majority Element（主元素）】\u003c/a\u003e\u003c/p\u003e","title":"LeetCode Majority Element 169"},{"content":"387. First Unique Character in a String Given a string, find the first non-repeating character in it and return it\u0026rsquo;s index. If it doesn\u0026rsquo;t exist, return -1. Examples:\ns = \u0026#34;leetcode\u0026#34; return 0. s = \u0026#34;loveleetcode\u0026#34;, return 2. Note: You may assume the string contain only lowercase letters.\n自己的解法 开始觉的遍历 char[] 然后判断在 String 的首位置和末位置，若一样就返回索引。呃，感觉有点偷鸡\npublic int firstUniqChar(String s) { for (int i = 0; i \u0026lt; s.length(); i++) { if (s.indexOf(s.charAt(i)) == s.lastIndexOf(s.charAt(i))) { return i; } } return -1; } 查了下别人的，又是 new int[26]\npublic int firstUniqChar(String s) { int[] count = new int[26]; for (int i = 0; i \u0026lt; s.length(); i++) { count[s.charAt(i) - \u0026#39;a\u0026#39;]++; } for (int i = 0; i \u0026lt; s.length(); i++) { if (count[s.charAt(i) - \u0026#39;a\u0026#39;] == 1) { return i; } } return -1; } 但是在运行时间上，下面的方法更快\n","permalink":"https://zyf.im/2016/08/23/leetcode-first-unique-character-in-a-string-387/","summary":"\u003cp\u003e\u003ca href=\"https://leetcode.com/problems/first-unique-character-in-a-string/\"\u003e387. First Unique Character in a String\u003c/a\u003e\n  Given a string, find the first non-repeating character in it and return it\u0026rsquo;s index. If it doesn\u0026rsquo;t exist, return -1.\n  \u003cstrong\u003eExamples:\u003c/strong\u003e\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003es = \u0026#34;leetcode\u0026#34;\nreturn 0.\n\ns = \u0026#34;loveleetcode\u0026#34;,\nreturn 2.\n\u003c/code\u003e\u003c/pre\u003e\u003c!-- more --\u003e\n\u003cp\u003e  \u003cstrong\u003eNote:\u003c/strong\u003e\n  You may assume the string contain only lowercase letters.\u003c/p\u003e\n\u003ch3 id=\"自己的解法\"\u003e自己的解法\u003c/h3\u003e\n\u003cp\u003e开始觉的遍历 char[] 然后判断在 String 的首位置和末位置，若一样就返回索引。呃，感觉有点偷鸡\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003epublic\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nf\"\u003efirstUniqChar\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eString\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"k\"\u003efor\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003elength\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"o\"\u003e++\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"k\"\u003eif\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eindexOf\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003echarAt\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e==\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003elastIndexOf\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003echarAt\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e)))\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"k\"\u003ereturn\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"k\"\u003ereturn\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e查了下别人的，又是 \u003ccode\u003enew int[26]\u003c/code\u003e\u003c/p\u003e","title":"LeetCode First Unique Character in a String 387"},{"content":"104. Maximum Depth of Binary Tree Given a binary tree, find its maximum depth. The maximum depth is the number of nodes along the longest path from the root node down to the farthest leaf node.\n自己的解法 自己想到应该用递归、为空的返回 0，不为空的返回 1，递归累加；但是有两个点这么判断呢？其实很容易取两数字的 MAX\npublic int maxDepth(TreeNode root) { if (root == null) { return 0; } return 1 + Math.max(maxDepth(root.left), maxDepth(root.right)); } 参考： 104 Maximum Depth of Binary Tree | Data Structure and algorithm analysis\n","permalink":"https://zyf.im/2016/08/23/leetcode-maximum-depth-of-binary-tree-104/","summary":"\u003cp\u003e\u003ca href=\"https://leetcode.com/problems/maximum-depth-of-binary-tree/\"\u003e104. Maximum Depth of Binary Tree\u003c/a\u003e\n  Given a binary tree, find its maximum depth.\n  The maximum depth is the number of nodes along the longest path from the root node down to the farthest leaf node.\u003c/p\u003e\n\u003c!-- more --\u003e\n\u003ch3 id=\"自己的解法\"\u003e自己的解法\u003c/h3\u003e\n\u003cp\u003e自己想到应该用递归、为空的返回 0，不为空的返回 1，递归累加；但是有两个点这么判断呢？其实很容易取两数字的 MAX\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003epublic\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nf\"\u003emaxDepth\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eTreeNode\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eroot\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e     \u003c/span\u003e\u003cspan class=\"k\"\u003eif\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eroot\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e==\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kc\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e        \u003c/span\u003e\u003cspan class=\"k\"\u003ereturn\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"k\"\u003ereturn\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003e1\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e+\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eMath\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003emax\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003emaxDepth\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eroot\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eleft\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003emaxDepth\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eroot\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eright\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e参考：\n\u003ca href=\"https://jingjingshao.gitbooks.io/data-structure-and-algorithm-analysis/content/Tree/104_maximum_depth_of_binary_tree.html\"\u003e104 Maximum Depth of Binary Tree | Data Structure and algorithm analysis\u003c/a\u003e\u003c/p\u003e","title":"LeetCode Maximum Depth of Binary Tree 104"},{"content":" 我们要用多大的代价，才能认清活着的意义？ 于娟，这个风华正茂的女子，拥有留洋经历和博士学位的复旦大学青年教师，在与晚期癌症抗争一年又四个月后，终于撒手人寰。她带走的家人的思念和不舍，给我们留下坚强的力量。\n《此生未完成》这本书是上周末聚会时 Zhen 提到的，上周京东买书就带上了。书里前半探讨作者在生死临界时对生活、工作、名利、家人、朋友的一些看法和思考。这对于刚刚毕业的我来说，确实有些是无法真切体会到的，毕竟经历少。但是在书的字里行间中，仍然可以看到一个（不知道用什么词）的女子。\n（一） 疾病能让人有怎样的疼痛？\n我还是没有哭，不是因为坚强，而是因为痛的想不起来哭，那个时候，只要能用尽全力顶着。如果稍微分神，我就会痛的晕厥。我不想家人看到我的痛苦。\n说来惭愧的一个对比，自己在喝多时有过这样的经历：自己抱着垃圾桶使劲顶着一股劲，要是有人来给自己说话，就会分神似的使劲的呕吐。可这蚀骨之痛要比这疼痛多少倍呢？\n（二） 重要的是当他得知我生病消息后的第一反应，眼神表情乃至电话语气网络留言里端倪尽出，你会觉得世间很多人情世故是那么的让你淡然一笑。\n在遇到大事的时候方显出真正的朋友和所谓的朋友，扬尘散土，洗沙留金。能遇到“大事”的机会不多，遇到的“大事”还能全身而退的机会就更少了。所以觉的自己应该及时去明辨所有的朋友，将真心给最真的，对于其他的就随他去吧。我不可能讨所有人喜欢，也用不着。\n（三） 三十岁之前的努力更多是因为自己有着太多的欲望和执著，从没有“只要活着就好”的简单。名利权情，没有一样是不辛苦的，却没有一样可以带走。\n这是一个作者很重要的一个观点。在现在的我看来，“只要活着就好”的活着，是一种精神上富有的活着，是充满智慧的活着。 就说现在的自己，什么都不曾拥有，或许不用拥有过的名、利，但是其他方面什么都没有，自己一切都是空的，看到好就会有强烈的“欲望”，如果再强烈一点就会有“执著”。在文字中我感受到了作者在精神方面的强大与富有，或许在这之后才能感受到在名、利之外更重要的东西。其实，自己真的很难想通，到底拥有什么自己就可以“苟”了，自己到底想要什么。了解自己真正想要什么真是一幸事。 作者提到的有时间，多多陪陪家人父母、有机会就尽孝，自己是很赞同的。\n（四） 外公反映土豆每次经过，都趴在玻璃上看玻璃窗里的圣诞树、圣诞彩球和姜饼屋。土豆眼神里有点想，但却乖乖看着，并不讨。外公回想说：“那个眼神我想起了卖火柴的小女孩，有时候孩子听话，你却反而会心酸。”\n这文字碰触心灵最柔软的地方。\n（五） 你的妈妈不是懦夫，所以你的人生里，遇到珍贵的人与关键的事，都要积极争取，可以失败，但是不能放弃。我想做一个让儿子骄傲的妈妈，只此一点，无论任何地步，我都不会选择自己走，哪怕，万劫不复的痛。\n（六） 更多人不会明白，我们两个的谈笑深处埋藏着多少不能言表的无声叹息。上一次见面，我和梅两个事多么风华正茂，像展翅云霄的鹰隼，挥着翅膀相约下次的冲天。这次的相逢，是灰头土脸被命运按在尘土里依然微笑的土鸡之间的问候。\n（七） “为啥是我得癌症” 的非学术报告，是书的精华文章。从饮食习惯、睡眠习惯、突击作业、环境问题，分析了对身体不利的因素。突击作业其实就是工作习惯。\n在饮食上常吃不寻常的动物、暴饮暴食、嗜荤如命。\n我们要相信聪明的祖先，几千年的智慧沉淀，才最终锁定了我们现在的食材，并在远古对他们进行豢养。如果孔雀比鸡好吃，那么现在的就是孔雀，孔雀就是鸡。\n在睡眠习惯上：\n二十三时至次日三时，是肝脏活动能力最强的时段，也是肝脏最佳的排毒时期，如果肝脏功能得不到休息，会引起肝脏血流相对不足，已受损的肝细胞难以修复并加剧恶化。所以“长期熬夜等于慢性自杀”的说法并不夸张。因此医生建议人们从二十三时左右开始上床睡觉，次日一至三时进入深睡眠状态，好好地养足肝血。\n突击作业：\n一辆平时就跌跌撞撞一直不维修的破车，一踩油门就彻夜地疯跑疯开半个月。一年搞个五六次，就是钢筋铁打的汽车，开个二十几年也到报废了。\n环境问题，空气污染、水污染和食品安全危机还有那可怕的甲醛家具。\n（八） 不去想控制大局小局，不想去多管闲事淡事，我不在有对手，不再有敌人，我也不在关心谁比谁强，课题也好，任务也罢，暂且放着。\n也许只有正在想明白的人，才懂的世间的一切，隔岸看花、风淡云轻。\n","permalink":"https://zyf.im/2016/08/22/being-alive-is-a-gift-reading-notes/","summary":"\u003cblockquote\u003e\n\u003cp\u003e我们要用多大的代价，才能认清活着的意义？\n于娟，这个风华正茂的女子，拥有留洋经历和博士学位的复旦大学青年教师，在与晚期癌症抗争一年又四个月后，终于撒手人寰。她带走的家人的思念和不舍，给我们留下坚强的力量。\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003e《此生未完成》这本书是上周末聚会时 Zhen 提到的，上周京东买书就带上了。书里前半探讨作者在生死临界时对生活、工作、名利、家人、朋友的一些看法和思考。这对于刚刚毕业的我来说，确实有些是无法真切体会到的，毕竟经历少。但是在书的字里行间中，仍然可以看到一个（不知道用什么词）的女子。\u003c/p\u003e\n\u003c!-- more --\u003e\n\u003ch2 id=\"一\"\u003e（一）\u003c/h2\u003e\n\u003cp\u003e疾病能让人有怎样的疼痛？\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e我还是没有哭，不是因为坚强，而是因为痛的想不起来哭，那个时候，只要能用尽全力顶着。如果稍微分神，我就会痛的晕厥。我不想家人看到我的痛苦。\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003e说来惭愧的一个对比，自己在喝多时有过这样的经历：自己抱着垃圾桶使劲顶着一股劲，要是有人来给自己说话，就会分神似的使劲的呕吐。可这蚀骨之痛要比这疼痛多少倍呢？\u003c/p\u003e\n\u003ch2 id=\"二\"\u003e（二）\u003c/h2\u003e\n\u003cblockquote\u003e\n\u003cp\u003e重要的是当他得知我生病消息后的第一反应，眼神表情乃至电话语气网络留言里端倪尽出，你会觉得世间很多人情世故是那么的让你淡然一笑。\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003e在遇到大事的时候方显出真正的朋友和所谓的朋友，扬尘散土，洗沙留金。能遇到“大事”的机会不多，遇到的“大事”还能全身而退的机会就更少了。所以觉的自己应该及时去明辨所有的朋友，将真心给最真的，对于其他的就随他去吧。我不可能讨所有人喜欢，也用不着。\u003c/p\u003e\n\u003ch2 id=\"三\"\u003e（三）\u003c/h2\u003e\n\u003cblockquote\u003e\n\u003cp\u003e三十岁之前的努力更多是因为自己有着太多的欲望和执著，从没有“只要活着就好”的简单。名利权情，没有一样是不辛苦的，却没有一样可以带走。\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003e这是一个作者很重要的一个观点。在现在的我看来，“只要活着就好”的活着，是一种精神上富有的活着，是充满智慧的活着。\n就说现在的自己，什么都不曾拥有，或许不用拥有过的名、利，但是其他方面什么都没有，自己一切都是空的，看到好就会有强烈的“欲望”，如果再强烈一点就会有“执著”。在文字中我感受到了作者在精神方面的强大与富有，或许在这之后才能感受到在名、利之外更重要的东西。其实，自己真的很难想通，到底拥有什么自己就可以“苟”了，自己到底想要什么。了解自己真正想要什么真是一幸事。\n作者提到的有时间，多多陪陪家人父母、有机会就尽孝，自己是很赞同的。\u003c/p\u003e\n\u003ch2 id=\"四\"\u003e（四）\u003c/h2\u003e\n\u003cblockquote\u003e\n\u003cp\u003e外公反映土豆每次经过，都趴在玻璃上看玻璃窗里的圣诞树、圣诞彩球和姜饼屋。土豆眼神里有点想，但却乖乖看着，并不讨。外公回想说：“那个眼神我想起了卖火柴的小女孩，有时候孩子听话，你却反而会心酸。”\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003e这文字碰触心灵最柔软的地方。\u003c/p\u003e\n\u003ch2 id=\"五\"\u003e（五）\u003c/h2\u003e\n\u003cblockquote\u003e\n\u003cp\u003e你的妈妈不是懦夫，所以你的人生里，遇到珍贵的人与关键的事，都要积极争取，可以失败，但是不能放弃。我想做一个让儿子骄傲的妈妈，只此一点，无论任何地步，我都不会选择自己走，哪怕，万劫不复的痛。\u003c/p\u003e\u003c/blockquote\u003e\n\u003ch2 id=\"六\"\u003e（六）\u003c/h2\u003e\n\u003cblockquote\u003e\n\u003cp\u003e更多人不会明白，我们两个的谈笑深处埋藏着多少不能言表的无声叹息。上一次见面，我和梅两个事多么风华正茂，像展翅云霄的鹰隼，挥着翅膀相约下次的冲天。这次的相逢，是灰头土脸被命运按在尘土里依然微笑的土鸡之间的问候。\u003c/p\u003e\u003c/blockquote\u003e\n\u003ch2 id=\"七\"\u003e（七）\u003c/h2\u003e\n\u003cp\u003e“为啥是我得癌症” 的非学术报告，是书的精华文章。从饮食习惯、睡眠习惯、突击作业、环境问题，分析了对身体不利的因素。突击作业其实就是工作习惯。\u003c/p\u003e\n\u003cp\u003e在饮食上常吃不寻常的动物、暴饮暴食、嗜荤如命。\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e我们要相信聪明的祖先，几千年的智慧沉淀，才最终锁定了我们现在的食材，并在远古对他们进行豢养。如果孔雀比鸡好吃，那么现在的就是孔雀，孔雀就是鸡。\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003e在睡眠习惯上：\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e二十三时至次日三时，是肝脏活动能力最强的时段，也是肝脏最佳的排毒时期，如果肝脏功能得不到休息，会引起肝脏血流相对不足，已受损的肝细胞难以修复并加剧恶化。所以“长期熬夜等于慢性自杀”的说法并不夸张。因此医生建议人们从二十三时左右开始上床睡觉，次日一至三时进入深睡眠状态，好好地养足肝血。\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003e突击作业：\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e一辆平时就跌跌撞撞一直不维修的破车，一踩油门就彻夜地疯跑疯开半个月。一年搞个五六次，就是钢筋铁打的汽车，开个二十几年也到报废了。\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003e环境问题，空气污染、水污染和食品安全危机还有那可怕的甲醛家具。\u003c/p\u003e\n\u003ch2 id=\"八\"\u003e（八）\u003c/h2\u003e\n\u003cblockquote\u003e\n\u003cp\u003e不去想控制大局小局，不想去多管闲事淡事，我不在有对手，不再有敌人，我也不在关心谁比谁强，课题也好，任务也罢，暂且放着。\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003e也许只有正在想明白的人，才懂的世间的一切，隔岸看花、风淡云轻。\u003c/p\u003e","title":"【此生为完成】随笔"},{"content":"349. Intersection of Two Arrays Given two arrays, write a function to compute their intersection. Example: Given nums1 = [1, 2, 2, 1], nums2 = [2, 2], return [2].\nNote: Each element in the result must be unique. The result can be in any order.\n自己的解法 使用 set 进行去重\npublic static int[] intersection2(int[] nums1, int[] nums2) { Set\u0026lt;Integer\u0026gt; nums1Set = new HashSet\u0026lt;\u0026gt;(); Set\u0026lt;Integer\u0026gt; set = new HashSet\u0026lt;\u0026gt;(); for (int integer : nums1) { nums1Set.add(integer); } for (int integer : nums2) { if (nums1Set.contains(integer)) { set.add(integer); } } int[] result = new int[set.size()]; int i = 0; for (int integer : set) { result[i] = integer; i++; } return result; } 别人的思路 LeetCode – Intersection of Two Arrays (Java)\nBinary Search\npublic int[] intersection(int[] nums1, int[] nums2) { Arrays.sort(nums1); Arrays.sort(nums2); ArrayList\u0026lt;Integer\u0026gt; list = new ArrayList\u0026lt;Integer\u0026gt;(); for(int i=0; i\u0026lt;nums1.length; i++){ if(i==0 || (i\u0026gt;0 \u0026amp;\u0026amp; nums1[i]!=nums1[i-1])){ if(Arrays.binarySearch(nums2, nums1[i])\u0026gt;-1){ list.add(nums1[i]); } } } int[] result = new int[list.size()]; int k=0; for(int i: list){ result[k++] = i; } return result; } Time = O(nlog(n)). Space = O(n).\n","permalink":"https://zyf.im/2016/08/22/leetcode-intersection-of-two-arrays-349/","summary":"\u003cp\u003e\u003ca href=\"https://leetcode.com/problems/intersection-of-two-arrays/\"\u003e349. Intersection of Two Arrays\u003c/a\u003e\n  Given two arrays, write a function to compute their intersection.\n  \u003cstrong\u003eExample:\u003c/strong\u003e\n  Given nums1 = \u003ccode\u003e[1, 2, 2, 1]\u003c/code\u003e, nums2 = \u003ccode\u003e[2, 2]\u003c/code\u003e, return \u003ccode\u003e[2]\u003c/code\u003e.\u003c/p\u003e\n\u003c!-- more --\u003e\n\u003cp\u003e  \u003cstrong\u003eNote:\u003c/strong\u003e\n  Each element in the result must be unique.\n  The result can be in any order.\u003c/p\u003e\n\u003ch3 id=\"自己的解法\"\u003e自己的解法\u003c/h3\u003e\n\u003cp\u003e使用 set 进行去重\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003epublic\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kd\"\u003estatic\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"o\"\u003e[]\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nf\"\u003eintersection2\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"o\"\u003e[]\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003enums1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"o\"\u003e[]\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003enums2\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eSet\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eInteger\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003enums1Set\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eHashSet\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u0026gt;\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eSet\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eInteger\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eset\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eHashSet\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u0026gt;\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003efor\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003einteger\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003enums1\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"n\"\u003enums1Set\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eadd\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003einteger\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003efor\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003einteger\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003enums2\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"k\"\u003eif\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003enums1Set\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003econtains\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003einteger\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e   \u003c/span\u003e\u003cspan class=\"n\"\u003eset\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eadd\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003einteger\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"o\"\u003e[]\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eresult\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003eset\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003esize\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\u003cspan class=\"o\"\u003e]\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003efor\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003einteger\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eset\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"n\"\u003eresult\u003c/span\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"o\"\u003e]\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003einteger\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"o\"\u003e++\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003ereturn\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eresult\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"别人的思路\"\u003e别人的思路\u003c/h3\u003e\n\u003cp\u003e\u003ca href=\"www.programcreek.com/2015/05/leetcode-intersection-of-two-arrays-java/\"\u003eLeetCode – Intersection of Two Arrays (Java)\u003c/a\u003e\u003c/p\u003e","title":"LeetCode Intersection of Two Arrays 349"},{"content":"100. Same Tree Given two binary trees, write a function to check if they are equal or not. Two binary trees are considered equal if they are structurally identical and the nodes have the same value.\n关于树结构自己没怎么看过，查了查遍历通常是：递归、stack\n自己的解法 /** * Definition for a binary tree node. * public class TreeNode { * int val; * TreeNode left; * TreeNode right; * TreeNode(int x) { val = x; } * } */ public class Solution { public boolean isSameTree(TreeNode p, TreeNode q) { if (p == null \u0026amp;\u0026amp; q == null) { return true; } if (p == null || q == null) { return false; } if (p.val == q.val) { return isSameTree(p.left, q.left) \u0026amp;\u0026amp; isSameTree(p.right, q.right); } return false; } } ","permalink":"https://zyf.im/2016/08/22/leetcode-same-tree-100/","summary":"\u003cp\u003e\u003ca href=\"https://leetcode.com/problems/same-tree/\"\u003e100. Same Tree\u003c/a\u003e\n  Given two binary trees, write a function to check if they are equal or not.\n  Two binary trees are considered equal if they are structurally identical and the nodes have the same value.\u003c/p\u003e\n\u003c!-- more --\u003e\n\u003cp\u003e关于树结构自己没怎么看过，查了查遍历通常是：递归、stack\u003c/p\u003e\n\u003ch3 id=\"自己的解法\"\u003e自己的解法\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003e/**\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003e * Definition for a binary tree node.\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003e * public class TreeNode {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003e *     int val;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003e *     TreeNode left;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003e *     TreeNode right;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003e *     TreeNode(int x) { val = x; }\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003e * }\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003e */\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"kd\"\u003epublic\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kd\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eSolution\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"kd\"\u003epublic\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kt\"\u003eboolean\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nf\"\u003eisSameTree\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eTreeNode\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ep\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eTreeNode\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eq\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e        \u003c/span\u003e\u003cspan class=\"k\"\u003eif\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ep\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e==\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kc\"\u003enull\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eq\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e==\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kc\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e   \u003c/span\u003e\u003cspan class=\"k\"\u003ereturn\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"k\"\u003eif\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ep\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e==\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kc\"\u003enull\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e||\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eq\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e==\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kc\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e   \u003c/span\u003e\u003cspan class=\"k\"\u003ereturn\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kc\"\u003efalse\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"k\"\u003eif\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ep\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eval\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e==\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eq\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eval\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e   \u003c/span\u003e\u003cspan class=\"k\"\u003ereturn\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eisSameTree\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ep\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eleft\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eq\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eleft\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eisSameTree\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ep\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eright\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eq\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eright\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"k\"\u003ereturn\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kc\"\u003efalse\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","title":"LeetCode Same Tree 100"},{"content":"168. Excel Sheet Column Title Given a positive integer, return its corresponding column title as appear in an Excel sheet.\nFor example:\n1 -\u0026gt; A 2 -\u0026gt; B 3 -\u0026gt; C ... 26 -\u0026gt; Z 27 -\u0026gt; AA 28 -\u0026gt; AB 自己的思路 十进制转“二十六进制”\npublic String convertToTitle(int n) { String str = \u0026#34;\u0026#34;; do { int chrInt = n % 26; char chr; if (chrInt == 0) { chr = \u0026#39;Z\u0026#39;; n -= 26; } else { chr = (char) (chrInt - 1 + \u0026#39;A\u0026#39;); } str = chr + str; n = n / 26; } while (n != 0); return str; } 别人的思路 public String convertToTitle(int n) { if(n \u0026lt;= 0){ throw new IllegalArgumentException(\u0026#34;Input is not valid!\u0026#34;); } StringBuilder sb = new StringBuilder(); while(n \u0026gt; 0){ n--; char ch = (char) (n % 26 + \u0026#39;A\u0026#39;); n /= 26; sb.append(ch); } sb.reverse(); return sb.toString(); } 思路是一样的，但是代码更简洁，使用了StringBuilder 和 reverse()，提前减 1 也避免了特殊处理\u0026rsquo;Z'\n在算法问题中常常用到：\n1 的 ascii 为 33，十六进制为 21H A 的 ascii 为 65，十六进制为 41H a 的 ascii 为 97，十六进制为 61H ","permalink":"https://zyf.im/2016/08/22/leetcode-excel-sheet-column-title-168/","summary":"\u003cp\u003e\u003ca href=\"https://leetcode.com/problems/excel-sheet-column-title/\"\u003e168. Excel Sheet Column Title\u003c/a\u003e\n  Given a positive integer, return its corresponding column title as appear in an Excel sheet.\u003c/p\u003e\n\u003c!-- more --\u003e\n\u003cp\u003eFor example:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"n\"\u003e1\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eA\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"n\"\u003e2\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eB\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"n\"\u003e3\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eC\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"p\"\u003e...\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"n\"\u003e26\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eZ\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"n\"\u003e27\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eAA\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"n\"\u003e28\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eAB\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"自己的思路\"\u003e自己的思路\u003c/h3\u003e\n\u003cp\u003e十进制转“二十六进制”\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003epublic\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eString\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nf\"\u003econvertToTitle\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003en\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eString\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003estr\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003edo\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003echrInt\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003en\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e%\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003e26\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"kt\"\u003echar\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003echr\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"k\"\u003eif\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003echrInt\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e==\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e   \u003c/span\u003e\u003cspan class=\"n\"\u003echr\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"sc\"\u003e\u0026#39;Z\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e   \u003c/span\u003e\u003cspan class=\"n\"\u003en\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e-=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003e26\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eelse\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e   \u003c/span\u003e\u003cspan class=\"n\"\u003echr\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003echar\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003echrInt\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003e1\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e+\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"sc\"\u003e\u0026#39;A\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"n\"\u003estr\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003echr\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e+\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003estr\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"n\"\u003en\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003en\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003e26\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003ewhile\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003en\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e!=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003ereturn\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003estr\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"别人的思路\"\u003e别人的思路\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003epublic\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eString\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nf\"\u003econvertToTitle\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003en\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"k\"\u003eif\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003en\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e){\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e        \u003c/span\u003e\u003cspan class=\"k\"\u003ethrow\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eIllegalArgumentException\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;Input is not valid!\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"n\"\u003eStringBuilder\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003esb\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eStringBuilder\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"k\"\u003ewhile\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003en\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e){\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e        \u003c/span\u003e\u003cspan class=\"n\"\u003en\u003c/span\u003e\u003cspan class=\"o\"\u003e--\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e        \u003c/span\u003e\u003cspan class=\"kt\"\u003echar\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ech\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003echar\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003en\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e%\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003e26\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e+\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"sc\"\u003e\u0026#39;A\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e        \u003c/span\u003e\u003cspan class=\"n\"\u003en\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e/=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003e26\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e        \u003c/span\u003e\u003cspan class=\"n\"\u003esb\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eappend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ech\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"n\"\u003esb\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003ereverse\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"k\"\u003ereturn\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003esb\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003etoString\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e思路是一样的，但是代码更简洁，使用了\u003ccode\u003eStringBuilder\u003c/code\u003e 和 \u003ccode\u003ereverse()\u003c/code\u003e，提前减 1 也避免了特殊处理\u0026rsquo;Z'\u003c/p\u003e","title":"LeetCode Excel Sheet Column Title 168"},{"content":"171. Excel Sheet Column Number Given a column title as appear in an Excel sheet, return its corresponding column number.\nFor example:\nA -\u0026gt; 1 B -\u0026gt; 2 C -\u0026gt; 3 ... Z -\u0026gt; 26 AA -\u0026gt; 27 AB -\u0026gt; 28 自己的思路 很像是“二十六进制”转十进制\npublic int titleToNumber(String s) { int col = 0; char[] chars = s.toCharArray(); int i = 0; while (i \u0026lt; chars.length) { int charInt = chars[chars.length - 1 - i] - 64; col += Math.pow(26, i) * charInt; i++; } return col; } 在算法问题中常常用到：\n1 的 ascii 为 33，十六进制为 21H A 的 ascii 为 65，十六进制为 41H a 的 ascii 为 97，十六进制为 61H 上面有个写的不好的地方就是 64，好像的很莫名的一个数字，其实时在将 A 折算为 1\n","permalink":"https://zyf.im/2016/08/22/leetcode-excel-sheet-column-number-171/","summary":"\u003cp\u003e\u003ca href=\"https://leetcode.com/problems/excel-sheet-column-number/\"\u003e171. Excel Sheet Column Number\u003c/a\u003e\n  Given a column title as appear in an Excel sheet, return its corresponding column number.\u003c/p\u003e\n\u003c!-- more --\u003e\n\u003cp\u003eFor example:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"n\"\u003eA\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003e1\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"n\"\u003eB\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003e2\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"n\"\u003eC\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003e3\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"p\"\u003e...\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"n\"\u003eZ\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003e26\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"n\"\u003eAA\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003e27\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"n\"\u003eAB\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003e28\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"自己的思路\"\u003e自己的思路\u003c/h3\u003e\n\u003cp\u003e很像是“二十六进制”转十进制\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003epublic\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nf\"\u003etitleToNumber\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eString\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ecol\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kt\"\u003echar\u003c/span\u003e\u003cspan class=\"o\"\u003e[]\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003echars\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003etoCharArray\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003ewhile\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003echars\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003elength\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003echarInt\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003echars\u003c/span\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003echars\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003elength\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003e1\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"o\"\u003e]\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003e64\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"n\"\u003ecol\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e+=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eMath\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003epow\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003e26\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003echarInt\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"o\"\u003e++\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003ereturn\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ecol\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e在算法问题中常常用到：\u003c/p\u003e","title":"LeetCode Excel Sheet Column Number 171"},{"content":" 日本民间流传着这样一个故事：在深山里，有一种特别的蛤蟆，它和同类相比不仅外表更丑，而且还多长了几条腿。人们转到它后，将其放在镜前或者玻璃箱内，蛤蟆一看到自己丑陋不堪的真面目，不禁吓出一身油。这种油，也是民间用来治疗烧伤烫伤的珍贵药材。\n第一次写人文类书籍的笔记。\n故事是从黑泽明一岁多光着身子洗澡开始回忆的，然后按时间，一个个小故事讲述自己。\n（一）\n二年级是他得到了“糖酥”这个绰号，因为有人揪他的头发，往他西装上抹鼻涕，让他哭了好几次。\n想到了自己大概三四年级的一件事：一次在公交车站等车被人嘲笑嘴巴大，是陌生的同龄人。自己当时被蒙掉了，也不知道说什么或者做点什么，傻傻的，后来车来了，上车回家了。我记得我是在车上委屈的哭了。十几年来这件事我一直都记得，总是把这事归为黑历史、很怂的事，也从来没和别人讲过。我当时为什么没有还击？是被大人教育的打架不是好孩子？还是自己的胆小？还是正中下怀？细思这些都有，是太小没有自己的判断力，也缺少一份对自己信心与肯定。\n要能再来我一定会把那小子打到哭。\n（二）\n小黑遇到了“崇尚自由、以鲜活的感性及创造精神从事教育的老师”，立川老师对智力发育缓慢、性格乖僻的他多方庇护，使他第一次有了自信。立川老师还为了使植草（小黑好友）尽快地开出灿烂的花，把植草移栽到了副班长这个盆里，而且放在向阳之处。\n遇到一个能指导你成长的同学、朋友、老师、哥哥姐姐真的是一件很幸运的事情。我觉的他们在有智慧的人群里，不是瞎折腾或者很世俗。\n（三）\n给客人吃的鱼，鱼头朝左，鱼腹朝着客人。给剖腹者上的鱼，大概是鱼头朝右，鱼背朝着本人。或许是因为，如果让剖腹者看到剖开的鱼腹，未免太残酷了。\n（四）\n小黑在学剑道时，道场的主人被汽车撞了，那是汽车本来是稀罕之物，却又让这稀罕之物撞伤，简直像挨马踢一样可笑。而对道场主人的尊敬烟消云散。自己在高野佐三郎的道场在学交叉坎时，被弹回来撞到墙上，眼前一阵发黑，两眼直冒金星，对自己剑道的自豪化为乌有。\n人世并不像想象的那么简单。人外有人，天外有天。自己不免是井底之蛙，总是管中窥豹。很多像这样的道理，我都听过，我也认同，可在没有遇到一件具体的事情的时候，总是看不到认不清自己的浅薄。多多经历，多多思考。\n（五）\n在体育课上，体育老师教跳高采取比赛的方法，撞掉竿就被淘汰下去。黑泽明刚一起跑，同学们就哄堂大笑。他们准是觉得我会头一个把横杆撞下来。出乎意料的是我轻松越过了横杆。横杆逐渐上移，然而，挑战的人中间总有我。看热闹的人们寂然无声了。不知道什么原因，居然出现了奇迹：只剩我一个人在挑战了。一个个无不呆呆地看着我。而且，只剩下我一个人之后，仍然几次跳过了横杆。也许是天使哀怜我体操课总得零分，给我的背插上了翅膀。 最后一句，写的真美。\n（六）\n人是可笑的，过分受惊时，头脑的一部分会脱离现实，想入非非，看起来显得十分沉着。当大地震时，抱着电线杆忍受着强烈的摇晃时，仍然想到了这些，而且非常佩服日式建筑的优越性。然而这绝不意味着我遇事沉着冷静。\n（七）\n没有经历过的人无法想象对人类来说何谓正真的黑暗，这黑暗又是多么的可怕。这恐怖夺走了人的正气。无论朝哪里望，什么都看不见，这是最使人感到孤立无援的地方，它使人内心深处产生了惊慌和不安，也使人处于名副其实的疑心生暗鬼状态。\n好像有点像我国的“吃盐防辐射”，都是巧妙地利用黑暗对人的威胁制造的阴谋？还是易受蛊惑的人心是社会发展的过程中要的经历？\n（八）\n结束这趟可怕的远足，当天晚上，我以为一定难以入睡，还会大做噩梦，但头刚一沾枕就到了第二天早晨。哥哥说：“面对可怕的事物闭眼不敢看，就会觉得它可怕；什么都不在乎，哪里还有什么可怕的呢？”。现在看来，那趟远足，对哥哥来说可能也是可怕的。正因为可怕，所以必须征服它。这次远足也是一次征服恐怖的远征。\n可是面对了自己可怕的东西后，还是怕的原因是什么呢？是还没有正面面对？\n（九）\n高山仰止\n对有气质、有修养或有崇高品德之人的崇敬、仰慕之情。\n（十）\n人能把卫星送进宇宙，在精神层面却不会向上看，而是像野狗一样，只注意脚下，徘徊不已。\n（十一）\n后娘用艾苦我身/我为后娘买大艾/为讨她欢心。继母为什么虐待前房孩子？如果说出于憎恨丈夫的前妻而虐待其子，这是没有道理的。认为这完全出于愚昧。愚昧是人的疯狂病症之一，以虐待没有反抗能力的孩子或者小动物为乐的人，纯粹是疯子。然而这类疯子并不认为这是犯罪，却认为是理所当然，所以难以对付。我能解开绑她的带子，然而无法把她从捆绑她的境遇中救出。对这个孩子来说，人们的同情是毫无意义的。那种温情反倒给她招来更多的麻烦。\n想到了打劫的故事，说：被劫持的人只要交的钱比上一人交的钱多一倍，就可以走。人争先恐后的交赎金，不再有人反抗。\n（十二）\n本来是红的，却不老实说它是红的，等到能坦率说出来的时候，已经到了晚年。很多人年轻时表现欲过强，这样反倒迷失了自己。我也毫不例外，拼命的考技巧作画，那画的俗气使我对自己心生憎恶，逐渐丧失了对自己才能有的信心，把绘画看作痛苦了。为了买油彩和画布还得干些不愿干的杂活儿赚钱才行。\n少搞些套路，玩花活，踏踏实实才是真。别瞎折腾，没有用。\n（十三）\n产生这种急于就业的焦虑和降格以求的心情，主要是以为哥哥突然去世，我要继他之后负起长子的责任。\n在年初有类似的经历，最后一个学期，都找工作去了，也要毕业要长大了，急着确定个工作。其实现在也着急着，想快有所作为。前几日，看到好友暗叶的朋友圈发：年轻人想法没多，都是还得慢慢来。我初看是不赞同。黑泽明的父亲也告诫他说：“不要着急，也没有着急的必要”，“要等下去，前面的道路自然会打开的”。这些话我确实还不太理解为什么，得慢慢的体会。\n（十四）\n凡事想用人的，必须先培养人。培养出人，激发出人的才能，这才能用。\n纷扰的现在，还有多少人或公司愿意培养人？应该说人培养应该是必须的。\n（十五）\n山本先生对于追随他的副导演，绝不干改变他们个性的事，而是一心一意的着力于发掘他们的个性；而且丝毫不让我们有从师学习的拘束心情，而是让我们充分的发展自己。 山本先生为了培养副导演，不惜牺牲自己的作品。 “那是卖香荷包的招牌。随随便便说话可不行！不知道的事情就该说不知道！”\n（十六）\n提出批评不难。但是，提出批评的人能够按照自己的批评意见亲自把剧本改好，却不是普通人能做到的事。\n太有同感了，常常有人在旁边指手画脚，却说不出什么切实可行的办法建议。\n（十七）\n人往往习惯于认为价值与辛苦成正比。这在电影界剪辑上是最要不得的。人们说电影是时间的艺术，所以，没有用的时间就应删去。\n这观点在互联网行业也行的通，做好的功能不合适了，说废也就废掉了。\n（十八）\n我常常把群众演员的名字忘掉，所以只好按他们的衣服颜色招呼。结果被山本先生训了几句：“黑泽明，那可不行。人都有个名嘛！”。名不见经传的演员听到山本先生如此亲切的招呼他，无不感到。难道能说山本先生有些滑头吗？我看应该说他善于用人。\n自己还不是什么重要人物，但是记住别人的名字应该是件重要的事情。\n（十九）\n关于演员的关键问题主要有以下几点：第一，人很难了解自己，不能客观的观察自己的说话方式和行为举止。第二，凡事有意识的动作，首先注意的不是动作本身，而是意识。第三，教给演员怎么做，同时必须告诉他为什么怎么做，而且让他充分理解、心悦诚服。\n做事情的时候应该反向考虑第三点，为什么要怎么做事情？目的是什么？\n（二十）\n电影评论家中冲有这样的人，看到电影中一些自己认为是缺点的地方就如获至宝，大发谬论，但是电影导演也乐于此道可就错了。\n现在这样的人越来越多，哗众取宠。\n（二十一）\n他们以为一部卖座影片的续集也必然会成功，于是不想再开拓新的领域，总想旧梦重温。重拍的影片绝不如前作，这虽然是已经证明的事实，但他们还要重蹈覆辙，这才是地地道道的愚蠢之举。\n学习新东西，找新路子。\n（二十二）\n我为了抵抗人的苦恼，戴上一幅强者的面具；而植草却为了沉溺与人的苦恼，戴上了一幅弱者的面具。事实不过如此。但这只是表面的不同，就本质来说。我们都是弱者。我不是特别的人。我既不是特别强的人，也不是得天独厚的有特殊才能的人。我不过是个不愿示弱于人，不愿输给别人，因而不懈努力的人。\n在原来看到这样的句子是很不屑的，觉的成功的人，说什么都行。现在信了，真的人都本是普通人，只是有的人一直在进步成长就现在不再普通了。\n（二十三）\n有一天，我在电车里看到这种杂志的广告，简直目瞪口呆。那上面用大字标题写着：是谁夺走了 XX 的贞操？乍看起来，这似乎在为 XX 女士鸣不平，实际则是把 XX 当作玩物恣意戏耍。我认为，这不是言论自由，而是言论暴力。\n没想到在那么早，就提到了“言论暴力”的话题，社交平台的评论区常常有的血雨腥风。\n（二十四）\n本民族人为什么对于本民族的存在毫无自信呢？为什么对异域的东西那么尊重，对于自己的东西就那么轻视呢？\n黑泽明提到是：可悲的国民性。自己没太理解。\n人是很难如实的谈论自己的。人总是本能的美化自己。人不会老老实实的说自己是怎样一个人，常常是假托别人才能老老实实的谈论自己。 因为，在没有什么能比作品更好的说明作者了。\n","permalink":"https://zyf.im/2016/08/17/something-like-an-autobiography-reading-notes/","summary":"\u003cblockquote\u003e\n\u003cp\u003e日本民间流传着这样一个故事：在深山里，有一种特别的蛤蟆，它和同类相比不仅外表更丑，而且还多长了几条腿。人们转到它后，将其放在镜前或者玻璃箱内，蛤蟆一看到自己丑陋不堪的真面目，不禁吓出一身油。这种油，也是民间用来治疗烧伤烫伤的珍贵药材。\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003e第一次写人文类书籍的笔记。\u003c/p\u003e\n\u003cp\u003e故事是从黑泽明一岁多光着身子洗澡开始回忆的，然后按时间，一个个小故事讲述自己。\u003c/p\u003e\n\u003cp\u003e（一）\u003c/p\u003e\n\u003cp\u003e二年级是他得到了“糖酥”这个绰号，因为有人揪他的头发，往他西装上抹鼻涕，让他哭了好几次。\u003c/p\u003e\n\u003cp\u003e想到了自己大概三四年级的一件事：一次在公交车站等车被人嘲笑嘴巴大，是陌生的同龄人。自己当时被蒙掉了，也不知道说什么或者做点什么，傻傻的，后来车来了，上车回家了。我记得我是在车上委屈的哭了。十几年来这件事我一直都记得，总是把这事归为黑历史、很怂的事，也从来没和别人讲过。我当时为什么没有还击？是被大人教育的打架不是好孩子？还是自己的胆小？还是正中下怀？细思这些都有，是太小没有自己的判断力，也缺少一份对自己信心与肯定。\u003c/p\u003e\n\u003cp\u003e要能再来我一定会把那小子打到哭。\u003c/p\u003e\n\u003c!-- more --\u003e\n\u003cp\u003e（二）\u003c/p\u003e\n\u003cp\u003e小黑遇到了“崇尚自由、以鲜活的感性及创造精神从事教育的老师”，立川老师对智力发育缓慢、性格乖僻的他多方庇护，使他第一次有了自信。立川老师还为了使植草（小黑好友）尽快地开出灿烂的花，把植草移栽到了副班长这个盆里，而且放在向阳之处。\u003c/p\u003e\n\u003cp\u003e遇到一个能指导你成长的同学、朋友、老师、哥哥姐姐真的是一件很幸运的事情。我觉的他们在有智慧的人群里，不是瞎折腾或者很世俗。\u003c/p\u003e\n\u003cp\u003e（三）\u003c/p\u003e\n\u003cp\u003e给客人吃的鱼，鱼头朝左，鱼腹朝着客人。给剖腹者上的鱼，大概是鱼头朝右，鱼背朝着本人。或许是因为，如果让剖腹者看到剖开的鱼腹，未免太残酷了。\u003c/p\u003e\n\u003cp\u003e（四）\u003c/p\u003e\n\u003cp\u003e小黑在学剑道时，道场的主人被汽车撞了，那是汽车本来是稀罕之物，却又让这稀罕之物撞伤，简直像挨马踢一样可笑。而对道场主人的尊敬烟消云散。自己在高野佐三郎的道场在学交叉坎时，被弹回来撞到墙上，眼前一阵发黑，两眼直冒金星，对自己剑道的自豪化为乌有。\u003c/p\u003e\n\u003cp\u003e人世并不像想象的那么简单。人外有人，天外有天。自己不免是井底之蛙，总是管中窥豹。很多像这样的道理，我都听过，我也认同，可在没有遇到一件具体的事情的时候，总是看不到认不清自己的浅薄。多多经历，多多思考。\u003c/p\u003e\n\u003cp\u003e（五）\u003c/p\u003e\n\u003cp\u003e在体育课上，体育老师教跳高采取比赛的方法，撞掉竿就被淘汰下去。黑泽明刚一起跑，同学们就哄堂大笑。他们准是觉得我会头一个把横杆撞下来。出乎意料的是我轻松越过了横杆。横杆逐渐上移，然而，挑战的人中间总有我。看热闹的人们寂然无声了。不知道什么原因，居然出现了奇迹：只剩我一个人在挑战了。一个个无不呆呆地看着我。而且，只剩下我一个人之后，仍然几次跳过了横杆。也许是天使哀怜我体操课总得零分，给我的背插上了翅膀。\n最后一句，写的真美。\u003c/p\u003e\n\u003cp\u003e（六）\u003c/p\u003e\n\u003cp\u003e人是可笑的，过分受惊时，头脑的一部分会脱离现实，想入非非，看起来显得十分沉着。当大地震时，抱着电线杆忍受着强烈的摇晃时，仍然想到了这些，而且非常佩服日式建筑的优越性。然而这绝不意味着我遇事沉着冷静。\u003c/p\u003e\n\u003cp\u003e（七）\u003c/p\u003e\n\u003cp\u003e没有经历过的人无法想象对人类来说何谓正真的黑暗，这黑暗又是多么的可怕。这恐怖夺走了人的正气。无论朝哪里望，什么都看不见，这是最使人感到孤立无援的地方，它使人内心深处产生了惊慌和不安，也使人处于名副其实的疑心生暗鬼状态。\u003c/p\u003e\n\u003cp\u003e好像有点像我国的“吃盐防辐射”，都是巧妙地利用黑暗对人的威胁制造的阴谋？还是易受蛊惑的人心是社会发展的过程中要的经历？\u003c/p\u003e\n\u003cp\u003e（八）\u003c/p\u003e\n\u003cp\u003e结束这趟可怕的远足，当天晚上，我以为一定难以入睡，还会大做噩梦，但头刚一沾枕就到了第二天早晨。哥哥说：“面对可怕的事物闭眼不敢看，就会觉得它可怕；什么都不在乎，哪里还有什么可怕的呢？”。现在看来，那趟远足，对哥哥来说可能也是可怕的。正因为可怕，所以必须征服它。这次远足也是一次征服恐怖的远征。\u003c/p\u003e\n\u003cp\u003e可是面对了自己可怕的东西后，还是怕的原因是什么呢？是还没有正面面对？\u003c/p\u003e\n\u003cp\u003e（九）\u003c/p\u003e\n\u003cp\u003e高山仰止\u003c/p\u003e\n\u003cp\u003e对有气质、有修养或有崇高品德之人的崇敬、仰慕之情。\u003c/p\u003e\n\u003cp\u003e（十）\u003c/p\u003e\n\u003cp\u003e人能把卫星送进宇宙，在精神层面却不会向上看，而是像野狗一样，只注意脚下，徘徊不已。\u003c/p\u003e\n\u003cp\u003e（十一）\u003c/p\u003e\n\u003cp\u003e后娘用艾苦我身/我为后娘买大艾/为讨她欢心。继母为什么虐待前房孩子？如果说出于憎恨丈夫的前妻而虐待其子，这是没有道理的。认为这完全出于愚昧。愚昧是人的疯狂病症之一，以虐待没有反抗能力的孩子或者小动物为乐的人，纯粹是疯子。然而这类疯子并不认为这是犯罪，却认为是理所当然，所以难以对付。我能解开绑她的带子，然而无法把她从捆绑她的境遇中救出。对这个孩子来说，人们的同情是毫无意义的。那种温情反倒给她招来更多的麻烦。\u003c/p\u003e\n\u003cp\u003e想到了打劫的故事，说：被劫持的人只要交的钱比上一人交的钱多一倍，就可以走。人争先恐后的交赎金，不再有人反抗。\u003c/p\u003e\n\u003cp\u003e（十二）\u003c/p\u003e\n\u003cp\u003e本来是红的，却不老实说它是红的，等到能坦率说出来的时候，已经到了晚年。很多人年轻时表现欲过强，这样反倒迷失了自己。我也毫不例外，拼命的考技巧作画，那画的俗气使我对自己心生憎恶，逐渐丧失了对自己才能有的信心，把绘画看作痛苦了。为了买油彩和画布还得干些不愿干的杂活儿赚钱才行。\u003c/p\u003e\n\u003cp\u003e少搞些套路，玩花活，踏踏实实才是真。别瞎折腾，没有用。\u003c/p\u003e\n\u003cp\u003e（十三）\u003c/p\u003e\n\u003cp\u003e产生这种急于就业的焦虑和降格以求的心情，主要是以为哥哥突然去世，我要继他之后负起长子的责任。\u003c/p\u003e\n\u003cp\u003e在年初有类似的经历，最后一个学期，都找工作去了，也要毕业要长大了，急着确定个工作。其实现在也着急着，想快有所作为。前几日，看到好友暗叶的朋友圈发：年轻人想法没多，都是还得慢慢来。我初看是不赞同。黑泽明的父亲也告诫他说：“不要着急，也没有着急的必要”，“要等下去，前面的道路自然会打开的”。这些话我确实还不太理解为什么，得慢慢的体会。\u003c/p\u003e\n\u003cp\u003e（十四）\u003c/p\u003e\n\u003cp\u003e凡事想用人的，必须先培养人。培养出人，激发出人的才能，这才能用。\u003c/p\u003e\n\u003cp\u003e纷扰的现在，还有多少人或公司愿意培养人？应该说人培养应该是必须的。\u003c/p\u003e\n\u003cp\u003e（十五）\u003c/p\u003e\n\u003cp\u003e山本先生对于追随他的副导演，绝不干改变他们个性的事，而是一心一意的着力于发掘他们的个性；而且丝毫不让我们有从师学习的拘束心情，而是让我们充分的发展自己。\n山本先生为了培养副导演，不惜牺牲自己的作品。\n“那是卖香荷包的招牌。随随便便说话可不行！不知道的事情就该说不知道！”\u003c/p\u003e\n\u003cp\u003e（十六）\u003c/p\u003e\n\u003cp\u003e提出批评不难。但是，提出批评的人能够按照自己的批评意见亲自把剧本改好，却不是普通人能做到的事。\u003c/p\u003e\n\u003cp\u003e太有同感了，常常有人在旁边指手画脚，却说不出什么切实可行的办法建议。\u003c/p\u003e\n\u003cp\u003e（十七）\u003c/p\u003e\n\u003cp\u003e人往往习惯于认为价值与辛苦成正比。这在电影界剪辑上是最要不得的。人们说电影是时间的艺术，所以，没有用的时间就应删去。\u003c/p\u003e\n\u003cp\u003e这观点在互联网行业也行的通，做好的功能不合适了，说废也就废掉了。\u003c/p\u003e\n\u003cp\u003e（十八）\u003c/p\u003e\n\u003cp\u003e我常常把群众演员的名字忘掉，所以只好按他们的衣服颜色招呼。结果被山本先生训了几句：“黑泽明，那可不行。人都有个名嘛！”。名不见经传的演员听到山本先生如此亲切的招呼他，无不感到。难道能说山本先生有些滑头吗？我看应该说他善于用人。\u003c/p\u003e\n\u003cp\u003e自己还不是什么重要人物，但是记住别人的名字应该是件重要的事情。\u003c/p\u003e\n\u003cp\u003e（十九）\u003c/p\u003e\n\u003cp\u003e关于演员的关键问题主要有以下几点：第一，人很难了解自己，不能客观的观察自己的说话方式和行为举止。第二，凡事有意识的动作，首先注意的不是动作本身，而是意识。第三，教给演员怎么做，同时必须告诉他为什么怎么做，而且让他充分理解、心悦诚服。\u003c/p\u003e\n\u003cp\u003e做事情的时候应该反向考虑第三点，为什么要怎么做事情？目的是什么？\u003c/p\u003e\n\u003cp\u003e（二十）\u003c/p\u003e\n\u003cp\u003e电影评论家中冲有这样的人，看到电影中一些自己认为是缺点的地方就如获至宝，大发谬论，但是电影导演也乐于此道可就错了。\u003c/p\u003e\n\u003cp\u003e现在这样的人越来越多，哗众取宠。\u003c/p\u003e\n\u003cp\u003e（二十一）\u003c/p\u003e\n\u003cp\u003e他们以为一部卖座影片的续集也必然会成功，于是不想再开拓新的领域，总想旧梦重温。重拍的影片绝不如前作，这虽然是已经证明的事实，但他们还要重蹈覆辙，这才是地地道道的愚蠢之举。\u003c/p\u003e\n\u003cp\u003e学习新东西，找新路子。\u003c/p\u003e\n\u003cp\u003e（二十二）\u003c/p\u003e","title":"【蛤蟆的油】随笔"},{"content":"283. Move Zeroes Given an array nums, write a function to move all 0\u0026rsquo;s to the end of it while maintaining the relative order of the non-zero elements. For example, given nums = [0, 1, 0, 3, 12], after calling your function, nums should be [1, 3, 12, 0, 0].\nNote:\nYou must do this in-place without making a copy of the array. Minimize the total number of operations. 大体意思 将数组中 0 元素移动到数组的末尾，不改变其他元素的顺序；不能 copy 数组，最小化的操作\n自己的思路 交换冒泡 public static void moveZeroes(int[] nums) { boolean hasChange = false; do { hasChange = false; for (int i = 0; i \u0026lt; nums.length - 1; i++) { if (nums[i] == 0 \u0026amp;\u0026amp; nums[i + 1] != 0) { nums[i] = nums[i + 1]; nums[i + 1] = 0; hasChange = true; } } } while (hasChange); System.out.println(Arrays.toString(nums)); } 与 0 换位置，参考了别人的想法 public static void moveZeroes2(int[] nums) { int firstZoneIndex = -1; for (int i = 0; i \u0026lt; nums.length; i++) { if (firstZoneIndex != -1) { // 发现了过0 if (nums[i] != 0) { nums[firstZoneIndex] = nums[i]; nums[i] = 0; firstZoneIndex++; } } else { // 没有发现过0 if (nums[i] == 0) { firstZoneIndex = i; } } } System.out.println(Arrays.toString(nums)); } 别人的算法 西施豆腐渣 - leetcode 283: Move Zeroes public void moveZeroes(int[] nums) { int i = 0; int j = 0; while (j \u0026lt; nums.length) { if (nums[j] != 0) { if (j != i) { nums[i++] = nums[j]; nums[j] = 0; } else { ++i; } } ++j; } } ","permalink":"https://zyf.im/2016/08/16/leetcode-move-zeroes-283/","summary":"\u003cp\u003e\u003ca href=\"https://leetcode.com/problems/move-zeroes/\"\u003e283. Move Zeroes\u003c/a\u003e\n  Given an array nums, write a function to move all 0\u0026rsquo;s to the end of it while maintaining the relative order of the non-zero elements. For example, given nums = [0, 1, 0, 3, 12], after calling your function, nums should be [1, 3, 12, 0, 0].\u003c/p\u003e\n\u003c!-- more --\u003e\n\u003cp\u003eNote:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eYou must do this in-place without making a copy of the array.\u003c/li\u003e\n\u003cli\u003eMinimize the total number of operations.\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch3 id=\"大体意思\"\u003e大体意思\u003c/h3\u003e\n\u003cp\u003e将数组中 0 元素移动到数组的末尾，不改变其他元素的顺序；不能 copy 数组，最小化的操作\u003c/p\u003e","title":"LeetCode Move Zeroes 283"},{"content":"383. Ransom Note Given an arbitrary ransom note string and another string containing letters from all the magazines, write a function that will return true if the ransom note can be constructed from the magazines ; otherwise, it will return false. Each letter in the magazine string can only be used once in your ransom note.\nNote: You may assume that both strings contain only lowercase letters.\ncanConstruct(\u0026#34;a\u0026#34;, \u0026#34;b\u0026#34;) -\u0026gt; false canConstruct(\u0026#34;aa\u0026#34;, \u0026#34;ab\u0026#34;) -\u0026gt; false canConstruct(\u0026#34;aa\u0026#34;, \u0026#34;aab\u0026#34;) -\u0026gt; true 自己第一次做 LeetCode 上面的题，也没什么算法方面的学习，摸着石头过河，步步提高。\n大体意思 判断第二个字符串中的字母是否可以组成第一个字符串，每个字母只能用一次；两个字符串仅包含小写字母\n自己的思路 将 ransom 转成 char 数组，遍历数组，然后在 magazines，进行对比，然后除去一个一样的字母\npublic static boolean canConstruct(String ransom, String magazine) { if (ransom.length() \u0026gt; magazine.length()) { return false; } char[] ransomChar = ransom.toCharArray(); for (int i = 0; i \u0026lt; ransomChar.length; i++) { String str = String.valueOf(ransomChar[i]); if (magazine.indexOf(str) == -1) { return false; } else if (magazine.indexOf(str) == magazine.length() - 2) { magazine = magazine.substring(0, magazine.indexOf(str)); } else { magazine = magazine.substring(0, magazine.indexOf(str)) + magazine.substring(magazine.indexOf(str) + 1); } } return true; } 别人的算法 leetcode Ransom Note - 细语呢喃 public class Solution { public boolean canConstruct(String ransomNote, String magazine) { int[] cnt = new int[26]; for (int i = 0; i \u0026lt; magazine.length(); i++) cnt[magazine.charAt(i) - 97]++; for (int i = 0; i \u0026lt; ransomNote.length(); i++) if (--cnt[ransomNote.charAt(i) - 97] \u0026lt; 0) return false; return true; } } 我的理解 26 个元素的数组，每个元素存放字母的个数，如果需要的多于存在的 return false ","permalink":"https://zyf.im/2016/08/11/leetcode-ransom-note-383/","summary":"\u003cp\u003e\u003ca href=\"https://leetcode.com/problems/ransom-note/\"\u003e383. Ransom Note\u003c/a\u003e\n  Given an arbitrary ransom note string and another string containing letters from all the magazines, write a function that will return true if the ransom note can be constructed from the magazines ; otherwise, it will return false.\n  Each letter in the magazine string can only be used once in your ransom note.\u003c/p\u003e\n\u003c!-- more --\u003e\n\u003cp\u003eNote:\nYou may assume that both strings contain only lowercase letters.\u003c/p\u003e","title":"LeetCode Ransom Note 383"},{"content":"涵盖全部 MySQL 数据库的基础，MySQL 数据库的基础知识、数据表的常用操作及各种约束的使用，以及综合的运用各种命令实现记录进行 CURD 等操作。\nMySQL 安装与配置 数据类型 流程控制与运算符 DDL、DCL、DQL、DML 常用函数 表类型（存储引擎） 图形化工具 修改 MySQL 提示符 MySQL 客户端的默认提示符是 mysql\u0026gt;，基本上没什么实际作用。其实可以修改这个提示符，让它显示一些有用的信息，例如当前所在的数据库等。修改方法有四种，其中前两种只对当前连接有效，后两种则对所有连接有效。\n连接客户端时通过参数指定 mysql --prompt=\u0026#34;(\\u@\\h) [\\d]\u0026gt; \u0026#34; my.cnf\n[mysql] prompt=mysql(\\\\u@\\\\h:\\\\d)\u0026gt; 这样提示符就会变成 (user@host) [database]\u0026gt;。其中常用的字符参数有：\n\\D 完整的日期 \\d 当前数据库 \\h 服务器名称 \\u 当前用户 连接上客户端后，通过 prompt 命令修改\nprompt (\\u@\\h) [\\d]\u0026gt; 在 MySQL 的配置文件中配置。\nprompt=(\\\\u@\\\\h) [\\\\d]\u0026gt;\\\\_ 通过环境变量配置。\nexport MYSQL_PS1=\u0026#34;(\\u@\\h) [\\d]\u0026gt; \u0026#34; 参考：http://renial.iteye.com/blog/773675\nMySQL 语法规范 关键字和函数名称全部 大写 数据库名称，表名称，字段名称全部 小写 SQL 语句必须以 分号结尾 数据库操作 数据库创建：CREATE 语法：CREATE {DATABASE SCHEMA} [IF NOT EXISTS] db_name [DEFAULT] CHARACTER SET [=] charset_name DATABASE 和 SCHEMA 是相同的，任选其一 IF NOT EXISTS:如果创建的数据库存在，则不只报出 warning，不写会报错 CHRARCTER SET utf8:为表设置编码方式，如果不设置则用 mysql 默认的编码方式 查看数据库列表：SHOW SHOW { DATABASE SCHEMAS } [LIKE \u0026lsquo;pattern\u0026rsquo; WHERE expr] SHOW CREATE DATABASE xx：显示 xx 数据库信息 数据库的修改：ALTER 修改数据库编码方式：ALTER { DATABASE SCHEMAS } [db_name][default] CHARACTER SET [=] charset_name 删除数据库：DROP 删除数据库：DROP { DATABASE SCHEMAS } [IF EXISTS] db_name; --修改mysql操作符为当前日期 mysql -uroot -proot prompt \\D --展示所有数据库 show databases; --创建数据库 create database if not exists t1 character set gbk; --展示数据库t1的创建命令和编码形式 show create database t1; --修改数据库编码格式 alter database t2 character set = utf8; --删除数据库 drop database if exists t1; --展示警告信息 show warnings; 四、数据类型 char 型字符串有 0-255 之间的字节，通常被称作定长类型。所存字节不满 char 型所给它的字节，剩下的以空格补齐，仍会存储满你所给它的字节。 varchar 型的字符串是变长类型，存多少字节它就存储多少字节，不会在后面补上空格。字节长度在 0-65535 之间。 1 个字节等于 8 个 bit，L+ 几个字节后面的几个字节指的是他的最大存储范围。8 个 bit 等于就是 8 个 1，相当于 255，就是 2 的 8 次方。16 个 1 就相当于 2 的 16 次方。3 个字节四个字节依次类推。 ENUM 枚举值 就是给他几个选项，它从这几个选项中做选择，最多有 65535 个值。 SET 我们称之为集合，集合最多有 64 个成员，它在这些集合成员中做任意的排列组合。 YEAR：2 位或者 4 位，1970 到 2069 年，允许 70 到 69 TIME：-8385959 到 8385959 DATE：1000.01.01 到 9999.12.31 DATETIME：1000.01.01 00:00:00 到 9999.12.31 23:59:59 TIMESTAMP：1970.01.01 00 点起 到 2037 年之间的一个值 五、数据表操作 数据表（或表）是数据库最重要的组成部分之一，是其他对象的基础 表是一个二维表，行称为 记录，列称为 字段 创建数据表据表 1、打开数据库：USE db_name; 2、查看当前数据库：SELECT DATABASE(); 3、创建数据表：\nCREATE TABLE [IF NOT EXISTS] table_name( column_name data_type, ... column_name data_type ) CREATE TABLE tb1( username VARCHAR(20), userage TINYINT UNSIGNED, salary FLOAT(8,2) UNSIGNED, ); 查看数据表 SHOW TABLES [FROM db_name] [LIKE \u0026#39;pattern\u0026#39; WHERE expr]; 查看当前选择的数据库的所有表\nSHOW TABLES; 查看 MYSQL 数据库中的所有表，当前选择数据库位置不变\nSHOW TABLES FROM MYSQL; 查看当前选择的数据库\nSELECT DATABASE(); 查看数据表结构\nSHOW COLUMNS FROM table_name; 插入与查找 插入记录\nINSERT [INTO] tb_name [(col_name,col_name,...)] VALUES (va1,...) 查找记录\nSELECT expr,.. FROM tb_name 空值与非空 NULL，字段值可以为空 NOT NULL，字段值禁止为空\nCREATE TABLE tb2( username VARCHAR(20) NOT NULL; age TINYINT UNSIGNE NULL; ); 自动编号 自动编号 AUTO_INCREMENT 自动编号，且必须与主键配合使用\n自动编号 AUTO_INCREMENT 作用 1、自动编号：保证记录的唯一性 2、类型必须为整型（可以是 FLOAT(5,0)等，小数点后必须为 0），必须和主键 PRIMARY KEY 组合使用 3、默认情况下，起始值为 1，每次的增量为 1\nCREATE TABLE tb3( id SMALLINT UNSIGNED AUTO_INCREMENT, username VARCHAR(30) NOT NULL); -- 报错，自动增量字段必须设置成主键 主键约束 PRIMARY KEY，也可以写成KEY 1、每张数据表只能存在一个主键 2、主键保证记录的唯一性 3、主键自动为NOT NULL，即必须要为主键赋值。但如果记录中添加了AUTO_INCREMENT，那么不需要手动赋值 4、auto_increment必须和主键primary key一起使用，但主键primary key不一定要和auto_increment一块使用\nCREATE TABLE tb3( id SMALLINT UNSIGNED AUTO_INCREMENT PRIMARY KEY, username VARCHAR(30) NOT NULL); 唯一约束 PRIMARE KEY 主键约束 一张表中只能有一个\nUNIQUE KEY 1、唯一约束 2、唯一约束可以保证记录的唯一性 3、唯一约束的字段可以为空值 4、每张数据表可以存在多个唯一约束\nCREATE TABLE tb3( id SMALLINT UNSIGNED AUTO_INCREMENT PRIMARY KEY, username VARCHAR(30) NOT NULL UNIQUE KEY, age tinyint UNSIGNED ); 在创建索引时也是有区别的 默认约束 DEFAULT 当插入记录时，如果没有明确为字段赋值，则自动赋予默认值。\nCREATE TABLE tb6( id SMALLINT UNSIGNED AUTO_INCREMENT PRIMARY KEY, username VARCHAR(20) NOT NULL UNIQUE KEY, sex ENUM(\u0026#39;1\u0026#39;,\u0026#39;2\u0026#39;,\u0026#39;3\u0026#39;) DEFAULT \u0026#39;3\u0026#39; ); 其中对性别字段默认选择3\n六、约束以及修改数据表 FOREIGN KEY：保持数据一致性，完整性；实现一对一或一对多关系。 要求：父表和子表必须使用相同的存储引擎,而且禁止使用临时表；数据表的存储引擎只能为 InnoDB；外键列和参照列必须具有类似的数据类型。其中数字的长度或是否有符号位必须相同；而字符的长度则可以不同；外键列和参照列必须创建索引。如果外键列不存在索引的话，MySQL 将自动创建索引。 在 MY.ini 文件中编辑默认的存储引擎：default-storage-engine=INNODB； 显示创建表的语句：SHOW CREATE TABLE table_name； 查看表是否有索引：SHOW INDEXS FROM table_name； 以网格查看表是否有索引：SHOW INDEXS FROM table_name\\G； CREATE TABLE table_name1( id SMALLINT UNSIGNED AUTO_INCREMENT PRIMARY KEY, name VARCHAR(20) NOT NULL ) CREATE TABLE table_name2( id SMALLINT UNSIGNED AUTO_INCREMENT PRIMARY KEY, username VARCHAR(20) NOT NULL, pid SMALLINT UNSIGNED, FOREIGN KEY (pid) REFERENCES table_name1(id) /* 外键 pid 参照 table_name1中的 id 字段 */ ) \u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2016/07/31/imooc-meet-mysql-notes/","summary":"\u003cp\u003e涵盖全部 MySQL 数据库的基础，MySQL 数据库的基础知识、数据表的常用操作及各种约束的使用，以及综合的运用各种命令实现记录进行 CURD 等操作。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eMySQL 安装与配置\u003c/li\u003e\n\u003cli\u003e数据类型\u003c/li\u003e\n\u003cli\u003e流程控制与运算符\u003c/li\u003e\n\u003cli\u003eDDL、DCL、DQL、DML\u003c/li\u003e\n\u003cli\u003e常用函数\u003c/li\u003e\n\u003cli\u003e表类型（存储引擎）\u003c/li\u003e\n\u003cli\u003e图形化工具\u003c/li\u003e\n\u003c/ul\u003e\n\u003c!-- more --\u003e\n\u003ch2 id=\"修改-mysql-提示符\"\u003e修改 MySQL 提示符\u003c/h2\u003e\n\u003cp\u003eMySQL 客户端的默认提示符是 \u003ccode\u003emysql\u0026gt;\u003c/code\u003e，基本上没什么实际作用。其实可以修改这个提示符，让它显示一些有用的信息，例如当前所在的数据库等。修改方法有四种，其中前两种只对当前连接有效，后两种则对所有连接有效。\u003c/p\u003e\n\u003ch3 id=\"连接客户端时通过参数指定\"\u003e连接客户端时通过参数指定\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003emysql --prompt\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;(\\u@\\h) [\\d]\u0026gt; \u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003ccode\u003emy.cnf\u003c/code\u003e\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode class=\"language-conf\" data-lang=\"conf\"\u003e[mysql]\nprompt=mysql(\\\\u@\\\\h:\\\\d)\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e这样提示符就会变成 \u003ccode\u003e(user@host) [database]\u0026gt;\u003c/code\u003e。其中常用的字符参数有：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003e\\D\u003c/code\u003e 完整的日期\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e\\d\u003c/code\u003e 当前数据库\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e\\h\u003c/code\u003e 服务器名称\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e\\u\u003c/code\u003e 当前用户\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e连接上客户端后，通过 \u003ccode\u003eprompt\u003c/code\u003e 命令修改\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sql\" data-lang=\"sql\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003eprompt\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"err\"\u003e\\\u003c/span\u003e\u003cspan class=\"n\"\u003eu\u003c/span\u003e\u003cspan class=\"o\"\u003e@\u003c/span\u003e\u003cspan class=\"err\"\u003e\\\u003c/span\u003e\u003cspan class=\"n\"\u003eh\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"err\"\u003e\\\u003c/span\u003e\u003cspan class=\"n\"\u003ed\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e在 MySQL 的配置文件中配置。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sql\" data-lang=\"sql\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003eprompt\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"err\"\u003e\\\\\u003c/span\u003e\u003cspan class=\"n\"\u003eu\u003c/span\u003e\u003cspan class=\"o\"\u003e@\u003c/span\u003e\u003cspan class=\"err\"\u003e\\\\\u003c/span\u003e\u003cspan class=\"n\"\u003eh\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"err\"\u003e\\\\\u003c/span\u003e\u003cspan class=\"n\"\u003ed\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"err\"\u003e\\\\\u003c/span\u003e\u003cspan class=\"n\"\u003e_\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e通过环境变量配置。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sql\" data-lang=\"sql\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003eexport\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eMYSQL_PS1\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;(\\u@\\h) [\\d]\u0026gt; \u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cblockquote\u003e\n\u003cp\u003e参考：\u003ca href=\"http://renial.iteye.com/blog/773675\"\u003ehttp://renial.iteye.com/blog/773675\u003c/a\u003e\u003c/p\u003e\u003c/blockquote\u003e\n\u003ch2 id=\"mysql-语法规范\"\u003eMySQL 语法规范\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e关键字和函数名称全部 \u003cstrong\u003e大写\u003c/strong\u003e\u003c/li\u003e\n\u003cli\u003e数据库名称，表名称，字段名称全部 \u003cstrong\u003e小写\u003c/strong\u003e\u003c/li\u003e\n\u003cli\u003eSQL 语句必须以 \u003cstrong\u003e分号结尾\u003c/strong\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"数据库操作\"\u003e数据库操作\u003c/h2\u003e\n\u003ch3 id=\"数据库创建create\"\u003e数据库创建：CREATE\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e语法：CREATE {DATABASE SCHEMA} [IF NOT EXISTS] db_name [DEFAULT] CHARACTER SET [=] charset_name\u003c/li\u003e\n\u003cli\u003eDATABASE 和 SCHEMA 是相同的，任选其一\u003c/li\u003e\n\u003cli\u003eIF NOT EXISTS:如果创建的数据库存在，则不只报出 warning，不写会报错\u003c/li\u003e\n\u003cli\u003eCHRARCTER SET utf8:为表设置编码方式，如果不设置则用 mysql 默认的编码方式\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"查看数据库列表show\"\u003e查看数据库列表：SHOW\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eSHOW { DATABASE SCHEMAS } [LIKE \u0026lsquo;pattern\u0026rsquo; WHERE expr]\u003c/li\u003e\n\u003cli\u003eSHOW CREATE DATABASE xx：显示 xx 数据库信息\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"数据库的修改alter\"\u003e数据库的修改：ALTER\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e修改数据库编码方式：ALTER { DATABASE SCHEMAS } [db_name][default] CHARACTER SET [=] charset_name\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"删除数据库drop\"\u003e删除数据库：DROP\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e删除数据库：DROP { DATABASE SCHEMAS } [IF EXISTS] db_name;\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sql\" data-lang=\"sql\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e--修改mysql操作符为当前日期\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"n\"\u003emysql\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003euroot\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003eproot\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eprompt\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"err\"\u003e\\\u003c/span\u003e\u003cspan class=\"n\"\u003eD\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"c1\"\u003e--展示所有数据库\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003eshow\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003edatabases\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"c1\"\u003e--创建数据库\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003ecreate\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003edatabase\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eif\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003enot\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eexists\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003et1\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nb\"\u003echaracter\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eset\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003egbk\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"c1\"\u003e--展示数据库t1的创建命令和编码形式\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003eshow\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003ecreate\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003edatabase\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003et1\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"c1\"\u003e--修改数据库编码格式\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003ealter\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003edatabase\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003et2\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nb\"\u003echaracter\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eset\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eutf8\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"c1\"\u003e--删除数据库\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003edrop\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003edatabase\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eif\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eexists\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003et1\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"c1\"\u003e--展示警告信息\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003eshow\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ewarnings\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"四数据类型\"\u003e四、数据类型\u003c/h2\u003e\n\u003cp\u003e\u003cimg alt=\"160731-imooc-mysql-tutorials-notes-int\" loading=\"lazy\" src=\"https://user-images.githubusercontent.com/9289792/80199388-d5776280-8653-11ea-9182-29a23e53ba50.png\"\u003e\u003c/p\u003e","title":"IMOOC 与MySQL的零距离接触"},{"content":"最近有需求使用 SSH 进行通信，而且要需免密码，总结了 SSH 密钥登陆免密码的方法。\n快速配置 本机 ip：192.168.1.1 服务器 ip：192.168.1.2 要实现本机免密码登录服务器，执行如下命令：\nssh-copy-id username@192.168.1.2 如果命令成功，则说明配置成功。如果执行失败，则需要参考下面的步骤进行配置。\n本地配置步骤 客户端生成公钥、私钥 ssh-keygen -t rsa -P \u0026#39;\u0026#39; -t 表示 key 的类型 -P 表示密码，-P '' 就表示空密码，也可以不用 -P 参数 运行完之后在 ~/.ssh 目录下生成私钥 id_rsa 和公钥 id_rsa.pub。\n将公钥添加到服务器 将客户端公钥 id_rsa.pub 写入到服务端 ~/.ssh/authorzied_keys 之中。\ncat ~/.ssh/id_rsa.pub 复制输出的内容，登陆服务端：\nvim ~/.ssh/authorized_keys 粘贴到最后一行。如果没有这个 authorzied_keys 文件，可以创建一个。\n设置文件权限 服务端，非必须。\nsudo chmod 755 ~/.ssh sudo chmod 600 ~/.ssh/authorized_keys 客户端重启服务 sudo service ssh restart 此时就可以不免密码登陆服务端了。\n以证书登录后 使用 sudo 操作 设置用户以证书登录后，使用 sudo 操作。在服务端设置：\nsudo visudo %sudo ALL=(ALL:ALL) ALL # 将上一行替换为： %sudo ALL=(ALL) NOPASSWD:ALL 类似 AWS PEM 配置方法 亚马逊 AWS 虚拟服务器使用一个预先生成的 *.pem 证书文件（密钥）为客户端和服务器之间建立连接。 例如：\nssh -i ~/ec2.pem ubuntu@12.34.56.78 首先确定你可以以密码的形式连接远程服务器，也可以 创建一个非超级管理员用户，并增加 sudo 权限。\nsudo ssh root@12.34.56.78 客户端生成验证没有密码密钥对 ssh-keygen -t rsa -b 2048 -v 执行上述命令首先会让你输入生成密钥的文件名：我这里输入的 myPemKey 之后一路回车。\nGenerating public/private rsa key pair. Enter file in which to save the key (/home/anonymouse/.ssh/id_rsa): myPemKey Enter passphrase (empty for no passphrase): Enter same passphrase again: Your identification has been saved in hetzner. Your public key has been saved in hetzner.pub. The key fingerprint is: bb:c6:9c:ee:6b:c0:67:58:b2:bb:4b:44:72:d3:cc:a5 localhost@localhost The key\u0026#39;s randomart image is: 在执行命令的当前目录下会生成一个 myPemKey.pub、myPemKey 两个文件。\n服务端添加公钥 把生成的 myPemKey.pub 通过本地命令推送到服务器端，使服务器自动添加认证这个证书\nssh-copy-id -i ~/myPemKey.pub root@12.34.56.78 输入你的 root 用户密码\n测试连接 sudo ssh -i ~/myPemKey root@12.34.56.78 或者把 myPemKey 重命名为 myPemKey.pem\nsudo ssh -i ~/myPemKey.pem root@12.34.56.78 禁用密码连接 注意：要保证 .pem 连接成功的状态下，禁用密码连接。\nsudo vi /etc/ssh/sshd_config 找到这一行 #PasswordAuthentication yes 取消前边的 # 注释，改为：\nPasswordAuthentication no 重启 ssh 服务\nsudo service ssh restart References 韩世磊-ubuntu 生成 .pem 证书连接服务器，取消 OpenSSH 密钥密码认证 韩世磊-ubuntu ssh 证书登录（不输入密码） \u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2016/07/29/linux-ssh-key-login-without-password/","summary":"\u003cp\u003e最近有需求使用 SSH 进行通信，而且要需免密码，总结了 SSH 密钥登陆免密码的方法。\u003c/p\u003e\n\u003ch2 id=\"快速配置\"\u003e快速配置\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e本机 ip：192.168.1.1\u003c/li\u003e\n\u003cli\u003e服务器 ip：192.168.1.2\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e要实现本机免密码登录服务器，执行如下命令：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003essh-copy-id username@192.168.1.2\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e如果命令成功，则说明配置成功。如果执行失败，则需要参考下面的步骤进行配置。\u003c/p\u003e\n\u003ch2 id=\"本地配置步骤\"\u003e本地配置步骤\u003c/h2\u003e\n\u003ch3 id=\"客户端生成公钥私钥\"\u003e客户端生成公钥、私钥\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003essh-keygen -t rsa -P \u003cspan class=\"s1\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cul\u003e\n\u003cli\u003e\u003ccode\u003e-t\u003c/code\u003e 表示 \u003ccode\u003ekey\u003c/code\u003e 的类型\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e-P\u003c/code\u003e 表示密码，\u003ccode\u003e-P ''\u003c/code\u003e 就表示空密码，也可以不用 \u003ccode\u003e-P\u003c/code\u003e 参数\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e运行完之后在 \u003ccode\u003e~/.ssh\u003c/code\u003e 目录下生成私钥 \u003ccode\u003eid_rsa\u003c/code\u003e 和公钥 \u003ccode\u003eid_rsa.pub\u003c/code\u003e。\u003c/p\u003e\n\u003ch3 id=\"将公钥添加到服务器\"\u003e将公钥添加到服务器\u003c/h3\u003e\n\u003cp\u003e将客户端公钥 \u003ccode\u003eid_rsa.pub\u003c/code\u003e 写入到服务端 \u003ccode\u003e~/.ssh/authorzied_keys\u003c/code\u003e 之中。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ecat ~/.ssh/id_rsa.pub\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e复制输出的内容，登陆服务端：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003evim ~/.ssh/authorized_keys\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e粘贴到最后一行。如果没有这个 \u003ccode\u003eauthorzied_keys\u003c/code\u003e 文件，可以创建一个。\u003c/p\u003e\n\u003ch3 id=\"设置文件权限\"\u003e设置文件权限\u003c/h3\u003e\n\u003cp\u003e服务端，非必须。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo chmod \u003cspan class=\"m\"\u003e755\u003c/span\u003e ~/.ssh\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo chmod \u003cspan class=\"m\"\u003e600\u003c/span\u003e ~/.ssh/authorized_keys\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"客户端重启服务\"\u003e客户端重启服务\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo service ssh restart\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e此时就可以不免密码登陆服务端了。\u003c/p\u003e\n\u003ch2 id=\"以证书登录后-使用-sudo-操作\"\u003e以证书登录后 使用 sudo 操作\u003c/h2\u003e\n\u003cp\u003e设置用户以证书登录后，使用 sudo 操作。在服务端设置：\u003c/p\u003e","title":"Linux SSH 密钥登陆免密码"},{"content":"主要涉及：JOIN 、JOIN 更新、GROUP BY HAVING 数据查重/去重。\nINNER INNER JOIN、LEFT JOIN、RIGHT JOIN、FULL JOIN(MySQL 不支持)、CROSS JOIN\n这是在网上找到的非常好的一篇博文，图解 JOIN 语句：\nCODING HORROR-A Visual Explanation of SQL Joins\n下图可以很清楚的明白，JOIN 的数据选取范围：\n更新使用过滤条件中包括本身的表 更新 t1 t2 表中 col_a 重复的字段：\nUPDATE t1 SET col_a = \u0026#39;hi\u0026#39; WHERE t1.col_a IN ( SELECT b.col_a FROM t1 a INNER JOIN t2 b on a.col_a = b.col_a ) ; ERROR:1093 可转换为：\nUPDATE t1 aa JOIN( SELECT b.col_a FROM t1 a INNER JOIN t2 b on a.col_a = b.col_a )bb on aa.col_a= bb.col_a SET col_a = \u0026#39;hi\u0026#39; ; 查询重复数据、删除重复数据 利用 GROUP BY 和 HAVING 查询重复数据：\nSELECT col_a, COUNT(*) FROM t1 GROUP BY col_a HAVING COUNT(*) \u0026gt; 1 ; 删除重复数据，对于相同数据保留 ID 最大的：\nDELETE a FROM t1 a JOIN ( SELECT col_a,COUNT(*),MAX(id) AS id FROM t1 GROUP BY col_a HAVING COUNT(*) \u0026gt; 1 )b ON a.col_a = b.col_a WHERE a.id \u0026lt; b.id ; \u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2016/07/25/imooc-mysql-development-skills-notes/","summary":"\u003cp\u003e主要涉及：JOIN 、JOIN 更新、GROUP BY HAVING 数据查重/去重。\u003c/p\u003e\n\u003c!-- more --\u003e\n\u003ch2 id=\"inner\"\u003eINNER\u003c/h2\u003e\n\u003cp\u003eINNER JOIN、LEFT JOIN、RIGHT JOIN、FULL JOIN(MySQL 不支持)、CROSS JOIN\u003c/p\u003e\n\u003cp\u003e这是在网上找到的非常好的一篇博文，图解 JOIN 语句：\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ca href=\"https://blog.codinghorror.com/a-visual-explanation-of-sql-joins/\"\u003eCODING HORROR-A Visual Explanation of SQL Joins\u003c/a\u003e\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003e下图可以很清楚的明白，JOIN 的数据选取范围：\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"160725-imooc-mysql-development-skills-notes-001\" loading=\"lazy\" src=\"https://user-images.githubusercontent.com/9289792/80199172-9d701f80-8653-11ea-8d20-498f54e41708.png\"\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"160725-imooc-mysql-development-skills-notes-002\" loading=\"lazy\" src=\"https://user-images.githubusercontent.com/9289792/80199188-9fd27980-8653-11ea-9386-e76dca7b4d0c.jpeg\"\u003e\u003c/p\u003e\n\u003ch2 id=\"更新使用过滤条件中包括本身的表\"\u003e更新使用过滤条件中包括本身的表\u003c/h2\u003e\n\u003cp\u003e更新 \u003ccode\u003et1\u003c/code\u003e \u003ccode\u003et2\u003c/code\u003e 表中 \u003ccode\u003ecol_a\u003c/code\u003e 重复的字段：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sql\" data-lang=\"sql\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eUPDATE\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003et1\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003eSET\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ecol_a\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;hi\u0026#39;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003eWHERE\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003et1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecol_a\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eIN\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"k\"\u003eSELECT\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eb\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecol_a\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"k\"\u003eFROM\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003et1\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ea\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eINNER\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eJOIN\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003et2\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eb\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eon\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"n\"\u003ea\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecol_a\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eb\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecol_a\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"n\"\u003eERROR\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"mi\"\u003e1093\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e可转换为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sql\" data-lang=\"sql\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eUPDATE\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003et1\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eaa\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eJOIN\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"k\"\u003eSELECT\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eb\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecol_a\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"k\"\u003eFROM\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003et1\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ea\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eINNER\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eJOIN\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003et2\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eb\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eon\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"n\"\u003ea\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecol_a\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eb\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecol_a\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"n\"\u003ebb\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eon\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eaa\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecol_a\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ebb\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecol_a\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003eSET\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ecol_a\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;hi\u0026#39;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"查询重复数据删除重复数据\"\u003e查询重复数据、删除重复数据\u003c/h2\u003e\n\u003cp\u003e利用 \u003ccode\u003eGROUP BY\u003c/code\u003e 和 \u003ccode\u003eHAVING\u003c/code\u003e 查询重复数据：\u003c/p\u003e","title":"IMOOC MySQL开发技巧"},{"content":"还是越来越觉的思想重要。每周给自己博客的计划是写三篇，稍稍改动下：其中一篇要是关于思想上的。\n周末的时候和北京的朋友们：龙、梦、思，小聚了下。问起毕业一个月感觉有啥变化，都说没啥。是，刚刚才一个月。可我心里却有些小慌张，总想搞个大新闻，让自己不那么平凡。是眼高手低吗？\n现在每天都会跑跑步，已经坚持了 6 天了也习惯了，挺赞的。也总是去了解新鲜的东西技术，并且尝试运用它们，才有点原来学长们不喜欢用用过的东西做事情的劲。关于英语的学习，现在找到一个法：阅读英文的技术教程或者技术文档。这些东西肯定和计算机有关，也写的比较通俗，感觉挺有收获的。\n最近状态还不错，就是晚上想看会书，可眼睛挺累的。职业生涯的第一个月，经济有些困难。想参与个开源项目。现在手头项目就自己一个人在编，有点孤独，也不知道自己设计的和写的哪里好哪里不好。还有就是在 GitHub 或者 StackOverflow 有人给自己点赞，感觉挺激动的。\n因为公司都是 Google 的服务，出门很方便，GitHub 也用的越来越多。时不时总能搜到、看到很多工程师写的博客，有教程、有分享，还有我最喜欢看的：他们的思想。我觉的他们现在都是比我棒的，我想知道他们是怎么想的、怎么解决问题、怎么看待问题、看待工作生活。\n最后毒奶一口自己：\n与那些名校的同学的差距不是毕业后的薪水，也不是学业水平的差距，而是一种思维方式与做事标准。 对自己的标准会不由自主的降低以适应这个环境，减少自身与环境的冲突，在一个低标准下，自觉“满意”的度过每一天。 为什么名企喜欢要名校的学生？其实名企要的不是多么高的 GPA 成绩，而是一种内在的精神状态。他们的辛苦不叫辛苦，也不为百万年薪。辛苦是他们获得自我实现的途径，自我是实现使他无穷快乐。这世界就是一拨人在昼夜不停的高速运转，另一拨人起床发现世界变了。 我们大部分人的工作和生活状态是怎样的呢？ 上班稍微努力点就开始讲究公平，自己不得志就开始抱怨公司和领导，下班后看几页书就觉得自己特别上进，辛苦上几天就觉得自己要赶紧去享受一下生活了，加几天班就担心自己会过劳死。 遇到些鸡毛蒜皮的小事儿就郁郁寡欢，仿佛遇到了天大的人生难题磨磨唧唧解决不清。看见牛逼的人也会心生羡慕，但总也突破不了努力却总不得要领魔咒。 越能干，越努力；越有钱，越上进 而造成这一切的差异，最主要的来自人的精神内核。 你要用牛人的标准要求自己，不断的走到牛人当中去，拉近和牛人之间的距离。当你觉得自己能够成为他们中的一员的时候，你才能成为了真正的牛人。\n成功？我才刚上路呢。\n\u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2016/07/11/write-some-humanities-diary/","summary":"\u003cp\u003e还是越来越觉的思想重要。每周给自己博客的计划是写三篇，稍稍改动下：其中一篇要是关于思想上的。\u003c/p\u003e\n\u003cp\u003e周末的时候和北京的朋友们：龙、梦、思，小聚了下。问起毕业一个月感觉有啥变化，都说没啥。是，刚刚才一个月。可我心里却有些小慌张，总想搞个大新闻，让自己不那么平凡。是眼高手低吗？\u003c/p\u003e\n\u003c!-- more --\u003e\n\u003cp\u003e现在每天都会跑跑步，已经坚持了 6 天了也习惯了，挺赞的。也总是去了解新鲜的东西技术，并且尝试运用它们，才有点原来学长们不喜欢用用过的东西做事情的劲。关于英语的学习，现在找到一个法：阅读英文的技术教程或者技术文档。这些东西肯定和计算机有关，也写的比较通俗，感觉挺有收获的。\u003c/p\u003e\n\u003cp\u003e最近状态还不错，就是晚上想看会书，可眼睛挺累的。职业生涯的第一个月，经济有些困难。想参与个开源项目。现在手头项目就自己一个人在编，有点孤独，也不知道自己设计的和写的哪里好哪里不好。还有就是在 GitHub 或者 StackOverflow 有人给自己点赞，感觉挺激动的。\u003c/p\u003e\n\u003cp\u003e因为公司都是 Google 的服务，出门很方便，GitHub 也用的越来越多。时不时总能搜到、看到很多工程师写的博客，有教程、有分享，还有我最喜欢看的：他们的思想。我觉的他们现在都是比我棒的，我想知道他们是怎么想的、怎么解决问题、怎么看待问题、看待工作生活。\u003c/p\u003e\n\u003cp\u003e最后毒奶一口自己：\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e与那些名校的同学的差距不是毕业后的薪水，也不是学业水平的差距，而是一种思维方式与做事标准。\n对自己的标准会不由自主的降低以适应这个环境，减少自身与环境的冲突，在一个低标准下，自觉“满意”的度过每一天。\n \n为什么名企喜欢要名校的学生？其实名企要的不是多么高的 GPA 成绩，而是一种内在的精神状态。他们的辛苦不叫辛苦，也不为百万年薪。辛苦是他们获得自我实现的途径，自我是实现使他无穷快乐。这世界就是一拨人在昼夜不停的高速运转，另一拨人起床发现世界变了。\n \n我们大部分人的工作和生活状态是怎样的呢？\n上班稍微努力点就开始讲究公平，自己不得志就开始抱怨公司和领导，下班后看几页书就觉得自己特别上进，辛苦上几天就觉得自己要赶紧去享受一下生活了，加几天班就担心自己会过劳死。\n遇到些鸡毛蒜皮的小事儿就郁郁寡欢，仿佛遇到了天大的人生难题磨磨唧唧解决不清。看见牛逼的人也会心生羡慕，但总也突破不了努力却总不得要领魔咒。\n \n越能干，越努力；越有钱，越上进\n而造成这一切的差异，最主要的来自人的精神内核。\n \n你要用牛人的标准要求自己，不断的走到牛人当中去，拉近和牛人之间的距离。当你觉得自己能够成为他们中的一员的时候，你才能成为了真正的牛人。\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003e成功？我才刚上路呢。\u003c/p\u003e\n\u003cp\u003e\u0026ndash; EOF \u0026ndash;\u003c/p\u003e","title":"写一些人文的日志"},{"content":"新项目部署上线，主要参考 世雷博客 的内容，自己也总结了下。从 JDK 安装、Web 容器、数据库，都有涉及比较全面。\nJDK8 安装 JDK8 1、添加软件源\nsudo add-apt-repository ppa:webupd8team/java 2、更新软件源\nsudo apt-get update 3、安装 jdk1.8\nsudo apt-get install oracle-java8-installer 查看 Java 安装路径 sudo update-alternatives --config java sudo update-alternatives --config javac 查看 Java 安装后的版本 java -version （扩展）增加多版本 JDK 和切换方法 1、安装 JDK 6 和 JDK 7\nsudo apt-get install oracle-java6-installer sudo apt-get install oracle-java7-installer 2、查看所有 JDK 安装版本\nsudo update-java-alternatives -l java-6-oracle 3 /usr/lib/jvm/java-6-oracle java-7-oracle 4 /usr/lib/jvm/java-7-oracle java-8-oracle 2 /usr/lib/jvm/java-8-oracle 3、通过 -s 参数可以方便的切换到其它的 JDK 版本\nsudo update-java-alternatives -s java-6-oracle sudo update-java-alternatives -s java-7-oracle sudo update-java-alternatives -s java-8-oracle 4、再次查看 JDK 版本\njava -version java version \u0026#34;1.6.0_45\u0026#34; Java(TM) SE Runtime Environment (build 1.6.0_45-b06) Java HotSpot(TM) 64-Bit Server VM (build 20.45-b01, mixed mode) Nginx Nginx 安装 1、更新软件源\nsudo apt-get update 2、安装 Nginx\nsudo apt-get install nginx 3、查看 Nginx 位置\nwhereis nginx Nginx 禁止外网访问 防止 Google 收录\nsudo vi /etc/nginx/sites-enabled/default 在 server 中添加\n# server add # 公司代理IP allow *.*.*.*; deny all; Nginx 域名调整 域名 www 跳转 non www，server 中添加配置\nserver_name www.aaa.org aaa.org; if ($host != \u0026#39;aaa.org\u0026#39;){ rewrite ^/(.*)$ http://aaa.org/$1 permanent; } Nginx GZip ## # Gzip Settings ## gzip on; gzip_disable \u0026#34;msie6\u0026#34;; gzip_vary on; gzip_min_length 1k; gzip_proxied any; gzip_comp_level 6; gzip_buffers 16 8k; gzip_http_version 1.1; gzip_types text/plain text/css application/json application/x-javascript text/xml application/xml application/xml+rss text/javascript application/x-httpd-php image/jpeg image/gif image/png image/x-icon Nginx 静态文件缓存 location ~*\\.(gif|jpg|jpeg|png|bmp|swf|woff|icon)$ { proxy_cache my_zone; proxy_cache_bypass $http_cache_control; proxy_cache_valid 200 1d; add_header X-Proxy-Cache $upstream_cache_status; expires 15d; } location ~ .*\\.(js|css|ttf)$ { proxy_cache my_zone; proxy_cache_bypass $http_cache_control; proxy_cache_valid 200 1d; add_header X-Proxy-Cache $upstream_cache_status; expires 15d; } 静态文件放在配置的 root 下\nroot /opt/***; 还有个技巧，项目中大量资源文件，例如 PDF，在设计访问 url 时可以 **/pdf/**，这样在 Nginx 进行配置就可以将文件分离出项目；这些文件也放在 root 路径下。\nlocation ^~ /html/ { } location ^~ /pdf/ { } Nginx Commands sudo service nginx stop sudo service nginx start sudo service nginx restart Nginx Show Log sudo tail -f /var/log/nginx/error.log WildFly 10.0.0.Final WildFly 安装 1、下载 WildFly，并提取到 /opt 目录 WildFly 10.0.0.Final 下载地址\ncd /opt sudo wget -c http://download.jboss.org/wildfly/10.0.0.Final/wildfly-10.0.0.Final.tar.gz sudo tar -xzvf wildfly-10.0.0.Final.tar.gz 2、创建 WildFly 用户和组\nsudo addgroup wildfly sudo useradd -g wildfly wildfly 改变 wildfly 文件夹的所有权：\nsudo chown -R wildfly:wildfly /opt/wildfly-10.0.0.Final 创建一个链接映射（好处：如果你改变 WildFly 版本,不需要更新其他配置）\nsudo ln -s wildfly-10.0.0.Final /opt/wildfly 3、安装 init.d 脚本 设置并使用 init.d 脚本来启动和停止 WildFly。复制/opt/wildfly/bin/init.d/wildfly-init-debian.sh脚本到 /etc/init.d/wildfly，更改权限,并使其可执行\nsudo cp /opt/wildfly/docs/contrib/scripts/init.d/wildfly-init-debian.sh /etc/init.d/wildfly sudo chown root:root /etc/init.d/wildfly sudo chmod ug+x /etc/init.d/wildfly 启动/停止 WildFly 命令\nsudo /etc/init.d/wildfly start sudo /etc/init.d/wildfly stop 4、WildFly 做为系统服务，开机启动\nsudo update-rc.d wildfly defaults 配置 WildFly 允许所有 ip 访问 1、打开配置文件 standalone.xml\nsudo vi /opt/wildfly/standalone/configuration/standalone.xml 2、替换此处\n\u0026lt;interface name=\u0026#34;management\u0026#34;\u0026gt; \u0026lt;inet-address value=\u0026#34;${jboss.bind.address.management:127.0.0.1}\u0026#34;/\u0026gt; \u0026lt;/interface\u0026gt; \u0026lt;interface name=\u0026#34;public\u0026#34;\u0026gt; \u0026lt;inet-address value=\u0026#34;${jboss.bind.address:0.0.0.0}\u0026#34;/\u0026gt; \u0026lt;/interface\u0026gt; 改为\n\u0026lt;interface name=\u0026#34;management\u0026#34;\u0026gt; \u0026lt;any-address/\u0026gt; \u0026lt;/interface\u0026gt; \u0026lt;interface name=\u0026#34;public\u0026#34;\u0026gt; \u0026lt;any-address/\u0026gt; \u0026lt;/interface\u0026gt; 3、保存后，重新启动 WildFily\nsudo service wildfly restart 删除默认欢迎内容（可选） 如果你部署了应用程序在上下文根目录里，欢迎你 将需要从 WildFly 配置删除默认内容。在 standalone.xml 文件里删除粗体突出显示的行\n\u0026lt;server name=\u0026#34;default-server\u0026#34;\u0026gt; \u0026lt;http-listener name=\u0026#34;default\u0026#34; socket-binding=\u0026#34;http\u0026#34;/\u0026gt; \u0026lt;host name=\u0026#34;default-host\u0026#34; alias=\u0026#34;localhost\u0026#34;\u0026gt; **\u0026lt;!-- \u0026lt;location name=\u0026#34;/\u0026#34; handler=\u0026#34;welcome-content\u0026#34;/\u0026gt; --\u0026gt;** \u0026lt;filter-ref name=\u0026#34;server-header\u0026#34;/\u0026gt; \u0026lt;filter-ref name=\u0026#34;x-powered-by-header\u0026#34;/\u0026gt; \u0026lt;/host\u0026gt; \u0026lt;/server\u0026gt; \u0026lt;handlers\u0026gt; **\u0026lt;!-- \u0026lt;file name=\u0026#34;welcome-content\u0026#34; path=\u0026#34;${jboss.home.dir}/welcome-content\u0026#34;/\u0026gt; --\u0026gt;** \u0026lt;/handlers\u0026gt; 其它设置 改为可以修改 JSP 页面不用重启\n\u0026lt;servlet-container name=\u0026#34;default\u0026#34;\u0026gt; \u0026lt;jsp-config development=\u0026#34;true\u0026#34;/\u0026gt; \u0026lt;/servlet-container\u0026gt; 注意事项 1、项目以站点根目录访问 你现在可以将应用程序部署到 WildFly 视图在 your_ip:8080 在你的项目目录 WEB-INF 下添加 jboss-web.xml，确保你的配置 context-root 设置为 /\n\u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;UTF-8\u0026#34;?\u0026gt; \u0026lt;jboss-web\u0026gt; \u0026lt;context-root\u0026gt;/\u0026lt;/context-root\u0026gt; \u0026lt;/jboss-web\u0026gt; 2、Linux 里设置端口 80 到 8080 注意：在之后的配置会使用 Nginx 反向代理，所用 WildFly 端口不用映射为 80，这里只是个方法的笔记\n注意，在 linux 里，由于内核的限制，普通用户不能使用 1024 一下的端口。所以在配置文件（standalone.xml）里改成 80，用普通用户是启动不了的。\n此时，我们需要在 linux 下使用 root 用户运行一个命令，使访问 80 端口的应用转到 8080 上：\nsudo iptables -t nat -A PREROUTING -p tcp --dport 80 -j REDIRECT --to-ports 8080 以上端口转发为临时操作，重启 linux 服务器后失效。如果要重启服务器不丢失 FORWARD 转发”操作，可写入配置。\n在 Linux 的下面部署了 tomcat，为了安全我们使用非 root 用户进行启动，但是在域名绑定时无法直接访问 80 端口号。众所周知，在 unix 下，非 root 用户不能监听 1024 以上的端口号，这个 tomcat 服务器就没办法绑定在 80 端口下。所以这里需要使用 linux 的端口转发机制，把到 80 端口的服务请求都转到 8080 端口上。\n2.1、安装 iptables-persistent\nsudo apt-get update sudo apt-get install iptables-persistent 2.2、添加 80 端口跳转到 8080 规则\nsudo iptables -t nat -A PREROUTING -p tcp --dport 80 -j REDIRECT --to-port 8080 2.3、保存跳转规则\nsudo service iptables-persistent save 3、wildfly 不支持 struts2 的配置文件（.xml）里用通配符 这是原博文的内容，我没有使用 struts2；在 spring 中有用通配符，但是好像没什么影响 jboss wildfly 不支持 struts2 配置文件里用通配符 *.xml，如下：\n\u0026lt;!-- \u0026lt;include file=\u0026#34;struts/*.xml\u0026#34;\u0026gt;\u0026lt;/include\u0026gt; --\u0026gt; \u0026lt;include file=\u0026#34;struts/struts_post.xml\u0026#34;\u0026gt;\u0026lt;/include\u0026gt; \u0026lt;include file=\u0026#34;struts/struts_user.xml\u0026#34;\u0026gt;\u0026lt;/include\u0026gt; 4、增加部署扫描仪的超时设置 位置：\n\u0026lt;subsystem xmlns=\u0026#34;urn:jboss:domain:deployment-scanner:2.0\u0026#34;\u0026gt; \u0026lt;deployment-scanner path=\u0026#34;deployments\u0026#34; relative-to=\u0026#34;jboss.server.base.dir\u0026#34; scan-interval=\u0026#34;5000\u0026#34; /\u0026gt; \u0026lt;/subsystem\u0026gt; \u0026lt;deployment-scanner\u0026gt; 内增加属性 deployment-timeout=\u0026quot;1200\u0026quot; 如下：\n\u0026lt;subsystem xmlns=\u0026#34;urn:jboss:domain:deployment-scanner:2.0\u0026#34;\u0026gt; \u0026lt;deployment-scanner path=\u0026#34;deployments\u0026#34; relative-to=\u0026#34;jboss.server.base.dir\u0026#34; scan-interval=\u0026#34;5000\u0026#34; deployment-timeout=\u0026#34;1200\u0026#34; /\u0026gt; \u0026lt;/subsystem\u0026gt; Nginx 反向代理 WildFly 1、在 http 中添加\nupstream jboss { server 127.0.0.1:8080; } 2、在 server 中修改\nlocation /{ proxy_pass http://jboss; proxy_redirect off; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; proxy_set_header X-Real-IP $remote_addr; proxy_set_header Host $http_host; index index.html index.htm index.jsp; # 动态网站要小心这个 缓存 选项 add_header Cache-Control max-age=1728000; } MySQL MySQL5.6 安装 sudo apt-get install mysql-server-5.6 MySQL 创建数据库 CREATE DATABASE IF NOT EXISTS scrapy DEFAULT CHARSET utf8 COLLATE utf8_general_ci; MySQL 数据库导出/导入 mysqldump -u root -p123456 db_name | gzip \u0026gt; /home/backup/db_name.sql.gz mysqldump -u root -p123456 --all-databases | gzip \u0026gt; /home/backup/all.sql.gz mysqldump -h192.168.1.100 -uroot -p db_name \u0026gt; db_name.sql mysqldump -uroot -p db_name_1 db_name_2 \u0026gt; db_name_1_and_2.sql gunzip \u0026lt; db_name.sql.gz | mysql -u root -p123456 db_name gunzip \u0026lt; all.sql.gz | mysql -u root -p123456 mysql -uroot -p show databases; use db_name; source ~/db_name.sql MySQL 查看表结构 desc user Project robots.txt config 禁止所有爬虫爬取 User-agent: * Disallow: / Renferences 韩世雷-ubuntu 配置 java jdk1.8 环境，增加多版本 jdk 和切换方法 韩世雷-ubuntu14.04 Terminal 配置 wildfly-10.0.0.Final 服务器 韩世雷-Ubuntu14.04 配置 iptables 把 80 端口转到 8080 ","permalink":"https://zyf.im/2016/07/07/ubuntu-jdk-nginx-wildfly-mysql-config/","summary":"\u003cp\u003e新项目部署上线，主要参考 \u003ca href=\"http://blog.csdn.net/hanshileiai\"\u003e世雷博客\u003c/a\u003e 的内容，自己也总结了下。从 JDK 安装、Web 容器、数据库，都有涉及比较全面。\u003c/p\u003e\n\u003ch2 id=\"jdk8\"\u003eJDK8\u003c/h2\u003e\n\u003ch3 id=\"安装-jdk8\"\u003e安装 JDK8\u003c/h3\u003e\n\u003cp\u003e1、添加软件源\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo add-apt-repository ppa:webupd8team/java\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e2、更新软件源\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo apt-get update\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e3、安装 jdk1.8\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo apt-get install oracle-java8-installer\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"查看-java-安装路径\"\u003e查看 Java 安装路径\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo update-alternatives --config java\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo update-alternatives --config javac\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"查看-java-安装后的版本\"\u003e查看 Java 安装后的版本\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ejava -version\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"扩展增加多版本-jdk-和切换方法\"\u003e（扩展）增加多版本 JDK 和切换方法\u003c/h3\u003e\n\u003cp\u003e1、安装 JDK 6 和 JDK 7\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo apt-get install oracle-java6-installer\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo apt-get install oracle-java7-installer\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e2、查看所有 JDK 安装版本\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo update-java-alternatives -l\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ejava-6-oracle \u003cspan class=\"m\"\u003e3\u003c/span\u003e /usr/lib/jvm/java-6-oracle\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ejava-7-oracle \u003cspan class=\"m\"\u003e4\u003c/span\u003e /usr/lib/jvm/java-7-oracle\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ejava-8-oracle \u003cspan class=\"m\"\u003e2\u003c/span\u003e /usr/lib/jvm/java-8-oracle\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e3、通过 \u003ccode\u003e-s\u003c/code\u003e 参数可以方便的切换到其它的 JDK 版本\u003c/p\u003e","title":"Ubuntu JDK Nginx WildFly MySQL 环境配置"},{"content":"在 GitHub Pages 不被百度收录解决方案 中，思路二是通过 Dnspod 的智能 DNS 服务。简而言之就是搭建一个 Server，做一个 Blog 的镜像站，专为百度收录使用。\n但是每次将新建的博客文章 PUSH 到 GitHub 后，还要再登陆 Server PULL 一下，简直是太蠢了。那有什么解决办法吗？答：GitHub Webhook。\nWebhook Webhook，也就是人们常说的钩子，是一个很有用的工具。你可以通过定制 Webhook 来监测你在 Github.com 上的各种事件，最常见的莫过于 push 事件。\n如果你设置了一个监测 push 事件的 Webhook，那么每当你的这个项目有了任何提交，这个 Webhook 都会被触发，这时 Github 就会发送一个 HTTP POST 请求到你配置好的地址。\n如此一来，你就可以通过这种方式去自动完成一些重复性工作；比如，你可以用 Webhook 来自动触发一些持续集成（CI）工具的运作，比如 Travis CI；又或者是通过 Webhook 去部署你的线上服务器。\nGithub 开发者平台的文档中对 Webhook 的所能做的事是这样描述的：\nYou’re only limited by your imagination.\n响应 Webhook 在参考文章里博主是使用 Node.js 编写的服务端响应代码，但考虑到自己对 Node.js 不熟悉，还要部署环境，所以改用 Python 语言编写响应代码。\n自己在 GitHub 搜索下 github webhook，language 选择 Python 便找到了 Python 编写的：razius/github-webhook-handler\n自己的 VPS 是在 Bandwagon Host 上购买的，最合适的配置：\nSelf-managed service SSD: 10 GB RAM: 512 MB CPU: 1x Intel Xeon BW: 1000 GB/mo Link speed: 1 Gigabit VPS technology: OpenVZ/KiwiVM Linux OS: 32-bit and 64-bit Centos, Debian, Ubuntu, Fedora 费用：\n$2.99 USD Monthly $7.99 USD Quarterly $12.99 USD Semi-Annually $19.99 USD Annually Bandwagon Host 支持支付宝付款很是方便，优惠码：IAMSMART52J3NC 再打个 9.5 折左右。这配置有时会 (out of stock) 等等随缘会有的。\n安装 Git apt-get update apt-get install git clone razius/github-webhook-handler git clone https://github.com/razius/github-webhook-handler.git 根据 github-webhook-handler Gettings started:\nInstallation Requirements Install dependencies found in requirements.txt\npip install -r requirements.txt Repository Configuration Edit repos.json to configure repositories, each repository must be registered under the form GITHUB_USER/REPOSITORY_NAME.\n{ \u0026#34;razius/puppet\u0026#34;: { \u0026#34;path\u0026#34;: \u0026#34;/home/puppet\u0026#34;, \u0026#34;key\u0026#34;: \u0026#34;MyVerySecretKey\u0026#34;, \u0026#34;action\u0026#34;: [[\u0026#34;git\u0026#34;, \u0026#34;pull\u0026#34;, \u0026#34;origin\u0026#34;, \u0026#34;master\u0026#34;]] }, \u0026#34;d3non/somerandomexample/branch:live\u0026#34;: { \u0026#34;path\u0026#34;: \u0026#34;/home/exampleapp\u0026#34;, \u0026#34;key\u0026#34;: \u0026#34;MyVerySecretKey\u0026#34;, \u0026#34;action\u0026#34;: [[\u0026#34;git\u0026#34;, \u0026#34;pull\u0026#34;, \u0026#34;origin\u0026#34;, \u0026#34;live\u0026#34;], [\u0026#34;echo\u0026#34;, \u0026#34;execute\u0026#34;, \u0026#34;some\u0026#34;, \u0026#34;commands\u0026#34;, \u0026#34;...\u0026#34;]] } } 过程如果出现：pip: command not found 可以执行：\nsudo apt-get install python-pip Set environment variable for the repos.json config export REPOS_JSON_PATH=/path/to/repos.json Start the server python index.py 80 clone and pull your Blog git clone git@github.com:imzyf/imzyf.github.io.git git pull origin master 过程如果出现：Permission denied (publickey). 可以参考：\nStack Overflow-Git - Permission denied (publickey) cd ~/.ssh \u0026amp;\u0026amp; ssh-keygen cat id_rsa.pub | xclip 然后添加到你的 GitHub 账户：Settings -\u0026gt; SSH keys 中。\nconfig imzyf.github.io Webhooks 首先进入你的 repo 主页，通过点击页面上的按钮 [settings] -\u0026gt; [Webhooks \u0026amp; service] 进入 Webhooks 配置主页面。也可以通过下面这个链接直接进入配置页面：\nhttps://github.com/[ 用户名 ]/[ 仓库名称 ]/settings/hooks 此处只需要配置 Webhook 所发出的 POST 请求发往何处即可，于是我们就配置我们所需要的路径： http://104.236.xxx.xxx:9988/deploy/。这个地址指向的就是那个能够响应 Webhook 所发出请求的服务器。\n配置好 Webhook 后，Github 会发送一个 ping 来测试这个地址。如果成功了，那么这个 Webhook 前就会加上一个绿色的勾；如果你得到的是一个红色的叉，那就好好检查一下哪儿出问题了吧！\nconfig Nginx server 最后想说的 为了一个百度收录大可不必这么麻烦，刚刚查到这些解决方案时心里也是烦的、虚的，但还是硬的头皮搞了。过程中已经不单单是为了百度收录自己的博客，而是变成学习了东西、思考问题。这些解决方案网上都有，也不是自己创造的，但是别人的东西自己不尝试，就还是别人的。\n现在百度已经收录我的博客了，imzyf.github.io 到 Server 也是自动部署的。解决问题后的快乐和信心，才是我这次最大的收获。\nReferences jerryzou-Webhook 实践 —— 自动部署 ","permalink":"https://zyf.im/2016/07/01/github-webhook-example/","summary":"\u003cp\u003e在 \u003ca href=\"/2016/06/30/github-pages-forbidden-baiduspide-solution/\"\u003eGitHub Pages 不被百度收录解决方案\u003c/a\u003e 中，思路二是通过 Dnspod 的智能 DNS 服务。简而言之就是搭建一个 Server，做一个 Blog 的镜像站，专为百度收录使用。\u003c/p\u003e\n\u003cp\u003e但是每次将新建的博客文章 \u003ccode\u003ePUSH\u003c/code\u003e 到 GitHub 后，还要再登陆 Server \u003ccode\u003ePULL\u003c/code\u003e 一下，简直是太蠢了。那有什么解决办法吗？答：GitHub Webhook。\u003c/p\u003e\n\u003c!-- more --\u003e\n\u003ch2 id=\"webhook\"\u003eWebhook\u003c/h2\u003e\n\u003cp\u003eWebhook，也就是人们常说的钩子，是一个很有用的工具。你可以通过定制 Webhook 来监测你在 Github.com 上的各种事件，最常见的莫过于 push 事件。\u003c/p\u003e\n\u003cp\u003e如果你设置了一个监测 push 事件的 Webhook，那么每当你的这个项目有了任何提交，这个 Webhook 都会被触发，这时 Github 就会发送一个 HTTP POST 请求到你配置好的地址。\u003c/p\u003e\n\u003cp\u003e如此一来，你就可以通过这种方式去自动完成一些重复性工作；比如，你可以用 Webhook 来自动触发一些持续集成（CI）工具的运作，比如 Travis CI；又或者是通过 Webhook 去部署你的线上服务器。\u003c/p\u003e\n\u003cp\u003eGithub 开发者平台的文档中对 Webhook 的所能做的事是这样描述的：\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eYou’re only limited by your imagination.\u003c/p\u003e\u003c/blockquote\u003e\n\u003ch2 id=\"响应-webhook\"\u003e响应 Webhook\u003c/h2\u003e\n\u003cp\u003e在参考文章里博主是使用 Node.js 编写的服务端响应代码，但考虑到自己对 Node.js 不熟悉，还要部署环境，所以改用 Python 语言编写响应代码。\u003c/p\u003e\n\u003cp\u003e自己在 GitHub 搜索下 \u003ccode\u003egithub webhook\u003c/code\u003e，\u003ccode\u003elanguage\u003c/code\u003e 选择 \u003ccode\u003ePython\u003c/code\u003e 便找到了 Python 编写的：\u003ca href=\"https://github.com/razius/github-webhook-handler\"\u003erazius/github-webhook-handler\u003c/a\u003e\u003c/p\u003e","title":"GitHub Webhook 自动部署 Hexo"},{"content":"2019-12-02 更新：现在我的 Blog 还是用的 GitHub Pages，反正没有备案的域名不会被百度收录。\n2017-04-22 更新：现在我的 Blog 使用的是 UFOVPS 直接部署的。\n在 使用 Hexo 和 Github 搭建个人独立博客 几天后，发现百度并不对博客进行收录。\n在天朝使用百度搜索毕竟多数，使用百度站长工具-抓取诊断，在百度 Spider 抓取结果返回 HTTP 头：HTTP/1.1 403 Forbidden，原来是 GitHub 禁止了百度爬虫的爬去。\nGoogle 后早已有许多热心网友给出了解决方案，自己在这里总结下。\n思路一：利用 CDN 解决百度爬虫被 Github Pages 拒绝的问题 解决思路 既然 Github 彻底和百度决裂了，那我们也只能自己动手来解决了。Github 可能是封了百度的 IP，也有可能是封了百度爬虫的 User-Agent。\n所以要解决这个问题，最好就不要让百度爬虫直接访问 Github 了，需要在中间套一层 反向代理。\n那么问题又来了，既然我可以搭一个反向代理服务器了，那我为什么不直接把博客放在这台服务器上？放 Github Pages 上不就是为了少一台服务器，少一点费用吗？\n那有没有免费的第三方反向代理服务呢？当然有，其实现在各种 CDN 服务 不就是吗？而且还额外提供了各种网络环境下的加速功能。\n但是使用 CDN 也会有一个非常大的缺点：只能对 静态资源 做，因为 CDN 和反向代理有一个很大的不同就是：它会做缓存，并向各个节点分发。\n所以 CDN 一般都是用来给静态资源做加速的。如果你对动态页面做加速，用户看到的页面在一段时间内就一直不会变了。但是我们不怕！因为 Github Pages 本来就是全静态的！\n国内提供 CDN 服务的有：加速乐、七牛云存储、又拍云等。\n最后选择了 又拍云\nCDN 回源配置\n有设置缓存时间的功能，上面明确写了：CDN 缓存时间是指 UPYUN 回源取得文件后，文件在 UPYUN CDN 网络中的缓存的时间，超过缓存时间则重新回源获取文件。\n是的，这才是真正满足我需求的功能！\n这个解决方案我尝试了，但是在 CDN 域名配置时，有天朝特色要求域名必须备案，我的域名 zyf.im 是在 name.com 上注册的，.im 的尾缀也无法在国内备案。所以这个方案不适合我。\n思路二：通过 Dnspod 的智能 DNS 服务 在这里博主首先分析了：使用 CDN 可能 无法 真正解决百度被拒绝的问题。理由是：CDN 节点众多，百度爬取的节点可能并没有页面的缓存。\n通过 Dnspod 的智能 DNS 服务可以变相解决这个问题，大概的设置如下图所示，只要为你所有的主机记录重复添加 A 记录，把线路类型设置为百度，并将记录值指向你自己的云主机即可。\n你说什么？等下！自己的云主机？没错，其实这种方式就是 专门为百度的爬虫增开了一个小窗口，使得它可以在你自己的服务器上爬取内容，而不是直接去爬取 Github Pages 的内容。你需要自己搭个服务器，并将你的静态网站架在上面。\n我博客解决方案就是采用这种方法。看起来有些“笨”因为我又搭建了一个 Server 用于博客，相当于没有完全利用 GitHub Pages，实际上普通用户访问我的博客就是有利用 GitHub 的 CDN 服务的，更快一些。而且我这么做还利用了 GitHub Webhook，当我把新的页面提交到 GitHub 时，我的博客服务器会自动 pull 最新的项目，这么看也就不那么“傻”了。\n请参看：GitHub Webhook 自动部署 Hexo\n经过这么一配置，我的博客现在已经被百度收录了。百度搜索：site:zyf.im\nReferences DOZER-利用 CDN 解决百度爬虫被 Github Pages 拒绝的问题 jerryzou-解决 Github Pages 禁止百度爬虫的方法与可行性分析 ","permalink":"https://zyf.im/2016/06/30/github-pages-forbidden-baiduspide-solution/","summary":"\u003cp\u003e2019-12-02 更新：现在我的 Blog 还是用的 GitHub Pages，反正没有备案的域名不会被百度收录。\u003c/p\u003e\n\u003cp\u003e2017-04-22 更新：现在我的 Blog 使用的是 \u003ca href=\"https://www.ufovps.com/\"\u003eUFOVPS\u003c/a\u003e 直接部署的。\u003c/p\u003e\n\u003chr\u003e\n\u003cp\u003e在 \u003ca href=\"/2016/06/24/hexo-github-blog/\"\u003e使用 Hexo 和 Github 搭建个人独立博客\u003c/a\u003e 几天后，发现百度并不对博客进行收录。\u003c/p\u003e\n\u003cp\u003e在天朝使用百度搜索毕竟多数，使用百度站长工具-抓取诊断，在百度 Spider 抓取结果返回 HTTP 头：HTTP/1.1 403 Forbidden，原来是 GitHub 禁止了百度爬虫的爬去。\u003c/p\u003e\n\u003c!-- more --\u003e\n\u003cp\u003eGoogle 后早已有许多热心网友给出了解决方案，自己在这里总结下。\u003c/p\u003e\n\u003ch2 id=\"思路一利用-cdn-解决百度爬虫被-github-pages-拒绝的问题\"\u003e思路一：利用 CDN 解决百度爬虫被 Github Pages 拒绝的问题\u003c/h2\u003e\n\u003ch3 id=\"解决思路\"\u003e解决思路\u003c/h3\u003e\n\u003cp\u003e既然 Github 彻底和百度决裂了，那我们也只能自己动手来解决了。Github 可能是封了百度的 IP，也有可能是封了百度爬虫的 User-Agent。\u003c/p\u003e\n\u003cp\u003e所以要解决这个问题，最好就不要让百度爬虫直接访问 Github 了，需要在中间套一层 \u003ca href=\"https://zh.wikipedia.org/wiki/%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86\"\u003e反向代理\u003c/a\u003e。\u003c/p\u003e\n\u003cp\u003e那么问题又来了，既然我可以搭一个反向代理服务器了，那我为什么不直接把博客放在这台服务器上？放 Github Pages 上不就是为了少一台服务器，少一点费用吗？\u003c/p\u003e\n\u003cp\u003e那有没有免费的第三方反向代理服务呢？当然有，其实现在各种 \u003cstrong\u003eCDN 服务\u003c/strong\u003e 不就是吗？而且还额外提供了各种网络环境下的加速功能。\u003c/p\u003e\n\u003cp\u003e但是使用 CDN 也会有一个非常大的缺点：只能对 \u003cstrong\u003e静态资源\u003c/strong\u003e 做，因为 CDN 和反向代理有一个很大的不同就是：它会做缓存，并向各个节点分发。\u003c/p\u003e\n\u003cp\u003e所以 CDN 一般都是用来给静态资源做加速的。如果你对动态页面做加速，用户看到的页面在一段时间内就一直不会变了。但是我们不怕！因为 Github Pages 本来就是全静态的！\u003c/p\u003e\n\u003cp\u003e国内提供 CDN 服务的有：加速乐、七牛云存储、又拍云等。\u003c/p\u003e","title":"GitHub Pages 不被百度收录解决方案"},{"content":"新项目自己撘框架，想着用点新的。看慕课网 Java 高并发秒杀 API 的系列课程时很受益。所以想着仿着来使用：Mavan-Spring-SpringMVC-Mybatis 的架构。框架整合的代码我已上传到我的 Github：maven-mybatis-spring-springmvc。\n本示例是在：Ubuntu15 上实现的；Windows 上安装 Maven 将不太相同。\nMaven Install 2016-09-10 更新：较新版 Eclipse 都有集成 Maven，所以并不需要安装\nRun command sudo apt-get install maven, to install the latest Apache Maven. Run command mvn -version to verify your installation. Where is Maven installed? The command apt-get install the Maven in /usr/share/maven The Maven configuration files are stored in /etc/maven Eclipse Maven Plugin - m2e 2016-09-10 更新：较新版 Eclipse 都有集成 Maven，所以并不需要安装\nopen Eclipse -\u0026gt; Help -\u0026gt; click \u0026ldquo;Install New Software\u0026rdquo; -\u0026gt; click \u0026ldquo;add\u0026rdquo; Name:m2e Location:http://download.eclipse.org/technology/m2e/releases click \u0026ldquo;ok\u0026rdquo; -\u0026gt; click \u0026ldquo;Maven Integration for Eclipse\u0026rdquo; -\u0026gt; click \u0026ldquo;Next\u0026rdquo; restrat Eclipse config m2e -\u0026gt; Window -\u0026gt; Preferences -\u0026gt; Maven -\u0026gt; Installations -\u0026gt; click \u0026ldquo;Add…\u0026rdquo; -\u0026gt; select Maven Create a Maven Project File -\u0026gt; New -\u0026gt; New Maven project select \u0026ldquo;Use default Workspace location\u0026rdquo; select \u0026ldquo;maven-archetype-j2ee-simple\u0026rdquo; input info -\u0026gt; Finish 选中项目右键菜单中选择 Properties -\u0026gt; Project Facets -\u0026gt; select \u0026ldquo;Dynamic Web Module\u0026rdquo; Version \u0026ldquo;3.1\u0026rdquo; Tips:\n如果在 Project Facets 选择版本时“can not change”，可以在项目目录下手动修改 .settings/org.eclipse.wst.common.project.facet.core.xml 文件配置 项目自动生成的 web.xml 版本较低，手动修改 \u0026lt;web-app xmlns=\u0026#34;http://xmlns.jcp.org/xml/ns/javaee\u0026#34; xmlns:xsi=\u0026#34;http://www.w3.org/2001/XMLSchema-instance\u0026#34; xsi:schemaLocation=\u0026#34;http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_3_1.xsd\u0026#34; version=\u0026#34;3.1\u0026#34; metadata-complete=\u0026#34;true\u0026#34;\u0026gt; \u0026lt;/web-app\u0026gt; 项目结构 ├── src ├── main | ├── java //java源代码 | ├── resources //配置资源文件 | └── webapp //web文件 | └── test └── java //junit测试 pom.xml Config Github-maven-mybatis-spring-springmvc pom.xml\n\u0026lt;!-- junit4 --\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;junit\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;junit\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;4.11\u0026lt;/version\u0026gt; \u0026lt;scope\u0026gt;test\u0026lt;/scope\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;!-- 日志 --\u0026gt; \u0026lt;!-- 实现slf4j接口整合 --\u0026gt; \u0026lt;!-- JDBC MySQL Driver --\u0026gt; \u0026lt;!-- DAO框架 mybatis --\u0026gt; \u0026lt;!-- Servlet API --\u0026gt; \u0026lt;!-- 1 Spring 核心依赖 --\u0026gt; \u0026lt;!-- 2 Spring DAO依赖 --\u0026gt; \u0026lt;!-- 3 Spring web相关依赖 --\u0026gt; \u0026lt;!-- 4 Spring Test相关依赖 --\u0026gt; logback.xml Config \u0026lt;configuration\u0026gt; \u0026lt;appender name=\u0026#34;STDOUT\u0026#34; class=\u0026#34;ch.qos.logback.core.ConsoleAppender\u0026#34;\u0026gt; \u0026lt;!-- encoders are assigned the type ch.qos.logback.classic.encoder.PatternLayoutEncoder by default --\u0026gt; \u0026lt;encoder\u0026gt; \u0026lt;pattern\u0026gt;%d{HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n \u0026lt;/pattern\u0026gt; \u0026lt;/encoder\u0026gt; \u0026lt;/appender\u0026gt; \u0026lt;root level=\u0026#34;info\u0026#34;\u0026gt; \u0026lt;appender-ref ref=\u0026#34;STDOUT\u0026#34; /\u0026gt; \u0026lt;/root\u0026gt; \u0026lt;/configuration\u0026gt; Mybatis Config Github-maven-mybatis-spring-springmvc mybatis-config.xml\n\u0026lt;configuration\u0026gt; \u0026lt;settings\u0026gt; \u0026lt;!-- 使用jdbc的getGeneratedKays 获取数据库自增主键 --\u0026gt; \u0026lt;setting name=\u0026#34;useGeneratedKeys\u0026#34; value=\u0026#34;true\u0026#34; /\u0026gt; \u0026lt;!-- 使用列别名替换列名 --\u0026gt; \u0026lt;setting name=\u0026#34;useColumnLabel\u0026#34; value=\u0026#34;true\u0026#34; /\u0026gt; \u0026lt;!-- 是否开启自动驼峰命名规则（camel case）映射，即从经典数据库列名 A_COLUMN 到经典 Java 属性名 aColumn 的类似映射。 --\u0026gt; \u0026lt;setting name=\u0026#34;mapUnderscoreToCamelCase\u0026#34; value=\u0026#34;true\u0026#34; /\u0026gt; \u0026lt;/settings\u0026gt; \u0026lt;/configuration\u0026gt; Spring Config Github-maven-mybatis-spring-springmvc spring\nSpring-DAO Config \u0026lt;!-- 1 数据库配置文件位置 --\u0026gt; \u0026lt;context:property-placeholder location=\u0026#34;classpath:jdbc.properties\u0026#34; /\u0026gt; \u0026lt;!-- 2 数据库连接池 --\u0026gt; \u0026lt;!-- Employee DB data source. --\u0026gt; \u0026lt;bean id=\u0026#34;dataSource\u0026#34; class=\u0026#34;com.mchange.v2.c3p0.ComboPooledDataSource\u0026#34;\u0026gt; \u0026lt;property name=\u0026#34;driverClass\u0026#34; value=\u0026#34;${jdbc.driverClassName}\u0026#34; /\u0026gt; \u0026lt;property name=\u0026#34;jdbcUrl\u0026#34; value=\u0026#34;${jdbc.dburl}\u0026#34; /\u0026gt; \u0026lt;property name=\u0026#34;user\u0026#34; value=\u0026#34;${jdbc.username}\u0026#34; /\u0026gt; \u0026lt;property name=\u0026#34;password\u0026#34; value=\u0026#34;${jdbc.password}\u0026#34; /\u0026gt; \u0026lt;!-- c3p0连接池 私有属性 --\u0026gt; \u0026lt;property name=\u0026#34;maxPoolSize\u0026#34; value=\u0026#34;${jdbc.maxPoolSize}\u0026#34; /\u0026gt; \u0026lt;property name=\u0026#34;minPoolSize\u0026#34; value=\u0026#34;${jdbc.minPoolSize}\u0026#34; /\u0026gt; \u0026lt;!-- 关闭连接后不自动commit --\u0026gt; \u0026lt;property name=\u0026#34;autoCommitOnClose\u0026#34; value=\u0026#34;false\u0026#34; /\u0026gt; \u0026lt;!-- 获取连接超时时间 --\u0026gt; \u0026lt;property name=\u0026#34;checkoutTimeout\u0026#34; value=\u0026#34;1000\u0026#34; /\u0026gt; \u0026lt;!-- 获取连接失败重试次数 --\u0026gt; \u0026lt;property name=\u0026#34;acquireRetryAttempts\u0026#34; value=\u0026#34;2\u0026#34; /\u0026gt; \u0026lt;/bean\u0026gt; \u0026lt;!-- 设计原则：约定大于配置 --\u0026gt; \u0026lt;!-- 3 配置 SqlSessionFactory 对象 --\u0026gt; \u0026lt;bean id=\u0026#34;sqlSessionFactory\u0026#34; class=\u0026#34;org.mybatis.spring.SqlSessionFactoryBean\u0026#34;\u0026gt; \u0026lt;!-- 注入数据库连接池 --\u0026gt; \u0026lt;property name=\u0026#34;dataSource\u0026#34; ref=\u0026#34;dataSource\u0026#34; /\u0026gt; \u0026lt;!-- 配置mybitis 全局配置文件 --\u0026gt; \u0026lt;property name=\u0026#34;configLocation\u0026#34; value=\u0026#34;classpath:mybatis-config.xml\u0026#34; /\u0026gt; \u0026lt;!-- 扫描entity包 使用别名 --\u0026gt; \u0026lt;property name=\u0026#34;typeAliasesPackage\u0026#34; value=\u0026#34;com.moma.dmv.entity\u0026#34; /\u0026gt; \u0026lt;!-- 扫描sql配置文件 mapper 需要的xml --\u0026gt; \u0026lt;property name=\u0026#34;mapperLocations\u0026#34; value=\u0026#34;classpath:mapper/*.xml\u0026#34; /\u0026gt; \u0026lt;/bean\u0026gt; \u0026lt;!-- 4 配置扫描Dao接口包，动态实现Dao接口，注入到spring容器中 --\u0026gt; \u0026lt;bean class=\u0026#34;org.mybatis.spring.mapper.MapperScannerConfigurer\u0026#34;\u0026gt; \u0026lt;!-- 注入sqlsessionFactory --\u0026gt; \u0026lt;property name=\u0026#34;sqlSessionFactoryBeanName\u0026#34; value=\u0026#34;sqlSessionFactory\u0026#34; /\u0026gt; \u0026lt;!-- 给出需要扫描Dao接口包 --\u0026gt; \u0026lt;property name=\u0026#34;basePackage\u0026#34; value=\u0026#34;com.moma.dmv.dao\u0026#34; /\u0026gt; \u0026lt;/bean\u0026gt; Spring-Service Config \u0026lt;!-- 扫描service包下 所有使用注解的类型 --\u0026gt; \u0026lt;context:component-scan base-package=\u0026#34;com.moma.dmv.service\u0026#34; /\u0026gt; \u0026lt;!-- 配置事务管理器 --\u0026gt; \u0026lt;bean id=\u0026#34;transactionManager\u0026#34; class=\u0026#34;org.springframework.jdbc.datasource.DataSourceTransactionManager\u0026#34;\u0026gt; \u0026lt;property name=\u0026#34;dataSource\u0026#34; ref=\u0026#34;dataSource\u0026#34; /\u0026gt; \u0026lt;/bean\u0026gt; \u0026lt;!-- 配置基于注解的声明式事务 --\u0026gt; \u0026lt;tx:annotation-driven transaction-manager=\u0026#34;transactionManager\u0026#34; /\u0026gt; \u0026lt;!-- 使用注解控制事务方法的优点 1：开发团队达成一致约定，明确标注事务方法的编程风格 2：保证事务方法的执行时间尽可能短，不要穿插其他网络操作RPC/HTTP请求或者剥离到事务方法外部 3：不是所有的方法都需要事务，比如只有一条修改操作，只读操作不需要事务控制 --\u0026gt; Spring-Web Config \u0026lt;!-- 1:开启springMVC 注解模式 --\u0026gt; \u0026lt;mvc:annotation-driven /\u0026gt; \u0026lt;!-- 2 静态资源默认servlet配置 1 加入对静态资源的处理 js gif png 2 允许使用“/”做整体映射 --\u0026gt; \u0026lt;mvc:default-servlet-handler /\u0026gt; \u0026lt;!-- 3:配置jsp 显示ViewResolver --\u0026gt; \u0026lt;bean class=\u0026#34;org.springframework.web.servlet.view.InternalResourceViewResolver\u0026#34;\u0026gt; \u0026lt;!-- 决定视图类型，如果添加了jstl支持（即有jstl.jar），那么默认就是解析为jstl视图 --\u0026gt; \u0026lt;property name=\u0026#34;viewClass\u0026#34; value=\u0026#34;org.springframework.web.servlet.view.JstlView\u0026#34; /\u0026gt; \u0026lt;!-- 视图前缀 --\u0026gt; \u0026lt;property name=\u0026#34;prefix\u0026#34; value=\u0026#34;/WEB-INF/jsp/\u0026#34; /\u0026gt; \u0026lt;!-- 视图后缀 --\u0026gt; \u0026lt;property name=\u0026#34;suffix\u0026#34; value=\u0026#34;.jsp\u0026#34; /\u0026gt; \u0026lt;/bean\u0026gt; \u0026lt;mvc:resources location=\u0026#34;/resources/\u0026#34; mapping=\u0026#34;/resources/**\u0026#34; /\u0026gt; \u0026lt;!-- 4:扫描web相关的bean --\u0026gt; \u0026lt;context:component-scan base-package=\u0026#34;com.moma.dmv.web\u0026#34; /\u0026gt; DAO Mapper Example \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;utf-8\u0026#34; ?\u0026gt; \u0026lt;!DOCTYPE mapper PUBLIC \u0026#34;-//mybatis.org//DTD Mapper 3.0//EN\u0026#34; \u0026#34;http://mybatis.org/dtd/mybatis-3-mapper.dtd\u0026#34;\u0026gt; \u0026lt;mapper namespace=\u0026#34;com.moma.dmv.dao.InfoDao\u0026#34;\u0026gt; \u0026lt;select id=\u0026#34;queryById\u0026#34; resultType=\u0026#34;Info\u0026#34; parameterType=\u0026#34;long\u0026#34;\u0026gt; \u0026lt;![CDATA[ select id,`key`,`value` from info where id = #{id} ]]\u0026gt; \u0026lt;/select\u0026gt; \u0026lt;select id=\u0026#34;queryAll\u0026#34; resultType=\u0026#34;Info\u0026#34;\u0026gt; \u0026lt;![CDATA[ select id,key,value from info limit #{offset},#{limit} ]]\u0026gt; \u0026lt;/select\u0026gt; \u0026lt;/mapper\u0026gt; web.xml Config \u0026lt;servlet\u0026gt; \u0026lt;servlet-name\u0026gt;dmv-dispatcher\u0026lt;/servlet-name\u0026gt; \u0026lt;servlet-class\u0026gt;org.springframework.web.servlet.DispatcherServlet\u0026lt;/servlet-class\u0026gt; \u0026lt;!-- 配置springMVC需要加载的配置文件 spring-dao.xml spring-service.xml spring-web.xml mybatis -\u0026gt; spring -\u0026gt; springMVC --\u0026gt; \u0026lt;init-param\u0026gt; \u0026lt;param-name\u0026gt;contextConfigLocation\u0026lt;/param-name\u0026gt; \u0026lt;param-value\u0026gt;classpath:spring/spring-*.xml\u0026lt;/param-value\u0026gt; \u0026lt;/init-param\u0026gt; \u0026lt;/servlet\u0026gt; \u0026lt;servlet-mapping\u0026gt; \u0026lt;servlet-name\u0026gt;dmv-dispatcher\u0026lt;/servlet-name\u0026gt; \u0026lt;!-- 默认匹配所有的请求 --\u0026gt; \u0026lt;url-pattern\u0026gt;/\u0026lt;/url-pattern\u0026gt; \u0026lt;/servlet-mapping\u0026gt; JUnit Example import javax.annotation.Resource; import org.junit.Test; import org.junit.runner.RunWith; import org.slf4j.Logger; import org.slf4j.LoggerFactory; import org.springframework.test.context.ContextConfiguration; import org.springframework.test.context.junit4.SpringJUnit4ClassRunner; import com.moma.dmv.dao.InfoDao; import com.moma.dmv.entity.Info; RunWith(SpringJUnit4ClassRunner.class) ContextConfiguration(locations = { \u0026#34;classpath:spring/spring-dao.xml\u0026#34; }) public class InfoDaoTest { @Resource private InfoDao infoDao; private Logger logger = LoggerFactory.getLogger(this.getClass()); @Test public void testQueryById() throws Exception { long id = 1; Info info = infoDao.queryById(id); logger.info(info.toString()); } } References MKyong-How to install Maven on Ubuntu Java 之道-使用 Eclipse 构建 Maven 项目 (step-by-step) ","permalink":"https://zyf.im/2016/06/27/eclipse-maven-spring-springmvc-mybatis-example/","summary":"\u003cp\u003e新项目自己撘框架，想着用点新的。看慕课网 \u003ca href=\"http://www.imooc.com/index/search?words=%E7%A7%92%E6%9D%80\"\u003eJava 高并发秒杀 API\u003c/a\u003e 的系列课程时很受益。所以想着仿着来使用：Mavan-Spring-SpringMVC-Mybatis 的架构。框架整合的代码我已上传到我的 Github：\u003ca href=\"https://github.com/imzyf/maven-mybatis-spring-springmvc\"\u003emaven-mybatis-spring-springmvc\u003c/a\u003e。\u003c/p\u003e\n\u003cp\u003e本示例是在：Ubuntu15 上实现的；Windows 上安装 Maven 将不太相同。\u003c/p\u003e\n\u003ch2 id=\"maven-install\"\u003eMaven Install\u003c/h2\u003e\n\u003cblockquote\u003e\n\u003cp\u003e2016-09-10 更新：较新版 Eclipse 都有集成 Maven，所以并不需要安装\u003c/p\u003e\u003c/blockquote\u003e\n\u003col\u003e\n\u003cli\u003eRun command \u003ccode\u003esudo apt-get install maven\u003c/code\u003e, to install the latest Apache Maven.\u003c/li\u003e\n\u003cli\u003eRun command \u003ccode\u003emvn -version to verify\u003c/code\u003e your installation.\u003c/li\u003e\n\u003cli\u003eWhere is Maven installed?\nThe command \u003ccode\u003eapt-get\u003c/code\u003e install the Maven in \u003ccode\u003e/usr/share/maven\u003c/code\u003e\nThe Maven configuration files are stored in \u003ccode\u003e/etc/maven\u003c/code\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2 id=\"eclipse-maven-plugin---m2e\"\u003eEclipse Maven Plugin - m2e\u003c/h2\u003e\n\u003cblockquote\u003e\n\u003cp\u003e2016-09-10 更新：较新版 Eclipse 都有集成 Maven，所以并不需要安装\u003c/p\u003e\u003c/blockquote\u003e\n\u003col\u003e\n\u003cli\u003eopen Eclipse -\u0026gt; Help -\u0026gt; click \u0026ldquo;Install New Software\u0026rdquo; -\u0026gt; click \u0026ldquo;add\u0026rdquo;\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-txt\" data-lang=\"txt\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eName:m2e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eLocation:http://download.eclipse.org/technology/m2e/releases\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003col start=\"2\"\u003e\n\u003cli\u003eclick \u0026ldquo;ok\u0026rdquo; -\u0026gt; click \u0026ldquo;Maven Integration for Eclipse\u0026rdquo; -\u0026gt; click \u0026ldquo;Next\u0026rdquo;\u003c/li\u003e\n\u003cli\u003erestrat Eclipse\u003c/li\u003e\n\u003cli\u003econfig m2e -\u0026gt; Window -\u0026gt; Preferences -\u0026gt; Maven -\u0026gt; Installations -\u0026gt; click \u0026ldquo;Add…\u0026rdquo; -\u0026gt; select Maven\u003c/li\u003e\n\u003c/ol\u003e\n\u003c!-- more --\u003e\n\u003ch2 id=\"create-a-maven-project\"\u003eCreate a Maven Project\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003eFile -\u0026gt; New -\u0026gt; New Maven project\u003c/li\u003e\n\u003cli\u003eselect \u0026ldquo;Use default Workspace location\u0026rdquo;\u003c/li\u003e\n\u003cli\u003eselect \u0026ldquo;maven-archetype-j2ee-simple\u0026rdquo;\u003c/li\u003e\n\u003cli\u003einput info -\u0026gt; Finish\u003c/li\u003e\n\u003cli\u003e选中项目右键菜单中选择 Properties -\u0026gt; Project Facets -\u0026gt; select \u0026ldquo;Dynamic Web Module\u0026rdquo; Version \u0026ldquo;3.1\u0026rdquo;\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eTips:\u003c/p\u003e","title":"Eclipse Maven Spring SpringMVC Mybatis 整合"},{"content":"Wordpress 这类博客系统功能强大，可对与我只想划拉的写点东西的人，感觉大材小用了。而且 Wordpress 需要部署，网站的服务器也会带来问题，国内的服务器首先需要备案，费用不低，国外服务器访问速度受影响。\n近来接触到一种新的博客系统 Hexo，它的不同地方就是将：在上线编写博客和页面渲染的过程在线下完成。\n在本地编写博文的 Markdown 文件，使用 Hexo 将博客网站的所有前台 HTML 等全部生成，让后将生成的文件上传的服务器就行了。\n那么原来 wp 中的评论等动态功能怎么办呢？放心第三方服务商早已为我们考虑了。例如：disqus就是一家第三方社会化评论系统，主要为网站主提供评论托管服务。\n本文的操作的系统环境是 Ubuntu 15，Windows 下的搭建可触类旁通。\n了解 Hexo A fast, simple \u0026amp; powerful blog framework\nHexo 是一个快速、简洁且高效的博客框架。Hexo 使用 Markdown（或其他渲染引擎）解析文章，在几秒内，即可利用靓丽的主题生成静态网页，Hexo setup 官方文档。\n安装 Git Download for Linux and Unix | git-scm\n安装 Node.js Linux | Mac 安装 Node.js 与常见问题 | zyf.im\n安装 Hexo 所有必备的应用程序安装完成后，即可使用 npm 安装 Hexo：\nnpm install -g hexo-cli 建站 安装 Hexo 完成后，请执行下列命令，Hexo 将会在指定文件夹中新建所需要的文件：\nhexo init \u0026lt;folder\u0026gt; cd \u0026lt;folder\u0026gt; npm install 新建完成后，指定文件夹的目录如下：\n├── _config.yml ├── package.json ├── scaffolds ├── source | ├── _drafts | └── _posts └── themes 新建一篇文章 hexo new [layout] \u0026lt;title\u0026gt; 如果没有设置 layout 的话，默认使用 _config.yml 中的 default_layout 参数代替。如果标题包含空格的话，请使用引号括起来。\n生成静态文件 hexo generate # 可以简写为 hexo g 启动服务器 hexo server # 可以简写为 hexo s 网站会在 http://localhost:4000 下启动。在服务器启动期间，Hexo 会监视文件变动并自动更新，您无须重启服务器。\n部署静态网页到 GitHub 注册设置 GitHub 登录 GitHub，注册自定义用户名如：imzyf 在主页右下角创建 New repository，name 必须和用户名一致如：imzyf.github.io 等待 3 分钟左右，之后即可访问静态主页如：https://imzyf.github.io 同步内容至 GitHub 在 Hexo 目录下 git clone git@github.com:imzyf/imzyf.github.io.git 将 public 文件下的所有文件拷贝到 imzyf.github.io 下 git add . 增加当前子目录下所有更改过的文件至 index git commit -m 'xxx' 提交到本地 git push origin master 将当前分支 push 到远程 master 分支 最后访问主页http://imzyf.github.io 观察效果 绑定个人域名 在 GitHub 项目页面，Settings -\u0026gt; GitHub Pages，Source 选择 master branch，Custom domain 填写自己的域名，同时勾选 Enforce HTTPS 让你的网址支持 HTTPS。\n在你的域名服务商那里，将填写的域名解析到：\u0026lt;username\u0026gt;.github.io 利于 imzyf.github.io。\nReferences HellDog-使用 GitHub 和 Hexo 搭建免费静态 Blog ","permalink":"https://zyf.im/2016/06/24/hexo-github-blog/","summary":"\u003cp\u003e\u003ccode\u003eWordpress\u003c/code\u003e 这类博客系统功能强大，可对与我只想划拉的写点东西的人，感觉大材小用了。而且 \u003ccode\u003eWordpress\u003c/code\u003e 需要部署，网站的服务器也会带来问题，国内的服务器首先需要备案，费用不低，国外服务器访问速度受影响。\u003c/p\u003e\n\u003cp\u003e近来接触到一种新的博客系统 Hexo，它的不同地方就是将：\u003cstrong\u003e在上线编写博客和页面渲染的过程在线下完成\u003c/strong\u003e。\u003c/p\u003e\n\u003cp\u003e在本地编写博文的 Markdown 文件，使用 Hexo 将博客网站的所有前台 HTML 等全部生成，让后将生成的文件上传的服务器就行了。\u003c/p\u003e\n\u003cp\u003e那么原来 wp 中的评论等动态功能怎么办呢？放心第三方服务商早已为我们考虑了。例如：\u003ca href=\"https://disqus.com/\"\u003edisqus\u003c/a\u003e就是一家第三方社会化评论系统，主要为网站主提供评论托管服务。\u003c/p\u003e\n\u003cp\u003e本文的操作的系统环境是 Ubuntu 15，Windows 下的搭建可触类旁通。\u003c/p\u003e\n\u003ch2 id=\"了解-hexo\"\u003e了解 Hexo\u003c/h2\u003e\n\u003cblockquote\u003e\n\u003cp\u003eA fast, simple \u0026amp; powerful blog framework\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003e\u003ca href=\"https://hexo.io/\"\u003eHexo\u003c/a\u003e 是一个快速、简洁且高效的博客框架。Hexo 使用 Markdown（或其他渲染引擎）解析文章，在几秒内，即可利用靓丽的主题生成静态网页，\u003ca href=\"https://hexo.io/zh-cn/docs/setup.html\"\u003eHexo setup 官方文档\u003c/a\u003e。\u003c/p\u003e","title":"使用 GitHub 和 Hexo 搭建个人独立博客"},{"content":"新买了 Filco Majestouch Convertible 2 键盘。在自己的笔记本上连接没什么问题，搬到公司 Ubuntu 的 IBM 笔记本这么都连接不上，查找解决。\n安装蓝牙的 hcidump：\nsudo apt-get install bluez-hcidump 然后，监测蓝牙事件\nsudo hcidump -at 再次连接蓝牙键盘，可以看到输出事件中有一条 Pin ... 键盘输入对应的 Pin，Enter，连接成功。\n\u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2016/06/14/ubuntu-bluetooth-keyboard/","summary":"\u003cp\u003e新买了 \u003ccode\u003eFilco Majestouch Convertible 2\u003c/code\u003e 键盘。在自己的笔记本上连接没什么问题，搬到公司 Ubuntu 的 IBM 笔记本这么都连接不上，查找解决。\u003c/p\u003e\n\u003cp\u003e安装蓝牙的 \u003ccode\u003ehcidump\u003c/code\u003e：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo apt-get install bluez-hcidump\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e然后，监测蓝牙事件\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo hcidump -at\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e再次连接蓝牙键盘，可以看到输出事件中有一条 \u003ccode\u003ePin ...\u003c/code\u003e 键盘输入对应的 Pin，Enter，连接成功。\u003c/p\u003e\n\u003cp\u003e\u0026ndash; EOF \u0026ndash;\u003c/p\u003e","title":"Ubuntu 下连接蓝牙键盘"},{"content":"final 修饰符 final 修饰符表示不可变。类似 C 中的 constant。用于修饰变量表示不可变的变量。用于修饰方法表示不可被重写。用于修饰类表示不可被继承。\nfinal 的成员变量 成员变量随着类或者实例的初始化而初始化。在类初始化时，静态变量就会被分配内存并初始化。对于实例变量，系统会在实例初始化的时候初始化这些变量。\n由于成员变量会被系统隐式的初始化。如果程序员不显式的初始化它们，那他们会变成 0，false，null 这样的值。失去了意义。\n所以 final 修饰的成员变量必须显式的初始化。\n类变量：必须在静态初始化块，或者在声明的时候初始化 实例变量：必须在非静态初始化块，声明时，或者构造函数中初始化。 final 的局部变量 对于形参：在方法内部无法对其进行赋值。 方法体内的 final 局部变量：只能赋值一次。\nfinal 的基本类型变量和引用类型变量 基本类型变量：值不可变。 引用类型变量：指针不可变，但是指向的内存区域可变。 public class FinalVariableTest { public static void main(String[] agrs){ final int[] arr = {1,23,4,5}; System.out.println(Arrays.toString(arr)); arr[2] = 20; System.out.print(Arrays.toString(arr)); } } //Console //[1, 23, 4, 5] //[1, 23, 20, 5] final 的宏替换 对于 final 的变量来说，不管是类变量，实例变量还是局部变量。只要在编译的时候可以确定，那么编译器就会把它看成一个直接量而不是变量。 比如:\npublic class FinalVar{ public static void main(String[] args){ final int a =5; System.out.println(a); } } 实际编译器在执行 System.out.println(a);等同于执行 System.out.println(5); 什么叫做编译时可以确定 下面这个例子。 str1 在编译的时候就可以确定。而 str2 需要调用 valueOf() 方法才能得到后面一个字符串。在编译的时候无法确定。从结果也可以看出来。\nfinal String str1 = \u0026#34;hello world\u0026#34;+2016; final String str2 = \u0026#34;hello world\u0026#34;+String.valueOf(2016); System.out.println(str1==\u0026#34;hello world2016\u0026#34;); System.out.println(str2==\u0026#34;hello world2016\u0026#34;); 再看这个\nString str1 = \u0026#34;hello world\u0026#34;; String str2 = \u0026#34;hello \u0026#34; + \u0026#34;world\u0026#34;; String s1 = \u0026#34;hello \u0026#34;; String s2 = \u0026#34;world\u0026#34;; String str3 = s1 + s2; System.out.println(str1 == str2); System.out.println(str1 == str3); str1 == str3 返回是 false。因为 str3 在编译是无法确定。所以不会被当作直接量。但是如 s1 和 s2 都加上 final。编译器会进行宏替换。str3 就等同于\u0026quot;hello\u0026quot; + \u0026ldquo;world\u0026rdquo;。\nfinal 的方法 final 的方法不会被重写。\nfinal 的类 final 的类不能被继承。\n不可变类 Java 提供的基础变量类型的包装类和 String 类都是不可变类。如果要自己创建不可变的类需要注意几点：\n使用 private 和 final 修饰成员变量。 提供带参数的构造器，用于根据需要传入参数来初始化类里的成员变量。 仅提供 getter 方法，不提供 setter 方法。 如果有必要重写 hashCode() 和 equals() 方法。还要保证两个用 equals 方法判断相等的对象 hasdCode() 也相等。 public class Address { private final String detail; private final String postCode; public Address(){ this.detail=\u0026#34;\u0026#34;; this.postCode=\u0026#34;\u0026#34;; } public Address(String detail，String postCode){ this.detail=detail; this.postCode=postCode; } public String getDetail(){ return this.detail; } public String getPoetCode(){ return this.postCode; } public boolean equals(Object obj){ if(this == obj){ return true; } if(obj!=null\u0026amp;\u0026amp;obj.getClass()==Address.class){ Address ad = (Address)obj; if(this.getClass().equals(ad.getDetail())\u0026amp;\u0026amp;this.getPoetCode().equals(ad.getPoetCode())){ return true; } } return false; } public int hashCode(){ return this.detail.hashCode()+this.postCode.hashCode(); } } 编写不可变类的时候，只需要提供 getter 方法，不提供 setter 方法就可以了。但是对引用传递一定要注意。因为引用传递传的是尼玛指针。下面就是一个失败的例子。\npublic class Person { public final Name name; public Person(Name name){ this.name = name; } public Name getName(){ return this.name; } public static void main(String[] agrs){ Name n = new Name(\u0026#34;Brady\u0026#34;，\u0026#34;Gao\u0026#34;); Person p = new Person(n); System.out.println(p.getName().getFirstName()); n.setFirstName(\u0026#34;heihei\u0026#34;); System.out.println(p.getName().getFirstName()); } } class Name { private String firstName; private String lastName; public Name(){} public Name(String firstName，String lastName){ this.firstName = firstName; this.lastName = lastName; } public String getFirstName(){ return this.firstName; } public void setFirstName(String firstName){ this.firstName = firstName; } public String getLastName(){ return this.lastName; } public void setLastName(String lastName){ this.lastName = lastName; } } 要想解决这个，就要做到，避免引用传递带来的指针的直接传递。 重写 Person 的构造方法。\npublic Person (Name name){ this.name = new Name(name.getFirstName()，name.getLastName()); } References 番茄博客-final 修饰符（原链接失效） ","permalink":"https://zyf.im/2016/06/13/java-modifier-final/","summary":"\u003ch2 id=\"final-修饰符\"\u003efinal 修饰符\u003c/h2\u003e\n\u003cp\u003efinal 修饰符表示不可变。类似 C 中的 constant。用于修饰变量表示不可变的变量。用于修饰方法表示不可被重写。用于修饰类表示不可被继承。\u003c/p\u003e\n\u003ch2 id=\"final-的成员变量\"\u003efinal 的成员变量\u003c/h2\u003e\n\u003cp\u003e成员变量随着类或者实例的初始化而初始化。在类初始化时，静态变量就会被分配内存并初始化。对于实例变量，系统会在实例初始化的时候初始化这些变量。\u003c/p\u003e\n\u003cp\u003e由于成员变量会被系统隐式的初始化。如果程序员不显式的初始化它们，那他们会变成 0，false，null 这样的值。失去了意义。\u003c/p\u003e\n\u003cp\u003e所以 \u003cstrong\u003efinal 修饰的成员变量必须显式的初始化。\u003c/strong\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e类变量：必须在静态初始化块，或者在声明的时候初始化\u003c/li\u003e\n\u003cli\u003e实例变量：必须在非静态初始化块，声明时，或者构造函数中初始化。\u003c/li\u003e\n\u003c/ul\u003e\n\u003c!-- more --\u003e\n\u003ch2 id=\"final-的局部变量\"\u003efinal 的局部变量\u003c/h2\u003e\n\u003cp\u003e对于形参：在方法内部无法对其进行赋值。\n方法体内的 final 局部变量：只能赋值一次。\u003c/p\u003e\n\u003ch2 id=\"final-的基本类型变量和引用类型变量\"\u003efinal 的基本类型变量和引用类型变量\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e基本类型变量：值不可变。\u003c/li\u003e\n\u003cli\u003e引用类型变量：指针不可变，但是指向的内存区域可变。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003epublic\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kd\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eFinalVariableTest\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kd\"\u003epublic\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kd\"\u003estatic\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kt\"\u003evoid\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nf\"\u003emain\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eString\u003c/span\u003e\u003cspan class=\"o\"\u003e[]\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eagrs\u003c/span\u003e\u003cspan class=\"p\"\u003e){\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"kd\"\u003efinal\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"o\"\u003e[]\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003earr\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"n\"\u003e23\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"n\"\u003e4\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"n\"\u003e5\u003c/span\u003e\u003cspan class=\"p\"\u003e};\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eout\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eprintln\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eArrays\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003etoString\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003earr\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"n\"\u003earr\u003c/span\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003e2\u003c/span\u003e\u003cspan class=\"o\"\u003e]\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003e20\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e        \u003c/span\u003e\u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eout\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eprint\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eArrays\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003etoString\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003earr\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e   \u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"c1\"\u003e//Console\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"c1\"\u003e//[1, 23, 4, 5]\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"c1\"\u003e//[1, 23, 20, 5]\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"final-的宏替换\"\u003efinal 的宏替换\u003c/h2\u003e\n\u003cp\u003e对于 final 的变量来说，不管是类变量，实例变量还是局部变量。只要在编译的时候可以确定，那么编译器就会把它看成一个直接量而不是变量。\n比如:\u003c/p\u003e","title":"Java final 修饰符"},{"content":"自己是第一次把一本厚厚的的技术类书读一遍。不过 7、8、9、10 章讲的是关于图形的就是翻了翻，没怎么看。第 4 章 对象与类，里面有很多非常基础，可以补充一些知识细节。第 14 章 多线程，是自己最陌生的，慕课网上有节课 深入浅出 Java 多线程 讲到的例子就是书上例子的变形，可以对照理解。第二遍阅读做做笔记。\n本文总结的是书中的：第 3 章 Java 的基本程序设计结构、第 4 章 对象与类。\n3 Java 的基础程序设计结构 3.3 数据类型 Java 是一种强类型语音。在 Java 中，一共有 8 中基本类型（primitive type），其中有 4 种整型、2 种浮点类型、1 种用于表示 Unicode 编码的字符单元的字符类型 char 和 1 种用于表示真值的 boolean 类型。 Java7 开始，还可以为数字字面量加下划线，如用 1_000_000 表示一百万。这些下划线只是为了让人更易读。Java 编译器会去除这些下划线。 浮点数值不适用于出现舍入误差的金融计算中。其主要原因时浮点数值采用二进制系统表示，而在二进制系统中无法精确的表示分数 1/10。这就好像十进制无法精确地表示 1/3 一样。如果需要在数值计算中不含有任何舍入误差，就应该使用 BigDecimal 类。 3.4 变量 尽管$是一个合法的 Java 字符，但不要在自己的代码中使用这个字符。它只用在 Java 编译器或其他工具生成的名字中。 3.6 字符串 由于不能修改 Java 字符串中的字符，所以在 Java 文档中将 String 类对象称为不可变字符串。 如果虚拟机始终将相同的字符串共享，就可以使用 == 运算符检测是否相等。但实际上只有字符串常量是共享的，而 + 或者 substring 等操作产生的结果并不是共享的。因此，千万不要使用 == 运算符测试字符串的相等性，以免在程序中出现糟糕的 bug。从表面上看，这种 bug 很像随机产生的间歇性错误。 3.10 数组 在 Java 中，允许将一个数组变量拷贝给另一个数组变量。这时，两个变量将引用同一个数组： int[] luckyNumbers = smallPrimes; luckNumbers[5] = 12; // now smallPrimes[5] is also 12 如果希望将一个数组的所用值拷贝到一个新的数组中去，就要使用 Arrays 类的 copyOf 方法： int[] copiedLuckyNumbers = Arrays.copyOf(luckyNumbers, luckyNumbers.length); 4 对象与类 4.1 面向对象程序设计概述 类之间的关系 依赖（uses-a） 聚合（has-a） 继承（is-a） 依赖（dependence），即 uses-a 关系。例如，Order 类使用 Account 类是因为 Order 对象需要访问 Account 对象查看信用状态。因此，如果一个类的方法操纵另一个类的对象，我们就说一个类依赖于另一个类。 应该尽可能的将相互依赖的类减至最少。我们如果 A 不知道 B 的存在，他就不会关心 B 的任何改变（这意味着 B 的改变不会导致 A 产生任何 bug）。用软件工程的术语来说，就是让类之间的耦合度最小。 聚合（aggressive），即 has-a 关系。例如，一个 Order 对象包含一些 Item 对象。聚合关系意味着类 A 的对象包含类 B 的对象。 继承（inheritance），即 is-a 关系。例如，RushOrder 类由 Order 类继承而来。在具有特殊性的 RushOrder 类中包含了一些用于优先处理的特殊方法，以及一个计算运费的不同方法；而其他的方法从 Order 类继承了来的。一般而言，如果类 A 扩展类 B，类 A 不但包含从类 B 继承的方法，还会拥有一些额外的功能。 4.2 使用预定义类 在对象与对象变量之间存在着一个重要的区别。例如： Date deadline; // deadline doesn\u0026#39;t refer to any object 定义了一个对象变量 deadline，它可以引用 Date 类型的对象。但是，一定要认识到：变量 deading 不是一个对象，实际上也没有引用对象。此时，不能将任何 Date 方法应用与这个变量上。 s = deadline.toString(); // not yet 必须首先初始化变量 deadline，可以用新构造的对象初始化这个变量，也可以让这个变量引用一个已存在的对象。 一定要认识到：一个对象变量并没有实际包含一个对象，而仅仅引用一个对象。 在 Java 中，任何对象变量的值都时对存储在另一个地方的一个对象的引用。new 操作符的返回值也是一个引用。 可显示地将对象变量设置为 null，表明这个对象变量目前没有引用任何对象。 4.3 用户自定义类 类文件必须与 public 类的名字相匹配。在一个原文件中，只能有一个共有类，但可以有任意数目的非共有类。 可以用 public 标记实例域，但这是一种极为不提倡的做法。public 数据域允许程序中的任何方法对其进行读取和修改。这就完全破坏了封装。这里强烈建议将实例域标记为 private。 构造器： 构造器与类同名 每个类可以有一个以上的构造器 构造器可以有 0 个、1 个或多个参数 构造器没有返回值 构造器总是伴随着 new 操作一起调用 类： 私有的数据域 公有的域服务器方法 公有的域改变方法 不要编写返回引用可变对象的访问器方法。 class Employee { ... private Date hireDay; public Date getHireDay() { return Date hireDay; } } 这样会破坏封装性！代码： Employee harry = ...; Date d = harry.getHireDay(); doule tenYearsInMilliSeconds = 10 * 365.25 * 24 * 60 * 60 * 1000; d.setTime(d.getTime() - (long)tenYearsInMilliSeconds); // let\u0026#39;s give Harry ten years of added seniority 出错的原因很微妙。d 和 harry.hireDay 引用同一个对象。对 d 调用更改器方法就可以自动地改变这个雇员的私有状态！ 如果需要返回一个可变对象的引用，应该首先对它进行克隆（clone）。对象 clone 是指存放在另一个位置上的对象副本。 public Date getHireDay() { return Date hireDay.clone(); } Employee 类的方法可以访问 Emloyee 类的任何一个对象的私有域 。 class Employee { public boolen equals(Employee other) { return name.equals(other.name); } } final 修饰符大都应用于基本（primitive）类型域，或不可变（immutable）类的域（如果类中的每个方法都是不会改变其对象，这中类就是不可变的类。例如，String 类就是一个不可变的类）。对于可变的类，使用 final 修饰符可能会对读者造成混乱。代码 private final Date hiredate; 仅仅意味着存储子 hiredate 变量中的对象引用在对象构造之后不能被改变，而并不意味着 hiredate 对象是一个常量。任何方法都可以对 hiredate 引用的对象调用 setTime 更改器。 4.4 静态域与静态方法 每一个雇员对象都有一个自己的 id 域，但这个类的所有实例将共享一个 nextId 域。 class Employee { private static int nextId = 1; private int id; } 换句话说，如果有 1000 个 Employee 类的对象，则有 1000 个实例域 id。但是，这有一个静态域 nextId。即使没有一个雇员对象，静态域 nextId 也是存在。它属于类，而不属于任何独立的对象。 可以使用对象调用静态方法。例如，如果 harry 是一个 Employee 对象，可以用 harry.getNextId() 代替 Employee.getNextId()。不过这中方式很容易造成混淆，其原因是 getNextId 方法计算的结果与 harry 毫无关系。我们建议使用类名来调用静态方法。 每一个类可以有一个 main 方法。这是一个常用于对类进行单元测试的技巧。 4.5 参数方法 Java 程序设计语言总是采用按值调用。也就是说，方法得到的是所有参数值的一个拷贝。 Java 程序设计语言中方法参数的使用情况： 一个方法不能修改一个基本数据类型的参数。 一个方法可以改变一个对象参数的状态。 一个方法不能让对象参数引用一个新的状态。 4.6 对象构造 要完整的描述一个方法需要指出方法以及参数类型，这叫做方法的签名（signature）。 返回类型不是方法签名的一部分。也就是说，不能有两个名字相同、参数类型也相同却返回不同类型值的方法。 如果在编写一个类时没有编写构造器，那么系统就会提供一个无参数构造器。这个构造器将所有的实例域设置为默认值。实例域中的数值类型数据设置为 0、布尔型数值设置为 false、所有对象变量将设置为 null。 如果类中提供了至少一个构造器，但是没有提供无参数的构造器，则在构造对象时如果没有提供参数就会被视为不合法。 对每一个实例域都可以被设置为一个有意义的初值，这是一种很好的设计习惯。 class Employee { private String name = \u0026#34;\u0026#34;; ... } 4.10 类设计技巧 一定要保证数据私有。绝对不要破坏封装性。 一定要对数据初始化。 不要在类中使用过多的基本类型。就是说，用其他的类代替多个相关的基本类型的使用。 不是所有的域都需要独立的域访问器和域更改器。 将职责过多的类进行分解。 类名和方法名要能够体现它们的职责。 ","permalink":"https://zyf.im/2016/05/06/core-java-reading-notes/","summary":"\u003cp\u003e自己是第一次把一本厚厚的的技术类书读一遍。不过 7、8、9、10 章讲的是关于图形的就是翻了翻，没怎么看。第 4 章 对象与类，里面有很多非常基础，可以补充一些知识细节。第 14 章 多线程，是自己最陌生的，慕课网上有节课 \u003ca href=\"http://www.imooc.com/view/202\"\u003e深入浅出 Java 多线程\u003c/a\u003e 讲到的例子就是书上例子的变形，可以对照理解。第二遍阅读做做笔记。\u003c/p\u003e\n\u003cp\u003e本文总结的是书中的：第 3 章 Java 的基本程序设计结构、第 4 章 对象与类。\u003c/p\u003e\n\u003c!-- more --\u003e\n\u003ch2 id=\"3-java-的基础程序设计结构\"\u003e3 Java 的基础程序设计结构\u003c/h2\u003e\n\u003ch3 id=\"33-数据类型\"\u003e3.3 数据类型\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eJava 是一种强类型语音。在 Java 中，一共有 8 中基本类型（primitive type），其中有 4 种整型、2 种浮点类型、1 种用于表示 Unicode 编码的字符单元的字符类型 char 和 1 种用于表示真值的 boolean 类型。\u003c/li\u003e\n\u003cli\u003eJava7 开始，还可以为数字字面量加下划线，如用 1_000_000 表示一百万。这些下划线只是为了让人更易读。Java 编译器会去除这些下划线。\u003c/li\u003e\n\u003cli\u003e浮点数值不适用于出现舍入误差的金融计算中。其主要原因时浮点数值采用二进制系统表示，而在二进制系统中无法精确的表示分数 1/10。这就好像十进制无法精确地表示 1/3 一样。如果需要在数值计算中不含有任何舍入误差，就应该使用 BigDecimal 类。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"34-变量\"\u003e3.4 变量\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e尽管$是一个合法的 Java 字符，但不要在自己的代码中使用这个字符。它只用在 Java 编译器或其他工具生成的名字中。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"36-字符串\"\u003e3.6 字符串\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e由于不能修改 Java 字符串中的字符，所以在 Java 文档中将 String 类对象称为不可变字符串。\u003c/li\u003e\n\u003cli\u003e如果虚拟机始终将相同的字符串共享，就可以使用 == 运算符检测是否相等。但实际上只有字符串常量是共享的，而 + 或者 substring 等操作产生的结果并不是共享的。因此，千万不要使用 == 运算符测试字符串的相等性，以免在程序中出现糟糕的 bug。从表面上看，这种 bug 很像随机产生的间歇性错误。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"310-数组\"\u003e3.10 数组\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e在 Java 中，允许将一个数组变量拷贝给另一个数组变量。这时，两个变量将引用同一个数组：\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"o\"\u003e[]\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eluckyNumbers\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003esmallPrimes\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"n\"\u003eluckNumbers\u003c/span\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003e5\u003c/span\u003e\u003cspan class=\"o\"\u003e]\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003e12\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"c1\"\u003e// now smallPrimes[5] is also 12\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cul\u003e\n\u003cli\u003e如果希望将一个数组的所用值拷贝到一个新的数组中去，就要使用 Arrays 类的 copyOf 方法：\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"o\"\u003e[]\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ecopiedLuckyNumbers\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eArrays\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003ecopyOf\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eluckyNumbers\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eluckyNumbers\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003elength\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"4-对象与类\"\u003e4 对象与类\u003c/h2\u003e\n\u003ch3 id=\"41-面向对象程序设计概述\"\u003e4.1 面向对象程序设计概述\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e类之间的关系\n依赖（uses-a）\n聚合（has-a）\n继承（is-a）\u003c/li\u003e\n\u003cli\u003e依赖（dependence），即 uses-a 关系。例如，Order 类使用 Account 类是因为 Order 对象需要访问 Account 对象查看信用状态。因此，如果一个类的方法操纵另一个类的对象，我们就说一个类依赖于另一个类。\n应该尽可能的将相互依赖的类减至最少。我们如果 A 不知道 B 的存在，他就不会关心 B 的任何改变（这意味着 B 的改变不会导致 A 产生任何 bug）。用软件工程的术语来说，就是让类之间的耦合度最小。\u003c/li\u003e\n\u003cli\u003e聚合（aggressive），即 has-a 关系。例如，一个 Order 对象包含一些 Item 对象。聚合关系意味着类 A 的对象包含类 B 的对象。\u003c/li\u003e\n\u003cli\u003e继承（inheritance），即 is-a 关系。例如，RushOrder 类由 Order 类继承而来。在具有特殊性的 RushOrder 类中包含了一些用于优先处理的特殊方法，以及一个计算运费的不同方法；而其他的方法从 Order 类继承了来的。一般而言，如果类 A 扩展类 B，类 A 不但包含从类 B 继承的方法，还会拥有一些额外的功能。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"42-使用预定义类\"\u003e4.2 使用预定义类\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e在对象与对象变量之间存在着一个重要的区别。例如：\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003eDate\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003edeadline\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"c1\"\u003e// deadline doesn\u0026#39;t refer to any object\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cul\u003e\n\u003cli\u003e定义了一个对象变量 deadline，它可以引用 Date 类型的对象。但是，一定要认识到：变量 deading 不是一个对象，实际上也没有引用对象。此时，不能将任何 Date 方法应用与这个变量上。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003edeadline\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003etoString\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"c1\"\u003e// not yet\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cul\u003e\n\u003cli\u003e必须首先初始化变量 deadline，可以用新构造的对象初始化这个变量，也可以让这个变量引用一个已存在的对象。\u003c/li\u003e\n\u003cli\u003e一定要认识到：一个对象变量并没有实际包含一个对象，而仅仅引用一个对象。\u003c/li\u003e\n\u003cli\u003e在 Java 中，任何对象变量的值都时对存储在另一个地方的一个对象的引用。new 操作符的返回值也是一个引用。\u003c/li\u003e\n\u003cli\u003e可显示地将对象变量设置为 null，表明这个对象变量目前没有引用任何对象。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"43-用户自定义类\"\u003e4.3 用户自定义类\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e类文件必须与 public 类的名字相匹配。在一个原文件中，只能有一个共有类，但可以有任意数目的非共有类。\u003c/li\u003e\n\u003cli\u003e可以用 public 标记实例域，但这是一种极为不提倡的做法。public 数据域允许程序中的任何方法对其进行读取和修改。这就完全破坏了封装。这里强烈建议将实例域标记为 private。\u003c/li\u003e\n\u003cli\u003e构造器：\n构造器与类同名\n每个类可以有一个以上的构造器\n构造器可以有 0 个、1 个或多个参数\n构造器没有返回值\n构造器总是伴随着 new 操作一起调用\u003c/li\u003e\n\u003cli\u003e类：\n私有的数据域\n公有的域服务器方法\n公有的域改变方法\u003c/li\u003e\n\u003cli\u003e不要编写返回引用可变对象的访问器方法。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eEmployee\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"p\"\u003e...\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"kd\"\u003eprivate\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eDate\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ehireDay\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"kd\"\u003epublic\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eDate\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nf\"\u003egetHireDay\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e        \u003c/span\u003e\u003cspan class=\"k\"\u003ereturn\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eDate\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ehireDay\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cul\u003e\n\u003cli\u003e这样会破坏封装性！代码：\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003eEmployee\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eharry\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e...;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"n\"\u003eDate\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ed\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eharry\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003egetHireDay\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"n\"\u003edoule\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003etenYearsInMilliSeconds\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003e10\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003e365\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003e25\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003e24\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003e60\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003e60\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003e1000\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"n\"\u003ed\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003esetTime\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ed\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003egetTime\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003elong\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"n\"\u003etenYearsInMilliSeconds\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"c1\"\u003e// let\u0026#39;s give Harry ten years of added seniority\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cul\u003e\n\u003cli\u003e出错的原因很微妙。d 和 harry.hireDay 引用同一个对象。对 d 调用更改器方法就可以自动地改变这个雇员的私有状态！\u003c/li\u003e\n\u003cli\u003e如果需要返回一个可变对象的引用，应该首先对它进行克隆（clone）。对象 clone 是指存放在另一个位置上的对象副本。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"kd\"\u003epublic\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eDate\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nf\"\u003egetHireDay\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e        \u003c/span\u003e\u003cspan class=\"k\"\u003ereturn\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eDate\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ehireDay\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eclone\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cul\u003e\n\u003cli\u003eEmployee 类的方法可以访问 Emloyee 类的任何一个对象的\u003cstrong\u003e私有域\u003c/strong\u003e 。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eEmployee\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"kd\"\u003epublic\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eboolen\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nf\"\u003eequals\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eEmployee\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eother\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e        \u003c/span\u003e\u003cspan class=\"k\"\u003ereturn\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eequals\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eother\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cul\u003e\n\u003cli\u003efinal 修饰符大都应用于基本（primitive）类型域，或不可变（immutable）类的域（如果类中的每个方法都是不会改变其对象，这中类就是不可变的类。例如，String 类就是一个不可变的类）。对于可变的类，使用 final 修饰符可能会对读者造成混乱。代码\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003eprivate\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kd\"\u003efinal\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eDate\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ehiredate\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cul\u003e\n\u003cli\u003e仅仅意味着存储子 hiredate 变量中的对象引用在对象构造之后不能被改变，而并不意味着 hiredate 对象是一个常量。任何方法都可以对 hiredate 引用的对象调用 setTime 更改器。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"44-静态域与静态方法\"\u003e4.4 静态域与静态方法\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e每一个雇员对象都有一个自己的 id 域，但这个类的所有实例将共享一个 nextId 域。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eEmployee\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"kd\"\u003eprivate\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kd\"\u003estatic\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003enextId\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"kd\"\u003eprivate\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eid\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cul\u003e\n\u003cli\u003e换句话说，如果有 1000 个 Employee 类的对象，则有 1000 个实例域 id。但是，这有一个静态域 nextId。即使没有一个雇员对象，静态域 nextId 也是存在。它属于类，而不属于任何独立的对象。\u003c/li\u003e\n\u003cli\u003e可以使用对象调用静态方法。例如，如果 harry 是一个 Employee 对象，可以用 harry.getNextId() 代替 Employee.getNextId()。不过这中方式很容易造成混淆，其原因是 getNextId 方法计算的结果与 harry 毫无关系。我们建议使用类名来调用静态方法。\u003c/li\u003e\n\u003cli\u003e每一个类可以有一个 main 方法。这是一个常用于对类进行单元测试的技巧。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"45-参数方法\"\u003e4.5 参数方法\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eJava 程序设计语言总是采用按值调用。也就是说，方法得到的是所有参数值的一个拷贝。\u003c/li\u003e\n\u003cli\u003eJava 程序设计语言中方法参数的使用情况：\n一个方法不能修改一个基本数据类型的参数。\n一个方法可以改变一个对象参数的状态。\n一个方法不能让对象参数引用一个新的状态。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"46-对象构造\"\u003e4.6 对象构造\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e要完整的描述一个方法需要指出方法以及参数类型，这叫做方法的签名（signature）。\u003c/li\u003e\n\u003cli\u003e返回类型不是方法签名的一部分。也就是说，不能有两个名字相同、参数类型也相同却返回不同类型值的方法。\u003c/li\u003e\n\u003cli\u003e如果在编写一个类时没有编写构造器，那么系统就会提供一个无参数构造器。这个构造器将所有的实例域设置为默认值。实例域中的数值类型数据设置为 0、布尔型数值设置为 false、所有对象变量将设置为 null。\u003c/li\u003e\n\u003cli\u003e如果类中提供了至少一个构造器，但是没有提供无参数的构造器，则在构造对象时如果没有提供参数就会被视为不合法。\u003c/li\u003e\n\u003cli\u003e对每一个实例域都可以被设置为一个有意义的初值，这是一种很好的设计习惯。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eEmployee\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"kd\"\u003eprivate\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eString\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ename\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"p\"\u003e...\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"410-类设计技巧\"\u003e4.10 类设计技巧\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e一定要保证数据私有。绝对不要破坏封装性。\u003c/li\u003e\n\u003cli\u003e一定要对数据初始化。\u003c/li\u003e\n\u003cli\u003e不要在类中使用过多的基本类型。就是说，用其他的类代替多个相关的基本类型的使用。\u003c/li\u003e\n\u003cli\u003e不是所有的域都需要独立的域访问器和域更改器。\u003c/li\u003e\n\u003cli\u003e将职责过多的类进行分解。\u003c/li\u003e\n\u003cli\u003e类名和方法名要能够体现它们的职责。\u003c/li\u003e\n\u003c/ul\u003e","title":"【Core Java】读书笔记"},{"content":"提问：Java 对象采用的是值传递还是引用传递？\n有些程序员认为 Java 对象采用的是引用调用，实际上，这种理解是不对的。下面给出一个反例来详细的阐述一下这一问题。\n首先，编写一个交换两个雇员对象的方法：\npublic static void swap(Employee x, Employee y) { Employee temp = x; x = y; y = temp; } 如果 Java 程序时引用调用，那么这个方法就应该能都实现交换实际的效果。\nSystem.out.println(\u0026#34;\\nTesting swap:\u0026#34;); Employee a = new Employee(\u0026#34;Alice\u0026#34;, 70000); Employee b = new Employee(\u0026#34;Bob\u0026#34;, 60000); System.out.println(\u0026#34;Before: a=\u0026#34; + a.getName()); System.out.println(\u0026#34;Before: b=\u0026#34; + b.getName()); swap(a, b); System.out.println(\u0026#34;After: a=\u0026#34; + a.getName()); System.out.println(\u0026#34;After: b=\u0026#34; + b.getName()); 但是结果 a 仍然时 Alice，b 是 Bob。对象引用进行的是值传递。\n其实不必取扣是值传递还是引用传递的字眼，理解其中的原因是最好。\n在调用 swap 时，a 将一个 引用的副本 传递给了 x，让 x 也指向了，相同与 a 指向的内存单元中的 Employee 对象 Alice，b 将一个引用的副本传递给了 y，让 y 也指向了，相同与 b 指向的内存单元中的 Employee 对象 Bob。\n这时执行 swap 方法内部的内容，交换了 x，y 的引用指向，这是 x 指向的时 Bob，y 是 Alice，但是在方法结束后，方法外的 a，b 的指向是仍然没有变化，a 是 Alice，b 是 Bob。\n书上总结 一个方法不能修改一个基本数据类型的参数。 一个方法可以改变一个对象参数的状态。 一个方法不能让对象参数引用一个新的对象。\n\u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2016/04/19/core-java-method-parameter/","summary":"\u003cp\u003e提问：Java 对象采用的是值传递还是引用传递？\u003c/p\u003e\n\u003cp\u003e有些程序员认为 Java 对象采用的是引用调用，实际上，这种理解是不对的。下面给出一个反例来详细的阐述一下这一问题。\u003c/p\u003e\n\u003cp\u003e首先，编写一个交换两个雇员对象的方法：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003epublic\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kd\"\u003estatic\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kt\"\u003evoid\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nf\"\u003eswap\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eEmployee\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eEmployee\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ey\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e   \u003c/span\u003e\u003cspan class=\"n\"\u003eEmployee\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003etemp\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e   \u003c/span\u003e\u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ey\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e   \u003c/span\u003e\u003cspan class=\"n\"\u003ey\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003etemp\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c!-- more --\u003e\n\u003cp\u003e如果 Java 程序时引用调用，那么这个方法就应该能都实现交换实际的效果。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eout\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eprintln\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;\\nTesting swap:\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"n\"\u003eEmployee\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ea\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eEmployee\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;Alice\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003e70000\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"n\"\u003eEmployee\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eb\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eEmployee\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;Bob\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003e60000\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eout\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eprintln\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;Before: a=\u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e+\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ea\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003egetName\u003c/span\u003e\u003cspan class=\"p\"\u003e());\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eout\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eprintln\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;Before: b=\u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e+\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eb\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003egetName\u003c/span\u003e\u003cspan class=\"p\"\u003e());\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"n\"\u003eswap\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ea\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eb\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eout\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eprintln\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;After: a=\u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e+\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ea\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003egetName\u003c/span\u003e\u003cspan class=\"p\"\u003e());\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eout\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eprintln\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;After: b=\u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e+\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eb\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003egetName\u003c/span\u003e\u003cspan class=\"p\"\u003e());\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e但是结果 a 仍然时 Alice，b 是 Bob。对象引用进行的是值传递。\u003c/p\u003e","title":"【Core Java】对象与类-方法参数传递"},{"content":"从 1,2,3\u0026hellip;h 中随机取 k 个中奖号码。\npackage im.zyf.javacore; import java.util.Arrays; import java.util.Scanner; public class LotteryDrawing { public static void main(String[] args) { Scanner in = new Scanner(System.in); System.out.println(\u0026#34;how many numbers do you need?\u0026#34;); int k = in.nextInt(); System.out.println(\u0026#34;what is the highest number?\u0026#34;); int h = in.nextInt(); int[] harr = new int[h]; for (int i = 0; i \u0026lt; h; i++) { harr[i] = i + 1; } int[] karr = new int[k]; for (int i = 0; i \u0026lt; k; i++) { int random = (int) (Math.random() * h); karr[i] = harr[random]; //将数组最后的值，代替掉被取走的值 harr[random] = harr[h - 1]; //数组长度减1 h--; } Arrays.sort(karr); System.out.println(Arrays.toString(karr)); } } Console:\nhow many numbers do you need? 3 what is the highest number? 4444444 [433177, 827621, 2607294] 有几个点：\n取过的数不能再取 取后升序排列 关键点：\n每次取的都是下标，而不是实际的值。下标指向包含尚未抽取的数组元素 \u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2016/03/23/core-java-array-dome/","summary":"\u003cp\u003e从 1,2,3\u0026hellip;h 中随机取 k 个中奖号码。\u003c/p\u003e\n\u003c!-- more --\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kn\"\u003epackage\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nn\"\u003eim.zyf.javacore\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nn\"\u003ejava.util.Arrays\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nn\"\u003ejava.util.Scanner\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"kd\"\u003epublic\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kd\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eLotteryDrawing\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"kd\"\u003epublic\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kd\"\u003estatic\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kt\"\u003evoid\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nf\"\u003emain\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eString\u003c/span\u003e\u003cspan class=\"o\"\u003e[]\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eargs\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e        \u003c/span\u003e\u003cspan class=\"n\"\u003eScanner\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ein\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eScanner\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003ein\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e        \u003c/span\u003e\u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eout\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eprintln\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;how many numbers do you need?\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e        \u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ek\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ein\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003enextInt\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e        \u003c/span\u003e\u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eout\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eprintln\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;what is the highest number?\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e        \u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eh\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ein\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003enextInt\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e        \u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"o\"\u003e[]\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eharr\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003eh\u003c/span\u003e\u003cspan class=\"o\"\u003e]\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e        \u003c/span\u003e\u003cspan class=\"k\"\u003efor\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eh\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"o\"\u003e++\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e            \u003c/span\u003e\u003cspan class=\"n\"\u003eharr\u003c/span\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"o\"\u003e]\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e+\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e        \u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e        \u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"o\"\u003e[]\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ekarr\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003ek\u003c/span\u003e\u003cspan class=\"o\"\u003e]\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e        \u003c/span\u003e\u003cspan class=\"k\"\u003efor\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ek\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"o\"\u003e++\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e            \u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003erandom\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eMath\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003erandom\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eh\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e            \u003c/span\u003e\u003cspan class=\"n\"\u003ekarr\u003c/span\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"o\"\u003e]\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eharr\u003c/span\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003erandom\u003c/span\u003e\u003cspan class=\"o\"\u003e]\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e            \u003c/span\u003e\u003cspan class=\"c1\"\u003e//将数组最后的值，代替掉被取走的值\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e            \u003c/span\u003e\u003cspan class=\"n\"\u003eharr\u003c/span\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003erandom\u003c/span\u003e\u003cspan class=\"o\"\u003e]\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eharr\u003c/span\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003eh\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003e1\u003c/span\u003e\u003cspan class=\"o\"\u003e]\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e            \u003c/span\u003e\u003cspan class=\"c1\"\u003e//数组长度减1\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e            \u003c/span\u003e\u003cspan class=\"n\"\u003eh\u003c/span\u003e\u003cspan class=\"o\"\u003e--\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e        \u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e        \u003c/span\u003e\u003cspan class=\"n\"\u003eArrays\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003esort\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ekarr\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e        \u003c/span\u003e\u003cspan class=\"n\"\u003eSystem\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eout\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eprintln\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eArrays\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003etoString\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ekarr\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eConsole:\u003c/p\u003e","title":"【Core Java】彩票选取中奖数字-数组例子"},{"content":"现在是大四下从学校出来实习。在面试一家公司时，面试官看到我的邮箱（168#yifans.com）是自己的域名后说：\n问：“有自己的网站吗？” “没有。” 问：“域名都买了不自己搭个网站?” “……”\n其实这也不是自己要搭博客的根本原因。\n在大学里，学了些做了些东西，可思考的不多。现在越发觉的一个人的强大在于思想。看书写些东西我想是提高一个人思想的方法吧。文字写下来了也方便交流。\n出来了换了一个环境，遇到新的人，新的事，可以换个角度看人看事。原来我理解的一些技术博客，就是解决问题后的笔记本，有问题从中找，而且觉得很多网上的技术博客里的内容都是来回的转来转去，很多解决方案都是过时的，没什么的。可最近在浏览博客园、csdn 发现了很多精华的前人分享自己所理解的知识、技术中走的弯路，阅读后很受益。\n想想自己，很多事、很多情况下就是这样：没见多少就下结论，管中窥豹，too young.\n其中有这样的一个签名:\n我不能保证写的每个地方都是对的，但是至少能保证不复制、不黏贴，保证每一句话、每一行代码都经过了认真的推敲、仔细的斟酌。每一篇文章的背后，希望都能看到自己对于技术、对于生活的态度。 我相信乔布斯说的，只有那些疯狂到认为自己可以改变世界的人才能真正地改变世界。面对压力，我可以挑灯夜战、不眠不休；面对困难，我愿意迎难而上、永不退缩。 其实我想说的是，我只是一个程序员，这就是我现在纯粹人生的全部。\n再认同不过了。\nReferences 为什么你要写博客？ - 知乎 \u0026ndash; EOF \u0026ndash;\n","permalink":"https://zyf.im/2016/03/18/try-to-write-something/","summary":"\u003cp\u003e现在是大四下从学校出来实习。在面试一家公司时，面试官看到我的邮箱（168#yifans.com）是自己的域名后说：\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e问：“有自己的网站吗？”\n“没有。”\n问：“域名都买了不自己搭个网站?”\n“……”\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003e其实这也不是自己要搭博客的根本原因。\u003c/p\u003e\n\u003cp\u003e在大学里，学了些做了些东西，可思考的不多。现在越发觉的一个人的强大在于思想。看书写些东西我想是提高一个人思想的方法吧。文字写下来了也方便交流。\u003c/p\u003e\n\u003cp\u003e出来了换了一个环境，遇到新的人，新的事，可以换个角度看人看事。原来我理解的一些技术博客，就是解决问题后的笔记本，有问题从中找，而且觉得很多网上的技术博客里的内容都是来回的转来转去，很多解决方案都是过时的，没什么的。可最近在浏览博客园、csdn 发现了很多精华的前人分享自己所理解的知识、技术中走的弯路，阅读后很受益。\u003c/p\u003e\n\u003cp\u003e想想自己，很多事、很多情况下就是这样：没见多少就下结论，管中窥豹，too young.\u003c/p\u003e\n\u003cp\u003e其中有这样的一个签名:\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e我不能保证写的每个地方都是对的，但是至少能保证不复制、不黏贴，保证每一句话、每一行代码都经过了认真的推敲、仔细的斟酌。每一篇文章的背后，希望都能看到自己对于技术、对于生活的态度。\n我相信乔布斯说的，只有那些疯狂到认为自己可以改变世界的人才能真正地改变世界。面对压力，我可以挑灯夜战、不眠不休；面对困难，我愿意迎难而上、永不退缩。\n其实我想说的是，我只是一个程序员，这就是我现在纯粹人生的全部。\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003e再认同不过了。\u003c/p\u003e\n\u003ch2 id=\"references\"\u003eReferences\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://zhuanlan.zhihu.com/p/19743861\"\u003e为什么你要写博客？ - 知乎\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u0026ndash; EOF \u0026ndash;\u003c/p\u003e","title":"试着写东西"},{"content":" 如若我从未成功，我想我会顺其自然， 如若我只听从别人的建议过日，我的心会死去。 我是太固执，管制精神的手段对我奈何不得， 有的人必会成为明日之星，我想该轮到我了。\n我是 Yifan，一名在帝都的开发工程师，现在专注于财经领域。这里记录了我开发过程中的一些经验或是人生感悟，希望对你有帮助。\n下面是我个人微信二维码，欢迎添加。:)\nTimeline 2024 12/31：回顾 2024 10/08：加入 RightCapital 05/11：福宝贴贴。 2023 12/31：回顾 2023 2022 12/31：回顾 2022 01/28：拖把光临。 2021 12/31：回顾 2021 07/02：不动产权证书。 2020 12/31：回顾 2020 05/11：终于复工了。 01/02：成都、丽江、大理 2019 12/31：回顾 2019 08/07：七月初七。 06/13：加入 TME 腾讯音乐娱乐集团。 2018 12/31：蜈支洲 - 丽禾温德姆跨年。回顾 2018 11/18：「你愿意嫁给我吗？」 03/13：Swift Pandarow v1.4.2 Release。 2017 12/31：回顾 2017 09/06：开始接触 iOS 开发。 06/25：与你相遇，好幸运。 2016 12/31：回顾 2016 08/31：刚刚毕业的两月个小结 07/01：大学顺利毕业，入职实习公司，更专注于计算机技术。 03/18：试着写东西 真实地活着。\n","permalink":"https://zyf.im/about/","summary":"\u003cblockquote\u003e\n\u003cp\u003e如若我从未成功，我想我会顺其自然，\u003c/br\u003e\n如若我只听从别人的建议过日，我的心会死去。\u003c/br\u003e\n我是太固执，管制精神的手段对我奈何不得，\u003c/br\u003e\n有的人必会成为明日之星，我想该轮到我了。\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003e我是 Yifan，一名在帝都的开发工程师，现在专注于财经领域。这里记录了我开发过程中的一些经验或是人生感悟，希望对你有帮助。\u003c/p\u003e\n\u003cp\u003e下面是我个人微信二维码，欢迎添加。:)\u003c/p\u003e\n\u003cimg alt=\"yifanszhao_wechat_qrcode\" style=\"width:240px;\" src=\"https://user-images.githubusercontent.com/9289792/126154429-3143f154-9eb4-4218-9755-8dc087eea27b.jpg\" /\u003e\n\u003ch2 id=\"timeline\"\u003eTimeline\u003c/h2\u003e\n\u003ch3 id=\"2024\"\u003e2024\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e12/31：\u003ca href=\"#\"\u003e回顾 2024\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e10/08：加入 RightCapital\u003c/li\u003e\n\u003cli\u003e05/11：福宝贴贴。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"2023\"\u003e2023\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e12/31：\u003ca href=\"#\"\u003e回顾 2023\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"2022\"\u003e2022\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e12/31：\u003ca href=\"#\"\u003e回顾 2022\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e01/28：拖把光临。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"2021\"\u003e2021\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e12/31：\u003ca href=\"#\"\u003e回顾 2021\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e07/02：不动产权证书。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"2020\"\u003e2020\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e12/31：\u003ca href=\"#\"\u003e回顾 2020\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e05/11：终于复工了。\u003c/li\u003e\n\u003cli\u003e01/02：\u003ca href=\"https://www.bilibili.com/video/BV1K7411o73B\"\u003e成都、丽江、大理\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"2019\"\u003e2019\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e12/31：\u003ca href=\"#\"\u003e回顾 2019\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e08/07：七月初七。\u003c/li\u003e\n\u003cli\u003e06/13：加入 TME 腾讯音乐娱乐集团。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"2018\"\u003e2018\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e12/31：蜈支洲 - 丽禾温德姆跨年。\u003ca href=\"/2018/12/31/review-2018/\"\u003e回顾 2018\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e11/18：「你愿意嫁给我吗？」\u003c/li\u003e\n\u003cli\u003e03/13：Swift Pandarow v1.4.2 Release。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"2017\"\u003e2017\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e12/31：\u003ca href=\"/2017/12/31/review-2017/\"\u003e回顾 2017\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e09/06：开始接触 iOS 开发。\u003c/li\u003e\n\u003cli\u003e06/25：与你相遇，好幸运。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"2016\"\u003e2016\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e12/31：\u003ca href=\"/2016/12/31/review-2016/\"\u003e回顾 2016\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e08/31：\u003ca href=\"/2016/08/31/20160601-20160831-report/\"\u003e刚刚毕业的两月个小结\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e07/01：大学顺利毕业，入职实习公司，更专注于计算机技术。\u003c/li\u003e\n\u003cli\u003e03/18：\u003ca href=\"/2016/03/18/try-to-write-something/\"\u003e试着写东西\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cblockquote\u003e\n\u003cp\u003e真实地活着。\u003c/p\u003e\u003c/blockquote\u003e","title":"About Yifans_Z"},{"content":"Engineers JieJiSS\u0026rsquo; Blog Student, Studying in Beijing, China. Pig Fang Blog Metro Fan / Minecraft Friends 我盒鸡王又回来啦 喷墨的鱼直播间（域名低价出售）。 ","permalink":"https://zyf.im/links/","summary":"\u003ch2 id=\"engineers\"\u003eEngineers\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://blog.jiejiss.com/\"\u003eJieJiSS\u0026rsquo; Blog\u003c/a\u003e Student, Studying in Beijing, China.\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://blog.gplane.win/\"\u003ePig Fang Blog\u003c/a\u003e Metro Fan / Minecraft\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"friends\"\u003eFriends\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://penmodeyu.com\"\u003e我盒鸡王又回来啦\u003c/a\u003e 喷墨的鱼直播间（域名低价出售）。\u003c/li\u003e\n\u003c/ul\u003e","title":"Links"}]