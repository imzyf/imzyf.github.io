<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Composer 文档笔记 | ZYF.IM BLOG</title>
<meta name=keywords content="php,composer"><meta name=description content="Basic usage

https://getcomposer.org/doc/01-basic-usage.md
# get a list of your locally available platform packages.
# php | ext-<name> | lib-<name>
composer show --platform
Libraries

https://getcomposer.org/doc/02-libraries.md
Light-weight distribution packages 轻量级分发包。使用 .gitattributes 来防止不需要的文件使 zip 分发包膨胀。
// .gitattributes
/demo export-ignore
phpunit.xml.dist export-ignore
/.github/ export-ignore
通过检查手动生成的压缩文件进行测试：
git archive branchName --format zip -o file.zip
Command-line interface / Commands

https://getcomposer.org/doc/03-cli.md
As Composer uses symfony/console you can call commands by short name if it&rsquo;s not ambiguous."><meta name=author content="Me, LLM"><link rel=canonical href=https://zyf.im/2020/10/28/composer-document-note/><link crossorigin=anonymous href=/assets/css/stylesheet.4997c86cdc3165a43745858554a5b14aaf4d3769db9f06a36b0c69ef98eb2927.css integrity="sha256-SZfIbNwxZaQ3RYWFVKWxSq9NN2nbnwajawxp75jrKSc=" rel="preload stylesheet" as=style><link rel=icon href=https://zyf.im/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://zyf.im/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://zyf.im/favicon-32x32.png><link rel=apple-touch-icon href=https://zyf.im/apple-touch-icon.png><link rel=mask-icon href=https://zyf.im/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://zyf.im/2020/10/28/composer-document-note/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-6DVZ6E58DG"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-6DVZ6E58DG")}</script><meta property="og:url" content="https://zyf.im/2020/10/28/composer-document-note/"><meta property="og:site_name" content="ZYF.IM BLOG"><meta property="og:title" content="Composer 文档笔记"><meta property="og:description" content="Basic usage https://getcomposer.org/doc/01-basic-usage.md
# get a list of your locally available platform packages. # php | ext-<name> | lib-<name> composer show --platform Libraries https://getcomposer.org/doc/02-libraries.md
Light-weight distribution packages 轻量级分发包。使用 .gitattributes 来防止不需要的文件使 zip 分发包膨胀。
// .gitattributes /demo export-ignore phpunit.xml.dist export-ignore /.github/ export-ignore 通过检查手动生成的压缩文件进行测试：
git archive branchName --format zip -o file.zip Command-line interface / Commands https://getcomposer.org/doc/03-cli.md
As Composer uses symfony/console you can call commands by short name if it’s not ambiguous."><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-10-28T11:36:27+00:00"><meta property="article:modified_time" content="2020-10-28T11:36:27+00:00"><meta property="article:tag" content="Php"><meta property="article:tag" content="Composer"><meta name=twitter:card content="summary"><meta name=twitter:title content="Composer 文档笔记"><meta name=twitter:description content="Basic usage

https://getcomposer.org/doc/01-basic-usage.md
# get a list of your locally available platform packages.
# php | ext-<name> | lib-<name>
composer show --platform
Libraries

https://getcomposer.org/doc/02-libraries.md
Light-weight distribution packages 轻量级分发包。使用 .gitattributes 来防止不需要的文件使 zip 分发包膨胀。
// .gitattributes
/demo export-ignore
phpunit.xml.dist export-ignore
/.github/ export-ignore
通过检查手动生成的压缩文件进行测试：
git archive branchName --format zip -o file.zip
Command-line interface / Commands

https://getcomposer.org/doc/03-cli.md
As Composer uses symfony/console you can call commands by short name if it&rsquo;s not ambiguous."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://zyf.im/posts/"},{"@type":"ListItem","position":2,"name":"Composer 文档笔记","item":"https://zyf.im/2020/10/28/composer-document-note/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Composer 文档笔记","name":"Composer 文档笔记","description":"Basic usage https://getcomposer.org/doc/01-basic-usage.md\n# get a list of your locally available platform packages. # php | ext-\u0026lt;name\u0026gt; | lib-\u0026lt;name\u0026gt; composer show --platform Libraries https://getcomposer.org/doc/02-libraries.md\nLight-weight distribution packages 轻量级分发包。使用 .gitattributes 来防止不需要的文件使 zip 分发包膨胀。\n// .gitattributes /demo export-ignore phpunit.xml.dist export-ignore /.github/ export-ignore 通过检查手动生成的压缩文件进行测试：\ngit archive branchName --format zip -o file.zip Command-line interface / Commands https://getcomposer.org/doc/03-cli.md\nAs Composer uses symfony/console you can call commands by short name if it\u0026rsquo;s not ambiguous.\n","keywords":["php","composer"],"articleBody":"Basic usage https://getcomposer.org/doc/01-basic-usage.md\n# get a list of your locally available platform packages. # php | ext- | lib- composer show --platform Libraries https://getcomposer.org/doc/02-libraries.md\nLight-weight distribution packages 轻量级分发包。使用 .gitattributes 来防止不需要的文件使 zip 分发包膨胀。\n// .gitattributes /demo export-ignore phpunit.xml.dist export-ignore /.github/ export-ignore 通过检查手动生成的压缩文件进行测试：\ngit archive branchName --format zip -o file.zip Command-line interface / Commands https://getcomposer.org/doc/03-cli.md\nAs Composer uses symfony/console you can call commands by short name if it’s not ambiguous.\ncomposer dump # calls composer dump-autoload Bash Completions\ncomposer completion bash \u003e completion.bash Global Options:\n--profile 显示计时和内存使用信息 install / i:\nphp composer.phar install 如果当前目录中有 composer.lock 文件，会使用其中的确切版本而不是重新解析。这确保了每个人使用的依赖版本相同。\n如果没有 composer.lock 文件，Composer 会在解析依赖后创建一个。\n常用选项：\n--prefer-install: 指定安装方式，可选 source 或 dist --no-dev: 跳过安装 require-dev 中列出的包 --optimize-autoloader (-o): 优化自动加载器，建议在生产环境使用 --classmap-authoritative (-a): 仅从 classmap 自动加载类，隐式启用 --optimize-autoloader update / u / upgrade:\nphp composer.phar update 更新所有依赖到最新版本（根据 composer.json 的约束）并更新 composer.lock 文件。\n常用选项：\n--prefer-stable: 优先使用稳定版本 --prefer-lowest: 尝试回退到最低匹配的版本 --with-dependencies: 同时更新依赖的依赖项 require / r:\nphp composer.phar require vendor/package:version 添加新的依赖包并更新 composer.json 文件。\nremove / rm / uninstall:\nphp composer.phar remove vendor/package 移除包并更新 composer.json 文件。\ndump-autoload / dumpautoload:\nphp composer.phar dump-autoload 更新自动加载器，不安装或更新任何包。在添加新类时很有用。\n选项：\n-o, --optimize: 生成优化的 autoloader --classmap-authoritative (-a): 仅从 classmap 自动加载 --no-dev: 不生成开发环境的 autoloader global:\nphp composer.phar global require vendor/package 全局安装包，存储在 COMPOSER_HOME 目录。\nsearch:\nphp composer.phar search keyword 搜索包。\nself-update / selfupdate:\nphp composer.phar self-update 更新 Composer 到最新版本。\nComposer 支持多种环境变量来控制其行为：\nCOMPOSER_HOME: 指定 Composer 主目录位置 COMPOSER_CACHE_DIR: 更改 Composer 缓存目录 COMPOSER_MEMORY_LIMIT: 设置 PHP 内存限制 COMPOSER_PROCESS_TIMEOUT: 设置命令执行超时时间（默认 300 秒） COMPOSER_NO_INTERACTION: 禁用交互模式 COMPOSER_NO_DEV: 等同于 --no-dev 选项 COMPOSER_VENDOR_DIR: 更改安装依赖的目录 The composer.json schema https://getcomposer.org/doc/04-schema.md\ncomposer.json 文件是 Composer 项目的核心配置文件，用于定义包的基本信息和依赖关系。以下是主要字段的说明：\n基本字段 name: 包名称，格式为 vendor/project，例如 monolog/monolog。必须小写，可包含短横线、下划线或点号。 description: 包的简短描述，通常为一行。 version: 包的版本号，格式如 1.0.0 或 v1.0.0。一般建议省略，由 VCS 标签推断。 type: 包类型，默认为 library。其他可选值包括 project、metapackage 和 composer-plugin。 keywords: 关键词数组，用于搜索和过滤。 homepage: 项目网站的 URL。 readme: 自述文件的相对路径，默认为 README.md。 time: 版本发布日期，格式为 YYYY-MM-DD 或 YYYY-MM-DD HH:MM:SS。 license: 包的许可证，可以是字符串或字符串数组。 作者与支持 authors: 包作者数组，每个作者为一个对象，包含 name、email、homepage 和 role 字段。 support: 提供支持的各种信息，如 email、issues、forum、wiki 等。 funding: 用于赞助包作者的 URL 数组。 依赖管理 require: 运行时必需的依赖包映射表（包名到版本约束）。 require-dev: 开发环境需要的依赖包映射表，仅对根包有效。 conflict: 与当前包冲突的包。 replace: 由当前包替换的包。 provide: 当前包提供的包（接口实现等）。 suggest: 推荐安装的包，仅起信息提示作用。 自动加载配置 autoload: 定义项目自动加载规则，支持 psr-4、psr-0、classmap 和 files。 autoload-dev: 开发环境的额外自动加载规则，仅对根包有效。 其他高级配置 repositories: 定义额外的包来源，仅对根包有效。 minimum-stability: 默认包稳定性过滤级别，仅对根包有效。 prefer-stable: 是否优先使用稳定版本，仅对根包有效。 config: 各种配置选项，仅对根包有效。 scripts: 在安装过程中各个阶段执行的脚本钩子，仅对根包有效。 extra: 供脚本使用的任意额外数据。 bin: 应作为二进制文件安装的文件集合。 示例：\n{ \"name\": \"monolog/monolog\", \"description\": \"Logging library\", \"keywords\": [\"logging\", \"psr-3\"], \"homepage\": \"https://github.com/Seldaek/monolog\", \"license\": \"MIT\", \"authors\": [ { \"name\": \"Jordi Boggiano\", \"email\": \"j.boggiano@seld.be\", \"homepage\": \"https://seld.be\" } ], \"require\": { \"php\": \"\u003e=5.3.0\", \"psr/log\": \"~1.0\" }, \"autoload\": { \"psr-4\": {\"Monolog\\\\\": \"src/Monolog\"} } } Repositories https://getcomposer.org/doc/05-repositories.md\n仓库是包的来源，Composer 会在所有配置的仓库中查找项目所需的包。本节介绍仓库的概念和类型。\n仓库类型 1. Composer 仓库 使用单个 packages.json 文件包含所有包元数据的仓库类型，这也是 Packagist 使用的类型。\n{ \"repositories\": [ { \"type\": \"composer\", \"url\": \"https://example.org\" } ] } 2. VCS 仓库 版本控制系统（Version Control System）仓库，支持从 git、svn、fossil 或 hg 仓库安装包。\n{ \"repositories\": [ { \"type\": \"vcs\", \"url\": \"https://github.com/username/repository\" } ], \"require\": { \"vendor/package\": \"dev-branch-name\" } } 使用 VCS 仓库的主要场景包括：\n维护第三方库的自己的分支 使用私有仓库 需要直接从版本控制系统获取代码 3. Package 仓库 针对不支持 Composer 的项目，可以手动定义包的信息。\n{ \"repositories\": [ { \"type\": \"package\", \"package\": { \"name\": \"smarty/smarty\", \"version\": \"3.1.7\", \"dist\": { \"url\": \"https://www.smarty.net/files/Smarty-3.1.7.zip\", \"type\": \"zip\" } } } ] } 自托管仓库选项 当需要保持包私有或为项目创建独立生态系统时，可以选择自托管仓库：\nPrivate Packagist：提供私有包托管和镜像功能的托管或自托管应用。\nSatis：轻量级的静态 Composer 仓库生成器，适合小型团队。\nArtifact 仓库：使用包含 ZIP 或 TAR 归档文件的文件夹作为包源。\n{ \"repositories\": [ { \"type\": \"artifact\", \"url\": \"path/to/directory/with/zips/\" } ] } Path 仓库：直接依赖本地目录，对于单体仓库特别有用。\n{ \"repositories\": [ { \"type\": \"path\", \"url\": \"../../packages/my-package\" } ] } 禁用 Packagist.org 默认情况下，Composer 会使用 Packagist.org 作为包源。如需禁用：\n{ \"repositories\": [ { \"packagist.org\": false } ] } 或通过全局配置：\nphp composer.phar config -g repo.packagist false Config https://getcomposer.org/doc/06-config.md\nComposer 配置选项可以通过 composer.json 中的 config 字段设置。以下是一些常用的配置项：\n基本配置选项 process-timeout: 进程执行超时时间（秒），默认 300（5分钟）。\n{ \"config\": { \"process-timeout\": 900 } } allow-plugins: 控制哪些 Composer 插件可以执行代码（Composer 2.2.0+）。\n{ \"config\": { \"allow-plugins\": { \"vendor/plugin-name\": true, \"another-vendor/*\": true } } } preferred-install: 首选安装方式，可为 source、dist 或 auto。\n{ \"config\": { \"preferred-install\": { \"vendor/*\": \"source\", \"*\": \"dist\" } } } 仓库与认证 github-protocols: 克隆 GitHub 仓库使用的协议列表，默认 [\"https\", \"ssh\", \"git\"]。\ngithub-oauth: GitHub OAuth 令牌列表。\ngitlab-oauth/gitlab-token: GitLab OAuth 令牌或私有令牌列表。\nhttp-basic: HTTP 基本认证信息。\n{ \"config\": { \"http-basic\": { \"example.org\": { \"username\": \"username\", \"password\": \"password\" } } } } 目录与缓存 vendor-dir: 安装依赖的目录，默认为 vendor。 bin-dir: 二进制文件链接目录，默认为 vendor/bin。 cache-dir: 缓存目录。 cache-files-ttl: 缓存文件的存活时间（秒），默认 15552000（6个月）。 cache-files-maxsize: 缓存可使用的最大空间，默认 “300MiB”。 自动加载相关 optimize-autoloader: 始终优化自动加载器，默认 false。 prepend-autoloader: 是否将 Composer 自动加载器前置到已存在的自动加载器，默认 true。 classmap-authoritative: 设为 true 时，自动加载器只会从 classmap 加载类，默认 false。 apcu-autoloader: 是否使用 APCu 缓存查找的类，默认 false。 安全与其他 platform-check: 平台检查级别，默认 php-only，可设为 true 或 false。 secure-http: 是否只允许通过 HTTPS 下载包，默认 true。 discard-changes: 处理脏更新的方式，默认 false，可设为 true 或 stash。 sort-packages: 添加新包时是否按名称排序，默认 false。 全局配置 某些配置可通过命令行全局设置：\nphp composer.phar config -g repo.packagist false php composer.phar config -g process-timeout 900 Runtime Composer utilities https://getcomposer.org/doc/07-runtime.md\nComposer 除了安装和管理依赖外，还提供了一些运行时实用工具。如果需要依赖特定版本的这些功能，可以通过 composer-runtime-api 包实现。\n自动加载 最常用的运行时工具是自动加载器，在所有 Composer 版本中可用。\nrequire __DIR__ . '/vendor/autoload.php'; // 现在可以使用项目的依赖了 $log = new Monolog\\Logger('name'); 已安装版本信息 Composer 2.0 引入了 Composer\\InstalledVersions 类，提供了检查已安装包的静态方法。\n检查包是否存在 \\Composer\\InstalledVersions::isInstalled('vendor/package'); // 返回布尔值 \\Composer\\InstalledVersions::isInstalled('psr/log-implementation'); // 检查虚拟包 从 Composer 2.1 开始，还可以检查包是否通过 require-dev 安装：\n\\Composer\\InstalledVersions::isInstalled('vendor/package', false); // 仅检查 require 中的包 检查包版本 use Composer\\Semver\\VersionParser; // 检查包是否满足版本约束 \\Composer\\InstalledVersions::satisfies(new VersionParser, 'vendor/package', '2.0.*'); // 获取包的版本号 $version = \\Composer\\InstalledVersions::getVersion('vendor/package'); // 标准化版本 (如 1.2.3.0) $prettyVersion = \\Composer\\InstalledVersions::getPrettyVersion('vendor/package'); // 原始版本 (如 v1.2.3) 获取包的安装路径 // 获取包安装的绝对路径 $path = \\Composer\\InstalledVersions::getInstallPath('vendor/package'); 查找指定类型的已安装包 // 获取所有类型为 'foo-plugin' 的已安装包 $packages = \\Composer\\InstalledVersions::getInstalledPackagesByType('foo-plugin'); 平台检查 Composer 2.0 引入了 vendor/composer/platform_check.php 文件，会在包含自动加载器时自动执行。它会验证当前 PHP 环境是否满足平台要求，如 PHP 版本和扩展。\n默认情况下，只检查 PHP 版本（php-only）。可以通过 platform-check 配置选项修改行为：\n{ \"config\": { \"platform-check\": true // 也检查 PHP 扩展 } } 如果要禁用此安全检查：\n{ \"config\": { \"platform-check\": false } } 二进制文件中的自动加载器路径 Composer 2.2 引入了全局变量 $_composer_autoload_path，它在运行 Composer 安装的二进制文件时设置。\n二进制文件中的 bin-dir 路径 Composer 2.2.2 引入了全局变量 $_composer_bin_dir，它在运行 Composer 安装的二进制文件时设置。\n","wordCount":"802","inLanguage":"en","datePublished":"2020-10-28T11:36:27Z","dateModified":"2020-10-28T11:36:27Z","author":[{"@type":"Person","name":"Me"},{"@type":"Person","name":"LLM"}],"mainEntityOfPage":{"@type":"WebPage","@id":"https://zyf.im/2020/10/28/composer-document-note/"},"publisher":{"@type":"Organization","name":"ZYF.IM BLOG","logo":{"@type":"ImageObject","url":"https://zyf.im/favicon.ico"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://zyf.im/ accesskey=h title="ZYF.IM (Alt + H)"><img src=https://zyf.im/apple-touch-icon.png alt aria-label=logo height=35>ZYF.IM</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://zyf.im/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://zyf.im/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://zyf.im/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://zyf.im/about/ title=About><span>About</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://zyf.im/>Home</a>&nbsp;»&nbsp;<a href=https://zyf.im/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">Composer 文档笔记</h1><div class=post-meta><span title='2020-10-28 11:36:27 +0000 UTC'>October 28, 2020</span>&nbsp;·&nbsp;4 min&nbsp;·&nbsp;802 words&nbsp;·&nbsp;Me, LLM</div></header><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#basic-usage>Basic usage</a><ul><li><a href=#libraries>Libraries</a></li></ul></li><li><a href=#command-line-interface--commands>Command-line interface / Commands</a></li><li><a href=#the-composerjson-schema>The composer.json schema</a><ul><li><a href=#基本字段>基本字段</a></li><li><a href=#作者与支持>作者与支持</a></li><li><a href=#依赖管理>依赖管理</a></li><li><a href=#自动加载配置>自动加载配置</a></li><li><a href=#其他高级配置>其他高级配置</a></li></ul></li><li><a href=#repositories>Repositories</a><ul><li><a href=#仓库类型>仓库类型</a></li><li><a href=#自托管仓库选项>自托管仓库选项</a></li><li><a href=#禁用-packagistorg>禁用 Packagist.org</a></li></ul></li><li><a href=#config>Config</a><ul><li><a href=#基本配置选项>基本配置选项</a></li><li><a href=#仓库与认证>仓库与认证</a></li><li><a href=#目录与缓存>目录与缓存</a></li><li><a href=#自动加载相关>自动加载相关</a></li><li><a href=#安全与其他>安全与其他</a></li><li><a href=#全局配置>全局配置</a></li></ul></li><li><a href=#runtime-composer-utilities>Runtime Composer utilities</a><ul><li><a href=#自动加载>自动加载</a></li><li><a href=#已安装版本信息>已安装版本信息</a></li><li><a href=#平台检查>平台检查</a></li><li><a href=#二进制文件中的自动加载器路径>二进制文件中的自动加载器路径</a></li><li><a href=#二进制文件中的-bin-dir-路径>二进制文件中的 bin-dir 路径</a></li></ul></li></ul></nav></div></details></div><div class=post-content><h2 id=basic-usage>Basic usage<a hidden class=anchor aria-hidden=true href=#basic-usage>#</a></h2><blockquote><p><a href=https://getcomposer.org/doc/01-basic-usage.md>https://getcomposer.org/doc/01-basic-usage.md</a></p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># get a list of your locally available platform packages.</span>
</span></span><span class=line><span class=cl><span class=c1># php | ext-&lt;name&gt; | lib-&lt;name&gt;</span>
</span></span><span class=line><span class=cl>composer show --platform
</span></span></code></pre></div><h3 id=libraries>Libraries<a hidden class=anchor aria-hidden=true href=#libraries>#</a></h3><blockquote><p><a href=https://getcomposer.org/doc/02-libraries.md>https://getcomposer.org/doc/02-libraries.md</a></p></blockquote><p>Light-weight distribution packages 轻量级分发包。使用 <code>.gitattributes</code> 来防止不需要的文件使 zip 分发包膨胀。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-txt data-lang=txt><span class=line><span class=cl>// .gitattributes
</span></span><span class=line><span class=cl>/demo export-ignore
</span></span><span class=line><span class=cl>phpunit.xml.dist export-ignore
</span></span><span class=line><span class=cl>/.github/ export-ignore
</span></span></code></pre></div><p>通过检查手动生成的压缩文件进行测试：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>git archive branchName --format zip -o file.zip
</span></span></code></pre></div><h2 id=command-line-interface--commands>Command-line interface / Commands<a hidden class=anchor aria-hidden=true href=#command-line-interface--commands>#</a></h2><blockquote><p><a href=https://getcomposer.org/doc/03-cli.md>https://getcomposer.org/doc/03-cli.md</a></p></blockquote><p>As Composer uses symfony/console you can call commands by short name if it&rsquo;s not ambiguous.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>composer dump
</span></span><span class=line><span class=cl><span class=c1># calls</span>
</span></span><span class=line><span class=cl>composer dump-autoload
</span></span></code></pre></div><p>Bash Completions</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>composer completion bash &gt; completion.bash
</span></span></code></pre></div><p>Global Options:</p><ul><li><code>--profile</code> 显示计时和内存使用信息</li></ul><p>install / i:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>php composer.phar install
</span></span></code></pre></div><p>如果当前目录中有 <code>composer.lock</code> 文件，会使用其中的确切版本而不是重新解析。这确保了每个人使用的依赖版本相同。</p><p>如果没有 <code>composer.lock</code> 文件，Composer 会在解析依赖后创建一个。</p><p>常用选项：</p><ul><li><code>--prefer-install</code>: 指定安装方式，可选 <code>source</code> 或 <code>dist</code></li><li><code>--no-dev</code>: 跳过安装 <code>require-dev</code> 中列出的包</li><li><code>--optimize-autoloader (-o)</code>: 优化自动加载器，建议在生产环境使用</li><li><code>--classmap-authoritative (-a)</code>: 仅从 classmap 自动加载类，隐式启用 <code>--optimize-autoloader</code></li></ul><p>update / u / upgrade:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>php composer.phar update
</span></span></code></pre></div><p>更新所有依赖到最新版本（根据 composer.json 的约束）并更新 composer.lock 文件。</p><p>常用选项：</p><ul><li><code>--prefer-stable</code>: 优先使用稳定版本</li><li><code>--prefer-lowest</code>: 尝试回退到最低匹配的版本</li><li><code>--with-dependencies</code>: 同时更新依赖的依赖项</li></ul><p>require / r:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>php composer.phar require vendor/package:version
</span></span></code></pre></div><p>添加新的依赖包并更新 composer.json 文件。</p><p>remove / rm / uninstall:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>php composer.phar remove vendor/package
</span></span></code></pre></div><p>移除包并更新 composer.json 文件。</p><p>dump-autoload / dumpautoload:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>php composer.phar dump-autoload
</span></span></code></pre></div><p>更新自动加载器，不安装或更新任何包。在添加新类时很有用。</p><p>选项：</p><ul><li><code>-o, --optimize</code>: 生成优化的 autoloader</li><li><code>--classmap-authoritative (-a)</code>: 仅从 classmap 自动加载</li><li><code>--no-dev</code>: 不生成开发环境的 autoloader</li></ul><p>global:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>php composer.phar global require vendor/package
</span></span></code></pre></div><p>全局安装包，存储在 COMPOSER_HOME 目录。</p><p>search:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>php composer.phar search keyword
</span></span></code></pre></div><p>搜索包。</p><p>self-update / selfupdate:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>php composer.phar self-update
</span></span></code></pre></div><p>更新 Composer 到最新版本。</p><p>Composer 支持多种环境变量来控制其行为：</p><ul><li><code>COMPOSER_HOME</code>: 指定 Composer 主目录位置</li><li><code>COMPOSER_CACHE_DIR</code>: 更改 Composer 缓存目录</li><li><code>COMPOSER_MEMORY_LIMIT</code>: 设置 PHP 内存限制</li><li><code>COMPOSER_PROCESS_TIMEOUT</code>: 设置命令执行超时时间（默认 300 秒）</li><li><code>COMPOSER_NO_INTERACTION</code>: 禁用交互模式</li><li><code>COMPOSER_NO_DEV</code>: 等同于 <code>--no-dev</code> 选项</li><li><code>COMPOSER_VENDOR_DIR</code>: 更改安装依赖的目录</li></ul><h2 id=the-composerjson-schema>The composer.json schema<a hidden class=anchor aria-hidden=true href=#the-composerjson-schema>#</a></h2><blockquote><p><a href=https://getcomposer.org/doc/04-schema.md>https://getcomposer.org/doc/04-schema.md</a></p></blockquote><p>composer.json 文件是 Composer 项目的核心配置文件，用于定义包的基本信息和依赖关系。以下是主要字段的说明：</p><h3 id=基本字段>基本字段<a hidden class=anchor aria-hidden=true href=#基本字段>#</a></h3><ul><li><strong>name</strong>: 包名称，格式为 <code>vendor/project</code>，例如 <code>monolog/monolog</code>。必须小写，可包含短横线、下划线或点号。</li><li><strong>description</strong>: 包的简短描述，通常为一行。</li><li><strong>version</strong>: 包的版本号，格式如 <code>1.0.0</code> 或 <code>v1.0.0</code>。一般建议省略，由 VCS 标签推断。</li><li><strong>type</strong>: 包类型，默认为 <code>library</code>。其他可选值包括 <code>project</code>、<code>metapackage</code> 和 <code>composer-plugin</code>。</li><li><strong>keywords</strong>: 关键词数组，用于搜索和过滤。</li><li><strong>homepage</strong>: 项目网站的 URL。</li><li><strong>readme</strong>: 自述文件的相对路径，默认为 <code>README.md</code>。</li><li><strong>time</strong>: 版本发布日期，格式为 <code>YYYY-MM-DD</code> 或 <code>YYYY-MM-DD HH:MM:SS</code>。</li><li><strong>license</strong>: 包的许可证，可以是字符串或字符串数组。</li></ul><h3 id=作者与支持>作者与支持<a hidden class=anchor aria-hidden=true href=#作者与支持>#</a></h3><ul><li><strong>authors</strong>: 包作者数组，每个作者为一个对象，包含 <code>name</code>、<code>email</code>、<code>homepage</code> 和 <code>role</code> 字段。</li><li><strong>support</strong>: 提供支持的各种信息，如 <code>email</code>、<code>issues</code>、<code>forum</code>、<code>wiki</code> 等。</li><li><strong>funding</strong>: 用于赞助包作者的 URL 数组。</li></ul><h3 id=依赖管理>依赖管理<a hidden class=anchor aria-hidden=true href=#依赖管理>#</a></h3><ul><li><strong>require</strong>: 运行时必需的依赖包映射表（包名到版本约束）。</li><li><strong>require-dev</strong>: 开发环境需要的依赖包映射表，仅对根包有效。</li><li><strong>conflict</strong>: 与当前包冲突的包。</li><li><strong>replace</strong>: 由当前包替换的包。</li><li><strong>provide</strong>: 当前包提供的包（接口实现等）。</li><li><strong>suggest</strong>: 推荐安装的包，仅起信息提示作用。</li></ul><h3 id=自动加载配置>自动加载配置<a hidden class=anchor aria-hidden=true href=#自动加载配置>#</a></h3><ul><li><strong>autoload</strong>: 定义项目自动加载规则，支持 <code>psr-4</code>、<code>psr-0</code>、<code>classmap</code> 和 <code>files</code>。</li><li><strong>autoload-dev</strong>: 开发环境的额外自动加载规则，仅对根包有效。</li></ul><h3 id=其他高级配置>其他高级配置<a hidden class=anchor aria-hidden=true href=#其他高级配置>#</a></h3><ul><li><strong>repositories</strong>: 定义额外的包来源，仅对根包有效。</li><li><strong>minimum-stability</strong>: 默认包稳定性过滤级别，仅对根包有效。</li><li><strong>prefer-stable</strong>: 是否优先使用稳定版本，仅对根包有效。</li><li><strong>config</strong>: 各种配置选项，仅对根包有效。</li><li><strong>scripts</strong>: 在安装过程中各个阶段执行的脚本钩子，仅对根包有效。</li><li><strong>extra</strong>: 供脚本使用的任意额外数据。</li><li><strong>bin</strong>: 应作为二进制文件安装的文件集合。</li></ul><p>示例：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;monolog/monolog&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;description&#34;</span><span class=p>:</span> <span class=s2>&#34;Logging library&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;keywords&#34;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&#34;logging&#34;</span><span class=p>,</span> <span class=s2>&#34;psr-3&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;homepage&#34;</span><span class=p>:</span> <span class=s2>&#34;https://github.com/Seldaek/monolog&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;license&#34;</span><span class=p>:</span> <span class=s2>&#34;MIT&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;authors&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;Jordi Boggiano&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;email&#34;</span><span class=p>:</span> <span class=s2>&#34;j.boggiano@seld.be&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;homepage&#34;</span><span class=p>:</span> <span class=s2>&#34;https://seld.be&#34;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>],</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;require&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;php&#34;</span><span class=p>:</span> <span class=s2>&#34;&gt;=5.3.0&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;psr/log&#34;</span><span class=p>:</span> <span class=s2>&#34;~1.0&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;autoload&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;psr-4&#34;</span><span class=p>:</span> <span class=p>{</span><span class=nt>&#34;Monolog\\&#34;</span><span class=p>:</span> <span class=s2>&#34;src/Monolog&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h2 id=repositories>Repositories<a hidden class=anchor aria-hidden=true href=#repositories>#</a></h2><blockquote><p><a href=https://getcomposer.org/doc/05-repositories.md>https://getcomposer.org/doc/05-repositories.md</a></p></blockquote><p>仓库是包的来源，Composer 会在所有配置的仓库中查找项目所需的包。本节介绍仓库的概念和类型。</p><h3 id=仓库类型>仓库类型<a hidden class=anchor aria-hidden=true href=#仓库类型>#</a></h3><h4 id=1-composer-仓库>1. Composer 仓库<a hidden class=anchor aria-hidden=true href=#1-composer-仓库>#</a></h4><p>使用单个 <code>packages.json</code> 文件包含所有包元数据的仓库类型，这也是 Packagist 使用的类型。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;repositories&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;composer&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;url&#34;</span><span class=p>:</span> <span class=s2>&#34;https://example.org&#34;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h4 id=2-vcs-仓库>2. VCS 仓库<a hidden class=anchor aria-hidden=true href=#2-vcs-仓库>#</a></h4><p>版本控制系统（Version Control System）仓库，支持从 git、svn、fossil 或 hg 仓库安装包。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;repositories&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;vcs&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;url&#34;</span><span class=p>:</span> <span class=s2>&#34;https://github.com/username/repository&#34;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>],</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;require&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;vendor/package&#34;</span><span class=p>:</span> <span class=s2>&#34;dev-branch-name&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>使用 VCS 仓库的主要场景包括：</p><ul><li>维护第三方库的自己的分支</li><li>使用私有仓库</li><li>需要直接从版本控制系统获取代码</li></ul><h4 id=3-package-仓库>3. Package 仓库<a hidden class=anchor aria-hidden=true href=#3-package-仓库>#</a></h4><p>针对不支持 Composer 的项目，可以手动定义包的信息。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;repositories&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;package&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;package&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;smarty/smarty&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nt>&#34;version&#34;</span><span class=p>:</span> <span class=s2>&#34;3.1.7&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nt>&#34;dist&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&#34;url&#34;</span><span class=p>:</span> <span class=s2>&#34;https://www.smarty.net/files/Smarty-3.1.7.zip&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;zip&#34;</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h3 id=自托管仓库选项>自托管仓库选项<a hidden class=anchor aria-hidden=true href=#自托管仓库选项>#</a></h3><p>当需要保持包私有或为项目创建独立生态系统时，可以选择自托管仓库：</p><ol><li><p><strong>Private Packagist</strong>：提供私有包托管和镜像功能的托管或自托管应用。</p></li><li><p><strong>Satis</strong>：轻量级的静态 Composer 仓库生成器，适合小型团队。</p></li><li><p><strong>Artifact 仓库</strong>：使用包含 ZIP 或 TAR 归档文件的文件夹作为包源。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;repositories&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;artifact&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;url&#34;</span><span class=p>:</span> <span class=s2>&#34;path/to/directory/with/zips/&#34;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div></li><li><p><strong>Path 仓库</strong>：直接依赖本地目录，对于单体仓库特别有用。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;repositories&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;path&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;url&#34;</span><span class=p>:</span> <span class=s2>&#34;../../packages/my-package&#34;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div></li></ol><h3 id=禁用-packagistorg>禁用 Packagist.org<a hidden class=anchor aria-hidden=true href=#禁用-packagistorg>#</a></h3><p>默认情况下，Composer 会使用 Packagist.org 作为包源。如需禁用：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;repositories&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;packagist.org&#34;</span><span class=p>:</span> <span class=kc>false</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>或通过全局配置：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>php composer.phar config -g repo.packagist <span class=nb>false</span>
</span></span></code></pre></div><h2 id=config>Config<a hidden class=anchor aria-hidden=true href=#config>#</a></h2><blockquote><p><a href=https://getcomposer.org/doc/06-config.md>https://getcomposer.org/doc/06-config.md</a></p></blockquote><p>Composer 配置选项可以通过 <code>composer.json</code> 中的 <code>config</code> 字段设置。以下是一些常用的配置项：</p><h3 id=基本配置选项>基本配置选项<a hidden class=anchor aria-hidden=true href=#基本配置选项>#</a></h3><ul><li><p><strong>process-timeout</strong>: 进程执行超时时间（秒），默认 300（5分钟）。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;config&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;process-timeout&#34;</span><span class=p>:</span> <span class=mi>900</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div></li><li><p><strong>allow-plugins</strong>: 控制哪些 Composer 插件可以执行代码（Composer 2.2.0+）。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;config&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;allow-plugins&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;vendor/plugin-name&#34;</span><span class=p>:</span> <span class=kc>true</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;another-vendor/*&#34;</span><span class=p>:</span> <span class=kc>true</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div></li><li><p><strong>preferred-install</strong>: 首选安装方式，可为 <code>source</code>、<code>dist</code> 或 <code>auto</code>。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;config&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;preferred-install&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;vendor/*&#34;</span><span class=p>:</span> <span class=s2>&#34;source&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;*&#34;</span><span class=p>:</span> <span class=s2>&#34;dist&#34;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div></li></ul><h3 id=仓库与认证>仓库与认证<a hidden class=anchor aria-hidden=true href=#仓库与认证>#</a></h3><ul><li><p><strong>github-protocols</strong>: 克隆 GitHub 仓库使用的协议列表，默认 <code>["https", "ssh", "git"]</code>。</p></li><li><p><strong>github-oauth</strong>: GitHub OAuth 令牌列表。</p></li><li><p><strong>gitlab-oauth</strong>/<strong>gitlab-token</strong>: GitLab OAuth 令牌或私有令牌列表。</p></li><li><p><strong>http-basic</strong>: HTTP 基本认证信息。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;config&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;http-basic&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;example.org&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nt>&#34;username&#34;</span><span class=p>:</span> <span class=s2>&#34;username&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nt>&#34;password&#34;</span><span class=p>:</span> <span class=s2>&#34;password&#34;</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div></li></ul><h3 id=目录与缓存>目录与缓存<a hidden class=anchor aria-hidden=true href=#目录与缓存>#</a></h3><ul><li><strong>vendor-dir</strong>: 安装依赖的目录，默认为 <code>vendor</code>。</li><li><strong>bin-dir</strong>: 二进制文件链接目录，默认为 <code>vendor/bin</code>。</li><li><strong>cache-dir</strong>: 缓存目录。</li><li><strong>cache-files-ttl</strong>: 缓存文件的存活时间（秒），默认 15552000（6个月）。</li><li><strong>cache-files-maxsize</strong>: 缓存可使用的最大空间，默认 &ldquo;300MiB&rdquo;。</li></ul><h3 id=自动加载相关>自动加载相关<a hidden class=anchor aria-hidden=true href=#自动加载相关>#</a></h3><ul><li><strong>optimize-autoloader</strong>: 始终优化自动加载器，默认 <code>false</code>。</li><li><strong>prepend-autoloader</strong>: 是否将 Composer 自动加载器前置到已存在的自动加载器，默认 <code>true</code>。</li><li><strong>classmap-authoritative</strong>: 设为 <code>true</code> 时，自动加载器只会从 classmap 加载类，默认 <code>false</code>。</li><li><strong>apcu-autoloader</strong>: 是否使用 APCu 缓存查找的类，默认 <code>false</code>。</li></ul><h3 id=安全与其他>安全与其他<a hidden class=anchor aria-hidden=true href=#安全与其他>#</a></h3><ul><li><strong>platform-check</strong>: 平台检查级别，默认 <code>php-only</code>，可设为 <code>true</code> 或 <code>false</code>。</li><li><strong>secure-http</strong>: 是否只允许通过 HTTPS 下载包，默认 <code>true</code>。</li><li><strong>discard-changes</strong>: 处理脏更新的方式，默认 <code>false</code>，可设为 <code>true</code> 或 <code>stash</code>。</li><li><strong>sort-packages</strong>: 添加新包时是否按名称排序，默认 <code>false</code>。</li></ul><h3 id=全局配置>全局配置<a hidden class=anchor aria-hidden=true href=#全局配置>#</a></h3><p>某些配置可通过命令行全局设置：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>php composer.phar config -g repo.packagist <span class=nb>false</span>
</span></span><span class=line><span class=cl>php composer.phar config -g process-timeout <span class=m>900</span>
</span></span></code></pre></div><h2 id=runtime-composer-utilities>Runtime Composer utilities<a hidden class=anchor aria-hidden=true href=#runtime-composer-utilities>#</a></h2><blockquote><p><a href=https://getcomposer.org/doc/07-runtime.md>https://getcomposer.org/doc/07-runtime.md</a></p></blockquote><p>Composer 除了安装和管理依赖外，还提供了一些运行时实用工具。如果需要依赖特定版本的这些功能，可以通过 <code>composer-runtime-api</code> 包实现。</p><h3 id=自动加载>自动加载<a hidden class=anchor aria-hidden=true href=#自动加载>#</a></h3><p>最常用的运行时工具是自动加载器，在所有 Composer 版本中可用。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=k>require</span> <span class=no>__DIR__</span> <span class=o>.</span> <span class=s1>&#39;/vendor/autoload.php&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 现在可以使用项目的依赖了
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nv>$log</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Monolog\Logger</span><span class=p>(</span><span class=s1>&#39;name&#39;</span><span class=p>);</span>
</span></span></code></pre></div><h3 id=已安装版本信息>已安装版本信息<a hidden class=anchor aria-hidden=true href=#已安装版本信息>#</a></h3><p>Composer 2.0 引入了 <code>Composer\InstalledVersions</code> 类，提供了检查已安装包的静态方法。</p><h4 id=检查包是否存在>检查包是否存在<a hidden class=anchor aria-hidden=true href=#检查包是否存在>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=nx>\Composer\InstalledVersions</span><span class=o>::</span><span class=na>isInstalled</span><span class=p>(</span><span class=s1>&#39;vendor/package&#39;</span><span class=p>);</span> <span class=c1>// 返回布尔值
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>\Composer\InstalledVersions</span><span class=o>::</span><span class=na>isInstalled</span><span class=p>(</span><span class=s1>&#39;psr/log-implementation&#39;</span><span class=p>);</span> <span class=c1>// 检查虚拟包
</span></span></span></code></pre></div><p>从 Composer 2.1 开始，还可以检查包是否通过 require-dev 安装：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=nx>\Composer\InstalledVersions</span><span class=o>::</span><span class=na>isInstalled</span><span class=p>(</span><span class=s1>&#39;vendor/package&#39;</span><span class=p>,</span> <span class=k>false</span><span class=p>);</span> <span class=c1>// 仅检查 require 中的包
</span></span></span></code></pre></div><h4 id=检查包版本>检查包版本<a hidden class=anchor aria-hidden=true href=#检查包版本>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=k>use</span> <span class=nx>Composer\Semver\VersionParser</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 检查包是否满足版本约束
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>\Composer\InstalledVersions</span><span class=o>::</span><span class=na>satisfies</span><span class=p>(</span><span class=k>new</span> <span class=nx>VersionParser</span><span class=p>,</span> <span class=s1>&#39;vendor/package&#39;</span><span class=p>,</span> <span class=s1>&#39;2.0.*&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 获取包的版本号
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nv>$version</span> <span class=o>=</span> <span class=nx>\Composer\InstalledVersions</span><span class=o>::</span><span class=na>getVersion</span><span class=p>(</span><span class=s1>&#39;vendor/package&#39;</span><span class=p>);</span> <span class=c1>// 标准化版本 (如 1.2.3.0)
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nv>$prettyVersion</span> <span class=o>=</span> <span class=nx>\Composer\InstalledVersions</span><span class=o>::</span><span class=na>getPrettyVersion</span><span class=p>(</span><span class=s1>&#39;vendor/package&#39;</span><span class=p>);</span> <span class=c1>// 原始版本 (如 v1.2.3)
</span></span></span></code></pre></div><h4 id=获取包的安装路径>获取包的安装路径<a hidden class=anchor aria-hidden=true href=#获取包的安装路径>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=c1>// 获取包安装的绝对路径
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nv>$path</span> <span class=o>=</span> <span class=nx>\Composer\InstalledVersions</span><span class=o>::</span><span class=na>getInstallPath</span><span class=p>(</span><span class=s1>&#39;vendor/package&#39;</span><span class=p>);</span>
</span></span></code></pre></div><h4 id=查找指定类型的已安装包>查找指定类型的已安装包<a hidden class=anchor aria-hidden=true href=#查找指定类型的已安装包>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=c1>// 获取所有类型为 &#39;foo-plugin&#39; 的已安装包
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nv>$packages</span> <span class=o>=</span> <span class=nx>\Composer\InstalledVersions</span><span class=o>::</span><span class=na>getInstalledPackagesByType</span><span class=p>(</span><span class=s1>&#39;foo-plugin&#39;</span><span class=p>);</span>
</span></span></code></pre></div><h3 id=平台检查>平台检查<a hidden class=anchor aria-hidden=true href=#平台检查>#</a></h3><p>Composer 2.0 引入了 <code>vendor/composer/platform_check.php</code> 文件，会在包含自动加载器时自动执行。它会验证当前 PHP 环境是否满足平台要求，如 PHP 版本和扩展。</p><p>默认情况下，只检查 PHP 版本（<code>php-only</code>）。可以通过 <code>platform-check</code> 配置选项修改行为：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;config&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;platform-check&#34;</span><span class=p>:</span> <span class=kc>true</span>  <span class=c1>// 也检查 PHP 扩展
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>如果要禁用此安全检查：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;config&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;platform-check&#34;</span><span class=p>:</span> <span class=kc>false</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h3 id=二进制文件中的自动加载器路径>二进制文件中的自动加载器路径<a hidden class=anchor aria-hidden=true href=#二进制文件中的自动加载器路径>#</a></h3><p>Composer 2.2 引入了全局变量 <code>$_composer_autoload_path</code>，它在运行 Composer 安装的二进制文件时设置。</p><h3 id=二进制文件中的-bin-dir-路径>二进制文件中的 bin-dir 路径<a hidden class=anchor aria-hidden=true href=#二进制文件中的-bin-dir-路径>#</a></h3><p>Composer 2.2.2 引入了全局变量 <code>$_composer_bin_dir</code>，它在运行 Composer 安装的二进制文件时设置。</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://zyf.im/tags/php/>Php</a></li><li><a href=https://zyf.im/tags/composer/>Composer</a></li></ul><nav class=paginav><a class=prev href=https://zyf.im/2020/11/28/mysql-blank-space/><span class=title>« Prev</span><br><span>MySQL 空格问题</span>
</a><a class=next href=https://zyf.im/2020/09/11/use-illuminate-components-without-laravel/><span class=title>Next »</span><br><span>在 Laravel 之外使用 illuminate 组件</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://zyf.im/>ZYF.IM BLOG</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>