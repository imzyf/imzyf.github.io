<!doctype html><html lang=en dir=auto data-theme=dark><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>PHP Migrating 8.3 to 8.4 | ZYF.IM BLOG</title><meta name=keywords content="php,php-migrating"><meta name=description content='ç®€ä»‹
PHP 8.4 å¼•å…¥äº†è®¸å¤šæ–°ç‰¹æ€§ï¼Œå¦‚å±æ€§é’©å­ï¼ˆProperty Hooksï¼‰ã€éå¯¹ç§°å¯è§æ€§ï¼ˆAsymmetric Visibilityï¼‰ã€#[Deprecated] å±æ€§ä»¥åŠæ›´æ–°çš„ DOM API ç­‰ã€‚æœ¬æ–‡å°†ä»‹ç»ä¸»è¦å˜åŒ–å’Œå¦‚ä½•è¿›è¡Œè¿ç§»ã€‚
å‚è€ƒèµ„æº

åœ¨çº¿æµ‹è¯•ç¯å¢ƒï¼šhttps://onlinephp.io/
å®˜æ–¹å‘å¸ƒè¯´æ˜ï¼šhttps://www.php.net/releases/8.4/en.php
è¿ç§»æŒ‡å—ï¼šhttps://www.php.net/manual/en/migration84.php
æ›´æ–°è¯¦æƒ…ï¼šhttps://php.watch/versions/8.4

PHP 8.4 æ–°ç‰¹æ€§
å±æ€§é’©å­ä¸éå¯¹ç§°å¯è§æ€§
// å±æ€§é’©å­ï¼ˆProperty Hooksï¼‰ä¸éå¯¹ç§°å¯è§æ€§ï¼ˆAsymmetric Visibilityï¼‰
class User {
    private bool $isModified = false;
    public function __construct(public private(set) string $first, private string $last)
    {
    }
    public string $fullName {
        get => $this->first . " " . $this->last;
        set {
            [$this->first, $this->last] = explode(&#39; &#39;, $value, 2);
            $this->isModified = true;
        }
    }
}
$user = new User("Ming", "Li");
echo $user->fullName; // è¾“å‡º: Ming Li
$user->fullName = "Hong Xiao";
echo $user->fullName; // è¾“å‡º: Hong Xiao

// éå¯¹ç§°å¯è§æ€§ç¤ºä¾‹
echo $user->first; // è¾“å‡º: Hong
$user->first = "Hua";
// é”™è¯¯: Fatal error: Uncaught Error: Cannot modify private(set) property User::$first
å±æ€§é’©å­å…è®¸æˆ‘ä»¬å®šä¹‰å±æ€§çš„è·å–å’Œè®¾ç½®è¡Œä¸ºï¼Œè€Œéå¯¹ç§°å¯è§æ€§å…è®¸æˆ‘ä»¬ä¸ºå±æ€§è®¾ç½®ä¸åŒçš„è¯»å†™æƒé™ã€‚åœ¨ä¸Šä¾‹ä¸­ï¼Œ$first å±æ€§å¯ä»¥å…¬å¼€è¯»å–ä½†åªèƒ½ç§æœ‰å†™å…¥ã€‚
#[Deprecated] å±æ€§
PHP 8.4 å¼•å…¥äº† #[Deprecated] å±æ€§ï¼Œå¯ä»¥ç”¨æ¥æ ‡è®°å·²å¼ƒç”¨çš„ä»£ç ï¼š'><meta name=author content="Me, LLM"><link rel=canonical href=https://zyf.im/2025/02/01/php-migrating-83-to-84/><link crossorigin=anonymous href=/assets/css/stylesheet.88888b1f97bcb20b824590bc7c6603a852913a2540638b3b3e2663e642691da3.css integrity="sha256-iIiLH5e8sguCRZC8fGYDqFKROiVAY4s7PiZj5kJpHaM=" rel="preload stylesheet" as=style><link rel=icon href=https://zyf.im/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://zyf.im/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://zyf.im/favicon-32x32.png><link rel=apple-touch-icon href=https://zyf.im/apple-touch-icon.png><link rel=mask-icon href=https://zyf.im/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://zyf.im/2025/02/01/php-migrating-83-to-84/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><script>localStorage.getItem("pref-theme")==="light"&&(document.querySelector("html").dataset.theme="light")</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-6DVZ6E58DG"></script><script>var doNotTrack=!1,dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes";if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-6DVZ6E58DG")}</script><meta property="og:url" content="https://zyf.im/2025/02/01/php-migrating-83-to-84/"><meta property="og:site_name" content="ZYF.IM BLOG"><meta property="og:title" content="PHP Migrating 8.3 to 8.4"><meta property="og:description" content='ç®€ä»‹ PHP 8.4 å¼•å…¥äº†è®¸å¤šæ–°ç‰¹æ€§ï¼Œå¦‚å±æ€§é’©å­ï¼ˆProperty Hooksï¼‰ã€éå¯¹ç§°å¯è§æ€§ï¼ˆAsymmetric Visibilityï¼‰ã€#[Deprecated] å±æ€§ä»¥åŠæ›´æ–°çš„ DOM API ç­‰ã€‚æœ¬æ–‡å°†ä»‹ç»ä¸»è¦å˜åŒ–å’Œå¦‚ä½•è¿›è¡Œè¿ç§»ã€‚
å‚è€ƒèµ„æº åœ¨çº¿æµ‹è¯•ç¯å¢ƒï¼šhttps://onlinephp.io/ å®˜æ–¹å‘å¸ƒè¯´æ˜ï¼šhttps://www.php.net/releases/8.4/en.php è¿ç§»æŒ‡å—ï¼šhttps://www.php.net/manual/en/migration84.php æ›´æ–°è¯¦æƒ…ï¼šhttps://php.watch/versions/8.4 PHP 8.4 æ–°ç‰¹æ€§ å±æ€§é’©å­ä¸éå¯¹ç§°å¯è§æ€§ // å±æ€§é’©å­ï¼ˆProperty Hooksï¼‰ä¸éå¯¹ç§°å¯è§æ€§ï¼ˆAsymmetric Visibilityï¼‰ class User { private bool $isModified = false; public function __construct(public private(set) string $first, private string $last) { } public string $fullName { get => $this->first . " " . $this->last; set { [$this->first, $this->last] = explode(&#39; &#39;, $value, 2); $this->isModified = true; } } } $user = new User("Ming", "Li"); echo $user->fullName; // è¾“å‡º: Ming Li $user->fullName = "Hong Xiao"; echo $user->fullName; // è¾“å‡º: Hong Xiao // éå¯¹ç§°å¯è§æ€§ç¤ºä¾‹ echo $user->first; // è¾“å‡º: Hong $user->first = "Hua"; // é”™è¯¯: Fatal error: Uncaught Error: Cannot modify private(set) property User::$first å±æ€§é’©å­å…è®¸æˆ‘ä»¬å®šä¹‰å±æ€§çš„è·å–å’Œè®¾ç½®è¡Œä¸ºï¼Œè€Œéå¯¹ç§°å¯è§æ€§å…è®¸æˆ‘ä»¬ä¸ºå±æ€§è®¾ç½®ä¸åŒçš„è¯»å†™æƒé™ã€‚åœ¨ä¸Šä¾‹ä¸­ï¼Œ$first å±æ€§å¯ä»¥å…¬å¼€è¯»å–ä½†åªèƒ½ç§æœ‰å†™å…¥ã€‚
#[Deprecated] å±æ€§ PHP 8.4 å¼•å…¥äº† #[Deprecated] å±æ€§ï¼Œå¯ä»¥ç”¨æ¥æ ‡è®°å·²å¼ƒç”¨çš„ä»£ç ï¼š'><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-02-01T17:42:42+08:00"><meta property="article:modified_time" content="2025-02-01T17:42:42+08:00"><meta property="article:tag" content="Php"><meta property="article:tag" content="Php-Migrating"><meta property="og:image" content="https://images.unsplash.com/photo-1549926506-afba2eb9fb6f?q=80&amp;w=960&amp;auto=format&amp;fit=crop&amp;ixlib=rb-4.0.3"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://images.unsplash.com/photo-1549926506-afba2eb9fb6f?q=80&amp;w=960&amp;auto=format&amp;fit=crop&amp;ixlib=rb-4.0.3"><meta name=twitter:title content="PHP Migrating 8.3 to 8.4"><meta name=twitter:description content='ç®€ä»‹
PHP 8.4 å¼•å…¥äº†è®¸å¤šæ–°ç‰¹æ€§ï¼Œå¦‚å±æ€§é’©å­ï¼ˆProperty Hooksï¼‰ã€éå¯¹ç§°å¯è§æ€§ï¼ˆAsymmetric Visibilityï¼‰ã€#[Deprecated] å±æ€§ä»¥åŠæ›´æ–°çš„ DOM API ç­‰ã€‚æœ¬æ–‡å°†ä»‹ç»ä¸»è¦å˜åŒ–å’Œå¦‚ä½•è¿›è¡Œè¿ç§»ã€‚
å‚è€ƒèµ„æº

åœ¨çº¿æµ‹è¯•ç¯å¢ƒï¼šhttps://onlinephp.io/
å®˜æ–¹å‘å¸ƒè¯´æ˜ï¼šhttps://www.php.net/releases/8.4/en.php
è¿ç§»æŒ‡å—ï¼šhttps://www.php.net/manual/en/migration84.php
æ›´æ–°è¯¦æƒ…ï¼šhttps://php.watch/versions/8.4

PHP 8.4 æ–°ç‰¹æ€§
å±æ€§é’©å­ä¸éå¯¹ç§°å¯è§æ€§
// å±æ€§é’©å­ï¼ˆProperty Hooksï¼‰ä¸éå¯¹ç§°å¯è§æ€§ï¼ˆAsymmetric Visibilityï¼‰
class User {
    private bool $isModified = false;
    public function __construct(public private(set) string $first, private string $last)
    {
    }
    public string $fullName {
        get => $this->first . " " . $this->last;
        set {
            [$this->first, $this->last] = explode(&#39; &#39;, $value, 2);
            $this->isModified = true;
        }
    }
}
$user = new User("Ming", "Li");
echo $user->fullName; // è¾“å‡º: Ming Li
$user->fullName = "Hong Xiao";
echo $user->fullName; // è¾“å‡º: Hong Xiao

// éå¯¹ç§°å¯è§æ€§ç¤ºä¾‹
echo $user->first; // è¾“å‡º: Hong
$user->first = "Hua";
// é”™è¯¯: Fatal error: Uncaught Error: Cannot modify private(set) property User::$first
å±æ€§é’©å­å…è®¸æˆ‘ä»¬å®šä¹‰å±æ€§çš„è·å–å’Œè®¾ç½®è¡Œä¸ºï¼Œè€Œéå¯¹ç§°å¯è§æ€§å…è®¸æˆ‘ä»¬ä¸ºå±æ€§è®¾ç½®ä¸åŒçš„è¯»å†™æƒé™ã€‚åœ¨ä¸Šä¾‹ä¸­ï¼Œ$first å±æ€§å¯ä»¥å…¬å¼€è¯»å–ä½†åªèƒ½ç§æœ‰å†™å…¥ã€‚
#[Deprecated] å±æ€§
PHP 8.4 å¼•å…¥äº† #[Deprecated] å±æ€§ï¼Œå¯ä»¥ç”¨æ¥æ ‡è®°å·²å¼ƒç”¨çš„ä»£ç ï¼š'><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://zyf.im/posts/"},{"@type":"ListItem","position":2,"name":"PHP Migrating 8.3 to 8.4","item":"https://zyf.im/2025/02/01/php-migrating-83-to-84/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"PHP Migrating 8.3 to 8.4","name":"PHP Migrating 8.3 to 8.4","description":"ç®€ä»‹ PHP 8.4 å¼•å…¥äº†è®¸å¤šæ–°ç‰¹æ€§ï¼Œå¦‚å±æ€§é’©å­ï¼ˆProperty Hooksï¼‰ã€éå¯¹ç§°å¯è§æ€§ï¼ˆAsymmetric Visibilityï¼‰ã€#[Deprecated] å±æ€§ä»¥åŠæ›´æ–°çš„ DOM API ç­‰ã€‚æœ¬æ–‡å°†ä»‹ç»ä¸»è¦å˜åŒ–å’Œå¦‚ä½•è¿›è¡Œè¿ç§»ã€‚\nå‚è€ƒèµ„æº åœ¨çº¿æµ‹è¯•ç¯å¢ƒï¼šhttps://onlinephp.io/ å®˜æ–¹å‘å¸ƒè¯´æ˜ï¼šhttps://www.php.net/releases/8.4/en.php è¿ç§»æŒ‡å—ï¼šhttps://www.php.net/manual/en/migration84.php æ›´æ–°è¯¦æƒ…ï¼šhttps://php.watch/versions/8.4 PHP 8.4 æ–°ç‰¹æ€§ å±æ€§é’©å­ä¸éå¯¹ç§°å¯è§æ€§ // å±æ€§é’©å­ï¼ˆProperty Hooksï¼‰ä¸éå¯¹ç§°å¯è§æ€§ï¼ˆAsymmetric Visibilityï¼‰ class User { private bool $isModified = false; public function __construct(public private(set) string $first, private string $last) { } public string $fullName { get =\u0026gt; $this-\u0026gt;first . \u0026#34; \u0026#34; . $this-\u0026gt;last; set { [$this-\u0026gt;first, $this-\u0026gt;last] = explode(\u0026#39; \u0026#39;, $value, 2); $this-\u0026gt;isModified = true; } } } $user = new User(\u0026#34;Ming\u0026#34;, \u0026#34;Li\u0026#34;); echo $user-\u0026gt;fullName; // è¾“å‡º: Ming Li $user-\u0026gt;fullName = \u0026#34;Hong Xiao\u0026#34;; echo $user-\u0026gt;fullName; // è¾“å‡º: Hong Xiao // éå¯¹ç§°å¯è§æ€§ç¤ºä¾‹ echo $user-\u0026gt;first; // è¾“å‡º: Hong $user-\u0026gt;first = \u0026#34;Hua\u0026#34;; // é”™è¯¯: Fatal error: Uncaught Error: Cannot modify private(set) property User::$first å±æ€§é’©å­å…è®¸æˆ‘ä»¬å®šä¹‰å±æ€§çš„è·å–å’Œè®¾ç½®è¡Œä¸ºï¼Œè€Œéå¯¹ç§°å¯è§æ€§å…è®¸æˆ‘ä»¬ä¸ºå±æ€§è®¾ç½®ä¸åŒçš„è¯»å†™æƒé™ã€‚åœ¨ä¸Šä¾‹ä¸­ï¼Œ$first å±æ€§å¯ä»¥å…¬å¼€è¯»å–ä½†åªèƒ½ç§æœ‰å†™å…¥ã€‚\n#[Deprecated] å±æ€§ PHP 8.4 å¼•å…¥äº† #[Deprecated] å±æ€§ï¼Œå¯ä»¥ç”¨æ¥æ ‡è®°å·²å¼ƒç”¨çš„ä»£ç ï¼š\n","keywords":["php","php-migrating"],"articleBody":"ç®€ä»‹ PHP 8.4 å¼•å…¥äº†è®¸å¤šæ–°ç‰¹æ€§ï¼Œå¦‚å±æ€§é’©å­ï¼ˆProperty Hooksï¼‰ã€éå¯¹ç§°å¯è§æ€§ï¼ˆAsymmetric Visibilityï¼‰ã€#[Deprecated] å±æ€§ä»¥åŠæ›´æ–°çš„ DOM API ç­‰ã€‚æœ¬æ–‡å°†ä»‹ç»ä¸»è¦å˜åŒ–å’Œå¦‚ä½•è¿›è¡Œè¿ç§»ã€‚\nå‚è€ƒèµ„æº åœ¨çº¿æµ‹è¯•ç¯å¢ƒï¼šhttps://onlinephp.io/ å®˜æ–¹å‘å¸ƒè¯´æ˜ï¼šhttps://www.php.net/releases/8.4/en.php è¿ç§»æŒ‡å—ï¼šhttps://www.php.net/manual/en/migration84.php æ›´æ–°è¯¦æƒ…ï¼šhttps://php.watch/versions/8.4 PHP 8.4 æ–°ç‰¹æ€§ å±æ€§é’©å­ä¸éå¯¹ç§°å¯è§æ€§ // å±æ€§é’©å­ï¼ˆProperty Hooksï¼‰ä¸éå¯¹ç§°å¯è§æ€§ï¼ˆAsymmetric Visibilityï¼‰ class User { private bool $isModified = false; public function __construct(public private(set) string $first, private string $last) { } public string $fullName { get =\u003e $this-\u003efirst . \" \" . $this-\u003elast; set { [$this-\u003efirst, $this-\u003elast] = explode(' ', $value, 2); $this-\u003eisModified = true; } } } $user = new User(\"Ming\", \"Li\"); echo $user-\u003efullName; // è¾“å‡º: Ming Li $user-\u003efullName = \"Hong Xiao\"; echo $user-\u003efullName; // è¾“å‡º: Hong Xiao // éå¯¹ç§°å¯è§æ€§ç¤ºä¾‹ echo $user-\u003efirst; // è¾“å‡º: Hong $user-\u003efirst = \"Hua\"; // é”™è¯¯: Fatal error: Uncaught Error: Cannot modify private(set) property User::$first å±æ€§é’©å­å…è®¸æˆ‘ä»¬å®šä¹‰å±æ€§çš„è·å–å’Œè®¾ç½®è¡Œä¸ºï¼Œè€Œéå¯¹ç§°å¯è§æ€§å…è®¸æˆ‘ä»¬ä¸ºå±æ€§è®¾ç½®ä¸åŒçš„è¯»å†™æƒé™ã€‚åœ¨ä¸Šä¾‹ä¸­ï¼Œ$first å±æ€§å¯ä»¥å…¬å¼€è¯»å–ä½†åªèƒ½ç§æœ‰å†™å…¥ã€‚\n#[Deprecated] å±æ€§ PHP 8.4 å¼•å…¥äº† #[Deprecated] å±æ€§ï¼Œå¯ä»¥ç”¨æ¥æ ‡è®°å·²å¼ƒç”¨çš„ä»£ç ï¼š\n#[Deprecated(\"Use newFunction() instead\", since: \"2.0\")] function oldFunction(): void { // ... } oldFunction(); // Warning: Function oldFunction() is deprecated, Use newFunction() instead è¿™ä½¿å¾—å¼€å‘è€…å¯ä»¥åœ¨è‡ªå·±çš„ä»£ç åº“ä¸­ä½¿ç”¨ä¸ PHP å†…éƒ¨ç›¸åŒçš„å¼ƒç”¨æœºåˆ¶ã€‚\nå¢å¼ºçš„ DOM API PHP 8.4 æ›´æ–°äº† DOM APIï¼Œæä¾›äº†æ›´ç°ä»£ã€æ›´æ˜“ç”¨çš„æ¥å£ï¼š\n// æ–°çš„ DOM API ç¤ºä¾‹ $doc = \\Dom\\HTMLDocument::createFromString('Hello'); // ä½¿ç”¨ querySelector å’Œ querySelectorAll $span = $doc-\u003equerySelector('span'); echo $span-\u003etextContent; // è¾“å‡º: Hello // ä½¿ç”¨ innerHTML/outerHTML $div = $doc-\u003equerySelector('div'); echo $div-\u003einnerHTML; // è¾“å‡º: Hello $div-\u003einnerHTML = 'World\n'; echo $div-\u003eouterHTML; // è¾“å‡º: World\nBCMath çš„å¯¹è±¡ API // BCMath çš„å¯¹è±¡ API use BcMath\\Number; $num1 = new Number('0.12345'); $num2 = new Number('2'); $result = $num1 + $num2; echo $result; // è¾“å‡º: '2.12345' var_dump($num1 \u003e $num2); // è¾“å‡º: false // PHP 8.4 ä¹‹å‰çš„å†™æ³• $num1 = '0.12345'; $num2 = 2; $result = bcadd($num1, $num2, 5); echo $result; // è¾“å‡º: '2.12345' var_dump(bccomp($num1, $num2) \u003e 0); // è¾“å‡º: false // æ–°å¢ bcdivmod() å‡½æ•° - åŒæ—¶è¿”å›å•†å’Œä½™æ•° [$quotient, $remainder] = bcdivmod('10', '3', 2); echo $quotient; // è¾“å‡º: 3 echo $remainder; // è¾“å‡º: 1.00 PHP 8.4 ä¸º BCMath å¼•å…¥äº†å¯¹è±¡ APIï¼Œä½¿ç”¨èµ·æ¥æ›´åŠ ç›´è§‚å’Œé¢å‘å¯¹è±¡ã€‚\nHTTP/3 æ”¯æŒ PHP 8.4 çš„ cURL æ‰©å±•æ–°å¢äº† HTTP/3 æ”¯æŒï¼š\n$ch = curl_init('https://example.com'); curl_setopt($ch, CURLOPT_HTTP_VERSION, CURL_HTTP_VERSION_3); // æˆ–å¼ºåˆ¶ä½¿ç”¨ HTTP/3 curl_setopt($ch, CURLOPT_HTTP_VERSION, CURL_HTTP_VERSION_3ONLY); $response = curl_exec($ch); å…¶ä»–æ–°å¢çš„ cURL é€‰é¡¹åŒ…æ‹¬ï¼šCURLOPT_PREREQFUNCTIONã€CURLOPT_DEBUGFUNCTIONã€CURLOPT_SERVER_RESPONSE_TIMEOUTã€CURLOPT_TCP_KEEPCNTã€‚\nPHP 8.4 æ–°å¢å‡½æ•° æ–°çš„æ•°ç»„æ“ä½œå‡½æ•° // array_find() - æŸ¥æ‰¾ç¬¬ä¸€ä¸ªæ»¡è¶³æ¡ä»¶çš„å…ƒç´  $animal = array_find( ['dog', 'cat', 'cow', 'duck', 'goose'], static fn (string $value): bool =\u003e str_starts_with($value, 'c'), ); var_dump($animal); // è¾“å‡º: string(3) \"cat\" // array_find_key() - æŸ¥æ‰¾ç¬¬ä¸€ä¸ªæ»¡è¶³æ¡ä»¶çš„å…ƒç´ çš„é”® $key = array_find_key( ['a' =\u003e 1, 'b' =\u003e 2, 'c' =\u003e 3], fn($v) =\u003e $v \u003e 1 ); var_dump($key); // è¾“å‡º: string(1) \"b\" // array_any() - æ£€æŸ¥æ˜¯å¦è‡³å°‘æœ‰ä¸€ä¸ªå…ƒç´ æ»¡è¶³æ¡ä»¶ $result = array_any([1, 2, 3, 4], fn($n) =\u003e $n \u003e 3); // true // array_all() - æ£€æŸ¥æ˜¯å¦æ‰€æœ‰å…ƒç´ éƒ½æ»¡è¶³æ¡ä»¶ $result = array_all([1, 2, 3, 4], fn($n) =\u003e $n \u003e 0); // true æ–°çš„å­—ç¬¦ä¸²å¤„ç†å‡½æ•° // å¤šå­—èŠ‚å­—ç¬¦ä¸²ä¿®å‰ªå‡½æ•° $str = \"ã€€ã“ã‚“ã«ã¡ã¯ã€€\"; // åŒ…å«å…¨è§’ç©ºæ ¼ echo mb_trim($str); // \"ã“ã‚“ã«ã¡ã¯\" echo mb_ltrim($str); // \"ã“ã‚“ã«ã¡ã¯ã€€\" echo mb_rtrim($str); // \"ã€€ã“ã‚“ã«ã¡ã¯\" // å¤šå­—èŠ‚é¦–å­—æ¯å¤§å°å†™è½¬æ¢ echo mb_ucfirst('Ã±oÃ±o'); // \"Ã‘oÃ±o\" echo mb_lcfirst('Ã‘oÃ‘o'); // \"Ã±oÃ‘o\" // æŒ‰å­—å½¢ç°‡æ‹†åˆ†å­—ç¬¦ä¸² $chars = grapheme_str_split('ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦'); var_dump($chars); // ['ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦'] æ—¥æœŸæ—¶é—´æ–°æ–¹æ³• // ä»æ—¶é—´æˆ³åˆ›å»º DateTime å¯¹è±¡ $dt = DateTime::createFromTimestamp(1704067200); $dti = DateTimeImmutable::createFromTimestamp(1704067200.123456); // å¾®ç§’å¤„ç† $dt = new DateTime(); echo $dt-\u003egetMicrosecond(); // è·å–å¾®ç§’ $dt-\u003esetMicrosecond(500000); // è®¾ç½®å¾®ç§’ round() å‡½æ•°æ–°èˆå…¥æ¨¡å¼ // PHP 8.4 æ–°å¢èˆå…¥æ¨¡å¼ echo round(1.5, 0, PHP_ROUND_HALF_UP); // 2 (å››èˆäº”å…¥) echo round(1.5, 0, PHP_ROUND_HALF_DOWN); // 1 (äº”èˆå…­å…¥) echo round(1.5, 0, PHP_ROUND_HALF_EVEN); // 2 (é“¶è¡Œå®¶èˆå…¥) echo round(1.5, 0, PHP_ROUND_HALF_ODD); // 1 (èˆå…¥åˆ°å¥‡æ•°) echo round(1.2, 0, PHP_ROUND_CEILING); // 2 (å‘ä¸Šå–æ•´) echo round(1.8, 0, PHP_ROUND_FLOOR); // 1 (å‘ä¸‹å–æ•´) echo round(-1.5, 0, PHP_ROUND_TOWARD_ZERO); // -1 (å‘é›¶å–æ•´) echo round(-1.5, 0, PHP_ROUND_AWAY_FROM_ZERO); // -2 (è¿œç¦»é›¶å–æ•´) // æ³¨æ„ï¼šæ— æ•ˆçš„èˆå…¥æ¨¡å¼ç°åœ¨ä¼šæŠ›å‡º ValueError å…¶ä»–æ–°å‡½æ•° // request_parse_body() - è§£æè¯·æ±‚ä½“ [$_POST, $_FILES] = request_parse_body(); // HTTP å“åº”å¤´å¤„ç† $headers = http_get_last_response_headers(); // è·å–æœ€åä¸€æ¬¡å“åº”å¤´ http_clear_last_response_headers(); // æ¸…é™¤å“åº”å¤´ç¼“å­˜ // IANA æ—¶åŒº ID echo intltz_get_iana_id('Asia/Shanghai'); // è·å–è§„èŒƒæ—¶åŒº ID å…¼å®¹æ€§ä¸è¿ç§» å¼ƒç”¨ç‰¹æ€§ éšå¼å¯ç©ºç±»å‹ // âŒ PHP 8.4 å·²å¼ƒç”¨ function save(Book $book = null) {} // âœ… ä¿®å¤æ–¹æ³•ï¼šæ˜¾å¼å£°æ˜å¯ç©ºç±»å‹ function save(?Book $book = null) {} åœ¨ PHP 8.4 ä¸­ï¼Œéšå¼å¯ç©ºç±»å‹å·²è¢«å¼ƒç”¨ï¼Œéœ€è¦ä½¿ç”¨é—®å·ï¼ˆ?ï¼‰æ˜¾å¼å£°æ˜å¯ç©ºç±»å‹ã€‚\nå…¶ä»–å¼ƒç”¨ // âŒ E_STRICT å¸¸é‡å·²å¼ƒç”¨ error_reporting(E_ALL \u0026 ~E_STRICT); // âŒ session_set_save_handler() è¶…è¿‡ 2 ä¸ªå‚æ•°å·²å¼ƒç”¨ session_set_save_handler($open, $close, $read, $write, $destroy, $gc); // âœ… ä½¿ç”¨ SessionHandlerInterface session_set_save_handler(new MySessionHandler(), true); // âŒ CSV å‡½æ•°çš„ $escape å‚æ•°é»˜è®¤å€¼å·²å¼ƒç”¨ï¼Œéœ€æ˜¾å¼ä¼ é€’ fgetcsv($handle, 0, ',', '\"'); // éœ€è¦ä¼ é€’ç¬¬å››ä¸ªå‚æ•° // âŒ CURLOPT_BINARYTRANSFER å·²å¼ƒç”¨ï¼ˆå®é™…ä¸Šä»æœªæœ‰ä»»ä½•æ•ˆæœï¼‰ è¡Œä¸ºå˜åŒ– exit/die å˜ä¸ºå‡½æ•° exit å’Œ die ä»è¯­è¨€ç»“æ„å˜ä¸ºå‡½æ•°ï¼Œè¿™æ„å‘³ç€ï¼š\n// ç°åœ¨å¯ä»¥ä½œä¸º callable ä½¿ç”¨ $callback = exit(...); // å‚æ•°ç±»å‹æ›´ä¸¥æ ¼ exit(new stdClass()); // TypeError: exit(): Argument #1 ($status) must be of type string|int å¸¸é‡ç±»å‹å˜åŒ– // PHP_ZTS å’Œ PHP_DEBUG ä» int å˜ä¸º bool var_dump(PHP_ZTS); // bool(true) æˆ– bool(false) var_dump(PHP_DEBUG); // bool(true) æˆ– bool(false) å·²ç§»é™¤çš„æ‰©å±• ä»¥ä¸‹æ‰©å±•ä» PHP æ ¸å¿ƒç§»è‡³ PECLï¼š\nPspell - æ‹¼å†™æ£€æŸ¥æ‰©å±• IMAP - é‚®ä»¶åè®®æ‰©å±• OCI8 - Oracle æ•°æ®åº“æ‰©å±• PDO-OCI - Oracle PDO é©±åŠ¨ å¦‚éœ€ç»§ç»­ä½¿ç”¨ï¼Œéœ€ä» PECL å®‰è£…ã€‚\næœ€ä½ç‰ˆæœ¬è¦æ±‚ OpenSSLï¼šæœ€ä½ç‰ˆæœ¬ 1.1.1 libcurlï¼šæœ€ä½ç‰ˆæœ¬ 7.61.0 Bcryptï¼šå¯†ç å“ˆå¸Œé»˜è®¤ cost ä» 10 æå‡åˆ° 12 æ€»ç»“ PHP 8.4 å¸¦æ¥äº†è®¸å¤šå®ç”¨çš„æ–°ç‰¹æ€§å’Œæ”¹è¿›ï¼š\nä¸»è¦æ–°ç‰¹æ€§ï¼š\nå±æ€§é’©å­å’Œéå¯¹ç§°å¯è§æ€§ #[Deprecated] å±æ€§ ç°ä»£åŒ–çš„ DOM API BCMath å¯¹è±¡ API HTTP/3 æ”¯æŒ æ–°çš„æ•°ç»„å’Œå­—ç¬¦ä¸²å‡½æ•° éœ€è¦æ³¨æ„çš„å˜åŒ–ï¼š\néšå¼å¯ç©ºç±»å‹å·²å¼ƒç”¨ exit/die å˜ä¸ºå‡½æ•° éƒ¨åˆ†æ‰©å±•ç§»è‡³ PECL ä¾èµ–åº“æœ€ä½ç‰ˆæœ¬è¦æ±‚æå‡ é€šè¿‡äº†è§£è¿™äº›å˜åŒ–å¹¶éµå¾ªè¿ç§»å»ºè®®ï¼Œå¯ä»¥é¡ºåˆ©åœ°ä» PHP 8.3 è¿ç§»åˆ° PHP 8.4ã€‚\n","wordCount":"741","inLanguage":"en","image":"https://images.unsplash.com/photo-1549926506-afba2eb9fb6f?q=80\u0026w=960\u0026auto=format\u0026fit=crop\u0026ixlib=rb-4.0.3","datePublished":"2025-02-01T17:42:42+08:00","dateModified":"2025-02-01T17:42:42+08:00","author":[{"@type":"Person","name":"Me"},{"@type":"Person","name":"LLM"}],"mainEntityOfPage":{"@type":"WebPage","@id":"https://zyf.im/2025/02/01/php-migrating-83-to-84/"},"publisher":{"@type":"Organization","name":"ZYF.IM BLOG","logo":{"@type":"ImageObject","url":"https://zyf.im/favicon.ico"}}}</script></head><body id=top><header class=header><nav class=nav><div class=logo><a href=https://zyf.im/ accesskey=h title="ZYF.IM (Alt + H)"><img src=https://zyf.im/apple-touch-icon.png alt aria-label=logo height=35>ZYF.IM</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://zyf.im/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://zyf.im/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://zyf.im/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://zyf.im/about/ title=About><span>About</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://zyf.im/>Home</a>&nbsp;Â»&nbsp;<a href=https://zyf.im/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">PHP Migrating 8.3 to 8.4</h1><div class=post-meta><span title='2025-02-01 17:42:42 +0800 CST'>February 1, 2025</span>&nbsp;Â·&nbsp;<span>4 min</span>&nbsp;Â·&nbsp;<span>741 words</span>&nbsp;Â·&nbsp;<span>Me, LLM</span></div></header><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#ç®€ä»‹>ç®€ä»‹</a><ul><li><a href=#å‚è€ƒèµ„æº>å‚è€ƒèµ„æº</a></li></ul></li><li><a href=#php-84-æ–°ç‰¹æ€§>PHP 8.4 æ–°ç‰¹æ€§</a><ul><li><a href=#å±æ€§é’©å­ä¸éå¯¹ç§°å¯è§æ€§>å±æ€§é’©å­ä¸éå¯¹ç§°å¯è§æ€§</a></li><li><a href=#deprecated-å±æ€§>#[Deprecated] å±æ€§</a></li><li><a href=#å¢å¼ºçš„-dom-api>å¢å¼ºçš„ DOM API</a></li><li><a href=#bcmath-çš„å¯¹è±¡-api>BCMath çš„å¯¹è±¡ API</a></li><li><a href=#http3-æ”¯æŒ>HTTP/3 æ”¯æŒ</a></li></ul></li><li><a href=#php-84-æ–°å¢å‡½æ•°>PHP 8.4 æ–°å¢å‡½æ•°</a><ul><li><a href=#æ–°çš„æ•°ç»„æ“ä½œå‡½æ•°>æ–°çš„æ•°ç»„æ“ä½œå‡½æ•°</a></li><li><a href=#æ–°çš„å­—ç¬¦ä¸²å¤„ç†å‡½æ•°>æ–°çš„å­—ç¬¦ä¸²å¤„ç†å‡½æ•°</a></li><li><a href=#æ—¥æœŸæ—¶é—´æ–°æ–¹æ³•>æ—¥æœŸæ—¶é—´æ–°æ–¹æ³•</a></li><li><a href=#round-å‡½æ•°æ–°èˆå…¥æ¨¡å¼>round() å‡½æ•°æ–°èˆå…¥æ¨¡å¼</a></li><li><a href=#å…¶ä»–æ–°å‡½æ•°>å…¶ä»–æ–°å‡½æ•°</a></li></ul></li><li><a href=#å…¼å®¹æ€§ä¸è¿ç§»>å…¼å®¹æ€§ä¸è¿ç§»</a><ul><li><a href=#å¼ƒç”¨ç‰¹æ€§>å¼ƒç”¨ç‰¹æ€§</a></li><li><a href=#è¡Œä¸ºå˜åŒ–>è¡Œä¸ºå˜åŒ–</a></li><li><a href=#å·²ç§»é™¤çš„æ‰©å±•>å·²ç§»é™¤çš„æ‰©å±•</a></li><li><a href=#æœ€ä½ç‰ˆæœ¬è¦æ±‚>æœ€ä½ç‰ˆæœ¬è¦æ±‚</a></li></ul></li><li><a href=#æ€»ç»“>æ€»ç»“</a></li></ul></nav></div></details></div><div class=post-content><h2 id=ç®€ä»‹>ç®€ä»‹<a hidden class=anchor aria-hidden=true href=#ç®€ä»‹>#</a></h2><p>PHP 8.4 å¼•å…¥äº†è®¸å¤šæ–°ç‰¹æ€§ï¼Œå¦‚å±æ€§é’©å­ï¼ˆProperty Hooksï¼‰ã€éå¯¹ç§°å¯è§æ€§ï¼ˆAsymmetric Visibilityï¼‰ã€<code>#[Deprecated]</code> å±æ€§ä»¥åŠæ›´æ–°çš„ DOM API ç­‰ã€‚æœ¬æ–‡å°†ä»‹ç»ä¸»è¦å˜åŒ–å’Œå¦‚ä½•è¿›è¡Œè¿ç§»ã€‚</p><h3 id=å‚è€ƒèµ„æº>å‚è€ƒèµ„æº<a hidden class=anchor aria-hidden=true href=#å‚è€ƒèµ„æº>#</a></h3><ul><li>åœ¨çº¿æµ‹è¯•ç¯å¢ƒï¼š<a href=https://onlinephp.io/>https://onlinephp.io/</a></li><li>å®˜æ–¹å‘å¸ƒè¯´æ˜ï¼š<a href=https://www.php.net/releases/8.4/en.php>https://www.php.net/releases/8.4/en.php</a></li><li>è¿ç§»æŒ‡å—ï¼š<a href=https://www.php.net/manual/en/migration84.php>https://www.php.net/manual/en/migration84.php</a></li><li>æ›´æ–°è¯¦æƒ…ï¼š<a href=https://php.watch/versions/8.4>https://php.watch/versions/8.4</a></li></ul><h2 id=php-84-æ–°ç‰¹æ€§>PHP 8.4 æ–°ç‰¹æ€§<a hidden class=anchor aria-hidden=true href=#php-84-æ–°ç‰¹æ€§>#</a></h2><h3 id=å±æ€§é’©å­ä¸éå¯¹ç§°å¯è§æ€§>å±æ€§é’©å­ä¸éå¯¹ç§°å¯è§æ€§<a hidden class=anchor aria-hidden=true href=#å±æ€§é’©å­ä¸éå¯¹ç§°å¯è§æ€§>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=c1>// å±æ€§é’©å­ï¼ˆProperty Hooksï¼‰ä¸éå¯¹ç§°å¯è§æ€§ï¼ˆAsymmetric Visibilityï¼‰
</span></span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>User</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>private</span> <span class=nx>bool</span> <span class=nv>$isModified</span> <span class=o>=</span> <span class=k>false</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=k>function</span> <span class=fm>__construct</span><span class=p>(</span><span class=k>public</span> <span class=k>private</span><span class=p>(</span><span class=nx>set</span><span class=p>)</span> <span class=nx>string</span> <span class=nv>$first</span><span class=p>,</span> <span class=k>private</span> <span class=nx>string</span> <span class=nv>$last</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=nx>string</span> <span class=nv>$fullName</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>get</span> <span class=o>=&gt;</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>first</span> <span class=o>.</span> <span class=s2>&#34; &#34;</span> <span class=o>.</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>last</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=nx>set</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=p>[</span><span class=nv>$this</span><span class=o>-&gt;</span><span class=na>first</span><span class=p>,</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>last</span><span class=p>]</span> <span class=o>=</span> <span class=nx>explode</span><span class=p>(</span><span class=s1>&#39; &#39;</span><span class=p>,</span> <span class=nv>$value</span><span class=p>,</span> <span class=mi>2</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>isModified</span> <span class=o>=</span> <span class=k>true</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=nv>$user</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>User</span><span class=p>(</span><span class=s2>&#34;Ming&#34;</span><span class=p>,</span> <span class=s2>&#34;Li&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=k>echo</span> <span class=nv>$user</span><span class=o>-&gt;</span><span class=na>fullName</span><span class=p>;</span> <span class=c1>// è¾“å‡º: Ming Li
</span></span></span><span class=line><span class=cl><span class=nv>$user</span><span class=o>-&gt;</span><span class=na>fullName</span> <span class=o>=</span> <span class=s2>&#34;Hong Xiao&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>echo</span> <span class=nv>$user</span><span class=o>-&gt;</span><span class=na>fullName</span><span class=p>;</span> <span class=c1>// è¾“å‡º: Hong Xiao
</span></span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// éå¯¹ç§°å¯è§æ€§ç¤ºä¾‹
</span></span></span><span class=line><span class=cl><span class=k>echo</span> <span class=nv>$user</span><span class=o>-&gt;</span><span class=na>first</span><span class=p>;</span> <span class=c1>// è¾“å‡º: Hong
</span></span></span><span class=line><span class=cl><span class=nv>$user</span><span class=o>-&gt;</span><span class=na>first</span> <span class=o>=</span> <span class=s2>&#34;Hua&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=c1>// é”™è¯¯: Fatal error: Uncaught Error: Cannot modify private(set) property User::$first
</span></span></span></code></pre></div><p>å±æ€§é’©å­å…è®¸æˆ‘ä»¬å®šä¹‰å±æ€§çš„è·å–å’Œè®¾ç½®è¡Œä¸ºï¼Œè€Œéå¯¹ç§°å¯è§æ€§å…è®¸æˆ‘ä»¬ä¸ºå±æ€§è®¾ç½®ä¸åŒçš„è¯»å†™æƒé™ã€‚åœ¨ä¸Šä¾‹ä¸­ï¼Œ<code>$first</code> å±æ€§å¯ä»¥å…¬å¼€è¯»å–ä½†åªèƒ½ç§æœ‰å†™å…¥ã€‚</p><h3 id=deprecated-å±æ€§>#[Deprecated] å±æ€§<a hidden class=anchor aria-hidden=true href=#deprecated-å±æ€§>#</a></h3><p>PHP 8.4 å¼•å…¥äº† <code>#[Deprecated]</code> å±æ€§ï¼Œå¯ä»¥ç”¨æ¥æ ‡è®°å·²å¼ƒç”¨çš„ä»£ç ï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=c1>#[Deprecated(&#34;Use newFunction() instead&#34;, since: &#34;2.0&#34;)]
</span></span></span><span class=line><span class=cl><span class=k>function</span> <span class=nf>oldFunction</span><span class=p>()</span><span class=o>:</span> <span class=nx>void</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>oldFunction</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=c1>// Warning: Function oldFunction() is deprecated, Use newFunction() instead
</span></span></span></code></pre></div><p>è¿™ä½¿å¾—å¼€å‘è€…å¯ä»¥åœ¨è‡ªå·±çš„ä»£ç åº“ä¸­ä½¿ç”¨ä¸ PHP å†…éƒ¨ç›¸åŒçš„å¼ƒç”¨æœºåˆ¶ã€‚</p><h3 id=å¢å¼ºçš„-dom-api>å¢å¼ºçš„ DOM API<a hidden class=anchor aria-hidden=true href=#å¢å¼ºçš„-dom-api>#</a></h3><p>PHP 8.4 æ›´æ–°äº† DOM APIï¼Œæä¾›äº†æ›´ç°ä»£ã€æ›´æ˜“ç”¨çš„æ¥å£ï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=c1>// æ–°çš„ DOM API ç¤ºä¾‹
</span></span></span><span class=line><span class=cl><span class=nv>$doc</span> <span class=o>=</span> <span class=nx>\Dom\HTMLDocument</span><span class=o>::</span><span class=na>createFromString</span><span class=p>(</span><span class=s1>&#39;&lt;div&gt;&lt;span&gt;Hello&lt;/span&gt;&lt;/div&gt;&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// ä½¿ç”¨ querySelector å’Œ querySelectorAll
</span></span></span><span class=line><span class=cl><span class=nv>$span</span> <span class=o>=</span> <span class=nv>$doc</span><span class=o>-&gt;</span><span class=na>querySelector</span><span class=p>(</span><span class=s1>&#39;span&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=k>echo</span> <span class=nv>$span</span><span class=o>-&gt;</span><span class=na>textContent</span><span class=p>;</span> <span class=c1>// è¾“å‡º: Hello
</span></span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// ä½¿ç”¨ innerHTML/outerHTML
</span></span></span><span class=line><span class=cl><span class=nv>$div</span> <span class=o>=</span> <span class=nv>$doc</span><span class=o>-&gt;</span><span class=na>querySelector</span><span class=p>(</span><span class=s1>&#39;div&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=k>echo</span> <span class=nv>$div</span><span class=o>-&gt;</span><span class=na>innerHTML</span><span class=p>;</span> <span class=c1>// è¾“å‡º: &lt;span&gt;Hello&lt;/span&gt;
</span></span></span><span class=line><span class=cl><span class=nv>$div</span><span class=o>-&gt;</span><span class=na>innerHTML</span> <span class=o>=</span> <span class=s1>&#39;&lt;p&gt;World&lt;/p&gt;&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>echo</span> <span class=nv>$div</span><span class=o>-&gt;</span><span class=na>outerHTML</span><span class=p>;</span> <span class=c1>// è¾“å‡º: &lt;div&gt;&lt;p&gt;World&lt;/p&gt;&lt;/div&gt;
</span></span></span></code></pre></div><h3 id=bcmath-çš„å¯¹è±¡-api>BCMath çš„å¯¹è±¡ API<a hidden class=anchor aria-hidden=true href=#bcmath-çš„å¯¹è±¡-api>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=c1>// BCMath çš„å¯¹è±¡ API
</span></span></span><span class=line><span class=cl><span class=k>use</span> <span class=nx>BcMath\Number</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=nv>$num1</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Number</span><span class=p>(</span><span class=s1>&#39;0.12345&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nv>$num2</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Number</span><span class=p>(</span><span class=s1>&#39;2&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nv>$result</span> <span class=o>=</span> <span class=nv>$num1</span> <span class=o>+</span> <span class=nv>$num2</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>echo</span> <span class=nv>$result</span><span class=p>;</span> <span class=c1>// è¾“å‡º: &#39;2.12345&#39;
</span></span></span><span class=line><span class=cl><span class=nx>var_dump</span><span class=p>(</span><span class=nv>$num1</span> <span class=o>&gt;</span> <span class=nv>$num2</span><span class=p>);</span> <span class=c1>// è¾“å‡º: false
</span></span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// PHP 8.4 ä¹‹å‰çš„å†™æ³•
</span></span></span><span class=line><span class=cl><span class=nv>$num1</span> <span class=o>=</span> <span class=s1>&#39;0.12345&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=nv>$num2</span> <span class=o>=</span> <span class=mi>2</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=nv>$result</span> <span class=o>=</span> <span class=nx>bcadd</span><span class=p>(</span><span class=nv>$num1</span><span class=p>,</span> <span class=nv>$num2</span><span class=p>,</span> <span class=mi>5</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=k>echo</span> <span class=nv>$result</span><span class=p>;</span> <span class=c1>// è¾“å‡º: &#39;2.12345&#39;
</span></span></span><span class=line><span class=cl><span class=nx>var_dump</span><span class=p>(</span><span class=nx>bccomp</span><span class=p>(</span><span class=nv>$num1</span><span class=p>,</span> <span class=nv>$num2</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>);</span> <span class=c1>// è¾“å‡º: false
</span></span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// æ–°å¢ bcdivmod() å‡½æ•° - åŒæ—¶è¿”å›å•†å’Œä½™æ•°
</span></span></span><span class=line><span class=cl><span class=p>[</span><span class=nv>$quotient</span><span class=p>,</span> <span class=nv>$remainder</span><span class=p>]</span> <span class=o>=</span> <span class=nx>bcdivmod</span><span class=p>(</span><span class=s1>&#39;10&#39;</span><span class=p>,</span> <span class=s1>&#39;3&#39;</span><span class=p>,</span> <span class=mi>2</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=k>echo</span> <span class=nv>$quotient</span><span class=p>;</span>  <span class=c1>// è¾“å‡º: 3
</span></span></span><span class=line><span class=cl><span class=k>echo</span> <span class=nv>$remainder</span><span class=p>;</span> <span class=c1>// è¾“å‡º: 1.00
</span></span></span></code></pre></div><p>PHP 8.4 ä¸º BCMath å¼•å…¥äº†å¯¹è±¡ APIï¼Œä½¿ç”¨èµ·æ¥æ›´åŠ ç›´è§‚å’Œé¢å‘å¯¹è±¡ã€‚</p><h3 id=http3-æ”¯æŒ>HTTP/3 æ”¯æŒ<a hidden class=anchor aria-hidden=true href=#http3-æ”¯æŒ>#</a></h3><p>PHP 8.4 çš„ cURL æ‰©å±•æ–°å¢äº† HTTP/3 æ”¯æŒï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=nv>$ch</span> <span class=o>=</span> <span class=nx>curl_init</span><span class=p>(</span><span class=s1>&#39;https://example.com&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>curl_setopt</span><span class=p>(</span><span class=nv>$ch</span><span class=p>,</span> <span class=nx>CURLOPT_HTTP_VERSION</span><span class=p>,</span> <span class=nx>CURL_HTTP_VERSION_3</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=c1>// æˆ–å¼ºåˆ¶ä½¿ç”¨ HTTP/3
</span></span></span><span class=line><span class=cl><span class=nx>curl_setopt</span><span class=p>(</span><span class=nv>$ch</span><span class=p>,</span> <span class=nx>CURLOPT_HTTP_VERSION</span><span class=p>,</span> <span class=nx>CURL_HTTP_VERSION_3ONLY</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nv>$response</span> <span class=o>=</span> <span class=nx>curl_exec</span><span class=p>(</span><span class=nv>$ch</span><span class=p>);</span>
</span></span></code></pre></div><p>å…¶ä»–æ–°å¢çš„ cURL é€‰é¡¹åŒ…æ‹¬ï¼š<code>CURLOPT_PREREQFUNCTION</code>ã€<code>CURLOPT_DEBUGFUNCTION</code>ã€<code>CURLOPT_SERVER_RESPONSE_TIMEOUT</code>ã€<code>CURLOPT_TCP_KEEPCNT</code>ã€‚</p><h2 id=php-84-æ–°å¢å‡½æ•°>PHP 8.4 æ–°å¢å‡½æ•°<a hidden class=anchor aria-hidden=true href=#php-84-æ–°å¢å‡½æ•°>#</a></h2><h3 id=æ–°çš„æ•°ç»„æ“ä½œå‡½æ•°>æ–°çš„æ•°ç»„æ“ä½œå‡½æ•°<a hidden class=anchor aria-hidden=true href=#æ–°çš„æ•°ç»„æ“ä½œå‡½æ•°>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=c1>// array_find() - æŸ¥æ‰¾ç¬¬ä¸€ä¸ªæ»¡è¶³æ¡ä»¶çš„å…ƒç´ 
</span></span></span><span class=line><span class=cl><span class=nv>$animal</span> <span class=o>=</span> <span class=nx>array_find</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=p>[</span><span class=s1>&#39;dog&#39;</span><span class=p>,</span> <span class=s1>&#39;cat&#39;</span><span class=p>,</span> <span class=s1>&#39;cow&#39;</span><span class=p>,</span> <span class=s1>&#39;duck&#39;</span><span class=p>,</span> <span class=s1>&#39;goose&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>    <span class=k>static</span> <span class=nx>fn</span> <span class=p>(</span><span class=nx>string</span> <span class=nv>$value</span><span class=p>)</span><span class=o>:</span> <span class=nx>bool</span> <span class=o>=&gt;</span> <span class=nx>str_starts_with</span><span class=p>(</span><span class=nv>$value</span><span class=p>,</span> <span class=s1>&#39;c&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>var_dump</span><span class=p>(</span><span class=nv>$animal</span><span class=p>);</span> <span class=c1>// è¾“å‡º: string(3) &#34;cat&#34;
</span></span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// array_find_key() - æŸ¥æ‰¾ç¬¬ä¸€ä¸ªæ»¡è¶³æ¡ä»¶çš„å…ƒç´ çš„é”®
</span></span></span><span class=line><span class=cl><span class=nv>$key</span> <span class=o>=</span> <span class=nx>array_find_key</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=p>[</span><span class=s1>&#39;a&#39;</span> <span class=o>=&gt;</span> <span class=mi>1</span><span class=p>,</span> <span class=s1>&#39;b&#39;</span> <span class=o>=&gt;</span> <span class=mi>2</span><span class=p>,</span> <span class=s1>&#39;c&#39;</span> <span class=o>=&gt;</span> <span class=mi>3</span><span class=p>],</span>
</span></span><span class=line><span class=cl>    <span class=nx>fn</span><span class=p>(</span><span class=nv>$v</span><span class=p>)</span> <span class=o>=&gt;</span> <span class=nv>$v</span> <span class=o>&gt;</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>var_dump</span><span class=p>(</span><span class=nv>$key</span><span class=p>);</span> <span class=c1>// è¾“å‡º: string(1) &#34;b&#34;
</span></span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// array_any() - æ£€æŸ¥æ˜¯å¦è‡³å°‘æœ‰ä¸€ä¸ªå…ƒç´ æ»¡è¶³æ¡ä»¶
</span></span></span><span class=line><span class=cl><span class=nv>$result</span> <span class=o>=</span> <span class=nx>array_any</span><span class=p>([</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>],</span> <span class=nx>fn</span><span class=p>(</span><span class=nv>$n</span><span class=p>)</span> <span class=o>=&gt;</span> <span class=nv>$n</span> <span class=o>&gt;</span> <span class=mi>3</span><span class=p>);</span> <span class=c1>// true
</span></span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// array_all() - æ£€æŸ¥æ˜¯å¦æ‰€æœ‰å…ƒç´ éƒ½æ»¡è¶³æ¡ä»¶
</span></span></span><span class=line><span class=cl><span class=nv>$result</span> <span class=o>=</span> <span class=nx>array_all</span><span class=p>([</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>],</span> <span class=nx>fn</span><span class=p>(</span><span class=nv>$n</span><span class=p>)</span> <span class=o>=&gt;</span> <span class=nv>$n</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>);</span> <span class=c1>// true
</span></span></span></code></pre></div><h3 id=æ–°çš„å­—ç¬¦ä¸²å¤„ç†å‡½æ•°>æ–°çš„å­—ç¬¦ä¸²å¤„ç†å‡½æ•°<a hidden class=anchor aria-hidden=true href=#æ–°çš„å­—ç¬¦ä¸²å¤„ç†å‡½æ•°>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=c1>// å¤šå­—èŠ‚å­—ç¬¦ä¸²ä¿®å‰ªå‡½æ•°
</span></span></span><span class=line><span class=cl><span class=nv>$str</span> <span class=o>=</span> <span class=s2>&#34;ã€€ã“ã‚“ã«ã¡ã¯ã€€&#34;</span><span class=p>;</span> <span class=c1>// åŒ…å«å…¨è§’ç©ºæ ¼
</span></span></span><span class=line><span class=cl><span class=k>echo</span> <span class=nx>mb_trim</span><span class=p>(</span><span class=nv>$str</span><span class=p>);</span>   <span class=c1>// &#34;ã“ã‚“ã«ã¡ã¯&#34;
</span></span></span><span class=line><span class=cl><span class=k>echo</span> <span class=nx>mb_ltrim</span><span class=p>(</span><span class=nv>$str</span><span class=p>);</span>  <span class=c1>// &#34;ã“ã‚“ã«ã¡ã¯ã€€&#34;
</span></span></span><span class=line><span class=cl><span class=k>echo</span> <span class=nx>mb_rtrim</span><span class=p>(</span><span class=nv>$str</span><span class=p>);</span>  <span class=c1>// &#34;ã€€ã“ã‚“ã«ã¡ã¯&#34;
</span></span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// å¤šå­—èŠ‚é¦–å­—æ¯å¤§å°å†™è½¬æ¢
</span></span></span><span class=line><span class=cl><span class=k>echo</span> <span class=nx>mb_ucfirst</span><span class=p>(</span><span class=s1>&#39;Ã±oÃ±o&#39;</span><span class=p>);</span> <span class=c1>// &#34;Ã‘oÃ±o&#34;
</span></span></span><span class=line><span class=cl><span class=k>echo</span> <span class=nx>mb_lcfirst</span><span class=p>(</span><span class=s1>&#39;Ã‘oÃ‘o&#39;</span><span class=p>);</span> <span class=c1>// &#34;Ã±oÃ‘o&#34;
</span></span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// æŒ‰å­—å½¢ç°‡æ‹†åˆ†å­—ç¬¦ä¸²
</span></span></span><span class=line><span class=cl><span class=nv>$chars</span> <span class=o>=</span> <span class=nx>grapheme_str_split</span><span class=p>(</span><span class=s1>&#39;ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>var_dump</span><span class=p>(</span><span class=nv>$chars</span><span class=p>);</span> <span class=c1>// [&#39;ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦&#39;]
</span></span></span></code></pre></div><h3 id=æ—¥æœŸæ—¶é—´æ–°æ–¹æ³•>æ—¥æœŸæ—¶é—´æ–°æ–¹æ³•<a hidden class=anchor aria-hidden=true href=#æ—¥æœŸæ—¶é—´æ–°æ–¹æ³•>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=c1>// ä»æ—¶é—´æˆ³åˆ›å»º DateTime å¯¹è±¡
</span></span></span><span class=line><span class=cl><span class=nv>$dt</span> <span class=o>=</span> <span class=nx>DateTime</span><span class=o>::</span><span class=na>createFromTimestamp</span><span class=p>(</span><span class=mi>1704067200</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nv>$dti</span> <span class=o>=</span> <span class=nx>DateTimeImmutable</span><span class=o>::</span><span class=na>createFromTimestamp</span><span class=p>(</span><span class=mf>1704067200.123456</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// å¾®ç§’å¤„ç†
</span></span></span><span class=line><span class=cl><span class=nv>$dt</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>DateTime</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=k>echo</span> <span class=nv>$dt</span><span class=o>-&gt;</span><span class=na>getMicrosecond</span><span class=p>();</span> <span class=c1>// è·å–å¾®ç§’
</span></span></span><span class=line><span class=cl><span class=nv>$dt</span><span class=o>-&gt;</span><span class=na>setMicrosecond</span><span class=p>(</span><span class=mi>500000</span><span class=p>);</span> <span class=c1>// è®¾ç½®å¾®ç§’
</span></span></span></code></pre></div><h3 id=round-å‡½æ•°æ–°èˆå…¥æ¨¡å¼>round() å‡½æ•°æ–°èˆå…¥æ¨¡å¼<a hidden class=anchor aria-hidden=true href=#round-å‡½æ•°æ–°èˆå…¥æ¨¡å¼>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=c1>// PHP 8.4 æ–°å¢èˆå…¥æ¨¡å¼
</span></span></span><span class=line><span class=cl><span class=k>echo</span> <span class=nx>round</span><span class=p>(</span><span class=mf>1.5</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=nx>PHP_ROUND_HALF_UP</span><span class=p>);</span>       <span class=c1>// 2 (å››èˆäº”å…¥)
</span></span></span><span class=line><span class=cl><span class=k>echo</span> <span class=nx>round</span><span class=p>(</span><span class=mf>1.5</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=nx>PHP_ROUND_HALF_DOWN</span><span class=p>);</span>     <span class=c1>// 1 (äº”èˆå…­å…¥)
</span></span></span><span class=line><span class=cl><span class=k>echo</span> <span class=nx>round</span><span class=p>(</span><span class=mf>1.5</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=nx>PHP_ROUND_HALF_EVEN</span><span class=p>);</span>     <span class=c1>// 2 (é“¶è¡Œå®¶èˆå…¥)
</span></span></span><span class=line><span class=cl><span class=k>echo</span> <span class=nx>round</span><span class=p>(</span><span class=mf>1.5</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=nx>PHP_ROUND_HALF_ODD</span><span class=p>);</span>      <span class=c1>// 1 (èˆå…¥åˆ°å¥‡æ•°)
</span></span></span><span class=line><span class=cl><span class=k>echo</span> <span class=nx>round</span><span class=p>(</span><span class=mf>1.2</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=nx>PHP_ROUND_CEILING</span><span class=p>);</span>       <span class=c1>// 2 (å‘ä¸Šå–æ•´)
</span></span></span><span class=line><span class=cl><span class=k>echo</span> <span class=nx>round</span><span class=p>(</span><span class=mf>1.8</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=nx>PHP_ROUND_FLOOR</span><span class=p>);</span>         <span class=c1>// 1 (å‘ä¸‹å–æ•´)
</span></span></span><span class=line><span class=cl><span class=k>echo</span> <span class=nx>round</span><span class=p>(</span><span class=o>-</span><span class=mf>1.5</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=nx>PHP_ROUND_TOWARD_ZERO</span><span class=p>);</span>  <span class=c1>// -1 (å‘é›¶å–æ•´)
</span></span></span><span class=line><span class=cl><span class=k>echo</span> <span class=nx>round</span><span class=p>(</span><span class=o>-</span><span class=mf>1.5</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=nx>PHP_ROUND_AWAY_FROM_ZERO</span><span class=p>);</span> <span class=c1>// -2 (è¿œç¦»é›¶å–æ•´)
</span></span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// æ³¨æ„ï¼šæ— æ•ˆçš„èˆå…¥æ¨¡å¼ç°åœ¨ä¼šæŠ›å‡º ValueError
</span></span></span></code></pre></div><h3 id=å…¶ä»–æ–°å‡½æ•°>å…¶ä»–æ–°å‡½æ•°<a hidden class=anchor aria-hidden=true href=#å…¶ä»–æ–°å‡½æ•°>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=c1>// request_parse_body() - è§£æè¯·æ±‚ä½“
</span></span></span><span class=line><span class=cl><span class=p>[</span><span class=nv>$_POST</span><span class=p>,</span> <span class=nv>$_FILES</span><span class=p>]</span> <span class=o>=</span> <span class=nx>request_parse_body</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// HTTP å“åº”å¤´å¤„ç†
</span></span></span><span class=line><span class=cl><span class=nv>$headers</span> <span class=o>=</span> <span class=nx>http_get_last_response_headers</span><span class=p>();</span> <span class=c1>// è·å–æœ€åä¸€æ¬¡å“åº”å¤´
</span></span></span><span class=line><span class=cl><span class=nx>http_clear_last_response_headers</span><span class=p>();</span> <span class=c1>// æ¸…é™¤å“åº”å¤´ç¼“å­˜
</span></span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// IANA æ—¶åŒº ID
</span></span></span><span class=line><span class=cl><span class=k>echo</span> <span class=nx>intltz_get_iana_id</span><span class=p>(</span><span class=s1>&#39;Asia/Shanghai&#39;</span><span class=p>);</span> <span class=c1>// è·å–è§„èŒƒæ—¶åŒº ID
</span></span></span></code></pre></div><h2 id=å…¼å®¹æ€§ä¸è¿ç§»>å…¼å®¹æ€§ä¸è¿ç§»<a hidden class=anchor aria-hidden=true href=#å…¼å®¹æ€§ä¸è¿ç§»>#</a></h2><h3 id=å¼ƒç”¨ç‰¹æ€§>å¼ƒç”¨ç‰¹æ€§<a hidden class=anchor aria-hidden=true href=#å¼ƒç”¨ç‰¹æ€§>#</a></h3><h4 id=éšå¼å¯ç©ºç±»å‹>éšå¼å¯ç©ºç±»å‹<a hidden class=anchor aria-hidden=true href=#éšå¼å¯ç©ºç±»å‹>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=c1>// âŒ PHP 8.4 å·²å¼ƒç”¨
</span></span></span><span class=line><span class=cl><span class=k>function</span> <span class=nf>save</span><span class=p>(</span><span class=nx>Book</span> <span class=nv>$book</span> <span class=o>=</span> <span class=k>null</span><span class=p>)</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// âœ… ä¿®å¤æ–¹æ³•ï¼šæ˜¾å¼å£°æ˜å¯ç©ºç±»å‹
</span></span></span><span class=line><span class=cl><span class=k>function</span> <span class=nf>save</span><span class=p>(</span><span class=o>?</span><span class=nx>Book</span> <span class=nv>$book</span> <span class=o>=</span> <span class=k>null</span><span class=p>)</span> <span class=p>{}</span>
</span></span></code></pre></div><p>åœ¨ PHP 8.4 ä¸­ï¼Œéšå¼å¯ç©ºç±»å‹å·²è¢«å¼ƒç”¨ï¼Œéœ€è¦ä½¿ç”¨é—®å·ï¼ˆ<code>?</code>ï¼‰æ˜¾å¼å£°æ˜å¯ç©ºç±»å‹ã€‚</p><h4 id=å…¶ä»–å¼ƒç”¨>å…¶ä»–å¼ƒç”¨<a hidden class=anchor aria-hidden=true href=#å…¶ä»–å¼ƒç”¨>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=c1>// âŒ E_STRICT å¸¸é‡å·²å¼ƒç”¨
</span></span></span><span class=line><span class=cl><span class=nx>error_reporting</span><span class=p>(</span><span class=k>E_ALL</span> <span class=o>&amp;</span> <span class=o>~</span><span class=nx>E_STRICT</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// âŒ session_set_save_handler() è¶…è¿‡ 2 ä¸ªå‚æ•°å·²å¼ƒç”¨
</span></span></span><span class=line><span class=cl><span class=nx>session_set_save_handler</span><span class=p>(</span><span class=nv>$open</span><span class=p>,</span> <span class=nv>$close</span><span class=p>,</span> <span class=nv>$read</span><span class=p>,</span> <span class=nv>$write</span><span class=p>,</span> <span class=nv>$destroy</span><span class=p>,</span> <span class=nv>$gc</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// âœ… ä½¿ç”¨ SessionHandlerInterface
</span></span></span><span class=line><span class=cl><span class=nx>session_set_save_handler</span><span class=p>(</span><span class=k>new</span> <span class=nx>MySessionHandler</span><span class=p>(),</span> <span class=k>true</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// âŒ CSV å‡½æ•°çš„ $escape å‚æ•°é»˜è®¤å€¼å·²å¼ƒç”¨ï¼Œéœ€æ˜¾å¼ä¼ é€’
</span></span></span><span class=line><span class=cl><span class=nx>fgetcsv</span><span class=p>(</span><span class=nv>$handle</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=s1>&#39;,&#39;</span><span class=p>,</span> <span class=s1>&#39;&#34;&#39;</span><span class=p>);</span> <span class=c1>// éœ€è¦ä¼ é€’ç¬¬å››ä¸ªå‚æ•°
</span></span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// âŒ CURLOPT_BINARYTRANSFER å·²å¼ƒç”¨ï¼ˆå®é™…ä¸Šä»æœªæœ‰ä»»ä½•æ•ˆæœï¼‰
</span></span></span></code></pre></div><h3 id=è¡Œä¸ºå˜åŒ–>è¡Œä¸ºå˜åŒ–<a hidden class=anchor aria-hidden=true href=#è¡Œä¸ºå˜åŒ–>#</a></h3><h4 id=exitdie-å˜ä¸ºå‡½æ•°>exit/die å˜ä¸ºå‡½æ•°<a hidden class=anchor aria-hidden=true href=#exitdie-å˜ä¸ºå‡½æ•°>#</a></h4><p><code>exit</code> å’Œ <code>die</code> ä»è¯­è¨€ç»“æ„å˜ä¸ºå‡½æ•°ï¼Œè¿™æ„å‘³ç€ï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=c1>// ç°åœ¨å¯ä»¥ä½œä¸º callable ä½¿ç”¨
</span></span></span><span class=line><span class=cl><span class=nv>$callback</span> <span class=o>=</span> <span class=k>exit</span><span class=p>(</span><span class=o>...</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// å‚æ•°ç±»å‹æ›´ä¸¥æ ¼
</span></span></span><span class=line><span class=cl><span class=k>exit</span><span class=p>(</span><span class=k>new</span> <span class=k>stdClass</span><span class=p>());</span> <span class=c1>// TypeError: exit(): Argument #1 ($status) must be of type string|int
</span></span></span></code></pre></div><h4 id=å¸¸é‡ç±»å‹å˜åŒ–>å¸¸é‡ç±»å‹å˜åŒ–<a hidden class=anchor aria-hidden=true href=#å¸¸é‡ç±»å‹å˜åŒ–>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=c1>// PHP_ZTS å’Œ PHP_DEBUG ä» int å˜ä¸º bool
</span></span></span><span class=line><span class=cl><span class=nx>var_dump</span><span class=p>(</span><span class=nx>PHP_ZTS</span><span class=p>);</span>   <span class=c1>// bool(true) æˆ– bool(false)
</span></span></span><span class=line><span class=cl><span class=nx>var_dump</span><span class=p>(</span><span class=nx>PHP_DEBUG</span><span class=p>);</span> <span class=c1>// bool(true) æˆ– bool(false)
</span></span></span></code></pre></div><h3 id=å·²ç§»é™¤çš„æ‰©å±•>å·²ç§»é™¤çš„æ‰©å±•<a hidden class=anchor aria-hidden=true href=#å·²ç§»é™¤çš„æ‰©å±•>#</a></h3><p>ä»¥ä¸‹æ‰©å±•ä» PHP æ ¸å¿ƒç§»è‡³ PECLï¼š</p><ul><li><strong>Pspell</strong> - æ‹¼å†™æ£€æŸ¥æ‰©å±•</li><li><strong>IMAP</strong> - é‚®ä»¶åè®®æ‰©å±•</li><li><strong>OCI8</strong> - Oracle æ•°æ®åº“æ‰©å±•</li><li><strong>PDO-OCI</strong> - Oracle PDO é©±åŠ¨</li></ul><p>å¦‚éœ€ç»§ç»­ä½¿ç”¨ï¼Œéœ€ä» PECL å®‰è£…ã€‚</p><h3 id=æœ€ä½ç‰ˆæœ¬è¦æ±‚>æœ€ä½ç‰ˆæœ¬è¦æ±‚<a hidden class=anchor aria-hidden=true href=#æœ€ä½ç‰ˆæœ¬è¦æ±‚>#</a></h3><ul><li><strong>OpenSSL</strong>ï¼šæœ€ä½ç‰ˆæœ¬ 1.1.1</li><li><strong>libcurl</strong>ï¼šæœ€ä½ç‰ˆæœ¬ 7.61.0</li><li><strong>Bcrypt</strong>ï¼šå¯†ç å“ˆå¸Œé»˜è®¤ cost ä» 10 æå‡åˆ° 12</li></ul><h2 id=æ€»ç»“>æ€»ç»“<a hidden class=anchor aria-hidden=true href=#æ€»ç»“>#</a></h2><p>PHP 8.4 å¸¦æ¥äº†è®¸å¤šå®ç”¨çš„æ–°ç‰¹æ€§å’Œæ”¹è¿›ï¼š</p><p><strong>ä¸»è¦æ–°ç‰¹æ€§ï¼š</strong></p><ul><li>å±æ€§é’©å­å’Œéå¯¹ç§°å¯è§æ€§</li><li><code>#[Deprecated]</code> å±æ€§</li><li>ç°ä»£åŒ–çš„ DOM API</li><li>BCMath å¯¹è±¡ API</li><li>HTTP/3 æ”¯æŒ</li><li>æ–°çš„æ•°ç»„å’Œå­—ç¬¦ä¸²å‡½æ•°</li></ul><p><strong>éœ€è¦æ³¨æ„çš„å˜åŒ–ï¼š</strong></p><ul><li>éšå¼å¯ç©ºç±»å‹å·²å¼ƒç”¨</li><li><code>exit</code>/<code>die</code> å˜ä¸ºå‡½æ•°</li><li>éƒ¨åˆ†æ‰©å±•ç§»è‡³ PECL</li><li>ä¾èµ–åº“æœ€ä½ç‰ˆæœ¬è¦æ±‚æå‡</li></ul><p>é€šè¿‡äº†è§£è¿™äº›å˜åŒ–å¹¶éµå¾ªè¿ç§»å»ºè®®ï¼Œå¯ä»¥é¡ºåˆ©åœ°ä» PHP 8.3 è¿ç§»åˆ° PHP 8.4ã€‚</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://zyf.im/tags/php/>Php</a></li><li><a href=https://zyf.im/tags/php-migrating/>Php-Migrating</a></li></ul><nav class=paginav><a class=prev href=https://zyf.im/2025/06/26/use-https-in-local-environment/><span class=title>Â« Prev</span><br><span>åœ¨æœ¬åœ°ç¯å¢ƒä½¿ç”¨ HTTPS</span>
</a><a class=next href=https://zyf.im/2024/08/01/php-migrating-82-to-83/><span class=title>Next Â»</span><br><span>PHP Migrating 8.2 to 8.3</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2026 <a href=https://zyf.im/>ZYF.IM BLOG</a></span> Â·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");if(menu){const e=localStorage.getItem("menu-scroll-position");e&&(menu.scrollLeft=parseInt(e,10)),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}}document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{const e=document.querySelector("html");e.dataset.theme==="dark"?(e.dataset.theme="light",localStorage.setItem("pref-theme","light")):(e.dataset.theme="dark",localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>