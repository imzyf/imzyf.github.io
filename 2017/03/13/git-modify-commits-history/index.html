<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Git 修改提交历史 | ZYF.IM BLOG</title><meta name=keywords content="git"><meta name=description content='在使用 Git 时，我们经常会遇到修改本地提交记录的情况。比如：修改最近一次提交记，还比如：将多次小的 commit 合并成一个大的 commit。
这种做发有利也有弊，利在：review 代码时，可以按功能看，可以省去 review 一些前期写的无效的代码；弊是：一次提交修改过多，如果有问题，不利于调试。
具体情况具体分析，是解决问题的金句。
修改最近一次提交记录
修改提交说明
如果只想更改最近一次的提交说明，只需输入：
git commit --amend
然后你就会进入文本编辑器，输入你想要的内容，保存并退出即可
改被提交的快照
如果你完成 commit 后又想修改被提交的快照，增加或者修改其中的文件。
先执行 git add 命令，将修改的文件添加到缓存区，然后运行 git commit -amend 命令，该命令会获取你当前的暂存区的内容一并提交到最后一次 commit
例如：新加了一个文件 new_file.cpp ，想要合并到最后一次提交，过程如下：
git add new_file.cpp
git commit -amend
也可以直接运行下面的命令，不过要小心，不要提交了多余的文件
git commit -a -amend
将文件从本次提交中移除
如果想把已经 commit 的文件从这次 commit 移除的话，运行命令：
git reset [-soft] HEAD~1 # -soft可加可不加，默认就是soft选项
git checkout -filename # 要从本次提交移除的文件名
git commit -m "new commit"

修改多个提交记录
要修改历史中更早的提交，你必须采用更复杂的工具。Git 没有一个修改历史的工具，但是你可以使用 rebase 工具来衍合一系列的提交到它们原来所在的 HEAD 上。'><meta name=author content="Me"><link rel=canonical href=https://zyf.im/2017/03/13/git-modify-commits-history/><link crossorigin=anonymous href=/assets/css/stylesheet.63618a0fd0c7dd946ad6f368012c097fc6e5a8464cefd289c140dd28c01ec58d.css integrity="sha256-Y2GKD9DH3ZRq1vNoASwJf8blqEZM79KJwUDdKMAexY0=" rel="preload stylesheet" as=style><link rel=icon href=https://zyf.im/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://zyf.im/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://zyf.im/favicon-32x32.png><link rel=apple-touch-icon href=https://zyf.im/apple-touch-icon.png><link rel=mask-icon href=https://zyf.im/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://zyf.im/2017/03/13/git-modify-commits-history/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-6DVZ6E58DG"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-6DVZ6E58DG")}</script><meta property="og:url" content="https://zyf.im/2017/03/13/git-modify-commits-history/"><meta property="og:site_name" content="ZYF.IM BLOG"><meta property="og:title" content="Git 修改提交历史"><meta property="og:description" content='在使用 Git 时，我们经常会遇到修改本地提交记录的情况。比如：修改最近一次提交记，还比如：将多次小的 commit 合并成一个大的 commit。
这种做发有利也有弊，利在：review 代码时，可以按功能看，可以省去 review 一些前期写的无效的代码；弊是：一次提交修改过多，如果有问题，不利于调试。
具体情况具体分析，是解决问题的金句。
修改最近一次提交记录 修改提交说明 如果只想更改最近一次的提交说明，只需输入：
git commit --amend 然后你就会进入文本编辑器，输入你想要的内容，保存并退出即可
改被提交的快照 如果你完成 commit 后又想修改被提交的快照，增加或者修改其中的文件。
先执行 git add 命令，将修改的文件添加到缓存区，然后运行 git commit -amend 命令，该命令会获取你当前的暂存区的内容一并提交到最后一次 commit
例如：新加了一个文件 new_file.cpp ，想要合并到最后一次提交，过程如下：
git add new_file.cpp git commit -amend 也可以直接运行下面的命令，不过要小心，不要提交了多余的文件
git commit -a -amend 将文件从本次提交中移除 如果想把已经 commit 的文件从这次 commit 移除的话，运行命令：
git reset [-soft] HEAD~1 # -soft可加可不加，默认就是soft选项 git checkout -filename # 要从本次提交移除的文件名 git commit -m "new commit" 修改多个提交记录 要修改历史中更早的提交，你必须采用更复杂的工具。Git 没有一个修改历史的工具，但是你可以使用 rebase 工具来衍合一系列的提交到它们原来所在的 HEAD 上。'><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2017-03-13T17:00:00+00:00"><meta property="article:modified_time" content="2017-03-13T17:00:00+00:00"><meta property="article:tag" content="Git"><meta name=twitter:card content="summary"><meta name=twitter:title content="Git 修改提交历史"><meta name=twitter:description content='在使用 Git 时，我们经常会遇到修改本地提交记录的情况。比如：修改最近一次提交记，还比如：将多次小的 commit 合并成一个大的 commit。
这种做发有利也有弊，利在：review 代码时，可以按功能看，可以省去 review 一些前期写的无效的代码；弊是：一次提交修改过多，如果有问题，不利于调试。
具体情况具体分析，是解决问题的金句。
修改最近一次提交记录
修改提交说明
如果只想更改最近一次的提交说明，只需输入：
git commit --amend
然后你就会进入文本编辑器，输入你想要的内容，保存并退出即可
改被提交的快照
如果你完成 commit 后又想修改被提交的快照，增加或者修改其中的文件。
先执行 git add 命令，将修改的文件添加到缓存区，然后运行 git commit -amend 命令，该命令会获取你当前的暂存区的内容一并提交到最后一次 commit
例如：新加了一个文件 new_file.cpp ，想要合并到最后一次提交，过程如下：
git add new_file.cpp
git commit -amend
也可以直接运行下面的命令，不过要小心，不要提交了多余的文件
git commit -a -amend
将文件从本次提交中移除
如果想把已经 commit 的文件从这次 commit 移除的话，运行命令：
git reset [-soft] HEAD~1 # -soft可加可不加，默认就是soft选项
git checkout -filename # 要从本次提交移除的文件名
git commit -m "new commit"

修改多个提交记录
要修改历史中更早的提交，你必须采用更复杂的工具。Git 没有一个修改历史的工具，但是你可以使用 rebase 工具来衍合一系列的提交到它们原来所在的 HEAD 上。'><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://zyf.im/posts/"},{"@type":"ListItem","position":2,"name":"Git 修改提交历史","item":"https://zyf.im/2017/03/13/git-modify-commits-history/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Git 修改提交历史","name":"Git 修改提交历史","description":"在使用 Git 时，我们经常会遇到修改本地提交记录的情况。比如：修改最近一次提交记，还比如：将多次小的 commit 合并成一个大的 commit。\n这种做发有利也有弊，利在：review 代码时，可以按功能看，可以省去 review 一些前期写的无效的代码；弊是：一次提交修改过多，如果有问题，不利于调试。\n具体情况具体分析，是解决问题的金句。\n修改最近一次提交记录 修改提交说明 如果只想更改最近一次的提交说明，只需输入：\ngit commit --amend 然后你就会进入文本编辑器，输入你想要的内容，保存并退出即可\n改被提交的快照 如果你完成 commit 后又想修改被提交的快照，增加或者修改其中的文件。\n先执行 git add 命令，将修改的文件添加到缓存区，然后运行 git commit -amend 命令，该命令会获取你当前的暂存区的内容一并提交到最后一次 commit\n例如：新加了一个文件 new_file.cpp ，想要合并到最后一次提交，过程如下：\ngit add new_file.cpp git commit -amend 也可以直接运行下面的命令，不过要小心，不要提交了多余的文件\ngit commit -a -amend 将文件从本次提交中移除 如果想把已经 commit 的文件从这次 commit 移除的话，运行命令：\ngit reset [-soft] HEAD~1 # -soft可加可不加，默认就是soft选项 git checkout -filename # 要从本次提交移除的文件名 git commit -m \u0026#34;new commit\u0026#34; 修改多个提交记录 要修改历史中更早的提交，你必须采用更复杂的工具。Git 没有一个修改历史的工具，但是你可以使用 rebase 工具来衍合一系列的提交到它们原来所在的 HEAD 上。\n","keywords":["git"],"articleBody":"在使用 Git 时，我们经常会遇到修改本地提交记录的情况。比如：修改最近一次提交记，还比如：将多次小的 commit 合并成一个大的 commit。\n这种做发有利也有弊，利在：review 代码时，可以按功能看，可以省去 review 一些前期写的无效的代码；弊是：一次提交修改过多，如果有问题，不利于调试。\n具体情况具体分析，是解决问题的金句。\n修改最近一次提交记录 修改提交说明 如果只想更改最近一次的提交说明，只需输入：\ngit commit --amend 然后你就会进入文本编辑器，输入你想要的内容，保存并退出即可\n改被提交的快照 如果你完成 commit 后又想修改被提交的快照，增加或者修改其中的文件。\n先执行 git add 命令，将修改的文件添加到缓存区，然后运行 git commit -amend 命令，该命令会获取你当前的暂存区的内容一并提交到最后一次 commit\n例如：新加了一个文件 new_file.cpp ，想要合并到最后一次提交，过程如下：\ngit add new_file.cpp git commit -amend 也可以直接运行下面的命令，不过要小心，不要提交了多余的文件\ngit commit -a -amend 将文件从本次提交中移除 如果想把已经 commit 的文件从这次 commit 移除的话，运行命令：\ngit reset [-soft] HEAD~1 # -soft可加可不加，默认就是soft选项 git checkout -filename # 要从本次提交移除的文件名 git commit -m \"new commit\" 修改多个提交记录 要修改历史中更早的提交，你必须采用更复杂的工具。Git 没有一个修改历史的工具，但是你可以使用 rebase 工具来衍合一系列的提交到它们原来所在的 HEAD 上。\n依靠这个交互式的 rebase 工具，你就可以停留在每一次提交后，如果你想修改或改变说明、增加文件或任何其他事情。你可以通过给 git rebase -i 命令以交互方式进行 rebase。\n例如，你想修改最近三次的提交说明，或者其中任意一次，你必须给 git rebase -i 提供一个参数，指明你想要修改的提交的父提交。\n例如 HEAD~3 是指从 HEAD 指针到 HEAD+3 的位置，也就是最近第 4 次提交。所以想修改最近 3 次提交，你需要指明第 3 次提交的父提交（第 4 次提交）即 HEAD~3。运行命令：\ngit rebase -i HEAD~3 再次提醒这是一个衍合命令，也就是 HEAD~3 到 HEAD 范围内的每一次提交都会被重写，不管你是否修改提交说明 SHA-1 的值都会发生变化。\n所以千万不要涵盖你已经推送到中心服务器的提交。这么做会使其他开发者产生混乱，因为你提供了同样变更的不同版本。运行该命令后进入交互界面，类似：\npick fecb551 Init the view model pick bb199a0 Update the version pick bc5cd9d Add new method # Rebase f77f585..fecb551 onto f77f585 # # Commands: # p, pick = use commit # r, reword = use commit, but edit the commit message # e, edit = use commit, but stop for amending # s, squash = use commit, but meld into previous commit # f, fixup = like \"squash\", but discard this commit's log message # x, exec = run command (the rest of the line) using shell # # These lines can be re-ordered; they are executed from top to bottom. # If you remove a line here THAT COMMIT WILL BE LOST. # However, if you remove everything, the rebase will be aborted. # Note that empty commits are commented out 根据命令提示，就可以进行历史更改了。很重要的一点是你得注意这些提交的顺序与你通常通过 log 命令看到的是相反的。\n如果你运行 log，你会看到下面这样的结果：\npick bc5cd9d Add new method pick bb199a0 Update the version pick fecb551 Init the view model 修改指定提交 例如：只修改最近第 3 次提交说明可以进行如下更改：\nreword fecb551 Init the view model pick bb199a0 Update the version pick bc5cd9d Add new method ... 保存并退出编辑器，rebase 命令在衍合到第 3 次提交时会进入提交说明编辑页面，在此进行编辑新的提交说明，保存并退出即可，rebase 命令继续进行直至完成全部衍合操作。\n如果你不仅想要修改提交说明，还要更改提交，可以进行如下更改：\nedit fecb551 Init the view model pick bb199a0 Update the version pick bc5cd9d Add new method ... 保存并退出编辑器，rebase 命令在衍合到第三次提交时会等待你提交新的更改，并提示你修改完成后运行 git commit –amend 命令，然后运行 git rebase –continue 继续进行 rebase 直至完成全部衍合。\n重排提交 你也可以使用 git rebase -i 命令对提交历史彻底重排或删除提交。例如你想删除”Update the version”这个提交，并且修改其他两次提交的顺序，可以将：\npick fecb551 Init the view model pick bb199a0 Update the version pick bc5cd9d Add new method ... 改为：\npick bc5cd9d Add new method pick fecb551 Init the view model 然后保存并退出编辑器，此时 rebase 命令会先应用 bc5cd9d (Add new method)，然后应用 fecb551 (Init the view model) bb199a0 Update the version 这次提交。然后保存并退出编辑器，此时 rebase 命令会先应用 bc5cd9d (Add new method)，然后应用 fecb551 (Init the view model)，接着停止。\n执行完上诉操作，你已经修改了这些提交的顺序，并且删除了 bb199a0 (Update the version) 这次提交。\n合并提交 git rebase -i 命令还可以将一系列提交合并成一个提交。从上面的脚本提示中可以看到 s, squash = use commit, but meld into previous commit 提示。\n如果用 squash 修饰提交就可以进行提交之间的合并，例如可以将脚本修改成这样：\npick fecb551 Init the view model squash bb199a0 Update the version squash bc5cd9d Add new method 保存并退出编辑器，rebase 命令会应用全部三次变更然后进入编辑器来归并三次提交说明。当你保存之后，你就拥有了一个包含前三次提交的全部变更的单一提交。\n拆分提交 拆分提交实际上就是撤销一次提交，然后分多次进行重新提交。例如你想将三次提交中的中间一次拆分。将 ”Update the version” 拆分成两次提交：”Update the version1” 和 ”Update the version2”，可以进行如下修改：\npick fecb551 Init the view model edit bb199a0 Update the version pick bc5cd9d Add new method 当 rebase 到 bb199a0 时，会进入等待你提交新 commit 的状态，这时看可以运行 git reset HEAD^ 对当前提交进行重置，然后分别运行 git add 命令添加想要提交的文件，分别进行 git commit，最后运行 git rebase –continue 完成所有衍合。整体过程如下：\ngit reset HEAD^ git add file1 git commit -m 'Update the version1' git add file2 git commit -m 'Update the version2' git rebase --continue 执行完上诉操作，提交历史看起来就像这样了：\n1c002dd Add new method 9b29157 Update the version2 35cfb2b Update the version1 f3cc40e Init the view model 再次提醒，这会修改你列表中的提交的 SHA 值，所以请确保这个列表里不包含你已经推送到共享仓库的提交。\nReferences Git 修改提交历史 - GLGJing’s Blog ","wordCount":"531","inLanguage":"en","datePublished":"2017-03-13T17:00:00Z","dateModified":"2017-03-13T17:00:00Z","author":{"@type":"Person","name":"Me"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://zyf.im/2017/03/13/git-modify-commits-history/"},"publisher":{"@type":"Organization","name":"ZYF.IM BLOG","logo":{"@type":"ImageObject","url":"https://zyf.im/favicon.ico"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://zyf.im/ accesskey=h title="ZYF.IM (Alt + H)"><img src=https://zyf.im/apple-touch-icon.png alt aria-label=logo height=35>ZYF.IM</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://zyf.im/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://zyf.im/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://zyf.im/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://zyf.im/about/ title=About><span>About</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://zyf.im/>Home</a>&nbsp;»&nbsp;<a href=https://zyf.im/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">Git 修改提交历史</h1><div class=post-meta><span title='2017-03-13 17:00:00 +0000 UTC'>March 13, 2017</span>&nbsp;·&nbsp;3 min&nbsp;·&nbsp;531 words&nbsp;·&nbsp;Me</div></header><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#修改最近一次提交记录>修改最近一次提交记录</a><ul><li><a href=#修改提交说明>修改提交说明</a></li><li><a href=#改被提交的快照>改被提交的快照</a></li><li><a href=#将文件从本次提交中移除>将文件从本次提交中移除</a></li></ul></li><li><a href=#修改多个提交记录>修改多个提交记录</a><ul><li><a href=#修改指定提交>修改指定提交</a></li><li><a href=#重排提交>重排提交</a></li><li><a href=#合并提交>合并提交</a></li><li><a href=#拆分提交>拆分提交</a></li></ul></li><li><a href=#references>References</a></li></ul></nav></div></details></div><div class=post-content><p>在使用 Git 时，我们经常会遇到修改本地提交记录的情况。比如：修改最近一次提交记，还比如：将多次小的 <code>commit</code> 合并成一个大的 <code>commit</code>。</p><p>这种做发有利也有弊，利在：review 代码时，可以按功能看，可以省去 review 一些前期写的无效的代码；弊是：一次提交修改过多，如果有问题，不利于调试。</p><p>具体情况具体分析，是解决问题的金句。</p><h2 id=修改最近一次提交记录>修改最近一次提交记录<a hidden class=anchor aria-hidden=true href=#修改最近一次提交记录>#</a></h2><h3 id=修改提交说明>修改提交说明<a hidden class=anchor aria-hidden=true href=#修改提交说明>#</a></h3><p>如果只想更改最近一次的提交说明，只需输入：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>git commit --amend
</span></span></code></pre></div><p>然后你就会进入文本编辑器，输入你想要的内容，保存并退出即可</p><h3 id=改被提交的快照>改被提交的快照<a hidden class=anchor aria-hidden=true href=#改被提交的快照>#</a></h3><p>如果你完成 <code>commit</code> 后又想修改被提交的快照，增加或者修改其中的文件。</p><p>先执行 <code>git add</code> 命令，将修改的文件添加到缓存区，然后运行 <code>git commit -amend</code> 命令，该命令会获取你当前的暂存区的内容一并提交到最后一次 <code>commit</code></p><p>例如：新加了一个文件 <code>new_file.cpp</code> ，想要合并到最后一次提交，过程如下：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>git add new_file.cpp
</span></span><span class=line><span class=cl>git commit -amend
</span></span></code></pre></div><p>也可以直接运行下面的命令，不过要小心，不要提交了多余的文件</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>git commit -a -amend
</span></span></code></pre></div><h3 id=将文件从本次提交中移除>将文件从本次提交中移除<a hidden class=anchor aria-hidden=true href=#将文件从本次提交中移除>#</a></h3><p>如果想把已经 <code>commit</code> 的文件从这次 <code>commit</code> 移除的话，运行命令：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>git reset <span class=o>[</span>-soft<span class=o>]</span> HEAD~1 <span class=c1># -soft可加可不加，默认就是soft选项</span>
</span></span><span class=line><span class=cl>git checkout -filename <span class=c1># 要从本次提交移除的文件名</span>
</span></span><span class=line><span class=cl>git commit -m <span class=s2>&#34;new commit&#34;</span>
</span></span></code></pre></div><h2 id=修改多个提交记录>修改多个提交记录<a hidden class=anchor aria-hidden=true href=#修改多个提交记录>#</a></h2><p>要修改历史中更早的提交，你必须采用更复杂的工具。Git 没有一个修改历史的工具，但是你可以使用 rebase 工具来衍合一系列的提交到它们原来所在的 HEAD 上。</p><p>依靠这个交互式的 rebase 工具，你就可以停留在每一次提交后，如果你想修改或改变说明、增加文件或任何其他事情。你可以通过给 <code>git rebase -i</code> 命令以交互方式进行 rebase。</p><p>例如，你想修改最近三次的提交说明，或者其中任意一次，你必须给 <code>git rebase -i</code> 提供一个参数，指明你想要修改的提交的父提交。</p><p>例如 <code>HEAD~3</code> 是指从 HEAD 指针到 HEAD+3 的位置，也就是最近第 4 次提交。所以想修改最近 3 次提交，你需要指明第 3 次提交的父提交（第 4 次提交）即 <code>HEAD~3</code>。运行命令：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>git rebase -i HEAD~3
</span></span></code></pre></div><p>再次提醒这是一个衍合命令，也就是 HEAD~3 到 HEAD 范围内的每一次提交都会被重写，不管你是否修改提交说明 SHA-1 的值都会发生变化。</p><p>所以千万不要涵盖你已经推送到中心服务器的提交。这么做会使其他开发者产生混乱，因为你提供了同样变更的不同版本。运行该命令后进入交互界面，类似：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>pick fecb551 Init the view model
</span></span><span class=line><span class=cl>pick bb199a0 Update the version
</span></span><span class=line><span class=cl>pick bc5cd9d Add new method
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Rebase f77f585..fecb551 onto f77f585</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=c1># Commands:</span>
</span></span><span class=line><span class=cl><span class=c1>#  p, pick = use commit</span>
</span></span><span class=line><span class=cl><span class=c1>#  r, reword = use commit, but edit the commit message</span>
</span></span><span class=line><span class=cl><span class=c1>#  e, edit = use commit, but stop for amending</span>
</span></span><span class=line><span class=cl><span class=c1>#  s, squash = use commit, but meld into previous commit</span>
</span></span><span class=line><span class=cl><span class=c1>#  f, fixup = like &#34;squash&#34;, but discard this commit&#39;s log message</span>
</span></span><span class=line><span class=cl><span class=c1>#  x, exec = run command (the rest of the line) using shell</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=c1># These lines can be re-ordered; they are executed from top to bottom.</span>
</span></span><span class=line><span class=cl><span class=c1># If you remove a line here THAT COMMIT WILL BE LOST.</span>
</span></span><span class=line><span class=cl><span class=c1># However, if you remove everything, the rebase will be aborted.</span>
</span></span><span class=line><span class=cl><span class=c1># Note that empty commits are commented out</span>
</span></span></code></pre></div><p>根据命令提示，就可以进行历史更改了。很重要的一点是你得注意这些提交的顺序与你通常通过 log 命令看到的是相反的。</p><p>如果你运行 log，你会看到下面这样的结果：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>pick bc5cd9d Add new method
</span></span><span class=line><span class=cl>pick bb199a0 Update the version
</span></span><span class=line><span class=cl>pick fecb551 Init the view model
</span></span></code></pre></div><h3 id=修改指定提交>修改指定提交<a hidden class=anchor aria-hidden=true href=#修改指定提交>#</a></h3><p>例如：只修改最近第 3 次提交说明可以进行如下更改：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>reword fecb551 Init the view model
</span></span><span class=line><span class=cl>pick bb199a0 Update the version
</span></span><span class=line><span class=cl>pick bc5cd9d Add new method
</span></span><span class=line><span class=cl>...
</span></span></code></pre></div><p>保存并退出编辑器，rebase 命令在衍合到第 3 次提交时会进入提交说明编辑页面，在此进行编辑新的提交说明，保存并退出即可，rebase 命令继续进行直至完成全部衍合操作。</p><p>如果你不仅想要修改提交说明，还要更改提交，可以进行如下更改：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>edit fecb551 Init the view model
</span></span><span class=line><span class=cl>pick bb199a0 Update the version
</span></span><span class=line><span class=cl>pick bc5cd9d Add new method
</span></span><span class=line><span class=cl>...
</span></span></code></pre></div><p>保存并退出编辑器，rebase 命令在衍合到第三次提交时会等待你提交新的更改，并提示你修改完成后运行 <code>git commit –amend</code> 命令，然后运行 <code>git rebase –continue</code> 继续进行 rebase 直至完成全部衍合。</p><h3 id=重排提交>重排提交<a hidden class=anchor aria-hidden=true href=#重排提交>#</a></h3><p>你也可以使用 <code>git rebase -i</code> 命令对提交历史彻底重排或删除提交。例如你想删除”Update the version”这个提交，并且修改其他两次提交的顺序，可以将：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>pick fecb551 Init the view model
</span></span><span class=line><span class=cl>pick bb199a0 Update the version
</span></span><span class=line><span class=cl>pick bc5cd9d Add new method
</span></span><span class=line><span class=cl>...
</span></span></code></pre></div><p>改为：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>pick bc5cd9d Add new method
</span></span><span class=line><span class=cl>pick fecb551 Init the view model
</span></span></code></pre></div><p>然后保存并退出编辑器，此时 rebase 命令会先应用 bc5cd9d (Add new method)，然后应用 fecb551 (Init the view model) bb199a0 Update the version 这次提交。然后保存并退出编辑器，此时 rebase 命令会先应用 bc5cd9d (Add new method)，然后应用 fecb551 (Init the view model)，接着停止。</p><p>执行完上诉操作，你已经修改了这些提交的顺序，并且删除了 bb199a0 (Update the version) 这次提交。</p><h3 id=合并提交>合并提交<a hidden class=anchor aria-hidden=true href=#合并提交>#</a></h3><p><code>git rebase -i</code> 命令还可以将一系列提交合并成一个提交。从上面的脚本提示中可以看到 s, squash = use commit, but meld into previous commit 提示。</p><p>如果用 squash 修饰提交就可以进行提交之间的合并，例如可以将脚本修改成这样：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>pick fecb551 Init the view model
</span></span><span class=line><span class=cl>squash bb199a0 Update the version
</span></span><span class=line><span class=cl>squash bc5cd9d Add new method
</span></span></code></pre></div><p>保存并退出编辑器，rebase 命令会应用全部三次变更然后进入编辑器来归并三次提交说明。当你保存之后，你就拥有了一个包含前三次提交的全部变更的单一提交。</p><h3 id=拆分提交>拆分提交<a hidden class=anchor aria-hidden=true href=#拆分提交>#</a></h3><p>拆分提交实际上就是撤销一次提交，然后分多次进行重新提交。例如你想将三次提交中的中间一次拆分。将 ”Update the version” 拆分成两次提交：”Update the version1” 和 ”Update the version2”，可以进行如下修改：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>pick fecb551 Init the view model
</span></span><span class=line><span class=cl>edit bb199a0 Update the version
</span></span><span class=line><span class=cl>pick bc5cd9d Add new method
</span></span></code></pre></div><p>当 rebase 到 bb199a0 时，会进入等待你提交新 commit 的状态，这时看可以运行 git reset HEAD^ 对当前提交进行重置，然后分别运行 git add 命令添加想要提交的文件，分别进行 git commit，最后运行 git rebase –continue 完成所有衍合。整体过程如下：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>git reset HEAD^
</span></span><span class=line><span class=cl>git add file1
</span></span><span class=line><span class=cl>git commit -m <span class=s1>&#39;Update the version1&#39;</span>
</span></span><span class=line><span class=cl>git add file2
</span></span><span class=line><span class=cl>git commit -m <span class=s1>&#39;Update the version2&#39;</span>
</span></span><span class=line><span class=cl>git rebase --continue
</span></span></code></pre></div><p>执行完上诉操作，提交历史看起来就像这样了：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>1c002dd Add new method
</span></span><span class=line><span class=cl>9b29157 Update the version2
</span></span><span class=line><span class=cl>35cfb2b Update the version1
</span></span><span class=line><span class=cl>f3cc40e Init the view model
</span></span></code></pre></div><p>再次提醒，这会修改你列表中的提交的 SHA 值，所以请确保这个列表里不包含你已经推送到共享仓库的提交。</p><h2 id=references>References<a hidden class=anchor aria-hidden=true href=#references>#</a></h2><ul><li><a href=http://glgjing.github.io/blog/2015/01/06/git-xiu-gai-ti-jiao-li-shi/>Git 修改提交历史 - GLGJing’s Blog</a></li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=https://zyf.im/tags/git/>Git</a></li></ul><nav class=paginav><a class=prev href=https://zyf.im/2017/03/14/google-no-country-redirection/><span class=title>« Prev</span><br><span>禁止 Google 根据区域重定向跳转</span>
</a><a class=next href=https://zyf.im/2017/03/09/php-empty-method-judge-0/><span class=title>Next »</span><br><span>PHP empty 方法判断 0.0</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://zyf.im/>ZYF.IM BLOG</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>