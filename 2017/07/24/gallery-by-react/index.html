<!DOCTYPE html><html lang="zh-cn"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><link rel="preconnect" href="//www.googletagmanager.com"><link rel="preconnect" href="//zz.bdstatic.com"><link rel="preconnect" href="//sp0.baidu.com"><link rel="preconnect" href="//www.google-analytics.com"><link rel="preconnect" href="//cdn1.lncld.net"><link rel="preconnect" href="//unpkg.com"><link rel="preconnect" href="//app-router.leancloud.cn"><link rel="preconnect" href="//9qpuwspm.api.lncld.net"><link rel="preconnect" href="//gravatar.loli.net"><title>React 图片画廊应用 | 全力以赴</title><meta name="HandheldFriendly" content="True"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="generator" content="hexo"><meta name="author" content="Yifans_Z"><meta name="description" content=""><meta name="keywords" content=""><meta name="theme-color" content="#3c484e"><meta name="msapplication-TileColor" content="#3c484e"><meta property="og:site_name" content="全力以赴"><meta property="og:type" content="article"><meta property="og:title" content="React 图片画廊应用 | 全力以赴"><meta property="og:description" content=""><meta property="og:url" content="https://zyf.im/2017/07/24/gallery-by-react/"><meta property="article:published_time" content="2017-07-24T19:07:00+08:00"><meta property="article:author" content="Yifans_Z"><meta property="article:published_first" content="全力以赴, /2017/07/24/gallery-by-react/"><link rel="stylesheet" href="/css/allinonecss.min.css"><script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-84666938-1"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-84666938-1")</script></head><body class="post-template"><div class="site-wrapper"><header class="site-header post-site-header outer"><div class="inner"><nav class="site-nav"><div class="site-nav-left"><ul class="nav"><li><a href="/" title="Home">HOME</a></li><li><a href="/archives" title="ARCHIVES">ARCHIVES</a></li><li><a href="/links" title="LINKS">LINKS</a></li><li><a href="/about" title="ABOUT">ABOUT</a></li></ul></div><div class="search-button-area"><a href="#search" class="search-button">Search ...</a></div><div class="site-nav-right"><a href="#search" class="search-button">Search ...</a><div class="social-links"><a class="social-link" title="github" href="https://github.com/imzyf" target="_blank" rel="noopener"><svg viewBox="0 0 1049 1024" xmlns="http://www.w3.org/2000/svg"><path d="M524.979332 0C234.676191 0 0 234.676191 0 524.979332c0 232.068678 150.366597 428.501342 358.967656 498.035028 26.075132 5.215026 35.636014-11.299224 35.636014-25.205961 0-12.168395-0.869171-53.888607-0.869171-97.347161-146.020741 31.290159-176.441729-62.580318-176.441729-62.580318-23.467619-60.841976-58.234462-76.487055-58.234463-76.487055-47.804409-32.15933 3.476684-32.15933 3.476685-32.15933 53.019436 3.476684 80.83291 53.888607 80.83291 53.888607 46.935238 79.963739 122.553122 57.365291 152.97411 43.458554 4.345855-33.897672 18.252593-57.365291 33.028501-70.402857-116.468925-12.168395-239.022047-57.365291-239.022047-259.012982 0-57.365291 20.860106-104.300529 53.888607-140.805715-5.215026-13.037566-23.467619-66.926173 5.215027-139.067372 0 0 44.327725-13.906737 144.282399 53.888607 41.720212-11.299224 86.917108-17.383422 131.244833-17.383422s89.524621 6.084198 131.244833 17.383422C756.178839 203.386032 800.506564 217.29277 800.506564 217.29277c28.682646 72.1412 10.430053 126.029806 5.215026 139.067372 33.897672 36.505185 53.888607 83.440424 53.888607 140.805715 0 201.64769-122.553122 245.975415-239.891218 259.012982 19.121764 16.514251 35.636014 47.804409 35.636015 97.347161 0 70.402857-0.869171 126.898978-0.869172 144.282399 0 13.906737 9.560882 30.420988 35.636015 25.205961 208.601059-69.533686 358.967656-265.96635 358.967655-498.035028C1049.958663 234.676191 814.413301 0 524.979332 0z"></path></svg></a></div></div></nav></div></header><div id="site-main" class="site-main outer" role="main"><div class="inner"><header class="post-full-header"><div class="post-full-meta"><time class="post-full-meta-date" datetime="2017-07-24T11:00:00.000Z">2017-07-24 </time><span class="date-divider">/</span></div><h1 class="post-full-title">React 图片画廊应用</h1></header><div class="post-full no-image"><div class="post-full-content"><article id="photoswipe" class="markdown-body"><h2 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h2><p>源于学习 MOOC React 实战 —— 打造画廊应用。项目源码：<a href="https://github.com/imzyf/gallery-by-react" target="_blank" rel="noopener">GitHub - imzyf/gallery-by-react</a></p><p>Thanks:</p><ul><li><a href="http://www.imooc.com/video/11739" target="_blank" rel="noopener">React 实战 —— 打造画廊应用</a></li><li><a href="https://github.com/ckinmind/gallery-by-react" target="_blank" rel="noopener">ckinmind/gallery-by-react</a></li><li><a href="https://github.com/Wobugaosuni/galleryByReact" target="_blank" rel="noopener">Wobugaosuni/galleryByReact</a></li></ul><h3 id="功能"><a href="#功能" class="headerlink" title="功能"></a>功能</h3><ul><li>图片分布：</li><li>中心区域：1 张图。</li><li>上部区域：至多 1 张图</li><li>两侧区域：剩下的图</li><li>除中心区域，图片在 ±30° 随机旋转。</li><li>点击中心区域图片，图片翻转，显示描述。</li><li>点击除中心区域图片，与中心图片互换位置。</li><li>圆点导航栏：<ul><li>位于中心区域图片所在的导航点，高亮显示。点击该圆点，图片翻转，显示描述。</li><li>除中心区域图片所在的导航点，被点击时，与中心图片互换位置。</li></ul></li></ul><h3 id="技术栈"><a href="#技术栈" class="headerlink" title="技术栈"></a>技术栈</h3><ul><li>使用 <code>React</code> 框架完成画廊页面制作。</li><li>使用 <code>ES6</code> 语法。</li><li>使用 <code>YEOMAN</code> 搭建项目，生成项目文件、代码结构。</li><li>使用 <code>Webpack</code> 实现前端自动化。</li><li>使用 <code>HTML5</code> 新增标签，如 <code>&lt;section&gt;、&lt;figure&gt;、&lt;figcaption&gt;、&lt;nav&gt;</code> 等。</li><li>使用 <code>SCSS</code> 编译器将 SCSS 文件编译成 CSS 文件。</li><li>使用 <code>CSS3</code> 的 transition 属性，实现旋转、平移、背景色的逐渐过渡。</li><li>使用 <code>Iconfont</code> 字体文件代替图片文件，支持 CSS3 对字体的修饰效果。</li><li>使用 <code>json</code> 格式存放图片信息。</li></ul><a id="more"></a><h2 id="项目搭建"><a href="#项目搭建" class="headerlink" title="项目搭建"></a>项目搭建</h2><h3 id="生成项目"><a href="#生成项目" class="headerlink" title="生成项目"></a>生成项目</h3><p>安装 yeoman <a href="http://yeoman.io/" target="_blank" rel="noopener">The web’s scaffolding tool for modern webapps | Yeoman</a></p><figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">npm install -g yo</span><br></pre></td></tr></tbody></table></figure><p>查看 yeoman 版本</p><figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">yo --version</span><br></pre></td></tr></tbody></table></figure><p>安装脚手架 generator-react-webpack <a href="https://github.com/react-webpack-generators/generator-react-webpack" target="_blank" rel="noopener">Yeoman generator for ReactJS and Webpack</a></p><figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">npm install -g generator-react-webpack</span><br></pre></td></tr></tbody></table></figure><p>查看 generator 版本</p><figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">npm ls -g --depth=1 2&gt;/dev/null | grep generator-</span><br></pre></td></tr></tbody></table></figure><ul><li><code>npm ls -g</code>：列出全局安装的所有 npm 包</li><li><code>--depth=1</code>：树状结构最多向下展示一层</li><li><code>2&gt;/dev/null</code>：如果执行 <code>npm ls -g</code> 的过程中，有错误消息，把错误消息重定向到我们的空设备文件上</li><li><code>&gt;</code>：重定向</li><li><code>1</code> 表示 standard out 标准输出</li><li><code>2</code> 表示 standard error 标准错误</li><li><code>/dev/null</code> 表示空设备文件</li><li><code>|</code>：通道，用来将上一个命令的输出内容作为下一个命令的输入内容</li><li><code>grep generator-</code>：在前面的输出结果中，检索 generator 开头的关键字内容</li></ul><p>生成项目</p><figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">yo react-webpack gallery-by-react</span><br></pre></td></tr></tbody></table></figure><p>启动服务，根据 <code>package.json</code> 中的 <code>scripts</code> 可以看出。</p><figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">npm run start</span><br></pre></td></tr></tbody></table></figure><!-- more --><p>我这里发生了一个报错：</p><figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">ERROR <span class="keyword">in</span> ./src/components/Main.js</span><br><span class="line">Module not found: Error: Cannot resolve module <span class="string">'sass-loader'</span> <span class="keyword">in</span> ...</span><br></pre></td></tr></tbody></table></figure><p>解决方法：</p><figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">npm install node-sass --save-dev</span><br><span class="line">npm install sass-loader --save-dev</span><br></pre></td></tr></tbody></table></figure><p>还遇到一个问题：<br>如果页面空白，可以尝试 <code>ctrl + f5</code>。</p><p>Generating new stateless functional components</p><figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">yo react-webpack:component my/namespaced/components/name --stateless</span><br></pre></td></tr></tbody></table></figure><h3 id="Webpack"><a href="#Webpack" class="headerlink" title="Webpack"></a>Webpack</h3><p><a href="https://webpack.js.org/" target="_blank" rel="noopener">webpack</a> is a module bundler.</p><p>关于 <code>generator-react-webpack</code> 目录结构大变样，已经是只需要 <code>webpack</code> 就能启动项目，其目录：</p><figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">|---cfg  这里存放 webpack 配置</span><br><span class="line">| |---base.js  webpack 基础配置</span><br><span class="line">| |---defaults.js  webpack 一些其他的默认配置</span><br><span class="line">| |---dev.js       测试环境的 webpack 配置，启动 npm run start 的时候会使用这份 webpack 设置。</span><br><span class="line">| |---dist.js      线上环境的 webpack 配置，启动 npm run dist 的时候会使用。</span><br><span class="line">| |---test.js      做单元测试的时候使用 npm run <span class="built_in">test</span>。</span><br><span class="line">|---dist           webpack 存放最终打包输出的用于生产环境的项目文件</span><br><span class="line">|---src                       <span class="comment"># 存放开发环境项目源码</span></span><br><span class="line">| |---/actions/               <span class="comment"># flux actions目录（没用到）</span></span><br><span class="line">| |---/components/            <span class="comment"># 组件目录</span></span><br><span class="line">| |---/config/                <span class="comment"># 配置目录（没用到）</span></span><br><span class="line">| |---/sources/               <span class="comment"># flux datasources目录（没用到）</span></span><br><span class="line">| |---/stores/                <span class="comment"># flux stores(没用到)</span></span><br><span class="line">| |---/styles/                <span class="comment"># 样式文件目录，内有一个App.css基础css文件</span></span><br><span class="line">| |---index.html              <span class="comment"># 项目入口文件</span></span><br><span class="line">| |---index.js                <span class="comment"># js入口文件</span></span><br><span class="line">|---/<span class="built_in">test</span>/                    <span class="comment"># 单元测试和集成测试目录</span></span><br><span class="line">|---.babelrc                  <span class="comment"># Babel 配置文件</span></span><br><span class="line">|---.editorconfig             <span class="comment"># EditorConfig 插件配置文件，用于统一编码风格。</span></span><br><span class="line">|---.eslintrc                 <span class="comment"># ESLint代码风格检测配置文件</span></span><br><span class="line">|---.gitignore                <span class="comment"># 需要 git 同步时忽略文件夹的配置文件</span></span><br><span class="line">|---.yo-rc.json               <span class="comment"># yeoman的配置文件</span></span><br><span class="line">|---karma.conf.js             <span class="comment"># karma测试框架的配置</span></span><br><span class="line">|---package.json              <span class="comment"># npm 的依赖配置项</span></span><br><span class="line">|---server.js                 <span class="comment"># 项目运行的js文件，命令可查看package.json中的script</span></span><br><span class="line">|---webpack.config.js         <span class="comment"># webpack配置文件，不同环境的配置项在cfg目录下</span></span><br></pre></td></tr></tbody></table></figure><h2 id="舞台构建"><a href="#舞台构建" class="headerlink" title="舞台构建"></a>舞台构建</h2><p>VCD 原则：View Controller Data。</p><p>创建 <code>src/sources/imageDatas.json</code></p><figure class="highlight json"><table><tbody><tr><td class="code"><pre><span class="line">[</span><br><span class="line">  {</span><br><span class="line">    <span class="attr">"fileName"</span>: <span class="string">"1.jpg"</span>,</span><br><span class="line">    <span class="attr">"title"</span>: <span class="string">"Heaven of time"</span>,</span><br><span class="line">    <span class="attr">"desc"</span>: <span class="string">"Here he comes Here comes Speed Racer."</span></span><br><span class="line">  },</span><br><span class="line">  {</span><br><span class="line">    <span class="attr">"fileName"</span>: <span class="string">"2.jpg"</span>,</span><br><span class="line">    <span class="attr">"title"</span>: <span class="string">"Heaven of time"</span>,</span><br><span class="line">    <span class="attr">"desc"</span>: <span class="string">"Here he comes Here comes Speed Racer."</span></span><br><span class="line">  }</span><br><span class="line">]</span><br></pre></td></tr></tbody></table></figure><p>安装 <a href="https://github.com/webpack-contrib/json-loader" target="_blank" rel="noopener">webpack-contrib/json-loader: json loader module for webpack</a>：</p><figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">npm install --save-dev json-loader</span><br></pre></td></tr></tbody></table></figure><p>json 中获取图片路径 ES6：</p><figure class="highlight javascript"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> imageJsonDatas <span class="keyword">from</span> <span class="string">"json!../data/imageDatas.json"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> imageDatas = imageJsonDatas.map(<span class="function">(<span class="params">image</span>) =&gt;</span> {</span><br><span class="line">  image.imageUrl = <span class="built_in">require</span>(<span class="string">"../images/"</span> + image.fileName);</span><br><span class="line">  <span class="keyword">return</span> image;</span><br><span class="line">});</span><br></pre></td></tr></tbody></table></figure><h2 id="图片组件构建"><a href="#图片组件构建" class="headerlink" title="图片组件构建"></a>图片组件构建</h2><figure class="highlight javascript"><table><tbody><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ImgFigure</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>{</span><br><span class="line">  render() {</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;figure className=<span class="string">"img-figure"</span>&gt;</span><br><span class="line">        &lt;img src={<span class="keyword">this</span>.props.data.imageUrl} alt={<span class="keyword">this</span>.props.data.title} /&gt;</span><br><span class="line">        &lt;figcaption&gt;</span><br><span class="line">          &lt;h2 className=<span class="string">"img-title"</span>&gt;{<span class="keyword">this</span>.props.data.title}&lt;<span class="regexp">/h2&gt;</span></span><br><span class="line"><span class="regexp">        &lt;/</span>figcaption&gt;</span><br><span class="line">      &lt;<span class="regexp">/figure&gt;</span></span><br><span class="line"><span class="regexp">    );</span></span><br><span class="line"><span class="regexp">  }</span></span><br><span class="line"><span class="regexp">}</span></span><br></pre></td></tr></tbody></table></figure><h3 id="设置图片位置"><a href="#设置图片位置" class="headerlink" title="设置图片位置"></a>设置图片位置</h3><ul><li>scrollWidth：对象的实际内容的宽度，不包边线宽度，会随对象中内容超过可视区后而变大。</li><li>clientWidth：对象内容的可视区的宽度，不包滚动条等边线，会随对象显示大小的变化而改变。</li><li>offsetWidth：对象整体的实际宽度，包滚动条等边线，会随对象显示大小的变化而改变。</li></ul><p>通过 <code>this.Constant</code> 初始化图片区域范围，在 <code>componentDidMount</code> 计算设置数值。</p><p>通过 <code>rearrange(centerIndex){}</code> 给每一个图片设置位置值。</p><h3 id="设置图片旋转"><a href="#设置图片旋转" class="headerlink" title="设置图片旋转"></a>设置图片旋转</h3><p>设置图片旋转角度，思路和设置图片位置一样：</p><figure class="highlight javascript"><table><tbody><tr><td class="code"><pre><span class="line">topImgs[index] = {</span><br><span class="line">  pos: {</span><br><span class="line">    top: getRangeRandom(topSection.y[<span class="number">0</span>], topSection.y[<span class="number">1</span>]),</span><br><span class="line">    left: getRangeRandom(topSection.x[<span class="number">0</span>], topSection.x[<span class="number">1</span>]),</span><br><span class="line">  },</span><br><span class="line">  rotate: get30DegRandom(),</span><br><span class="line">};</span><br></pre></td></tr></tbody></table></figure><p>设置角度样式，兼容游览器：</p><figure class="highlight javascript"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (rotate) {</span><br><span class="line">  [<span class="string">"MozTransform"</span>, <span class="string">"msTransform"</span>, <span class="string">"Webkittransform"</span>, <span class="string">"transform"</span>].forEach(</span><br><span class="line">    (value) =&gt; {</span><br><span class="line">      styleObj[value] = <span class="string">"rotate("</span> + rotate + <span class="string">"deg)"</span>;</span><br><span class="line">    }</span><br><span class="line">  );</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><h3 id="设置图片正反翻转、居中"><a href="#设置图片正反翻转、居中" class="headerlink" title="设置图片正反翻转、居中"></a>设置图片正反翻转、居中</h3><p>设置修改 state.isInverse 的方法：</p><figure class="highlight javascript"><table><tbody><tr><td class="code"><pre><span class="line">inverse(index) {</span><br><span class="line">    <span class="keyword">let</span> {imgsArrangeArr} = <span class="keyword">this</span>.state;</span><br><span class="line">    imgsArrangeArr[index].isInverse = !imgsArrangeArr[index].isInverse;</span><br><span class="line">    <span class="keyword">this</span>.setState({</span><br><span class="line">        imgsArrangeArr</span><br><span class="line">    })</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><figure class="highlight javascript"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> imgFigureClassName = <span class="string">"img-figure"</span>;</span><br><span class="line">imgFigureClassName += isInverse ? <span class="string">" is-inverse"</span> : <span class="string">""</span>;</span><br></pre></td></tr></tbody></table></figure><p>视图中 <code>onClick</code> 方法：</p><figure class="highlight javascript"><table><tbody><tr><td class="code"><pre><span class="line">&lt;figure</span><br><span class="line">  className={imgFigureClassName}</span><br><span class="line">  style={styleObj}</span><br><span class="line">  onClick={<span class="keyword">this</span>.handleClick}</span><br><span class="line">/&gt;</span><br></pre></td></tr></tbody></table></figure><p>处理点击方法：</p><figure class="highlight javascript"><table><tbody><tr><td class="code"><pre><span class="line">handleClick(e) {</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> {isCenter} = <span class="keyword">this</span>.props.arrange;</span><br><span class="line">    <span class="keyword">if</span> (isCenter) {</span><br><span class="line">        <span class="keyword">this</span>.props.inverse()</span><br><span class="line">    } <span class="keyword">else</span> {</span><br><span class="line">        <span class="keyword">this</span>.props.center()</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    e.stopPropagation();</span><br><span class="line">    e.preventDefault();</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><h3 id="设置过渡动画"><a href="#设置过渡动画" class="headerlink" title="设置过渡动画"></a>设置过渡动画</h3><p>补间动画：</p><figure class="highlight css"><table><tbody><tr><td class="code"><pre><span class="line"><span class="selector-tag">transition</span>: <span class="selector-tag">transform</span> 0<span class="selector-class">.6s</span> <span class="selector-tag">ease-in-out</span>, <span class="selector-tag">left</span> 0<span class="selector-class">.6s</span> <span class="selector-tag">ease-in-out</span>,</span><br><span class="line">  <span class="selector-tag">top</span> 0<span class="selector-class">.6s</span> <span class="selector-tag">ease-in-out</span>;</span><br></pre></td></tr></tbody></table></figure><p>更自然的图片翻转，翻转时转轴同时移动：</p><figure class="highlight css"><table><tbody><tr><td class="code"><pre><span class="line"><span class="selector-tag">transform-origin</span>: 0 50% 0; <span class="comment">/* 50% 50% 0 */</span></span><br><span class="line"></span><br><span class="line"><span class="selector-tag">transform</span>: <span class="selector-tag">translate</span>(0) <span class="selector-tag">rotateY</span>(180<span class="selector-tag">deg</span>);</span><br></pre></td></tr></tbody></table></figure><p>增强透视，父节点添加：</p><figure class="highlight css"><table><tbody><tr><td class="code"><pre><span class="line"><span class="selector-tag">perspective</span>: 1800<span class="selector-tag">px</span>;</span><br></pre></td></tr></tbody></table></figure><h2 id="控制组件"><a href="#控制组件" class="headerlink" title="控制组件"></a>控制组件</h2><figure class="highlight javascript"><table><tbody><tr><td class="code"><pre><span class="line">render() {</span><br><span class="line">    <span class="keyword">return</span>(</span><br><span class="line">        &lt;span className=<span class="string">"controller-unit"</span> onClick={(e)=&gt;<span class="keyword">this</span>.handleClick(e)}&gt;&lt;<span class="regexp">/span&gt;</span></span><br><span class="line"><span class="regexp">    );</span></span><br><span class="line"><span class="regexp">}</span></span><br></pre></td></tr></tbody></table></figure><h3 id="使用-Iconfont-添加箭头"><a href="#使用-Iconfont-添加箭头" class="headerlink" title="使用 Iconfont 添加箭头"></a>使用 Iconfont 添加箭头</h3><p><a href="http://www.iconfont.cn/" target="_blank" rel="noopener">Iconfont-阿里巴巴矢量图标库</a></p><ul><li>Iconfont 的体积更小。</li><li>Iconfont 是矢量图，拉伸不变形，颜色可自行更换，支持 CSS3 对字体的修饰效果。</li></ul><figure class="highlight css"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">@font-face</span> {</span><br><span class="line">  <span class="attribute">font-family</span>: <span class="string">"icons-turn-arrow"</span>;</span><br><span class="line">  <span class="attribute">src</span>: <span class="built_in">url</span>(<span class="string">"../fonts/icons/turn-arrow.eot"</span>) <span class="built_in">format</span>(<span class="string">"enbedded"</span>), <span class="built_in">url</span>(<span class="string">"../fonts/icons/turn-arrow.woff"</span>)</span><br><span class="line">      <span class="built_in">format</span>(<span class="string">"woff"</span>), <span class="built_in">url</span>(<span class="string">"../fonts/icons/turn-arrow.ttf"</span>) <span class="built_in">format</span>(<span class="string">"truetype"</span>), <span class="built_in">url</span>(<span class="string">"../fonts/icons/turn-arrow.svg"</span>)</span><br><span class="line">      <span class="built_in">format</span>(<span class="string">"svg"</span>);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>修改 <code>cfg/defaults.js</code>:</p><figure class="highlight js"><table><tbody><tr><td class="code"><pre><span class="line">test: <span class="regexp">/\.(png|jpg|gif|woff|woff2)$/</span>,</span><br><span class="line"></span><br><span class="line">改为：</span><br><span class="line">test: <span class="regexp">/\.(png|jpg|gif|woff|woff2|eot|ttf|svg)$/</span>,</span><br></pre></td></tr></tbody></table></figure><p>屏幕渲染机制有两种：</p><ul><li>灰阶渲染：控制边缘亮度，所耗内存相对较低，应用于手机。</li><li>亚像素渲染：效果更好，所耗内存相对更高，应用于 Mac 等。</li></ul><p>Mac 上有些浅色字体图片（在上面设置了白色，可以设置为深色进行测试）在浏览器上显得较粗，解决方案：</p><p>在父元素上设置属性，修改浏览器的属性：</p><figure class="highlight css"><table><tbody><tr><td class="code"><pre><span class="line"><span class="selector-tag">-webkit-font-smoothing</span>: <span class="selector-tag">antialiased</span>; <span class="comment">/* 开启 chrome 在 Mac 下字体渲染的灰阶平滑 */</span></span><br><span class="line"><span class="selector-tag">-moz-osx-font-smoothing</span>: <span class="selector-tag">grayscale</span>; <span class="comment">/* 开启 firefox 在 Mac 下字体渲染的灰阶平滑 */</span></span><br></pre></td></tr></tbody></table></figure><h3 id="事件响应"><a href="#事件响应" class="headerlink" title="事件响应"></a>事件响应</h3><figure class="highlight js"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> { isInverse, isCenter } = <span class="keyword">this</span>.props.arrange;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> controllerUnitClassName = <span class="string">"controller-unit"</span>;</span><br><span class="line"><span class="keyword">if</span> (isCenter) {</span><br><span class="line">  controllerUnitClassName += <span class="string">" is-center"</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (isInverse) {</span><br><span class="line">    controllerUnitClassName += <span class="string">" is-inverse"</span>;</span><br><span class="line">  }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><h2 id="GitHub-Page-发布"><a href="#GitHub-Page-发布" class="headerlink" title="GitHub Page 发布"></a>GitHub Page 发布</h2><p>GitHub Page 需要使用相对路径，修改：</p><p><code>cfg/default.js</code>：</p><figure class="highlight javascript"><table><tbody><tr><td class="code"><pre><span class="line">publicPath: <span class="string">'/assets/'</span>,</span><br><span class="line"></span><br><span class="line">改为：</span><br><span class="line">publicPath: <span class="string">'assets/'</span>,</span><br></pre></td></tr></tbody></table></figure><p><code>src/index.html</code></p><figure class="highlight html"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"/assets/app.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line">改成：</span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"assets/app.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><p>然后打包项目：</p><figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">npm run dist</span><br></pre></td></tr></tbody></table></figure><p>将 <code>dist</code> 提交到 Git 仓库：</p><figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">git add dist</span><br><span class="line">git commit -m <span class="string">"release project"</span></span><br></pre></td></tr></tbody></table></figure><p>推送到 GitHub Page：</p><figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">git subtree push --prefix=dist origin gh-pages</span><br></pre></td></tr></tbody></table></figure><p>改回代码：</p><figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">git reset --hard</span><br></pre></td></tr></tbody></table></figure><h2 id="TODO"><a href="#TODO" class="headerlink" title="TODO"></a>TODO</h2><ul><li style="list-style:none"><input type="checkbox">CSS Modules, radium</li><li style="list-style:none"><input type="checkbox">React Flux</li><li style="list-style:none"><input type="checkbox">React Animation API</li><li style="list-style:none"><input type="checkbox">React Canvas</li></ul></article><ul class="tags-postTags"><li><a href="/tags/react/" rel="tag"># react</a></li></ul></div></div></div><nav id="gobottom" class="pagination"><a class="prev-post" title="【Git 权威指南】读书笔记 - 独奏 - Part 3" href="/2017/08/03/got-git-reading-notes-solo-part3/">← 【Git 权威指南】读书笔记 - 独奏 - Part 3 </a><span class="prev-next-post">·</span> <a class="next-post" title="React 入门" href="/2017/07/20/imooc-react-getting-started-tutorial/">React 入门 →</a></nav></div><div class="toc-bar"><div class="toc-btn-bar"><a href="#site-main" class="toc-btn"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg"><path d="M793.024 710.272a32 32 0 1 0 45.952-44.544l-310.304-320a32 32 0 0 0-46.4 0.48l-297.696 320a32 32 0 0 0 46.848 43.584l274.752-295.328 286.848 295.808z"></path></svg></a><div class="toc-btn toc-switch"><svg class="toc-open" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg"><path d="M779.776 480h-387.2a32 32 0 0 0 0 64h387.2a32 32 0 0 0 0-64M779.776 672h-387.2a32 32 0 0 0 0 64h387.2a32 32 0 0 0 0-64M256 288a32 32 0 1 0 0 64 32 32 0 0 0 0-64M392.576 352h387.2a32 32 0 0 0 0-64h-387.2a32 32 0 0 0 0 64M256 480a32 32 0 1 0 0 64 32 32 0 0 0 0-64M256 672a32 32 0 1 0 0 64 32 32 0 0 0 0-64"></path></svg> <svg class="toc-close hide" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg"><path d="M512 960c-247.039484 0-448-200.960516-448-448S264.960516 64 512 64 960 264.960516 960 512 759.039484 960 512 960zM512 128.287273c-211.584464 0-383.712727 172.128262-383.712727 383.712727 0 211.551781 172.128262 383.712727 383.712727 383.712727 211.551781 0 383.712727-172.159226 383.712727-383.712727C895.712727 300.415536 723.551781 128.287273 512 128.287273z"></path><path d="M557.05545 513.376159l138.367639-136.864185c12.576374-12.416396 12.672705-32.671738 0.25631-45.248112s-32.704421-12.672705-45.248112-0.25631l-138.560301 137.024163-136.447897-136.864185c-12.512727-12.512727-32.735385-12.576374-45.248112-0.063647-12.512727 12.480043-12.54369 32.735385-0.063647 45.248112l136.255235 136.671523-137.376804 135.904314c-12.576374 12.447359-12.672705 32.671738-0.25631 45.248112 6.271845 6.335493 14.496116 9.504099 22.751351 9.504099 8.12794 0 16.25588-3.103239 22.496761-9.247789l137.567746-136.064292 138.687596 139.136568c6.240882 6.271845 14.432469 9.407768 22.65674 9.407768 8.191587 0 16.352211-3.135923 22.591372-9.34412 12.512727-12.480043 12.54369-32.704421 0.063647-45.248112L557.05545 513.376159z"></path></svg></div><a href="#gobottom" class="toc-btn"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg"><path d="M231.424 346.208a32 32 0 0 0-46.848 43.584l297.696 320a32 32 0 0 0 46.4 0.48l310.304-320a32 32 0 1 0-45.952-44.544l-286.848 295.808-274.752-295.36z"></path></svg></a></div><div class="toc-main"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#介绍"><span class="toc-text">介绍</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#功能"><span class="toc-text">功能</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#技术栈"><span class="toc-text">技术栈</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#项目搭建"><span class="toc-text">项目搭建</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#生成项目"><span class="toc-text">生成项目</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Webpack"><span class="toc-text">Webpack</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#舞台构建"><span class="toc-text">舞台构建</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#图片组件构建"><span class="toc-text">图片组件构建</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#设置图片位置"><span class="toc-text">设置图片位置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#设置图片旋转"><span class="toc-text">设置图片旋转</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#设置图片正反翻转、居中"><span class="toc-text">设置图片正反翻转、居中</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#设置过渡动画"><span class="toc-text">设置过渡动画</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#控制组件"><span class="toc-text">控制组件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#使用-Iconfont-添加箭头"><span class="toc-text">使用 Iconfont 添加箭头</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#事件响应"><span class="toc-text">事件响应</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#GitHub-Page-发布"><span class="toc-text">GitHub Page 发布</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#TODO"><span class="toc-text">TODO</span></a></li></ol></div></div><div class="pswp" tabindex="-1" role="dialog" aria-hidden="true"><div class="pswp__bg"></div><div class="pswp__scroll-wrap"><div class="pswp__container"><div class="pswp__item"></div><div class="pswp__item"></div><div class="pswp__item"></div></div><div class="pswp__ui pswp__ui--hidden"><div class="pswp__top-bar"><div class="pswp__counter"></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button> <button class="pswp__button pswp__button--share" title="Share"></button> <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button> <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class="pswp__preloader"><div class="pswp__preloader__icn"><div class="pswp__preloader__cut"><div class="pswp__preloader__donut"></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class="pswp__share-tooltip"></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button> <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class="pswp__caption"><div class="pswp__caption__center"></div></div></div></div></div></div><aside class="read-next outer"><div class="inner"><div class="read-next-feed"><article class="read-next-card" style="background-image:url(https://i.loli.net/2017/11/26/5a19c56faa29f.jpg)"><header class="read-next-card-header"><small class="read-next-card-header-sitetitle">— 全力以赴 —</small><h3 class="read-next-card-header-title">Recent Posts</h3></header><div class="read-next-divider"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 14.5s2 3 5 3 5.5-2.463 5.5-5.5S21 6.5 18 6.5c-5 0-7 11-12 11C2.962 17.5.5 15.037.5 12S3 6.5 6 6.5s4.5 3.5 4.5 3.5"></path></svg></div><div class="read-next-card-content"><ul><li><a href="/2022/08/14/mysql-course-45-reading-notes/">《MySQL 实战 45 讲》笔记</a></li><li><a href="/2022/07/28/shell-code-snippet/">Shell Code Snippet</a></li><li><a href="/2022/07/26/front-end-code-snippet/">Front-end Code Snippet</a></li></ul></div><footer class="read-next-card-footer"><a href="/archives">MORE →</a></footer></article><article class="read-next-card" style="background-image:url(https://i.loli.net/2017/11/26/5a19c56faa29f.jpg)"><header class="read-next-card-header tagcloud-card"><h3 class="read-next-card-header-title">Categories</h3></header><div class="read-next-card-content"><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/code-snippet/">code-snippet</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/report/">report</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/yii2/">yii2</a></li></ul></div></article><article class="read-next-card" style="background-image:url(https://i.loli.net/2017/11/26/5a19c56faa29f.jpg)"><header class="read-next-card-header tagcloud-card"><h3 class="read-next-card-header-title">Tag Cloud</h3></header><div class="read-next-card-content-ext"><a href="/tags/algorithm/" style="font-size:18.62px">algorithm</a> <a href="/tags/aws/" style="font-size:14px">aws</a> <a href="/tags/centos/" style="font-size:14.77px">centos</a> <a href="/tags/composer/" style="font-size:15.54px">composer</a> <a href="/tags/css/" style="font-size:17.08px">css</a> <a href="/tags/design-patterns/" style="font-size:14.77px">design-patterns</a> <a href="/tags/docker/" style="font-size:14px">docker</a> <a href="/tags/git/" style="font-size:23.23px">git</a> <a href="/tags/github/" style="font-size:15.54px">github</a> <a href="/tags/hexo/" style="font-size:15.54px">hexo</a> <a href="/tags/hive/" style="font-size:14px">hive</a> <a href="/tags/html/" style="font-size:16.31px">html</a> <a href="/tags/ios/" style="font-size:20.15px">ios</a> <a href="/tags/java/" style="font-size:20.92px">java</a> <a href="/tags/javascript/" style="font-size:14px">javascript</a> <a href="/tags/js/" style="font-size:14px">js</a> <a href="/tags/leetcode/" style="font-size:22.46px">leetcode</a> <a href="/tags/linux/" style="font-size:17.08px">linux</a> <a href="/tags/mac/" style="font-size:17.08px">mac</a> <a href="/tags/movie/" style="font-size:14px">movie</a> <a href="/tags/mysql/" style="font-size:21.69px">mysql</a> <a href="/tags/nginx/" style="font-size:17.85px">nginx</a> <a href="/tags/node-js/" style="font-size:14.77px">node-js</a> <a href="/tags/npm/" style="font-size:14px">npm</a> <a href="/tags/photoshop/" style="font-size:14px">photoshop</a> <a href="/tags/php/" style="font-size:24px">php</a> <a href="/tags/phpstorm/" style="font-size:14.77px">phpstorm</a> <a href="/tags/pr/" style="font-size:14px">pr</a> <a href="/tags/react/" style="font-size:16.31px">react</a> <a href="/tags/react-native/" style="font-size:14px">react-native</a> <a href="/tags/reading-notes/" style="font-size:17.85px">reading-notes</a> <a href="/tags/redis/" style="font-size:14px">redis</a> <a href="/tags/sql/" style="font-size:14px">sql</a> <a href="/tags/ssh/" style="font-size:14.77px">ssh</a> <a href="/tags/swift/" style="font-size:19.38px">swift</a> <a href="/tags/swoft/" style="font-size:14px">swoft</a> <a href="/tags/thinking/" style="font-size:14px">thinking</a> <a href="/tags/ubuntu/" style="font-size:18.62px">ubuntu</a> <a href="/tags/vim/" style="font-size:14px">vim</a> <a href="/tags/vscode/" style="font-size:14px">vscode</a> <a href="/tags/vue/" style="font-size:14.77px">vue</a> <a href="/tags/xcode/" style="font-size:14px">xcode</a> <a href="/tags/yii2/" style="font-size:14.77px">yii2</a></div></article></div></div></aside><div id="search" class="search-overlay"><div class="search-form"><input id="local-search-input" class="search-input" type="text" name="search" placeholder="Search ..."> <a class="search-overlay-close" href="#"></a></div><div id="local-search-result"></div></div><footer class="site-footer outer"><div class="site-footer-content inner"><div class="copyright"><a href="/" title="全力以赴">全力以赴 · 永远热泪盈眶 © 2022</a></div><nav class="site-footer-nav"><a href="https://hexo.io/" title="Hexo" target="_blank" rel="noopener">Hexo</a> <a href="https://github.com/xzhih/hexo-theme-casper" title="Casper" target="_blank" rel="noopener">Casper</a></nav></div></footer><script data-ad-client="ca-pub-2330747317815601" async="" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script>window.navigator&&navigator.serviceWorker&&navigator.serviceWorker.getRegistrations().then(function(r){for(var e of r)e.unregister()})</script><script id="scriptLoad" src="/js/allinone.min.js" async=""></script><script>document.getElementById("scriptLoad").addEventListener("load",function(){new Blazy;searchFunc("/")})</script><link rel="stylesheet" href="/photoswipe/photoswipe.css"><link rel="stylesheet" href="/photoswipe/default-skin/default-skin.css"><script src="/photoswipe/photoswipe.min.js"></script><script src="/photoswipe/photoswipe-ui-default.min.js"></script></body></html>