<!DOCTYPE html>
<html lang="zh-cn">
  <head><meta name="generator" content="Hexo 3.8.0">
    
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">


<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">

<meta name="theme-color" content="#f8f5ec">
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">



  <meta name="description" content="Vagrant Getting Started Tutorial">




  <meta name="keywords" content="ubuntu, vagrant, Yifans_Z Blog">










  <link rel="alternate" href="/atom.xml" title="Yifans_Z Blog">




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=2.10.3">



<link rel="canonical" href="https://zyf.im/2017/04/24/vagrant-getting-started-tutorial/">



  <link rel="stylesheet" type="text/css" href="/lib/fancybox/jquery.fancybox.css">






<link rel="stylesheet" type="text/css" href="/css/style.css?v=2.10.3">



  


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-84666938-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-84666938-1');
</script>


  <script id="baidu_push">
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>





  <script src="//cdn1.lncld.net/static/js/3.1.1/av-min.js"></script>
  <script id="leancloud">
    AV.init({
      appId: "er5hlK0M8mWKUTrVtqnHl97N-gzGzoHsz",
      appKey: "a6lIOEoJs3ijGvj3eP2rkFGG"
    });
  </script>





<script>
  window.config = {"leancloud":{"app_id":"er5hlK0M8mWKUTrVtqnHl97N-gzGzoHsz","app_key":"a6lIOEoJs3ijGvj3eP2rkFGG"},"toc":true,"fancybox":true,"pjax":false};
</script>

<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
  (adsbygoogle = window.adsbygoogle || []).push({
    google_ad_client: "ca-pub-2330747317815601",
    enable_page_level_ads: true
  });
</script>

    <title> Vagrant Getting Started Tutorial - Yifans_Z Blog </title>
  </head>

  <body><div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/." class="logo">Yifans_Z Blog</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>

<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    
      <a href="/">
        <li class="mobile-menu-item">
          
          
            首页
          
        </li>
      </a>
    
      <a href="/archives/">
        <li class="mobile-menu-item">
          
          
            归档
          
        </li>
      </a>
    
      <a href="/tags">
        <li class="mobile-menu-item">
          
          
            标签
          
        </li>
      </a>
    
      <a href="/about">
        <li class="mobile-menu-item">
          
          
            关于
          
        </li>
      </a>
    
  </ul>
</nav>

    <div class="container" id="mobile-panel">
      <header id="header" class="header"><div class="logo-wrapper">
  <a href="/." class="logo">Yifans_Z Blog</a>
</div>

<nav class="site-navbar">
  
    <ul id="menu" class="menu">
      
        <li class="menu-item">
          <a class="menu-item-link" href="/">
            
            
              首页
            
          </a>
        </li>
      
        <li class="menu-item">
          <a class="menu-item-link" href="/archives/">
            
            
              归档
            
          </a>
        </li>
      
        <li class="menu-item">
          <a class="menu-item-link" href="/tags">
            
            
              标签
            
          </a>
        </li>
      
        <li class="menu-item">
          <a class="menu-item-link" href="/about">
            
            
              关于
            
          </a>
        </li>
      
    </ul>
  
</nav>

      </header>

      <main id="main" class="main">
        <div class="content-wrapper">
          <div id="content" class="content">
            
  
  <article class="post">
    <header class="post-header">
      <h1 class="post-title">
        
          Vagrant Getting Started Tutorial
        
      </h1>

      <div class="post-meta">
        <span class="post-time">
          2017-04-24
        </span>
        
        
        <span class="post-visits" data-url="/2017/04/24/vagrant-getting-started-tutorial/" data-title="Vagrant Getting Started Tutorial">
          阅读次数 0
        </span>
        
      </div>
    </header>

    
    
  <div class="post-toc" id="post-toc">
    <h2 class="post-toc-title">文章目录</h2>
    <div class="post-toc-content">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Vagrant-介绍"><span class="toc-text">Vagrant 介绍</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Vagrant-文档"><span class="toc-text">Vagrant 文档</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#安装-Virtual-Box-和-Vagrant"><span class="toc-text">安装 Virtual Box 和 Vagrant</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Enable-Virtualization-Technolog"><span class="toc-text">Enable Virtualization Technolog</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#新建虚拟机"><span class="toc-text">新建虚拟机</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#下载-Ubuntu-box"><span class="toc-text">下载 Ubuntu box</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#添加镜像"><span class="toc-text">添加镜像</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#初始化虚拟机配置"><span class="toc-text">初始化虚拟机配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#启动虚拟机"><span class="toc-text">启动虚拟机</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#配置虚拟机环境"><span class="toc-text">配置虚拟机环境</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#SSH-登陆虚拟机"><span class="toc-text">SSH 登陆虚拟机</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#替换国内源"><span class="toc-text">替换国内源</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#LNMP"><span class="toc-text">LNMP</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Ngnix"><span class="toc-text">Ngnix</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#MySQL"><span class="toc-text">MySQL</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#PHP"><span class="toc-text">PHP</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Vagrant-高级"><span class="toc-text">Vagrant 高级</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#端口转发"><span class="toc-text">端口转发</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#使用-VirtualBox-设置"><span class="toc-text">使用 VirtualBox 设置</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#使用-Vagrant-配置"><span class="toc-text">使用 Vagrant 配置</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#网络配置"><span class="toc-text">网络配置</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Private-Networks"><span class="toc-text">Private Networks</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Public-Networks"><span class="toc-text">Public Networks</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Synced-Folders-共享目录"><span class="toc-text">Synced Folders 共享目录</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Provider-VirtualBox-Configuration"><span class="toc-text">Provider VirtualBox Configuration</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Virtual-Machine-Name"><span class="toc-text">Virtual Machine Name</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#VBoxManage-Customizations"><span class="toc-text">VBoxManage Customizations</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Virtual-hostname"><span class="toc-text">Virtual hostname</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Overwrite-host-locale-in-ssh-session"><span class="toc-text">Overwrite host locale in ssh session</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Vagrant-打包分发"><span class="toc-text">Vagrant 打包分发</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#通过-Vagrantfile-升级"><span class="toc-text">通过 Vagrantfile 升级</span></a></li></ol></li></ol>
    </div>
  </div>



    <div class="post-content">
      
        <p><strong>2018-04-12 更新：</strong> 开发环境或是生产环境推荐 Docker。</p>
<a id="more"></a>
<p>Vagrant 入门教程。Vagrant 安装、配置管理、打包分发</p>
<h2 id="Vagrant-介绍"><a href="#Vagrant-介绍" class="headerlink" title="Vagrant 介绍"></a>Vagrant 介绍</h2><p>Vagrant 可以为你提供可配置、可再生、便携的工作环境，它主要是一个中间层技术，它的下层是 VirtualBox，VMware，AWS 或者其他 provider，它的上层是 provisioning 工具，比如 shell scripts，Chef or Puppet 等可以自动化安装和配置软件的工具。</p>
<p>简单说：Vagrant 是虚拟机管理工具。</p>
<p>对于开发人员来说，Vagrant 可以帮你统一团队成员的开发环境。如果你或者你的伙伴创建了一个 Vagrantfile，那么你只需要执行 vagrant up 就行了，所有的软件都会统一安装并且配置好。同时还避免令人烦躁的 “在我的机器上是可以的” 问题。</p>
<p><em>实践环境：Ubuntu 16.04、IBM X200 laptops</em></p>
<h2 id="Vagrant-文档"><a href="#Vagrant-文档" class="headerlink" title="Vagrant 文档"></a>Vagrant 文档</h2><ul>
<li><a href="https://www.vagrantup.com/docs/index.html" target="_blank" rel="noopener">Vagrant Documentation</a></li>
</ul>
<h2 id="安装-Virtual-Box-和-Vagrant"><a href="#安装-Virtual-Box-和-Vagrant" class="headerlink" title="安装 Virtual Box 和 Vagrant"></a>安装 Virtual Box 和 Vagrant</h2><ul>
<li>下载 <a href="https://www.virtualbox.org/wiki/Downloads" target="_blank" rel="noopener">链接</a> 并安装 Virtual Box</li>
<li>下载 <a href="https://www.vagrantup.com/downloads.html" target="_blank" rel="noopener">链接</a> 并安装 Vagrant</li>
</ul>
<h2 id="Enable-Virtualization-Technolog"><a href="#Enable-Virtualization-Technolog" class="headerlink" title="Enable Virtualization Technolog"></a>Enable Virtualization Technolog</h2><p>在刚启动电脑时，按 F1 进入 BIOS，Config-&gt;CPU-&gt;Intel Virtualization Technology 中 <code>Intel VT-d Feature</code> 改成 <code>Enabled</code>，保存退出。</p>
<p><strong>注意：</strong> 这里有一个坑，修改后需要 <strong>关机再启动</strong>，直接重启电脑，配置不生效。</p>
<h2 id="新建虚拟机"><a href="#新建虚拟机" class="headerlink" title="新建虚拟机"></a>新建虚拟机</h2><h3 id="下载-Ubuntu-box"><a href="#下载-Ubuntu-box" class="headerlink" title="下载 Ubuntu box"></a>下载 Ubuntu box</h3><p>在 <a href="https://atlas.hashicorp.com/boxes/search?utf8=%E2%9C%93&amp;sort=&amp;provider=&amp;q=ubuntu" target="_blank" rel="noopener">Discover Vagrant Boxes</a> 查找 Ubuntu Server 14.04 64 box 安装命令</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">vagrant init ubuntu/trusty64; vagrant up --provider virtualbox</span><br></pre></td></tr></table></figure>
<p>下载速度缓慢，可以在命令行中看到 box 链接，建议直接在游览器中下载</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">https://atlas.hashicorp.com/ubuntu/boxes/trusty64/versions/20170405.0.0/providers/virtualbox.box</span><br></pre></td></tr></table></figure>
<h3 id="添加镜像"><a href="#添加镜像" class="headerlink" title="添加镜像"></a>添加镜像</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">vagrant box add ubuntu1404 ubuntu1404.box</span><br></pre></td></tr></table></figure>
<h3 id="初始化虚拟机配置"><a href="#初始化虚拟机配置" class="headerlink" title="初始化虚拟机配置"></a>初始化虚拟机配置</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">vagrant init ubuntu1404</span><br></pre></td></tr></table></figure>
<p>可以在 Vagrantfile 中增加：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">config.vm.provider &quot;virtualbox&quot; do |vb|</span><br><span class="line">  vb.memory = &quot;1024&quot;</span><br><span class="line">  vb.cpus = 2</span><br><span class="line">end</span><br></pre></td></tr></table></figure>
<h3 id="启动虚拟机"><a href="#启动虚拟机" class="headerlink" title="启动虚拟机"></a>启动虚拟机</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">vagrant up</span><br></pre></td></tr></table></figure>
<p>没有的话则新建。这里也可在 VM VirtualBox 中可以看到新的虚拟机。</p>
<h2 id="配置虚拟机环境"><a href="#配置虚拟机环境" class="headerlink" title="配置虚拟机环境"></a>配置虚拟机环境</h2><h3 id="SSH-登陆虚拟机"><a href="#SSH-登陆虚拟机" class="headerlink" title="SSH 登陆虚拟机"></a>SSH 登陆虚拟机</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">vagrant ssh</span><br></pre></td></tr></table></figure>
<h3 id="替换国内源"><a href="#替换国内源" class="headerlink" title="替换国内源"></a>替换国内源</h3><p>备份旧源：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">sudo cp /etc/apt/sources.list /etc/apt/sources.list.bak</span><br></pre></td></tr></table></figure>
<p>修改使用 aliyun 源：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">sudo vim /etc/apt/sources.list</span><br></pre></td></tr></table></figure>
<p>替换为：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">deb http://mirrors.aliyun.com/ubuntu/ trusty main restricted universe multiverse</span><br><span class="line">deb http://mirrors.aliyun.com/ubuntu/ trusty-security main restricted universe multiverse</span><br><span class="line">deb http://mirrors.aliyun.com/ubuntu/ trusty-updates main restricted universe multiverse</span><br><span class="line">deb http://mirrors.aliyun.com/ubuntu/ trusty-proposed main restricted universe multiverse</span><br><span class="line">deb http://mirrors.aliyun.com/ubuntu/ trusty-backports main restricted universe multiverse</span><br><span class="line">deb-src http://mirrors.aliyun.com/ubuntu/ trusty main restricted universe multiverse</span><br><span class="line">deb-src http://mirrors.aliyun.com/ubuntu/ trusty-security main restricted universe multiverse</span><br><span class="line">deb-src http://mirrors.aliyun.com/ubuntu/ trusty-updates main restricted universe multiverse</span><br><span class="line">deb-src http://mirrors.aliyun.com/ubuntu/ trusty-proposed main restricted universe multiverse</span><br><span class="line">deb-src http://mirrors.aliyun.com/ubuntu/ trusty-backports main restricted universe multiverse</span><br></pre></td></tr></table></figure>
<p>更新源：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">sudo apt-get update</span><br></pre></td></tr></table></figure>
<h3 id="LNMP"><a href="#LNMP" class="headerlink" title="LNMP"></a>LNMP</h3><h4 id="Ngnix"><a href="#Ngnix" class="headerlink" title="Ngnix"></a>Ngnix</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># search</span></span><br><span class="line">apt-cache search nginx</span><br><span class="line"><span class="comment"># install</span></span><br><span class="line">sudo apt-get install nginx</span><br><span class="line"><span class="comment"># show version</span></span><br><span class="line">nginx -v</span><br><span class="line"><span class="comment">#nginx version: nginx/1.4.6 (Ubuntu)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># test nginx</span></span><br><span class="line">curl -I <span class="string">'http://127.0.0.1'</span></span><br></pre></td></tr></table></figure>
<h4 id="MySQL"><a href="#MySQL" class="headerlink" title="MySQL"></a>MySQL</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt-get install mysql-server-5.6</span><br></pre></td></tr></table></figure>
<h4 id="PHP"><a href="#PHP" class="headerlink" title="PHP"></a>PHP</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt-get install php5-cli</span><br><span class="line">php -v</span><br><span class="line"><span class="comment">#PHP 5.5.9-1ubuntu4.21 (cli)</span></span><br><span class="line"><span class="comment"># install extend</span></span><br><span class="line">sudo apt-get install php5-mcrypt php5-mysql php5-gd</span><br><span class="line"><span class="comment"># install support nginx fastcgi</span></span><br><span class="line">sudo apt-get install php5-cgi php5-fpm -y</span><br></pre></td></tr></table></figure>
<h2 id="Vagrant-高级"><a href="#Vagrant-高级" class="headerlink" title="Vagrant 高级"></a>Vagrant 高级</h2><h3 id="端口转发"><a href="#端口转发" class="headerlink" title="端口转发"></a>端口转发</h3><h4 id="使用-VirtualBox-设置"><a href="#使用-VirtualBox-设置" class="headerlink" title="使用 VirtualBox 设置"></a>使用 VirtualBox 设置</h4><p>首先挂起虚拟机：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vagrant <span class="built_in">suspend</span></span><br></pre></td></tr></table></figure>
<p>在 VirtualBox 选择 Settings-&gt;Network-&gt;Advenced-&gt;Port Forwarding-&gt;adds</p>
<ul>
<li><code>Host IP</code> 宿主机端口</li>
<li><code>Guest Port</code> 虚拟机端口</li>
</ul>
<p>重启后失效，因为 Vagrant 会去读自己的配置文件</p>
<h4 id="使用-Vagrant-配置"><a href="#使用-Vagrant-配置" class="headerlink" title="使用 Vagrant 配置"></a>使用 Vagrant 配置</h4><blockquote>
<p><a href="https://www.vagrantup.com/docs/networking/forwarded_ports.html" target="_blank" rel="noopener">Forwarded Ports - Networking</a></p>
</blockquote>
<p>This will allow accessing port 80 on the guest via port 8080 on the host.</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line">Vagrant.configure(<span class="string">"2"</span>) <span class="keyword">do</span> <span class="params">|config|</span></span><br><span class="line">  config.vm.network <span class="string">"forwarded_port"</span>, <span class="symbol">guest:</span> <span class="number">80</span>, <span class="symbol">host:</span> <span class="number">8080</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vagrant reload</span><br></pre></td></tr></table></figure>
<p>重启虚拟机。</p>
<h3 id="网络配置"><a href="#网络配置" class="headerlink" title="网络配置"></a>网络配置</h3><h4 id="Private-Networks"><a href="#Private-Networks" class="headerlink" title="Private Networks"></a>Private Networks</h4><blockquote>
<p><a href="https://www.vagrantup.com/docs/networking/private_network.html" target="_blank" rel="noopener">Private Networks - Networking</a></p>
</blockquote>
<p>Static IP</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line">Vagrant.configure(<span class="string">"2"</span>) <span class="keyword">do</span> <span class="params">|config|</span></span><br><span class="line">  config.vm.network <span class="string">"private_network"</span>, <span class="symbol">ip:</span> <span class="string">"192.168.50.4"</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p>Host 访问 Guest machine 将不需要端口转发</p>
<h4 id="Public-Networks"><a href="#Public-Networks" class="headerlink" title="Public Networks"></a>Public Networks</h4><blockquote>
<p><a href="https://www.vagrantup.com/docs/networking/public_network.html" target="_blank" rel="noopener">Public Networks - Networking</a></p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">config.vm.network &quot;public_network&quot;, ip: &quot;192.168.0.17&quot;</span><br></pre></td></tr></table></figure>
<p>要和 Host machine 在同一网段，同一路由下的计算机也可访问</p>
<h3 id="Synced-Folders-共享目录"><a href="#Synced-Folders-共享目录" class="headerlink" title="Synced Folders 共享目录"></a>Synced Folders 共享目录</h3><blockquote>
<p><a href="https://www.vagrantup.com/docs/synced-folders/basic_usage.html" target="_blank" rel="noopener">Basic Usage - Synced Folders</a></p>
</blockquote>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line">Vagrant.configure(<span class="string">"2"</span>) <span class="keyword">do</span> <span class="params">|config|</span></span><br><span class="line">  <span class="comment"># other config here</span></span><br><span class="line"></span><br><span class="line">  config.vm.synced_folder <span class="string">"src/"</span>, <span class="string">"/srv/website"</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p>Enabling NFS Synced Folders, To enable NFS, just add the <code>type: &quot;nfs&quot;</code> flag onto your synced folder:</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line">Vagrant.configure(<span class="string">"2"</span>) <span class="keyword">do</span> <span class="params">|config|</span></span><br><span class="line">  config.vm.synced_folder <span class="string">"."</span>, <span class="string">"/vagrant"</span>, <span class="symbol">type:</span> <span class="string">"nfs"</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p>使用 NFS 需要配置 private network，如果遇到：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">It appears your machine doesn<span class="string">'t support NFS, or there is not an</span></span><br><span class="line"><span class="string">adapter to enable NFS on this machine for Vagrant. Please verify</span></span><br><span class="line"><span class="string">that `nfsd` is installed on your machine, and try again.</span></span><br><span class="line"><span class="string">It appears your machine doesn'</span>t support NFS</span><br></pre></td></tr></table></figure>
<p>try to：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt-get install nfs-common nfs-kernel-server</span><br></pre></td></tr></table></figure>
<p>Caveats：</p>
<blockquote>
<p><a href="https://www.vagrantup.com/docs/synced-folders/virtualbox.html" target="_blank" rel="noopener">Synced Folders VirtualBox</a></p>
</blockquote>
<p>There is a VirtualBox bug related to sendfile which can result in corrupted or non-updating files. You should deactivate sendfile in any web servers you may be running.</p>
<p>In Nginx:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">sendfile off;</span><br></pre></td></tr></table></figure>
<h3 id="Provider-VirtualBox-Configuration"><a href="#Provider-VirtualBox-Configuration" class="headerlink" title="Provider VirtualBox Configuration"></a>Provider VirtualBox Configuration</h3><blockquote>
<p><a href="https://www.vagrantup.com/docs/virtualbox/configuration.html" target="_blank" rel="noopener">Provider VirtualBox Configuration</a></p>
</blockquote>
<h4 id="Virtual-Machine-Name"><a href="#Virtual-Machine-Name" class="headerlink" title="Virtual Machine Name"></a>Virtual Machine Name</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">config.vm.provider &quot;virtualbox&quot; do |vb|</span><br><span class="line">   vb.name = &quot;my_vm&quot;</span><br><span class="line">end</span><br></pre></td></tr></table></figure>
<h4 id="VBoxManage-Customizations"><a href="#VBoxManage-Customizations" class="headerlink" title="VBoxManage Customizations"></a>VBoxManage Customizations</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">config.vm.provider &quot;virtualbox&quot; do |vb|</span><br><span class="line">  vb.memory = 1024</span><br><span class="line">  vb.cpus = 2</span><br><span class="line">end</span><br></pre></td></tr></table></figure>
<h4 id="Virtual-hostname"><a href="#Virtual-hostname" class="headerlink" title="Virtual hostname"></a>Virtual hostname</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">config.vm.hostname = &quot;mooc&quot;</span><br></pre></td></tr></table></figure>
<h3 id="Overwrite-host-locale-in-ssh-session"><a href="#Overwrite-host-locale-in-ssh-session" class="headerlink" title="Overwrite host locale in ssh session"></a>Overwrite host locale in ssh session</h3><figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line">ENV[<span class="string">"LC_ALL"</span>] = <span class="string">"en_US.UTF-8"</span></span><br><span class="line"></span><br><span class="line">Vagrant.configure(<span class="string">"2"</span>) <span class="keyword">do</span> <span class="params">|config|</span></span><br><span class="line">  <span class="comment"># ...</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<h2 id="Vagrant-打包分发"><a href="#Vagrant-打包分发" class="headerlink" title="Vagrant 打包分发"></a>Vagrant 打包分发</h2><p>关闭虚拟机：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">vagrant halt</span><br></pre></td></tr></table></figure>
<p>打包时注意：Vagrantfile 中固定的 IP，可以先注释；打包：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">vagrant package --output mooc.box</span><br></pre></td></tr></table></figure>
<p>启动 box：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">vagrant box add mooc mooc.box</span><br><span class="line">vagrant init mooc</span><br><span class="line">vagrant up</span><br></pre></td></tr></table></figure>
<h3 id="通过-Vagrantfile-升级"><a href="#通过-Vagrantfile-升级" class="headerlink" title="通过 Vagrantfile 升级"></a>通过 Vagrantfile 升级</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">config.vm.provision &quot;shell&quot;, inline: &lt;&lt;-SHELL</span><br><span class="line">   apt-get update</span><br><span class="line">   apt-get install -y redis-server</span><br><span class="line">SHELL</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">vagrant reload --provision</span><br></pre></td></tr></table></figure>
<blockquote>
<p>Reference:</p>
<ul>
<li><a href="https://github.com/apanly/mooc/tree/master/vagrant" target="_blank" rel="noopener">mooc/vagrant at master · apanly/mooc</a></li>
<li><a href="http://www.imooc.com/learn/805" target="_blank" rel="noopener">vagrant 打造跨平台可移动的开发环境</a></li>
<li><a href="http://weizhifeng.net/learn-vagrant-01.html" target="_blank" rel="noopener">Vagrant 介绍</a></li>
</ul>
</blockquote>

      
    </div>

    
      
      

  <div class="post-copyright">
    <p class="copyright-item">
      <span>原文作者: </span>
      <a href="https://zyf.im">Yifans_Z</a>
    </p>
    <p class="copyright-item">
      <span>原文链接: </span>
      <a href="https://zyf.im/2017/04/24/vagrant-getting-started-tutorial/">https://zyf.im/2017/04/24/vagrant-getting-started-tutorial/</a>
    </p>
    <p class="copyright-item">
      <span>许可协议: </span>
      
      <a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/" target="_blank">知识共享署名-非商业性使用 4.0 国际许可协议</a>
    </p>
  </div>



      
      
  <div class="post-reward">
    <input type="checkbox" name="reward" id="reward" hidden>
    <label class="reward-button" for="reward">赞赏支持</label>
    <div class="qr-code">
      
      
        <label class="qr-code-image" for="reward">
          <img class="image" src="https://cdn-qn.yifans.com/imzyf/reward_wechat.jpg" title="wechat">
        </label>
      
      
    </div>
  </div>


    

    
      <footer class="post-footer">
        
          <div class="post-tags">
            
              <a href="/tags/ubuntu/">ubuntu</a>
            
              <a href="/tags/vagrant/">vagrant</a>
            
          </div>
        
        
        
  <nav class="post-nav">
    
      <a class="prev" href="/2017/05/10/install-and-setting-ngx-pagespeed-in-ubuntu/">
        <i class="iconfont icon-left"></i>
        <span class="prev-text nav-default">Ubuntu 安装配置 ngx_pagespeed</span>
        <span class="prev-text nav-mobile">上一篇</span>
      </a>
    
    
      <a class="next" href="/2017/04/21/what-is-fastcgi-params-fastcgi-conf-snippets-fastcgi-php-conf/">
        <span class="next-text nav-default">区分 Nginx 中 fastcgi_params fastcgi.conf snippets/fastcgi-php.conf</span>
        <span class="prev-text nav-mobile">下一篇</span>
        <i class="iconfont icon-right"></i>
      </a>
    
  </nav>


      </footer>
    

  </article>


          </div>
          
  <div class="comments" id="comments">
    
      <div id="disqus_thread">
        <noscript>
          Please enable JavaScript to view the
          <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a>
        </noscript>
      </div>
    
  </div>


        </div>
      </main>

      <footer id="footer" class="footer">

  <div class="social-links">
    
      
        
          <a href="mailto:168@yifans.com" class="iconfont icon-email" title="email"></a>
        
      
    
      
        
          <a href="https://github.com/imzyf" class="iconfont icon-github" title="github"></a>
        
      
    
      
        
          <a href="https://stackoverflow.com/users/5958443/yifan" class="iconfont icon-stack-overflow" title="stack-overflow"></a>
        
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    

    
      <a href="/atom.xml" class="iconfont icon-rss" title="rss"></a>
    
  </div>



<div class="copyright">
  <span class="power-by">
    由 <a class="hexo-link" rel="nofollow" href="https://hexo.io/">Hexo</a> 强力驱动
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    主题 -
    <a class="theme-link" rel="nofollow" href="https://github.com/ahonn/hexo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    
    &copy;
    
      2016 -
    
    2019

    <span class="heart">
      <i class="iconfont icon-heart"></i>
    </span>
    <span class="author">Yifans_Z</span>
  </span>
</div>

<!-- Start of StatCounter Code for Default Guide -->
<script type="text/javascript">
var sc_project=11262529;
var sc_invisible=1;
var sc_security="476b93ef";
var scJsHost = (("https:" == document.location.protocol) ?
"https://secure." : "http://www.");
document.write("<sc"+"ript type='text/javascript' src='" +
scJsHost+
"statcounter.com/counter/counter.js'></"+"script>");
</script>
<noscript><div class="statcounter"><a title="web analytics" href="http://statcounter.com/" target="_blank"><img class="statcounter" src="//c.statcounter.com/11262529/0/476b93ef/1/" alt="web
analytics"></a></div></noscript>
<!-- End of StatCounter Code for Default Guide -->

      </footer>

      <div class="back-to-top" id="back-to-top">
        <i class="iconfont icon-up"></i>
      </div>
    </div>

    
  
  <script type="text/javascript">
    var disqus_config = function () {
        this.page.url = 'https://zyf.im/2017/04/24/vagrant-getting-started-tutorial/';
        this.page.identifier = '2017/04/24/vagrant-getting-started-tutorial/';
        this.page.title = 'Vagrant Getting Started Tutorial';
    };
    (function() {
    var d = document, s = d.createElement('script');

    s.src = '//yifans.disqus.com/embed.js';

    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
    })();  
  </script>

  

  



    
  







  
    <script type="text/javascript" src="/lib/jquery/jquery.min.js"></script>
  

  
    <script type="text/javascript" src="/lib/slideout/slideout.js"></script>
  

  
    <script type="text/javascript" src="/lib/fancybox/jquery.fancybox.pack.js"></script>
  

  

  


    <script type="text/javascript" src="/js/src/even.js?v=2.10.3"></script>

  </body>
</html>
